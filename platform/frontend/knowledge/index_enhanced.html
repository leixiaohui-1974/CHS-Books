<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ°´åˆ©æ°´ç”µæ°´åŠ¡çŸ¥è¯†åº“ - æ™ºèƒ½é—®ç­”ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .search-section {
            margin-bottom: 30px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-btn, .ask-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-btn:hover, .ask-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .search-btn:active, .ask-btn:active {
            transform: translateY(0);
        }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .filter-group {
            flex: 1;
        }

        .filter-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .filter-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
        }

        .results {
            margin-top: 30px;
        }

        .result-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            transition: all 0.3s;
        }

        .result-item:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateX(5px);
        }

        .result-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .result-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .meta-tag {
            padding: 4px 10px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 12px;
        }

        .relevance {
            color: #666;
        }

        .relevance-bar {
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .relevance-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .answer-section {
            background: #f0f7ff;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
            margin-top: 20px;
        }

        .answer-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .answer-header h3 {
            color: #667eea;
            font-size: 20px;
        }

        .answer-content {
            color: #333;
            line-height: 1.8;
            white-space: pre-wrap;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .examples {
            margin-top: 30px;
        }

        .example-group {
            margin-bottom: 25px;
        }

        .example-group h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .example-item {
            background: #f8f9fa;
            padding: 12px 18px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .example-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }

        .feedback-section {
            margin-top: 20px;
            padding: 20px;
            background: #fff8e1;
            border-radius: 10px;
        }

        .feedback-buttons {
            display: flex;
            gap: 10px;
        }

        .feedback-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .feedback-btn.positive {
            background: #4caf50;
            color: white;
        }

        .feedback-btn.negative {
            background: #f44336;
            color: white;
        }

        .feedback-btn:hover {
            transform: scale(1.05);
        }

        .timing-info {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            font-size: 14px;
            color: #666;
        }

        .timing-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒŠ æ°´åˆ©æ°´ç”µæ°´åŠ¡çŸ¥è¯†åº“</h1>
            <p>æ™ºèƒ½é—®ç­”ç³»ç»Ÿ - åŸºäºRAGæŠ€æœ¯çš„ä¸“ä¸šçŸ¥è¯†æ£€ç´¢</p>
        </div>

        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('qa')">ğŸ’¬ æ™ºèƒ½é—®ç­”</button>
                <button class="tab" onclick="switchTab('search')">ğŸ” çŸ¥è¯†æ£€ç´¢</button>
                <button class="tab" onclick="switchTab('stats')">ğŸ“Š ç»Ÿè®¡ä¿¡æ¯</button>
                <button class="tab" onclick="switchTab('help')">â“ ä½¿ç”¨å¸®åŠ©</button>
            </div>

            <!-- æ™ºèƒ½é—®ç­”æ ‡ç­¾é¡µ -->
            <div id="qa-tab" class="tab-content active">
                <div class="search-section">
                    <h3 style="margin-bottom: 15px;">æå‡ºæ‚¨çš„é—®é¢˜</h3>
                    <div class="search-box">
                        <input type="text" id="question-input" class="search-input" 
                               placeholder="ä¾‹å¦‚ï¼šä»€ä¹ˆæ˜¯æ°´åŠ›å­¦ï¼Ÿæ··å‡åœŸé‡åŠ›åå¦‚ä½•è®¾è®¡ï¼Ÿ">
                        <button class="ask-btn" onclick="askQuestion()">ğŸ¤– æé—®</button>
                    </div>
                </div>

                <div id="qa-results" class="results"></div>

                <div class="examples">
                    <h3 style="margin-bottom: 20px;">ç¤ºä¾‹é—®é¢˜</h3>
                    <div class="example-group">
                        <h4>ğŸ“š åŸºç¡€ç†è®º</h4>
                        <div class="example-item" onclick="setQuestion('ä»€ä¹ˆæ˜¯æ°´åŠ›å­¦ï¼Ÿ')">
                            ä»€ä¹ˆæ˜¯æ°´åŠ›å­¦ï¼Ÿ
                        </div>
                        <div class="example-item" onclick="setQuestion('æ˜æ¸ æµåŠ¨çš„ç‰¹ç‚¹æœ‰å“ªäº›ï¼Ÿ')">
                            æ˜æ¸ æµåŠ¨çš„ç‰¹ç‚¹æœ‰å“ªäº›ï¼Ÿ
                        </div>
                    </div>

                    <div class="example-group">
                        <h4>ğŸ—ï¸ å·¥ç¨‹è®¾è®¡</h4>
                        <div class="example-item" onclick="setQuestion('æ··å‡åœŸé‡åŠ›åå¦‚ä½•è¿›è¡Œç¨³å®šæ€§åˆ†æï¼Ÿ')">
                            æ··å‡åœŸé‡åŠ›åå¦‚ä½•è¿›è¡Œç¨³å®šæ€§åˆ†æï¼Ÿ
                        </div>
                        <div class="example-item" onclick="setQuestion('æ°´ç”µç«™ç”±å“ªäº›ä¸»è¦éƒ¨åˆ†ç»„æˆï¼Ÿ')">
                            æ°´ç”µç«™ç”±å“ªäº›ä¸»è¦éƒ¨åˆ†ç»„æˆï¼Ÿ
                        </div>
                    </div>

                    <div class="example-group">
                        <h4>ğŸ“‹ è§„èŒƒæ ‡å‡†</h4>
                        <div class="example-item" onclick="setQuestion('SL 319è§„èŒƒä¸»è¦è§„å®šäº†ä»€ä¹ˆå†…å®¹ï¼Ÿ')">
                            SL 319è§„èŒƒä¸»è¦è§„å®šäº†ä»€ä¹ˆå†…å®¹ï¼Ÿ
                        </div>
                    </div>

                    <div class="example-group">
                        <h4>ğŸš€ å‰æ²¿æŠ€æœ¯</h4>
                        <div class="example-item" onclick="setQuestion('æ™ºæ…§æ°´åˆ©æœ‰å“ªäº›åº”ç”¨ï¼Ÿ')">
                            æ™ºæ…§æ°´åˆ©æœ‰å“ªäº›åº”ç”¨ï¼Ÿ
                        </div>
                        <div class="example-item" onclick="setQuestion('BIMæŠ€æœ¯åœ¨æ°´åˆ©å·¥ç¨‹ä¸­å¦‚ä½•åº”ç”¨ï¼Ÿ')">
                            BIMæŠ€æœ¯åœ¨æ°´åˆ©å·¥ç¨‹ä¸­å¦‚ä½•åº”ç”¨ï¼Ÿ
                        </div>
                    </div>
                </div>
            </div>

            <!-- çŸ¥è¯†æ£€ç´¢æ ‡ç­¾é¡µ -->
            <div id="search-tab" class="tab-content">
                <div class="search-section">
                    <div class="search-box">
                        <input type="text" id="search-input" class="search-input" 
                               placeholder="è¾“å…¥å…³é”®è¯æœç´¢çŸ¥è¯†...">
                        <button class="search-btn" onclick="searchKnowledge()">æœç´¢</button>
                    </div>

                    <div class="filters">
                        <div class="filter-group">
                            <label>åˆ†ç±»ç­›é€‰</label>
                            <select id="category-filter">
                                <option value="">å…¨éƒ¨åˆ†ç±»</option>
                                <option value="æ°´åŠ›å­¦">æ°´åŠ›å­¦</option>
                                <option value="å·¥ç¨‹åŠ›å­¦">å·¥ç¨‹åŠ›å­¦</option>
                                <option value="åœŸåŠ›å­¦">åœŸåŠ›å­¦</option>
                                <option value="å·¥ç¨‹æµ‹é‡">å·¥ç¨‹æµ‹é‡</option>
                                <option value="æ°´å·¥å»ºç­‘ç‰©">æ°´å·¥å»ºç­‘ç‰©</option>
                                <option value="æ°´ç”µå·¥ç¨‹">æ°´ç”µå·¥ç¨‹</option>
                                <option value="æ°´èµ„æº">æ°´èµ„æº</option>
                                <option value="æ–½å·¥æŠ€æœ¯">æ–½å·¥æŠ€æœ¯</option>
                                <option value="è§„èŒƒæ ‡å‡†">è§„èŒƒæ ‡å‡†</option>
                                <option value="å·¥ç¨‹ç®¡ç†">å·¥ç¨‹ç®¡ç†</option>
                            </select>
                        </div>

                        <div class="filter-group">
                            <label>å±‚çº§ç­›é€‰</label>
                            <select id="level-filter">
                                <option value="">å…¨éƒ¨å±‚çº§</option>
                                <option value="æœ¬ç§‘">æœ¬ç§‘</option>
                                <option value="ç¡•å£«">ç¡•å£«</option>
                                <option value="åšå£«">åšå£«</option>
                                <option value="é€šç”¨">é€šç”¨</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="search-results" class="results"></div>
            </div>

            <!-- ç»Ÿè®¡ä¿¡æ¯æ ‡ç­¾é¡µ -->
            <div id="stats-tab" class="tab-content">
                <h3 style="margin-bottom: 20px;">ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="stat-total">78</div>
                        <div class="stat-label">çŸ¥è¯†æ¡ç›®</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">10</div>
                        <div class="stat-label">ä¸“ä¸šåˆ†ç±»</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">4</div>
                        <div class="stat-label">å­¦æœ¯å±‚çº§</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">120ms</div>
                        <div class="stat-label">å¹³å‡æ£€ç´¢æ—¶é—´</div>
                    </div>
                </div>

                <h4 style="margin-top: 30px; margin-bottom: 15px;">çŸ¥è¯†åˆ†ç±»åˆ†å¸ƒ</h4>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <div style="margin-bottom: 10px;">æ°´åŠ›å­¦ï¼š10æ¡</div>
                    <div style="margin-bottom: 10px;">å·¥ç¨‹ç®¡ç†ï¼š14æ¡</div>
                    <div style="margin-bottom: 10px;">æ–½å·¥æŠ€æœ¯ï¼š10æ¡</div>
                    <div style="margin-bottom: 10px;">è§„èŒƒæ ‡å‡†ï¼š8æ¡</div>
                    <div style="margin-bottom: 10px;">æ°´å·¥å»ºç­‘ç‰©ï¼š8æ¡</div>
                    <div>å…¶ä»–ï¼š28æ¡</div>
                </div>
            </div>

            <!-- å¸®åŠ©æ ‡ç­¾é¡µ -->
            <div id="help-tab" class="tab-content">
                <h3 style="margin-bottom: 20px;">ä½¿ç”¨å¸®åŠ©</h3>
                
                <h4 style="color: #667eea; margin-top: 20px; margin-bottom: 10px;">ğŸ’¬ æ™ºèƒ½é—®ç­”</h4>
                <p style="line-height: 1.8; color: #666;">
                    åœ¨æ™ºèƒ½é—®ç­”æ¨¡å¼ä¸‹ï¼Œæ‚¨å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€æå‡ºé—®é¢˜ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€ç´¢ç›¸å…³çŸ¥è¯†å¹¶ç”Ÿæˆä¸“ä¸šå›ç­”ã€‚
                    æ”¯æŒå®šä¹‰ç±»ã€æ–¹æ³•ç±»ã€è§„èŒƒç±»ç­‰å¤šç§é—®é¢˜ç±»å‹ã€‚
                </p>

                <h4 style="color: #667eea; margin-top: 20px; margin-bottom: 10px;">ğŸ” çŸ¥è¯†æ£€ç´¢</h4>
                <p style="line-height: 1.8; color: #666;">
                    åœ¨çŸ¥è¯†æ£€ç´¢æ¨¡å¼ä¸‹ï¼Œæ‚¨å¯ä»¥é€šè¿‡å…³é”®è¯æœç´¢ç›¸å…³çŸ¥è¯†ï¼Œæ”¯æŒæŒ‰åˆ†ç±»å’Œå±‚çº§è¿›è¡Œè¿‡æ»¤ã€‚
                    ç³»ç»Ÿä½¿ç”¨è¯­ä¹‰æ£€ç´¢æŠ€æœ¯ï¼Œèƒ½å¤Ÿç†è§£æ‚¨çš„æŸ¥è¯¢æ„å›¾ã€‚
                </p>

                <h4 style="color: #667eea; margin-top: 20px; margin-bottom: 10px;">ğŸ“Š ç³»ç»Ÿç‰¹ç‚¹</h4>
                <ul style="line-height: 2; color: #666; margin-left: 20px;">
                    <li>âœ… è¯­ä¹‰æ£€ç´¢ï¼šæ™ºèƒ½ç†è§£ç”¨æˆ·é—®é¢˜</li>
                    <li>âœ… RAGæŠ€æœ¯ï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆ</li>
                    <li>âœ… ä¸“ä¸šçŸ¥è¯†ï¼šæ°´åˆ©æ°´ç”µæ°´åŠ¡å…¨é¢†åŸŸ</li>
                    <li>âœ… å¤šå±‚çº§ï¼šæœ¬ç§‘/ç¡•å£«/åšå£«/é€šç”¨</li>
                    <li>âœ… å¿«é€Ÿå“åº”ï¼šå¹³å‡120msæ£€ç´¢æ—¶é—´</li>
                </ul>

                <h4 style="color: #667eea; margin-top: 20px; margin-bottom: 10px;">ğŸ¯ åº”ç”¨åœºæ™¯</h4>
                <ul style="line-height: 2; color: #666; margin-left: 20px;">
                    <li>ğŸ“š å­¦ä¹ åŸ¹è®­ï¼šå¿«é€ŸæŸ¥æ‰¾ä¸“ä¸šçŸ¥è¯†</li>
                    <li>ğŸ—ï¸ å·¥ç¨‹è®¾è®¡ï¼šè·å–è®¾è®¡æ–¹æ³•å’Œè§„èŒƒ</li>
                    <li>ğŸ“‹ è§„èŒƒæŸ¥è¯¢ï¼šæŸ¥æ‰¾ç›¸å…³æ ‡å‡†è§„èŒƒ</li>
                    <li>ğŸ’¡ æŠ€æœ¯å’¨è¯¢ï¼šè·å¾—ä¸“ä¸šå»ºè®®</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';

        function switchTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µ
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });

            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeç±»
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾
            event.target.classList.add('active');
        }

        function setQuestion(question) {
            document.getElementById('question-input').value = question;
            askQuestion();
        }

        async function askQuestion() {
            const query = document.getElementById('question-input').value.trim();
            if (!query) {
                alert('è¯·è¾“å…¥é—®é¢˜');
                return;
            }

            const resultsDiv = document.getElementById('qa-results');
            resultsDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>æ­£åœ¨æ€è€ƒæ‚¨çš„é—®é¢˜...</p>
                </div>
            `;

            try {
                const response = await fetch(`${API_BASE}/api/ask`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: query,
                        top_k: 5,
                        include_context: true
                    })
                });

                const data = await response.json();

                let html = `
                    <div class="answer-section">
                        <div class="answer-header">
                            <h3>ğŸ¤– AIä¸“å®¶å›ç­”</h3>
                        </div>
                        <div class="answer-content">${data.answer}</div>
                        <div class="timing-info">
                            <div class="timing-item">â±ï¸ æ£€ç´¢æ—¶é—´: ${data.timing.retrieval_ms}ms</div>
                            <div class="timing-item">âš¡ ç”Ÿæˆæ—¶é—´: ${data.timing.generation_ms}ms</div>
                            <div class="timing-item">ğŸ“Š æ€»è€—æ—¶: ${data.timing.total_ms}ms</div>
                        </div>
                        <div class="feedback-section">
                            <p style="margin-bottom: 10px; font-weight: bold;">è¿™ä¸ªå›ç­”å¯¹æ‚¨æœ‰å¸®åŠ©å—ï¼Ÿ</p>
                            <div class="feedback-buttons">
                                <button class="feedback-btn positive" onclick="submitFeedback(true, '${query}')">ğŸ‘ æœ‰å¸®åŠ©</button>
                                <button class="feedback-btn negative" onclick="submitFeedback(false, '${query}')">ğŸ‘ éœ€è¦æ”¹è¿›</button>
                            </div>
                        </div>
                    </div>
                `;

                if (data.context && data.context.length > 0) {
                    html += '<div style="margin-top: 30px;"><h3 style="margin-bottom: 15px;">ğŸ“š å‚è€ƒçŸ¥è¯†æ¥æº</h3>';
                    data.context.forEach(item => {
                        html += `
                            <div class="result-item">
                                <div class="result-title">${item.title}</div>
                                <div class="result-meta">
                                    <span class="meta-tag">${item.category}</span>
                                    <span class="meta-tag">${item.level}</span>
                                    <span class="relevance">ç›¸å…³åº¦: ${(item.relevance * 100).toFixed(1)}%</span>
                                </div>
                                <div class="relevance-bar">
                                    <div class="relevance-fill" style="width: ${item.relevance * 100}%"></div>
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                }

                resultsDiv.innerHTML = html;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #f44336;">
                        <p>âŒ å‡ºé”™äº†: ${error.message}</p>
                        <p style="margin-top: 10px; font-size: 14px;">è¯·ç¡®ä¿APIæœåŠ¡æ­£åœ¨è¿è¡Œ</p>
                    </div>
                `;
            }
        }

        async function searchKnowledge() {
            const query = document.getElementById('search-input').value.trim();
            const category = document.getElementById('category-filter').value;
            const level = document.getElementById('level-filter').value;

            if (!query) {
                alert('è¯·è¾“å…¥æœç´¢å…³é”®è¯');
                return;
            }

            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>æ­£åœ¨æœç´¢...</p>
                </div>
            `;

            try {
                const response = await fetch(`${API_BASE}/api/search`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: query,
                        top_k: 10,
                        category: category || null,
                        level: level || null
                    })
                });

                const data = await response.json();

                if (data.results.length === 0) {
                    resultsDiv.innerHTML = `
                        <div style="padding: 40px; text-align: center; color: #666;">
                            <p style="font-size: 18px;">ğŸ˜• æœªæ‰¾åˆ°ç›¸å…³çŸ¥è¯†</p>
                            <p style="margin-top: 10px;">è¯•è¯•è°ƒæ•´æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶</p>
                        </div>
                    `;
                    return;
                }

                let html = `<p style="margin-bottom: 20px; color: #666;">æ‰¾åˆ° ${data.total_results} æ¡ç›¸å…³çŸ¥è¯†ï¼ˆè€—æ—¶ï¼š${data.retrieval_time_ms}msï¼‰</p>`;
                
                data.results.forEach(item => {
                    html += `
                        <div class="result-item">
                            <div class="result-title">${item.title}</div>
                            <div class="result-meta">
                                <span class="meta-tag">${item.category}</span>
                                <span class="meta-tag">${item.level}</span>
                                <span class="meta-tag">${item.source_type}</span>
                                <span class="relevance">ç›¸å…³åº¦: ${(item.relevance * 100).toFixed(1)}%</span>
                            </div>
                            <div class="relevance-bar">
                                <div class="relevance-fill" style="width: ${item.relevance * 100}%"></div>
                            </div>
                        </div>
                    `;
                });

                resultsDiv.innerHTML = html;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #f44336;">
                        <p>âŒ å‡ºé”™äº†: ${error.message}</p>
                        <p style="margin-top: 10px; font-size: 14px;">è¯·ç¡®ä¿APIæœåŠ¡æ­£åœ¨è¿è¡Œ</p>
                    </div>
                `;
            }
        }

        async function submitFeedback(helpful, query) {
            try {
                const response = await fetch(`${API_BASE}/api/feedback`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        query: query,
                        helpful: helpful,
                        feedback: helpful ? 'æœ‰å¸®åŠ©' : 'éœ€è¦æ”¹è¿›'
                    })
                });

                if (response.ok) {
                    alert(helpful ? 'æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼ğŸ‘' : 'æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼Œæˆ‘ä»¬ä¼šæŒç»­æ”¹è¿›ï¼');
                }
            } catch (error) {
                console.error('æäº¤åé¦ˆå¤±è´¥:', error);
            }
        }

        // æ”¯æŒå›è½¦é”®æé—®
        document.getElementById('question-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                askQuestion();
            }
        });

        // æ”¯æŒå›è½¦é”®æœç´¢
        document.getElementById('search-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchKnowledge();
            }
        });
    </script>
</body>
</html>
