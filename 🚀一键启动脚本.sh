#!/bin/bash
# 15æœ¬è€ƒç ”ä¹¦ç³»åˆ— - ä¸€é”®å¯åŠ¨è„šæœ¬

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "   ğŸš€ 15æœ¬è€ƒç ”ä¹¦ç³»åˆ— - å¿«é€Ÿå¯åŠ¨èœå•"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“š é¡¹ç›®æ¦‚è§ˆï¼š"
echo "  â€¢ 15æœ¬ä¹¦ç³»åˆ—ï¼ˆ174ä¸ªè¯¦ç»†æ–‡ä»¶ï¼‰"
echo "  â€¢ 14ä»½é…å¥—æ–‡æ¡£"
echo "  â€¢ 7ä¸ªå­¦ä¹ å·¥å…·"
echo "  â€¢ 17,950+è¡ŒPythonä»£ç "
echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

# æ£€æŸ¥Pythonç‰ˆæœ¬
check_python() {
    if command -v python3 &> /dev/null; then
        PYTHON_VERSION=$(python3 --version 2>&1 | awk '{print $2}')
        echo "âœ… Pythonç‰ˆæœ¬: $PYTHON_VERSION"
    else
        echo "âŒ æœªæ‰¾åˆ°Python3ï¼Œè¯·å…ˆå®‰è£…Python"
        exit 1
    fi
}

# æ£€æŸ¥ä¾èµ–
check_dependencies() {
    echo "ğŸ” æ£€æŸ¥ä¾èµ–..."
    
    MISSING_DEPS=()
    
    python3 -c "import numpy" 2>/dev/null || MISSING_DEPS+=("numpy")
    python3 -c "import matplotlib" 2>/dev/null || MISSING_DEPS+=("matplotlib")
    python3 -c "import pandas" 2>/dev/null || MISSING_DEPS+=("pandas")
    
    if [ ${#MISSING_DEPS[@]} -eq 0 ]; then
        echo "âœ… æ‰€æœ‰ä¾èµ–å·²å®‰è£…"
    else
        echo "âš ï¸ ç¼ºå°‘ä¾èµ–: ${MISSING_DEPS[*]}"
        echo ""
        read -p "æ˜¯å¦ç°åœ¨å®‰è£…ï¼Ÿ(y/n): " INSTALL
        if [ "$INSTALL" = "y" ]; then
            echo "æ­£åœ¨å®‰è£…ä¾èµ–..."
            pip3 install numpy matplotlib pandas
        fi
    fi
}

# ä¸»èœå•
show_menu() {
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo "ğŸ“‹ åŠŸèƒ½èœå•"
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    echo ""
    echo "  ğŸ“– æŸ¥çœ‹æ–‡æ¡£"
    echo "    1. æŸ¥çœ‹READMEï¼ˆé¡¹ç›®ä»‹ç»ï¼‰"
    echo "    2. æŸ¥çœ‹å¿«é€Ÿå¼€å§‹æŒ‡å—"
    echo "    3. æŸ¥çœ‹å¸¸è§é—®é¢˜FAQ"
    echo "    4. æŸ¥çœ‹çŸ¥è¯†ä½“ç³»å¯¼èˆªå›¾"
    echo ""
    echo "  ğŸ¤– å­¦ä¹ å·¥å…·"
    echo "    5. å¯åŠ¨å­¦ä¹ åŠ©æ‰‹CLI"
    echo "    6. å¯åŠ¨å­¦ä¹ æé†’ç³»ç»Ÿ"
    echo "    7. å¯åŠ¨æ•°æ®åˆ†æå·¥å…·ï¼ˆæ¼”ç¤ºï¼‰"
    echo "    8. ç”Ÿæˆå¯è§†åŒ–æŠ¥å‘Š"
    echo ""
    echo "  ğŸ“š æµè§ˆå†…å®¹"
    echo "    9. æŸ¥çœ‹ä¹¦ç±åˆ—è¡¨"
    echo "    10. æŸ¥çœ‹æ–‡æ¡£åˆ—è¡¨"
    echo "    11. æŸ¥çœ‹å·¥å…·åˆ—è¡¨"
    echo ""
    echo "  ğŸ”§ é¡¹ç›®ç®¡ç†"
    echo "    12. éªŒè¯é¡¹ç›®å®Œæ•´æ€§"
    echo "    13. æŸ¥çœ‹é¡¹ç›®ç»Ÿè®¡"
    echo ""
    echo "  0. é€€å‡º"
    echo ""
    echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
}

# æ‰§è¡Œé€‰æ‹©
execute_choice() {
    case $1 in
        1)
            echo ""
            echo "ğŸ“– README.md"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            head -50 README.md
            echo ""
            echo "..."
            read -p "æŒ‰EnteræŸ¥çœ‹æ›´å¤šï¼Œæˆ–è¾“å…¥qè¿”å›: " MORE
            if [ "$MORE" != "q" ]; then
                cat README.md | less
            fi
            ;;
        2)
            echo ""
            cat "ğŸš€å¿«é€Ÿå¼€å§‹æŒ‡å—-START_HERE.md" | less
            ;;
        3)
            echo ""
            cat "â“å¸¸è§é—®é¢˜FAQ.md" | less
            ;;
        4)
            echo ""
            cat "ğŸ—ºï¸çŸ¥è¯†ä½“ç³»å¯¼èˆªå›¾.md" | less
            ;;
        5)
            echo ""
            echo "ğŸ¤– å¯åŠ¨å­¦ä¹ åŠ©æ‰‹CLI..."
            python3 "ğŸ¤–å­¦ä¹ åŠ©æ‰‹CLI.py"
            ;;
        6)
            echo ""
            echo "â° å¯åŠ¨å­¦ä¹ æé†’ç³»ç»Ÿ..."
            python3 "â°å­¦ä¹ æé†’ç³»ç»Ÿ.py"
            ;;
        7)
            echo ""
            echo "ğŸ“Š è¿è¡Œæ•°æ®åˆ†æå·¥å…·æ¼”ç¤º..."
            python3 "ğŸ“Šå­¦ä¹ æ•°æ®åˆ†æå·¥å…·.py"
            ;;
        8)
            echo ""
            echo "ğŸ“ˆ å¯åŠ¨å¯è§†åŒ–æŠ¥å‘Šç”Ÿæˆå™¨..."
            python3 "ğŸ“ˆå­¦ä¹ å¯è§†åŒ–æŠ¥å‘Šç”Ÿæˆå™¨.py"
            ;;
        9)
            echo ""
            echo "ğŸ“š ä¹¦ç±åˆ—è¡¨"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            cd books/graduate-exam-prep
            for dir in */; do
                FILE_COUNT=$(find "$dir" -name "*è¯¦ç»†*.md" 2>/dev/null | wc -l)
                echo "  ğŸ“– $dir: $FILE_COUNT è¯¦ç»†æ–‡ä»¶"
            done
            cd ../..
            read -p "æŒ‰Enterè¿”å›..."
            ;;
        10)
            echo ""
            echo "ğŸ“– é…å¥—æ–‡æ¡£åˆ—è¡¨"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            ls -1 *.md 2>/dev/null | head -20
            echo ""
            echo "..."
            read -p "æŒ‰Enterè¿”å›..."
            ;;
        11)
            echo ""
            echo "ğŸ› ï¸ å­¦ä¹ å·¥å…·åˆ—è¡¨"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            echo "  ğŸ“‹ Markdownæ¨¡æ¿ï¼š"
            echo "    â€¢ ğŸ“‹å­¦ä¹ è¿›åº¦è¿½è¸ªè¡¨.md"
            echo "    â€¢ ğŸ¯3ä¸ªæœˆå­¦ä¹ è®¡åˆ’æ¨¡æ¿.md"
            echo "    â€¢ ğŸ“å­¦ä¹ æˆæœå±•ç¤ºæ¨¡æ¿.md"
            echo "    â€¢ ğŸ“šæ–‡æ¡£ç´¢å¼•ç›®å½•.md"
            echo ""
            echo "  ğŸ¤– Pythonå·¥å…·ï¼š"
            echo "    â€¢ ğŸ¤–å­¦ä¹ åŠ©æ‰‹CLI.py"
            echo "    â€¢ â°å­¦ä¹ æé†’ç³»ç»Ÿ.py"
            echo "    â€¢ ğŸ“Šå­¦ä¹ æ•°æ®åˆ†æå·¥å…·.py"
            echo "    â€¢ ğŸ“ˆå­¦ä¹ å¯è§†åŒ–æŠ¥å‘Šç”Ÿæˆå™¨.py"
            echo "    â€¢ ğŸ”§é¡¹ç›®éªŒè¯è„šæœ¬.py"
            read -p "æŒ‰Enterè¿”å›..."
            ;;
        12)
            echo ""
            echo "ğŸ”§ éªŒè¯é¡¹ç›®å®Œæ•´æ€§..."
            python3 "ğŸ”§é¡¹ç›®éªŒè¯è„šæœ¬.py"
            read -p "æŒ‰Enterè¿”å›..."
            ;;
        13)
            echo ""
            echo "ğŸ“Š é¡¹ç›®ç»Ÿè®¡"
            echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
            BOOK_FILES=$(find books/graduate-exam-prep -name "*è¯¦ç»†*.md" 2>/dev/null | wc -l)
            DOC_FILES=$(ls -1 *.md 2>/dev/null | wc -l)
            PY_FILES=$(ls -1 *.py 2>/dev/null | wc -l)
            echo "  ğŸ“š ä¹¦ç±å†…å®¹æ–‡ä»¶: $BOOK_FILES ä¸ª"
            echo "  ğŸ“– é…å¥—æ–‡æ¡£: $DOC_FILES ä¸ª"
            echo "  ğŸ Pythonå·¥å…·: $PY_FILES ä¸ª"
            echo "  ğŸ“¦ æ€»è®¡æ ¸å¿ƒæ–‡ä»¶: $((BOOK_FILES + DOC_FILES + PY_FILES)) ä¸ª"
            echo ""
            echo "  ğŸ’» ä»£ç è¡Œæ•°ç»Ÿè®¡:"
            if command -v wc &> /dev/null; then
                PY_LINES=$(cat *.py 2>/dev/null | wc -l)
                echo "    Pythonä»£ç : $PY_LINES è¡Œ"
            fi
            read -p "æŒ‰Enterè¿”å›..."
            ;;
        0)
            echo ""
            echo "ğŸ‘‹ æ„Ÿè°¢ä½¿ç”¨ï¼ç¥å­¦ä¹ æ„‰å¿«ï¼"
            exit 0
            ;;
        *)
            echo "âŒ æ— æ•ˆé€‰æ‹©ï¼Œè¯·é‡è¯•"
            sleep 1
            ;;
    esac
}

# ä¸»ç¨‹åº
main() {
    check_python
    check_dependencies
    
    while true; do
        show_menu
        read -p "è¯·é€‰æ‹©åŠŸèƒ½ï¼ˆ0-13ï¼‰: " CHOICE
        execute_choice $CHOICE
    done
}

# è¿è¡Œä¸»ç¨‹åº
main
