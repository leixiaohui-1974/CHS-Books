# 案例20：流域水资源综合管理（终章）

## 工程背景

流域是水资源管理的自然单元，涉及多水源、多用户、多目标、多约束。本综合案例整合教材所有技术，从评价、预测到优化、控制、风险管理和决策支持，构建完整的流域水资源综合管理系统。

## 案例目标

1. 整合教材全部核心模块
2. 展示完整的管理流程
3. 体现系统化思维
4. 提供综合解决方案

## 流域基本情况

### 物理系统
- **水库**: 2座梯级水库（上游100万m³，下游300万m³）
- **河流**: 主干河道100km
- **水源**: 地表水、地下水、再生水
- **用户**: 城市供水、农业灌溉、工业用水、生态需求

### 管理挑战
- 水资源短缺
- 水质污染
- 用水冲突
- 洪旱频繁
- 生态退化

## 技术架构

```
第一层：数据与评价
├─ 水文数据分析（core.hydrology）
├─ 频率分析
├─ 水资源评价（core.decision）
└─ 承载力评估

第二层：预测与规划
├─ 需水预测（core.forecasting + core.ml）
├─ 来水预测
├─ 水质预测
└─ 不确定性分析（core.risk）

第三层：优化与配置
├─ 多目标优化（core.optimization）
├─ 水资源优化分配
├─ 梯级水库调度
└─ 鲁棒优化（core.risk）

第四层：实时控制
├─ MPC控制（core.control）
├─ 水库实时调度
├─ 供水管网优化
└─ 数字孪生（core.digital_twin）

第五层：风险管理
├─ 风险识别（core.risk）
├─ 蒙特卡洛模拟
├─ VaR/CVaR评估
└─ 应急预案

第六层：决策支持
├─ 方案生成
├─ 多准则评估（core.decision）
├─ 情景分析
└─ 可视化报告
```

## 完整流程

### 阶段1：现状评价
```python
# 水文分析
runoff_analysis()
frequency_analysis()

# 水资源评价
water_balance()
carrying_capacity()
```

### 阶段2：需求预测
```python
# 需水预测
demand_forecast_ml()
inflow_forecast()

# 不确定性
uncertainty_analysis()
```

### 阶段3：优化配置
```python
# 多目标优化
allocation = multiobjective_optimization()

# 梯级调度
schedule = cascade_dispatch()
```

### 阶段4：实时控制
```python
# MPC控制
mpc_controller()

# 数字孪生
digital_twin_update()
```

### 阶段5：风险评估
```python
# 风险分析
risk_assessment()
var_cvar_calculation()
```

### 阶段6：综合决策
```python
# 方案评估
ahp_topsis()

# 决策建议
recommendation()
```

## 核心指标

### 经济指标
- 供水成本：元/m³
- 发电收益：万元/年
- 投资回收期：年

### 技术指标
- 供水保证率：≥95%
- 灌溉保证率：≥75%
- 发电保证率：≥90%

### 环境指标
- 生态流量满足率：≥80%
- 水质达标率：≥90%
- 湿地面积：不减少

### 风险指标
- VaR(95%)：可控
- 缺水风险：≤5%
- 洪水风险：百年一遇

## 运行方法

```bash
cd code/examples/case20_basin_management
python main.py
```

## 预期结果

### 水资源配置方案
```
总供水量: 1200万m³/年
  - 生活用水: 400万m³ (33%)
  - 工业用水: 300万m³ (25%)
  - 农业灌溉: 400万m³ (33%)
  - 生态用水: 100万m³ (8%)
```

### 综合评价
```
经济效益: 8000万元/年
环境效益: 优（85分）
社会效益: 良（80分）
综合评分: 0.85
```

### 风险评估
```
缺水风险: 3.5%
洪水风险: 可控
水质风险: 低
综合风险等级: 中低
```

## 思考题

1. 流域管理与单工程管理的区别？
2. 如何协调上下游利益冲突？
3. 多目标优化中的权重如何确定？
4. 气候变化如何影响流域管理？
5. 如何实现流域智慧化管理？

## 扩展方向

1. **智慧流域**：IoT、大数据、AI
2. **流域数字孪生**：全流域虚拟仿真
3. **协同调度**：多水库联合优化
4. **生态修复**：水生态系统保护
5. **流域治理**：多主体协同机制

## 教学意义

本案例是全教材的综合应用，完整展示了：
- ✅ 8个核心模块的协同应用
- ✅ 从评价到决策的完整流程
- ✅ 理论方法与工程实践的结合
- ✅ 系统化、综合化的思维方式

## 参考文献

1. Loucks DP, van Beek E. Water Resource Systems Planning and Management[M]. Springer, 2017.
2. World Bank. Integrated River Basin Management: From Concepts to Good Practice[R]. 2020.

## 作者信息

- 案例编号：Case 20（终章）
- 难度等级：⭐⭐⭐⭐⭐ (综合应用)
- 所需时间：10-12小时
- 更新日期：2025-11-02

---

**特别说明**：本案例是全教材的压轴之作，整合了前19个案例的所有技术，展现了水资源系统工程的完整面貌。
