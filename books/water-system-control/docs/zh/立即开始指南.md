# ç«‹å³å¼€å§‹æŒ‡å— - æ°´ç³»ç»Ÿæ§åˆ¶è®ºæ•™æå¼€å‘

**é€‚ç”¨äººå‘˜ï¼š** å‡†å¤‡å¼€å‘é›¶åŸºç¡€å‹å¥½æ•™æçš„å›¢é˜Ÿ  
**é¢„è®¡æ—¶é—´ï¼š** ç¬¬ä¸€å‘¨çš„å…·ä½“æ“ä½œæ­¥éª¤  
**ç›®æ ‡ï¼š** å®Œæˆç¯å¢ƒå‡†å¤‡ï¼Œå¼€å§‹ç¬¬ä¸€ä¸ªæ¡ˆä¾‹

---

## ğŸ“‹ å®Œæˆæƒ…å†µæ€»ç»“

### âœ… å·²å®Œæˆçš„å·¥ä½œ

1. **æ–¹æ¡ˆæ–‡æ¡£**ï¼ˆå…±3ä¸ªæ–‡æ¡£ï¼Œ100KB+å†…å®¹ï¼‰
   - âœ… `/workspace/docs/zh/æ°´ç³»ç»Ÿæ§åˆ¶è®ºæ•™æå¼€å‘æ–¹æ¡ˆ.md` - ä¼ ç»Ÿ12ç« ç†è®ºä½“ç³»
   - âœ… `/workspace/docs/zh/æ°´ç®±æ¡ˆä¾‹é©±åŠ¨æ•™å­¦ä½“ç³».md` - 12ä¸ªé€’è¿›å¼æ¡ˆä¾‹ï¼ˆ**æ¨è**ï¼‰
   - âœ… `/workspace/docs/zh/é›¶åŸºç¡€æ•™æå¼€å‘è¯¦ç»†æ–¹æ¡ˆ.md` - é¢å‘é«˜ä¸­åŸºç¡€å­¦ç”Ÿçš„è¯¦ç»†æŒ‡å—
   - âœ… `/workspace/docs/zh/æ•™æå¼€å‘æ–¹æ¡ˆæ€»ç»“.md` - æ–¹æ¡ˆå¯¹æ¯”ä¸é€‰æ‹©å»ºè®®
   - âœ… `/workspace/docs/zh/ç«‹å³å¼€å§‹æŒ‡å—.md` - æœ¬æ–‡æ¡£

2. **ä»£ç æ¸…ç†å‡†å¤‡**
   - âœ… åˆ›å»ºäº†æ¸…ç†è„šæœ¬ `/workspace/scripts/cleanup_complex_models.py`
   - âœ… åˆ†æäº†ç°æœ‰æ°´åŠ›å­¦æ¨¡å‹
   - âœ… æ ‡è¯†äº†éœ€è¦ä¿ç•™å’Œåˆ é™¤çš„éƒ¨åˆ†

3. **æ¡ˆä¾‹ç¼–å†™æ¨¡æ¿**
   - âœ… 7éƒ¨åˆ†æ ‡å‡†ç»“æ„ï¼ˆèƒŒæ™¯ã€é—®é¢˜ã€åŸç†ã€æ–¹æ³•ã€å»ºæ¨¡ã€ç»“æœã€è®¨è®ºï¼‰
   - âœ… æ¯éƒ¨åˆ†çš„è¯¦ç»†è¦æ±‚å’Œç¤ºä¾‹
   - âœ… ä»£ç è§„èŒƒå’Œç»˜å›¾è§„èŒƒ

---

## ğŸ¯ æœ¬å‘¨ä»»åŠ¡ï¼ˆç¬¬1å‘¨ï¼‰

### Day 1-2ï¼šä»£ç æ¸…ç†ä¸å¤‡ä»½

#### ä»»åŠ¡1.1ï¼šè¿è¡Œæ¸…ç†åˆ†æ
```bash
cd /workspace
python3 scripts/cleanup_complex_models.py
```

**é¢„æœŸè¾“å‡ºï¼š**
- å¤‡ä»½ç›®å½•ï¼š`/workspace/backup/hydraulic_models_YYYYMMDD_HHMMSS/`
- æ¸…ç†æŠ¥å‘Šï¼š`CLEANUP_REPORT.md`
- å¼ƒç”¨è¯´æ˜ï¼š`DEPRECATION_NOTICE.md`

#### ä»»åŠ¡1.2ï¼šæ‰‹åŠ¨æ¸…ç†ï¼ˆè°¨æ…æ“ä½œï¼‰

**ä¿ç•™çš„æ–‡ä»¶ï¼š**
```python
# src/simulation/hydraulic_models.py
# åªä¿ç•™ HydraulicModel åŸºç±»å’Œ LevelPoolModel

class HydraulicModel:
    """ä¿ç•™"""
    pass

class LevelPoolModel(HydraulicModel):
    """ä¿ç•™ - è¿™æ˜¯ç®€å•çš„æ°´å¹³æ± æ¨¡å‹"""
    pass

class DynamicWaveModel(HydraulicModel):
    """åˆ é™¤æˆ–æ³¨é‡Šæ‰"""
    pass
```

**åˆ é™¤æˆ–å½’æ¡£çš„æ–‡ä»¶ï¼š**
- `src/simulation/fvm_hydraulic_models.py` - è¿‡äºå¤æ‚ï¼Œç§»è‡³ `backup/`

**æ“ä½œæ­¥éª¤ï¼š**
```bash
# 1. å†æ¬¡ç¡®è®¤å¤‡ä»½å·²å®Œæˆ
ls -lh /workspace/backup/

# 2. æ³¨é‡Šæ‰å¤æ‚æ¨¡å‹ï¼ˆä¿å®ˆæ–¹æ¡ˆï¼‰
# åœ¨ hydraulic_models.py ä¸­çš„ DynamicWaveModel å‰åŠ ä¸Šï¼š
# """
# âš ï¸ DEPRECATED - æ­¤æ¨¡å‹è¿‡äºå¤æ‚ï¼Œä¸æ¨èä½¿ç”¨
# è¯·ä½¿ç”¨ LevelPoolModel æˆ–æ•™å­¦ä¸“ç”¨çš„ SingleTankModel
# """

# 3. ç§»åŠ¨ FVM æ–‡ä»¶åˆ°å½’æ¡£ç›®å½•
mkdir -p /workspace/archive
mv /workspace/src/simulation/fvm_hydraulic_models.py /workspace/archive/

# 4. æ›´æ–° __init__.pyï¼Œç§»é™¤å¤æ‚æ¨¡å‹çš„å¯¼å…¥
# ç¼–è¾‘ src/simulation/__init__.py
```

#### ä»»åŠ¡1.3ï¼šè¿è¡Œç°æœ‰æµ‹è¯•
```bash
cd /workspace
python3 -m pytest tests/ -v --tb=short
```

**å¦‚æœæµ‹è¯•å¤±è´¥ï¼š**
1. æŸ¥çœ‹å¤±è´¥çš„æµ‹è¯•
2. æ›´æ–°æµ‹è¯•ï¼Œç§»é™¤å¯¹å¤æ‚æ¨¡å‹çš„ä¾èµ–
3. è®°å½•éœ€è¦ä¿®å¤çš„åŠŸèƒ½

---

### Day 3ï¼šåˆ›å»ºæ•™å­¦æ¨¡å‹åŸºç¡€è®¾æ–½

#### ä»»åŠ¡3.1ï¼šåˆ›å»ºç›®å½•ç»“æ„
```bash
cd /workspace

# åˆ›å»ºæ•™å­¦æ¨¡å‹ç›®å½•
mkdir -p src/models/water_tank
touch src/models/water_tank/__init__.py

# åˆ›å»ºæ¡ˆä¾‹ä»£ç ç›®å½•
mkdir -p examples/textbook_cases/case_01_home_water_tower
mkdir -p examples/textbook_cases/shared

# åˆ›å»ºJupyter Notebookç›®å½•
mkdir -p notebooks/textbook/case_01

# åˆ›å»ºæµ‹è¯•ç›®å½•
mkdir -p tests/standard_cases
mkdir -p tests/models/water_tank

# åˆ›å»ºç¡¬ä»¶å®éªŒç›®å½•
mkdir -p hardware/arduino/case_01
```

#### ä»»åŠ¡3.2ï¼šåˆ›å»ºç¬¬ä¸€ä¸ªæ•™å­¦æ¨¡å‹

**æ–‡ä»¶ï¼š** `src/models/water_tank/single_tank.py`

```python
"""
å•æ°´ç®±æ¨¡å‹ - æ•™å­¦ä¸“ç”¨

è¿™æ˜¯ä¸“é—¨ä¸ºæ•™å­¦è®¾è®¡çš„ç®€åŒ–æ¨¡å‹ï¼Œç‰¹ç‚¹ï¼š
1. æç®€å®ç°ï¼Œå®¹æ˜“ç†è§£
2. è¯¦ç»†æ³¨é‡Šï¼Œæ¯è¡Œéƒ½è§£é‡Š
3. é€‚åˆé«˜ä¸­ç‰©ç†åŸºç¡€çš„å­¦ç”Ÿ
4. å¯ç›´æ¥ç”¨äºä»¿çœŸå’Œæ§åˆ¶å®éªŒ
"""

import numpy as np


class SingleTank:
    """
    å•æ°´ç®±æ¨¡å‹
    
    åŸºäºç‰©ç†åŸç†ï¼š
    - è´¨é‡å®ˆæ’ï¼šdV/dt = Q_in - Q_out
    - å‡ ä½•å…³ç³»ï¼šV = A Ã— h
    - æµå‡ºè§„å¾‹ï¼šQ_out = h / Rï¼ˆçº¿æ€§è¿‘ä¼¼ï¼‰
    
    é€‚ç”¨åœºæ™¯ï¼š
    - å®¶åº­æ°´å¡”
    - å·¥ä¸šå‚¨ç½
    - æ°´ä½æ§åˆ¶ç³»ç»Ÿæ•™å­¦
    """
    
    def __init__(self, A=2.0, R=2.0, K=1.0):
        """
        åˆå§‹åŒ–æ°´ç®±
        
        å‚æ•°ï¼š
            A (float): æ¨ªæˆªé¢ç§¯ï¼ˆå•ä½ï¼šå¹³æ–¹ç±³ mÂ²ï¼‰
                - é»˜è®¤ 2.0 mÂ² ï¼ˆç›¸å½“äºè¾¹é•¿çº¦1.4ç±³çš„æ­£æ–¹å½¢ï¼‰
                - è¶Šå¤§ï¼Œæ°´ä½å˜åŒ–è¶Šæ…¢
            
            R (float): å‡ºå£é˜»åŠ›ç³»æ•°ï¼ˆå•ä½ï¼šåˆ†é’Ÿ/å¹³æ–¹ç±³ min/mÂ²ï¼‰
                - é»˜è®¤ 2.0 min/mÂ²
                - è¶Šå¤§ï¼Œå‡ºæ°´è¶Šæ…¢
                - ç‰©ç†æ„ä¹‰ï¼šQ_out = h / R
            
            K (float): æ³µå¢ç›Šï¼ˆå•ä½ï¼šç«‹æ–¹ç±³æ¯åˆ†é’Ÿ mÂ³/minï¼‰
                - é»˜è®¤ 1.0
                - è¡¨ç¤ºæ³µçš„æŠ½æ°´èƒ½åŠ›
                - å®é™…æµé‡ = K Ã— æ§åˆ¶ä¿¡å·(0-1)
        
        ç¤ºä¾‹ï¼š
            >>> tank = SingleTank(A=2.0, R=2.0, K=1.0)
            >>> print(tank)
            å•æ°´ç®±: A=2.00mÂ², R=2.00min/mÂ², K=1.00mÂ³/min
        """
        # å‚æ•°æ£€æŸ¥
        if A <= 0:
            raise ValueError(f"æ¨ªæˆªé¢ç§¯å¿…é¡»å¤§äº0ï¼Œå½“å‰å€¼ï¼š{A}")
        if R <= 0:
            raise ValueError(f"é˜»åŠ›ç³»æ•°å¿…é¡»å¤§äº0ï¼Œå½“å‰å€¼ï¼š{R}")
        if K < 0:
            raise ValueError(f"æ³µå¢ç›Šä¸èƒ½ä¸ºè´Ÿï¼Œå½“å‰å€¼ï¼š{K}")
        
        self.A = A  # æ¨ªæˆªé¢ç§¯
        self.R = R  # é˜»åŠ›ç³»æ•°
        self.K = K  # æ³µå¢ç›Š
        
        # è®¡ç®—ç‰¹æ€§å‚æ•°ï¼ˆç”¨äºåˆ†æï¼‰
        self.tau = A * R  # æ—¶é—´å¸¸æ•°ï¼ˆç§’ï¼‰
        self.steady_state_gain = K * R  # ç¨³æ€å¢ç›Š
        
        # åˆå§‹çŠ¶æ€
        self.h = 2.0  # åˆå§‹æ°´ä½ 2ç±³
        self.t = 0.0  # ä»¿çœŸæ—¶é—´
    
    def compute_flow_out(self, h):
        """
        è®¡ç®—å‡ºæ°´æµé‡
        
        ç‰©ç†æ¨¡å‹ï¼šQ_out = h / R
        - æ°´ä½è¶Šé«˜ï¼Œå‹åŠ›è¶Šå¤§ï¼Œå‡ºæ°´è¶Šå¿«
        - çº¿æ€§åŒ–è¿‘ä¼¼ï¼ˆå®é™…å¯èƒ½æ˜¯å¹³æ–¹æ ¹å…³ç³»ï¼‰
        
        å‚æ•°ï¼š
            h (float): å½“å‰æ°´ä½ï¼ˆç±³ï¼‰
        
        è¿”å›ï¼š
            float: å‡ºæ°´æµé‡ï¼ˆmÂ³/minï¼‰
        """
        if h <= 0:
            return 0.0  # æ²¡æ°´äº†ï¼Œä¸èƒ½å†æµå‡º
        
        Q_out = h / self.R
        return Q_out
    
    def compute_level_change_rate(self, h, Q_in):
        """
        è®¡ç®—æ°´ä½å˜åŒ–é€Ÿåº¦ dh/dt
        
        æ¨å¯¼è¿‡ç¨‹ï¼š
        1. è´¨é‡å®ˆæ’ï¼šdV/dt = Q_in - Q_out
        2. å‡ ä½•å…³ç³»ï¼šV = A Ã— hï¼Œæ‰€ä»¥ dV/dt = A Ã— dh/dt
        3. ä»£å…¥å¾—ï¼šA Ã— dh/dt = Q_in - Q_out
        4. ä¸¤è¾¹é™¤ä»¥Aï¼šdh/dt = (Q_in - Q_out) / A
        
        å‚æ•°ï¼š
            h (float): å½“å‰æ°´ä½ï¼ˆç±³ï¼‰
            Q_in (float): å…¥æ°´æµé‡ï¼ˆmÂ³/minï¼‰
        
        è¿”å›ï¼š
            float: æ°´ä½å˜åŒ–é€Ÿåº¦ï¼ˆm/minï¼‰
        """
        Q_out = self.compute_flow_out(h)
        dh_dt = (Q_in - Q_out) / self.A
        return dh_dt
    
    def step(self, u, dt=0.1):
        """
        æ¨è¿›ä¸€ä¸ªæ—¶é—´æ­¥é•¿ï¼ˆæ¬§æ‹‰æ³•ï¼‰
        
        æ•°å€¼æ–¹æ³•ï¼šæ˜¾å¼æ¬§æ‹‰æ³•
        - h_new = h_old + dh/dt Ã— dt
        - ç®€å•ä½†è¦æ±‚dtè¶³å¤Ÿå°
        
        å‚æ•°ï¼š
            u (float): æ§åˆ¶è¾“å…¥ï¼ˆ0-1ä¹‹é—´ï¼Œ0=å…³æ³µï¼Œ1=å…¨é€Ÿï¼‰
            dt (float): æ—¶é—´æ­¥é•¿ï¼ˆåˆ†é’Ÿï¼‰ï¼Œé»˜è®¤0.1åˆ†é’Ÿ=6ç§’
        
        è¿”å›ï¼š
            float: æ›´æ–°åçš„æ°´ä½ï¼ˆç±³ï¼‰
        
        ç¤ºä¾‹ï¼š
            >>> tank = SingleTank()
            >>> tank.h = 2.0  # åˆå§‹æ°´ä½2ç±³
            >>> new_h = tank.step(u=0.5, dt=0.1)  # 50%åŠŸç‡æŠ½æ°´
            >>> print(f"æ–°æ°´ä½: {new_h:.3f}ç±³")
        """
        # é™åˆ¶æ§åˆ¶è¾“å…¥åœ¨åˆç†èŒƒå›´å†…
        u = np.clip(u, 0.0, 1.0)
        
        # è®¡ç®—å®é™…æµå…¥é‡
        Q_in = self.K * u
        
        # è®¡ç®—æ°´ä½å˜åŒ–é€Ÿåº¦
        dh_dt = self.compute_level_change_rate(self.h, Q_in)
        
        # æ›´æ–°æ°´ä½ï¼ˆæ¬§æ‹‰æ³•ï¼‰
        self.h = self.h + dh_dt * dt
        
        # æ°´ä½ä¸èƒ½ä¸ºè´Ÿ
        self.h = max(0.0, self.h)
        
        # æ›´æ–°æ—¶é—´
        self.t += dt
        
        return self.h
    
    def reset(self, h0=2.0):
        """
        é‡ç½®æ°´ç®±çŠ¶æ€
        
        å‚æ•°ï¼š
            h0 (float): åˆå§‹æ°´ä½ï¼ˆç±³ï¼‰ï¼Œé»˜è®¤2.0ç±³
        """
        self.h = h0
        self.t = 0.0
    
    def get_state_space_matrices(self):
        """
        è¿”å›çŠ¶æ€ç©ºé—´è¡¨ç¤º
        
        çŠ¶æ€æ–¹ç¨‹ï¼šdh/dt = -h/(AÃ—R) + (K/A)Ã—u
        è¾“å‡ºæ–¹ç¨‹ï¼šy = h
        
        çŸ©é˜µå½¢å¼ï¼š
        - A = -1/(AÃ—R) = -1/Ï„
        - B = K/A
        - C = 1
        - D = 0
        
        è¿”å›ï¼š
            tuple: (A, B, C, D) çŠ¶æ€ç©ºé—´çŸ©é˜µ
        
        ç”¨é€”ï¼š
        - æ§åˆ¶ç³»ç»Ÿè®¾è®¡ï¼ˆLQRã€æç‚¹é…ç½®ç­‰ï¼‰
        - å¯æ§æ€§ã€å¯è§‚æ€§åˆ†æ
        - ä¼ é€’å‡½æ•°è®¡ç®—
        """
        A_matrix = np.array([[-1.0 / self.tau]])
        B_matrix = np.array([[self.K / self.A]])
        C_matrix = np.array([[1.0]])
        D_matrix = np.array([[0.0]])
        
        return A_matrix, B_matrix, C_matrix, D_matrix
    
    def get_transfer_function(self):
        """
        è¿”å›ä¼ é€’å‡½æ•°å‚æ•°
        
        ä¼ é€’å‡½æ•°ï¼šG(s) = K_dc / (Ï„Ã—s + 1)
        - K_dc = K Ã— R ï¼ˆç›´æµå¢ç›Šï¼‰
        - Ï„ = A Ã— R ï¼ˆæ—¶é—´å¸¸æ•°ï¼‰
        
        è¿”å›ï¼š
            dict: {'gain': K_dc, 'tau': Ï„}
        
        ç”¨é€”ï¼š
        - é¢‘åŸŸåˆ†æ
        - PIDå‚æ•°æ•´å®š
        - ç³»ç»Ÿè¾¨è¯†éªŒè¯
        """
        return {
            'gain': self.steady_state_gain,
            'tau': self.tau,
            'description': f'G(s) = {self.steady_state_gain:.2f} / ({self.tau:.2f}Ã—s + 1)'
        }
    
    def __repr__(self):
        """å­—ç¬¦ä¸²è¡¨ç¤º"""
        return (f"SingleTank(A={self.A:.2f}mÂ², R={self.R:.2f}min/mÂ², "
                f"K={self.K:.2f}mÂ³/min, h={self.h:.2f}m)")
    
    def __str__(self):
        """ç”¨æˆ·å‹å¥½çš„å­—ç¬¦ä¸²"""
        return (f"å•æ°´ç®±: æ¨ªæˆªé¢ç§¯{self.A:.2f}mÂ², é˜»åŠ›ç³»æ•°{self.R:.2f}min/mÂ², "
                f"æ³µå¢ç›Š{self.K:.2f}mÂ³/min, å½“å‰æ°´ä½{self.h:.2f}m")


# ============================================================================
# ä»¥ä¸‹æ˜¯è¾…åŠ©å‡½æ•°ï¼Œç”¨äºæ•™å­¦æ¼”ç¤º
# ============================================================================

def simulate_open_loop(tank, u_sequence, dt=0.1):
    """
    å¼€ç¯ä»¿çœŸï¼ˆå›ºå®šè¾“å…¥ï¼‰
    
    å‚æ•°ï¼š
        tank (SingleTank): æ°´ç®±å¯¹è±¡
        u_sequence (array): æ§åˆ¶è¾“å…¥åºåˆ—
        dt (float): æ—¶é—´æ­¥é•¿
    
    è¿”å›ï¼š
        tuple: (t, h, Q_in, Q_out) æ—¶é—´ã€æ°´ä½ã€å…¥æ°´ã€å‡ºæ°´åºåˆ—
    """
    n_steps = len(u_sequence)
    t = np.arange(n_steps) * dt
    h = np.zeros(n_steps)
    Q_in = np.zeros(n_steps)
    Q_out = np.zeros(n_steps)
    
    for i, u in enumerate(u_sequence):
        h[i] = tank.h
        Q_in[i] = tank.K * u
        Q_out[i] = tank.compute_flow_out(tank.h)
        tank.step(u, dt)
    
    return t, h, Q_in, Q_out


def simulate_closed_loop(tank, controller, duration=60, dt=0.1):
    """
    é—­ç¯ä»¿çœŸï¼ˆå¸¦åé¦ˆæ§åˆ¶ï¼‰
    
    å‚æ•°ï¼š
        tank (SingleTank): æ°´ç®±å¯¹è±¡
        controller: æ§åˆ¶å™¨å¯¹è±¡ï¼ˆéœ€è¦æœ‰control(h)æ–¹æ³•ï¼‰
        duration (float): ä»¿çœŸæ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰
        dt (float): æ—¶é—´æ­¥é•¿
    
    è¿”å›ï¼š
        tuple: (t, h, u, error) æ—¶é—´ã€æ°´ä½ã€æ§åˆ¶è¾“å…¥ã€è¯¯å·®åºåˆ—
    """
    n_steps = int(duration / dt)
    t = np.zeros(n_steps)
    h = np.zeros(n_steps)
    u = np.zeros(n_steps)
    error = np.zeros(n_steps)
    
    for i in range(n_steps):
        t[i] = tank.t
        h[i] = tank.h
        
        # æ§åˆ¶å™¨è®¡ç®—
        u[i] = controller.control(tank.h)
        error[i] = controller.setpoint - tank.h
        
        # æ°´ç®±æ›´æ–°
        tank.step(u[i], dt)
    
    return t, h, u, error


if __name__ == "__main__":
    """æµ‹è¯•ä»£ç """
    print("=" * 60)
    print("å•æ°´ç®±æ¨¡å‹æµ‹è¯•")
    print("=" * 60)
    
    # åˆ›å»ºæ°´ç®±
    tank = SingleTank(A=2.0, R=2.0, K=1.0)
    print(f"\n{tank}")
    print(f"æ—¶é—´å¸¸æ•°: {tank.tau:.2f} åˆ†é’Ÿ")
    print(f"ç¨³æ€å¢ç›Š: {tank.steady_state_gain:.2f}")
    
    # æµ‹è¯•é˜¶è·ƒå“åº”
    print("\n[æµ‹è¯•] é˜¶è·ƒè¾“å…¥ u=1.0 (å…¨é€ŸæŠ½æ°´)")
    tank.reset(h0=2.0)
    
    for i in range(5):
        h_new = tank.step(u=1.0, dt=1.0)  # æ¯æ­¥1åˆ†é’Ÿ
        print(f"  t={tank.t:.1f}åˆ†é’Ÿ, æ°´ä½={h_new:.3f}ç±³")
    
    # è·å–çŠ¶æ€ç©ºé—´
    A, B, C, D = tank.get_state_space_matrices()
    print(f"\nçŠ¶æ€ç©ºé—´çŸ©é˜µ:")
    print(f"  A = {A[0,0]:.4f}")
    print(f"  B = {B[0,0]:.4f}")
    print(f"  C = {C[0,0]:.4f}")
    print(f"  D = {D[0,0]:.4f}")
    
    # è·å–ä¼ é€’å‡½æ•°
    tf = tank.get_transfer_function()
    print(f"\nä¼ é€’å‡½æ•°: {tf['description']}")
    
    print("\nâœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡!")
```

ä¿å­˜å¹¶æµ‹è¯•ï¼š
```bash
cd /workspace
python3 src/models/water_tank/single_tank.py
```

---

### Day 4-5ï¼šåˆ›å»ºæ ‡å‡†æµ‹è¯•æ¡ˆä¾‹

#### ä»»åŠ¡4.1ï¼šç¼–å†™ç¬¬ä¸€ä¸ªæ ‡å‡†æµ‹è¯•

**æ–‡ä»¶ï¼š** `tests/standard_cases/test_first_order_system.py`

```python
"""
æ ‡å‡†æµ‹è¯•æ¡ˆä¾‹ TC-01: ä¸€é˜¶ç³»ç»Ÿé˜¶è·ƒå“åº”

å‚è€ƒï¼šOgata "Modern Control Engineering" Example 5-1
"""

import pytest
import numpy as np
import sys
import os

# æ·»åŠ srcåˆ°è·¯å¾„
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..', '..'))

from src.models.water_tank.single_tank import SingleTank


class TestTC01_FirstOrderStepResponse:
    """ä¸€é˜¶ç³»ç»Ÿé˜¶è·ƒå“åº”æ ‡å‡†æ¡ˆä¾‹"""
    
    def test_time_constant(self):
        """
        æµ‹è¯•æ—¶é—´å¸¸æ•°
        
        ç†è®ºï¼šå½“ t = Ï„ æ—¶ï¼Œè¾“å‡ºè¾¾åˆ°æœ€ç»ˆå€¼çš„ 63.2%
        """
        # åˆ›å»ºç³»ç»Ÿ: Ï„ = AÃ—R = 2Ã—2 = 4åˆ†é’Ÿ
        tank = SingleTank(A=2.0, R=2.0, K=1.0)
        tank.reset(h0=0.0)  # ä»0å¼€å§‹
        
        # å•ä½é˜¶è·ƒè¾“å…¥
        dt = 0.01  # å°æ­¥é•¿ç¡®ä¿ç²¾åº¦
        final_value = tank.steady_state_gain  # ç†è®ºæœ€ç»ˆå€¼
        
        # ä»¿çœŸåˆ° t = Ï„
        target_time = tank.tau
        n_steps = int(target_time / dt)
        
        for _ in range(n_steps):
            tank.step(u=1.0, dt=dt)
        
        # éªŒè¯
        expected = 0.632 * final_value  # 63.2%
        actual = tank.h
        error = abs(actual - expected) / expected
        
        print(f"\n[TC-01] æ—¶é—´å¸¸æ•°æµ‹è¯•:")
        print(f"  Ï„ = {tank.tau:.2f} åˆ†é’Ÿ")
        print(f"  æœ€ç»ˆå€¼ = {final_value:.3f} ç±³")
        print(f"  t=Ï„æ—¶æœŸæœ› = {expected:.3f} ç±³ (63.2%)")
        print(f"  t=Ï„æ—¶å®é™… = {actual:.3f} ç±³")
        print(f"  ç›¸å¯¹è¯¯å·® = {error*100:.2f}%")
        
        assert error < 0.02, f"æ—¶é—´å¸¸æ•°æµ‹è¯•å¤±è´¥ï¼šè¯¯å·®{error*100:.1f}%è¶…è¿‡2%"
    
    def test_steady_state_value(self):
        """
        æµ‹è¯•ç¨³æ€å€¼
        
        ç†è®ºï¼štâ†’âˆ æ—¶ï¼Œè¾“å‡º = KÃ—RÃ—u = 1.0Ã—2.0Ã—1.0 = 2.0
        """
        tank = SingleTank(A=2.0, R=2.0, K=1.0)
        tank.reset(h0=0.0)
        
        # ä»¿çœŸè¶³å¤Ÿé•¿æ—¶é—´ï¼ˆ5å€æ—¶é—´å¸¸æ•°ï¼‰
        dt = 0.1
        duration = 5 * tank.tau
        n_steps = int(duration / dt)
        
        for _ in range(n_steps):
            tank.step(u=1.0, dt=dt)
        
        expected = tank.steady_state_gain
        actual = tank.h
        error = abs(actual - expected)
        
        print(f"\n[TC-01] ç¨³æ€å€¼æµ‹è¯•:")
        print(f"  ä»¿çœŸæ—¶é•¿ = {duration:.1f} åˆ†é’Ÿ (5Ï„)")
        print(f"  ç†è®ºç¨³æ€å€¼ = {expected:.3f} ç±³")
        print(f"  å®é™…ç¨³æ€å€¼ = {actual:.3f} ç±³")
        print(f"  ç»å¯¹è¯¯å·® = {error:.4f} ç±³")
        
        assert error < 0.01, f"ç¨³æ€å€¼æµ‹è¯•å¤±è´¥ï¼šè¯¯å·®{error:.3f}ç±³è¶…è¿‡0.01ç±³"
    
    def test_linearity(self):
        """
        æµ‹è¯•çº¿æ€§æ€§
        
        ç†è®ºï¼šå¦‚æœè¾“å…¥æ”¾å¤§2å€ï¼Œè¾“å‡ºä¹Ÿåº”æ”¾å¤§2å€
        """
        tank1 = SingleTank(A=2.0, R=2.0, K=1.0)
        tank2 = SingleTank(A=2.0, R=2.0, K=1.0)
        
        tank1.reset(h0=0.0)
        tank2.reset(h0=0.0)
        
        # tank1: è¾“å…¥ u=0.5
        # tank2: è¾“å…¥ u=1.0
        dt = 0.1
        n_steps = int(5 * tank1.tau / dt)
        
        for _ in range(n_steps):
            tank1.step(u=0.5, dt=dt)
            tank2.step(u=1.0, dt=dt)
        
        # tank2çš„è¾“å‡ºåº”è¯¥æ˜¯tank1çš„2å€
        ratio = tank2.h / tank1.h if tank1.h > 0 else 0
        
        print(f"\n[TC-01] çº¿æ€§æ€§æµ‹è¯•:")
        print(f"  è¾“å…¥u1=0.5 â†’ è¾“å‡ºh1={tank1.h:.3f}ç±³")
        print(f"  è¾“å…¥u2=1.0 â†’ è¾“å‡ºh2={tank2.h:.3f}ç±³")
        print(f"  æ¯”å€¼ h2/h1 = {ratio:.3f} (æœŸæœ›2.0)")
        
        assert abs(ratio - 2.0) < 0.01, f"çº¿æ€§æ€§æµ‹è¯•å¤±è´¥ï¼šæ¯”å€¼{ratio:.3f}ä¸ç­‰äº2.0"


if __name__ == "__main__":
    """ç›´æ¥è¿è¡Œæµ‹è¯•"""
    pytest.main([__file__, "-v", "-s"])
```

è¿è¡Œæµ‹è¯•ï¼š
```bash
cd /workspace
python3 -m pytest tests/standard_cases/test_first_order_system.py -v -s
```

---

## ğŸ“š ä¸‹å‘¨è®¡åˆ’ï¼ˆç¬¬2å‘¨ï¼‰

### Day 6-7ï¼šå¼€å§‹ç¼–å†™æ¡ˆä¾‹1

æŒ‰ç…§ `/workspace/docs/zh/é›¶åŸºç¡€æ•™æå¼€å‘è¯¦ç»†æ–¹æ¡ˆ.md` ä¸­çš„7éƒ¨åˆ†æ¨¡æ¿ï¼Œç¼–å†™ï¼š

1. ç”Ÿæ´»åœºæ™¯å¼•å…¥
2. é—®é¢˜æç‚¼ä¸åˆ†æ
3. ç‰©ç†åŸç†ï¼ˆé«˜ä¸­ç‰©ç†+ç®€å•æ¨å¯¼ï¼‰
4. æ§åˆ¶æ–¹æ³•ï¼ˆå¼€å…³æ§åˆ¶ã€æ¯”ä¾‹æ§åˆ¶ï¼‰
5. å»ºæ¨¡ä¸ä»¿çœŸï¼ˆå®Œæ•´Pythonä»£ç ï¼‰
6. ç»“æœåˆ†æä¸è®¨è®º
7. æ€»ç»“ä¸å±•æœ›

### Day 8-9ï¼šåˆ›å»ºJupyter Notebook

å°†æ¡ˆä¾‹1è½¬æ¢ä¸ºäº¤äº’å¼Notebookï¼ŒåŒ…å«ï¼š
- å¯è¿è¡Œçš„ä»£ç å•å…ƒ
- ipywidgetsäº¤äº’æ§ä»¶
- å†…åµŒçš„ç»ƒä¹ é¢˜

### Day 10ï¼šå­¦ç”Ÿè¯•ç”¨ä¸åé¦ˆ

æ‰¾2-3åå­¦ç”Ÿè¯•ç”¨æ¡ˆä¾‹1ï¼Œæ”¶é›†åé¦ˆï¼š
- å“ªäº›åœ°æ–¹éš¾ä»¥ç†è§£ï¼Ÿ
- å“ªäº›å›¾è¡¨éœ€è¦æ”¹è¿›ï¼Ÿ
- ä»£ç æ³¨é‡Šæ˜¯å¦è¶³å¤Ÿï¼Ÿ
- ç»ƒä¹ é¢˜éš¾åº¦å¦‚ä½•ï¼Ÿ

---

## ğŸ“ è·å–å¸®åŠ©

å¦‚æœåœ¨å®æ–½è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŠ€æœ¯é—®é¢˜**ï¼šæŸ¥çœ‹å·²åˆ›å»ºçš„æ–‡æ¡£
   - æ¨¡å‹è®¾è®¡ï¼š`é›¶åŸºç¡€æ•™æå¼€å‘è¯¦ç»†æ–¹æ¡ˆ.md`
   - æ¡ˆä¾‹ç»“æ„ï¼š7éƒ¨åˆ†æ¨¡æ¿
   - ä»£ç è§„èŒƒï¼š`single_tank.py` ç¤ºä¾‹

2. **æ•™å­¦é—®é¢˜**ï¼šå‚è€ƒåŸåˆ™
   - å‡è®¾å­¦ç”Ÿåªæœ‰é«˜ä¸­åŸºç¡€
   - å…ˆç‰©ç†åæ•°å­¦
   - å¤§é‡å›¾ç¤ºå’Œä¾‹å­
   - é¿å…è·³æ­¥

3. **è¿›åº¦é—®é¢˜**ï¼š
   - æ¯å®Œæˆä¸€ä¸ªæ¡ˆä¾‹å°±æ˜¯é‡Œç¨‹ç¢‘
   - è¾¹å¼€å‘è¾¹æµ‹è¯•è¾¹æ”¹è¿›
   - ä¸æ±‚å®Œç¾ï¼Œæ±‚å¿«é€Ÿè¿­ä»£

---

## âœ… æœ¬å‘¨æœ«æ£€æŸ¥æ¸…å•

åœ¨ç¬¬1å‘¨ç»“æŸæ—¶ï¼Œæ‚¨åº”è¯¥å®Œæˆï¼š

- [ ] ä»£ç å¤‡ä»½å’Œæ¸…ç†åˆ†ææŠ¥å‘Š
- [ ] SingleTankModel ç±»å®ç°å¹¶é€šè¿‡æµ‹è¯•
- [ ] TC-01 æ ‡å‡†æµ‹è¯•æ¡ˆä¾‹é€šè¿‡
- [ ] æ¡ˆä¾‹1çš„å¤§çº²å’Œéƒ¨åˆ†å†…å®¹
- [ ] å­¦ç”Ÿè¯•ç”¨å®‰æ’

**å¦‚æœå…¨éƒ¨å®Œæˆï¼Œæ­å–œæ‚¨ï¼æ‚¨å·²ç»æˆåŠŸå¼€å§‹äº†è¿™ä¸ªé¡¹ç›®ã€‚** ğŸ‰

**ç»§ç»­åŠ æ²¹ï¼Œç¬¬2å‘¨æˆ‘ä»¬å°†å®Œæˆç¬¬ä¸€ä¸ªå®Œæ•´æ¡ˆä¾‹ï¼** ğŸ’ª
