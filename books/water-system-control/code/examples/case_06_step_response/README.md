# 案例6：阶跃响应法快速建模 - 图解法参数辨识

## 案例背景

现场工程师在调试一个水箱控制系统时，需要快速建立系统模型以便调试PID控制器。然而现场没有计算机，只有记录仪和计算器。工程师决定使用经典的阶跃响应图解法，这是一种无需复杂计算的快速建模方法。

通过记录系统对阶跃输入的响应曲线，利用响应曲线的特征点（如63.2%稳态值点、初始切线等），可以用简单的图解和计算提取系统参数。

## 学习目标

1. 理解一阶系统的阶跃响应特性
2. 掌握时间常数的图解提取方法（63.2%法、切线法）
3. 学习稳态增益的测量和计算
4. 理解图解法的优缺点和适用场景
5. 对比图解法与优化算法的精度

## 核心理论

### 1. 一阶系统阶跃响应

单水箱系统的传递函数：
```
        K
G(s) = ---
       τs + 1
```

其中：
- K = K_pump × R（稳态增益）
- τ = A × R（时间常数）

对单位阶跃输入 u(t) = U，系统响应为：
```
h(t) = h0 + K×U × (1 - e^(-t/τ))
```

### 2. 特征参数的物理意义

**时间常数 τ**：
- 定义：系统响应达到稳态值63.2%所需时间
- 物理意义：反映系统响应快慢
- τ越大，系统响应越慢

**稳态增益 K**：
- 定义：稳态输出变化量与输入变化量之比
- 计算：K = Δh_ss / Δu
- 物理意义：反映系统放大特性

### 3. 图解法辨识方法

#### 方法1：63.2%法

1. 测量初始值 h0 和稳态值 h_ss
2. 计算63.2%值：h_63.2 = h0 + 0.632 × (h_ss - h0)
3. 从响应曲线读取达到h_63.2时的时间，即为τ
4. 计算稳态增益：K = (h_ss - h0) / U

#### 方法2：切线法

1. 在响应曲线起点做切线
2. 切线与稳态值水平线的交点对应的时间即为τ
3. 切线斜率 = (h_ss - h0) / τ

#### 方法3：双点法

利用两个时刻的响应值：
```
h(t1) = h0 + K×U × (1 - e^(-t1/τ))
h(t2) = h0 + K×U × (1 - e^(-t2/τ))
```

求解 τ 和 K。

### 4. 从 τ 和 K 反推物理参数

已知：
- τ = A × R
- K = K_pump × R

如果已知泵增益 K_pump（可从泵铭牌获取），则：
```
R = K / K_pump
A = τ / R
```

## 计算任务

### 任务1：阶跃响应实验

记录水箱对阶跃输入（u: 0 → 0.6）的响应数据。

### 任务2：图解法提取参数

使用三种图解法提取时间常数τ和稳态增益K：
- 63.2%法
- 切线法
- 双点法

### 任务3：模型验证

使用辨识的参数预测系统响应，与实测数据对比。

### 任务4：方法对比

对比三种图解法和优化算法的精度。

## 使用方法

```bash
# 运行主程序（图解法辨识全流程）
cd books/water-system-control/code/examples/case_06_step_response
python main.py

# 运行扩展实验（不同图解法对比、噪声影响等）
python experiments.py
```

## 文件说明

- `main.py` - 主程序：阶跃响应实验、图解法辨识、模型验证
- `experiments.py` - 扩展实验：三种图解法对比、噪声影响、不同系统参数测试
- `README.md` - 本文件

## 预期结果

### 辨识精度（无噪声）

真实参数：
- τ = A × R = 2.5 × 1.8 = 4.5 分钟
- K = K_pump × R = 1.2 × 1.8 = 2.16 m

图解法结果：
- 63.2%法：τ ≈ 4.5 min，K ≈ 2.16 m（误差 < 1%）
- 切线法：τ ≈ 4.5 min，K ≈ 2.16 m（误差 < 1%）
- 双点法：τ ≈ 4.5 min，K ≈ 2.16 m（误差 < 1%）

### 特征时间

- 1τ（63.2%）：约4.5分钟
- 2τ（86.5%）：约9.0分钟
- 3τ（95.0%）：约13.5分钟
- 4τ（98.2%）：约18.0分钟
- 5τ（99.3%）：约22.5分钟

## 工程意义

本案例展示了：

1. **快速建模方法**：
   - 无需复杂计算和优化算法
   - 现场工程师用纸笔即可完成
   - 适合应急调试场景

2. **物理直观性**：
   - 参数具有明确物理意义
   - 可通过图形直观理解系统特性
   - 易于向非专业人员解释

3. **工程实践价值**：
   - 经典方法，工业界广泛应用
   - 快速估计PID参数（如Ziegler-Nichols法）
   - 系统故障诊断（通过τ变化判断）

4. **局限性认识**：
   - 仅适用于一阶或近似一阶系统
   - 对噪声敏感（需平滑处理）
   - 精度不如优化算法（但对工程应用足够）

## 图解法 vs 优化算法

| 特性 | 图解法 | 优化算法（案例5） |
|------|--------|-------------------|
| 计算复杂度 | 低 | 高 |
| 所需工具 | 纸笔、计算器 | 计算机、编程 |
| 精度 | 中等（1-5%） | 高（< 1%） |
| 适用系统 | 一阶系统 | 任意系统 |
| 噪声鲁棒性 | 较差 | 较好 |
| 现场适用性 | 优秀 | 一般 |
| 学习难度 | 低 | 中等 |

## 扩展思考

1. **二阶系统**：图解法如何扩展到二阶系统？
2. **时滞系统**：如何识别纯时滞？
3. **噪声处理**：实测数据有噪声时如何提高精度？
4. **快速整定**：如何基于τ和K快速整定PID参数？
5. **在线监测**：能否用阶跃响应监测系统老化？

## 相关案例

- **案例4**：PID控制与参数整定（可使用本案例辨识结果）
- **案例5**：参数辨识与最小二乘法（优化算法方法）
- **案例11**（规划中）：频域分析方法

## 历史背景

阶跃响应法是20世纪40-50年代发展起来的经典方法，在计算机普及前被广泛应用。著名的Ziegler-Nichols整定法（1942年）就基于阶跃响应。虽然现在有更精确的计算方法，但图解法因其简单直观，至今仍在工业现场使用。

## 参考资料

1. Ziegler, J. G., & Nichols, N. B. (1942). Optimum settings for automatic controllers
2. Åström, K. J., & Hägglund, T. (2006). Advanced PID Control
3. 李友善 (2010). 过程控制系统
