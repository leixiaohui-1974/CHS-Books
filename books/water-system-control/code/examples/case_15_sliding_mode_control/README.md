# 案例15：滑模控制 - 鲁棒非线性控制

## 场景描述

滑模控制（Sliding Mode Control, SMC）是一种强鲁棒的非线性控制方法，特别适合处理不确定性和扰动。即使系统参数变化或存在外部干扰，滑模控制仍能保持良好的性能。

在水箱控制中，滑模控制可以：
- 应对参数不确定性（水箱面积、阀门阻力变化）
- 抑制外部扰动（进水扰动、出水变化）
- 保证有限时间收敛
- 实现精确跟踪

## 教学目标

1. **理解滑模控制原理**：滑模面、到达条件、滑模运动
2. **掌握控制律设计**：等效控制+切换控制
3. **学习抖振抑制**：边界层法、饱和函数
4. **分析鲁棒性**：参数变化、扰动抑制
5. **对比性能**：滑模vs PID vs自适应

## 核心概念

### 1. 滑模控制基本思想

**核心思想**：设计切换控制律，使系统状态在有限时间内到达并保持在预定的滑模面上。

**三个阶段**：
1. **到达阶段**：从任意初始状态到达滑模面
2. **滑模运动**：沿滑模面向平衡点运动
3. **稳态**：达到期望值

### 2. 滑模面设计

对于一阶系统，典型的滑模面：
```
s = e + λ∫e dt
```

其中：
- **e = r - y**：跟踪误差
- **λ > 0**：设计参数（决定收敛速度）

**物理意义**：s = 0 定义了一个动态的误差收敛轨迹

### 3. 滑模到达条件

**Lyapunov稳定性条件**：
```
s·ṡ < 0
```

即滑模函数与其导数异号，保证状态趋向滑模面。

### 4. 控制律设计

**等效控制 ueq**：
- 维持系统在滑模面上运动所需的控制量
- 通过 ṡ = 0 求解得到

**切换控制 usw**：
- 克服不确定性和扰动
- 典型形式：k·sign(s) 或 k·sat(s/φ)

**总控制律**：
```
u = ueq + usw
```

### 5. 抖振问题

**抖振原因**：
- sign函数不连续导致高频切换
- 实际系统有延迟、惯性

**抑制方法**：
1. **边界层法**：用饱和函数替代符号函数
   ```
   sat(s/φ) = { s/φ,     |s| ≤ φ
              { sign(s),  |s| > φ
   ```
2. **高阶滑模**：使用更高阶的滑模变量
3. **观测器**：估计扰动并补偿

### 6. 鲁棒性分析

**优势**：
- 对匹配不确定性完全鲁棒
- 有限时间收敛
- 实现简单

**局限**：
- 抖振问题
- 需要知道不确定性上界
- 对未建模动态敏感

## 任务列表

### 任务1：基本滑模控制器设计
- 设计滑模面
- 推导等效控制和切换控制
- 验证到达条件

### 任务2：抖振抑制
- 对比sign函数vs饱和函数
- 边界层厚度影响
- 跟踪精度与抖振权衡

### 任务3：鲁棒性测试
- 参数不确定性
- 外部扰动抑制
- 与其他方法对比

### 任务4：自适应滑模控制
- 不确定性自适应估计
- 减小切换增益
- 降低保守性

## 使用方法

```bash
cd books/water-system-control/code/examples/case_15_sliding_mode_control
python main.py
python experiments.py
```

## 预期结果

1. **基本性能**：
   - 快速收敛到滑模面
   - 精确跟踪参考值
   - 有限时间稳定

2. **鲁棒性**：
   - 参数变化时性能保持
   - 强扰动抑制能力
   - 优于PID和自适应控制

3. **抖振控制**：
   - sign函数产生明显抖振
   - 饱和函数有效抑制
   - 边界层厚度影响分析

## 工程意义

### 1. 实际应用

**适用场合**：
- 不确定性大的系统
- 要求高鲁棒性
- 快速响应需求
- 扰动频繁的环境

**典型应用**：
- **机器人**：关节控制、轨迹跟踪
- **航空航天**：姿态控制、导弹制导
- **电机控制**：变速驱动、伺服系统
- **过程控制**：反应釜温度、液位控制

### 2. 优势与挑战

**优势**：
- 对参数不确定性和扰动鲁棒
- 有限时间收敛
- 设计相对简单
- 无需精确模型

**挑战**：
- 抖振问题（高频切换）
- 需要测量状态导数（或估计）
- 切换增益需知不确定性界
- 对传感器噪声敏感

### 3. 工程实现建议

- **抖振抑制**：使用饱和函数或连续近似
- **增益调参**：保守但避免过大
- **传感器滤波**：低通滤波器抑制噪声
- **自适应切换**：根据误差动态调整增益
- **监督切换**：异常时切回备用控制器

## 关键公式

### 滑模面
```
s = e + λ∫e dt
  = (r - y) + λ∫(r - y) dt
```

### 到达律
```
ṡ = -k·sign(s) - ε·s
```

### 控制律
```
u = ueq + usw
ueq：通过 ṡ = 0 求解
usw = -k·sat(s/φ)
```

### 饱和函数
```
sat(x) = { x,        |x| ≤ 1
         { sign(x),  |x| > 1
```

## 扩展学习

experiments.py包含：

1. **切换增益影响**：k对收敛速度和抖振的影响
2. **边界层厚度优化**：φ对性能的影响
3. **扰动抑制测试**：不同幅度扰动下的性能
4. **自适应滑模**：自适应估计不确定性上界

## 理论深化

### 1. 高阶滑模

**二阶滑模（Super-Twisting）**：
```
u = -k1|s|^(1/2)·sign(s) + u1
du1/dt = -k2·sign(s)
```

**优点**：连续控制，无抖振

### 2. 终端滑模

**非线性滑模面**：
```
s = e + β·|e|^α·sign(e)
```

其中 0 < α < 1，实现有限时间收敛。

### 3. 积分滑模

**包含积分项**：
```
s = e + λ∫e + c·∫sign(s)
```

增强鲁棒性，消除稳态误差。

## 常见问题

**Q1: 滑模控制 vs PID，如何选择？**

A:
- **PID**：系统稳定、参数已知、要求平滑控制
- **滑模**：不确定性大、扰动强、要求快速响应和鲁棒性

**Q2: 如何选择滑模面参数λ？**

A:
- λ越大，收敛越快，但控制量越大
- λ越小，收敛慢，但控制温和
- 典型范围：1 ~ 10（归一化后）

**Q3: 边界层厚度如何选择？**

A:
- φ太小：抖振严重
- φ太大：跟踪精度下降
- 折衷选择：φ = 0.01 ~ 0.1（归一化误差）

**Q4: 滑模控制需要测量什么？**

A:
- 至少需要测量输出y
- 如果滑模面包含导数项，需要估计或测量ẏ
- 可用观测器或数值微分估计导数

**Q5: 实际系统如何避免抖振？**

A:
- 使用饱和函数代替sign
- 采用高阶滑模算法
- 增加低通滤波器
- 自适应调整切换增益

## 下一步

- **案例16**：模糊控制 - 知识驱动的智能控制
- **案例17**：神经网络控制 - 数据驱动的学习控制
- **案例18**：反馈线性化 - 精确线性化非线性系统

---

**作者**: CHS-Books项目
**日期**: 2025-10-30
**版本**: 1.0
**关键词**: 滑模控制, SMC, 鲁棒控制, 非线性控制, 抖振抑制, 边界层法
