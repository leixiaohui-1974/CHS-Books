# 案例7：多点源污染叠加模拟

## 案例背景

某河段接纳3个工业企业排污口和1个污水处理厂尾水排放，需要评估多个点源叠加对河流水质的影响，确定达标距离和排放控制方案。

**河流参数**:
- 流量: Q = 50 m³/s
- 流速: u = 0.8 m/s
- 水深: H = 3.5 m
- 河宽: B = 18 m
- 扩散系数: D = 5 m²/s
- COD降解系数: k = 0.15 day⁻¹

**点源排放情况**:

| 点源 | 位置(km) | 流量(m³/s) | COD(mg/L) | 类型 |
|------|----------|------------|-----------|------|
| 排污口1 | 2 | 0.5 | 150 | 化工厂 |
| 排污口2 | 5 | 0.3 | 120 | 印染厂 |
| 排污口3 | 8 | 0.4 | 100 | 造纸厂 |
| 污水厂 | 12 | 2.0 | 50 | 城市污水 |

**水质目标**: III类水（COD ≤ 20 mg/L）

## 学习目标

1. 理解多点源污染叠加效应
2. 掌握点源边界条件处理
3. 学会达标距离计算
4. 掌握排放方案优化方法
5. 理解污染物迁移转化规律

## 核心理论

### 1. 一维河流水质方程

**稳态对流-扩散-反应方程**:
```
u * ∂C/∂x = D * ∂²C/∂x² - k * C
```

**物理意义**:
- 左项: 对流输运
- 右项第一项: 扩散输运
- 右项第二项: 降解反应

**假设条件**:
- 河流为一维
- 稳态条件
- 完全混合断面
- 常数流速和扩散系数

### 2. 点源边界条件

#### 质量守恒

**混合后浓度**:
```
C_mixed = (Q_river * C_river + Q_waste * C_waste) / (Q_river + Q_waste)
```

**混合后流量**:
```
Q_mixed = Q_river + Q_waste
```

#### 混合过程

**完全混合长度**（经验公式）:
```
L_mix = 0.13 * B * u
```

其中：
- B: 河宽 (m)
- u: 流速 (m/s)

**混合时间**:
```
t_mix = L_mix / u
```

### 3. 解析解

#### 不考虑扩散（Pe >> 1）

对于对流占主导的情况：

```
C(x) = C0 * exp(-k * (x - x0) / u)
```

**距离衰减**:
- x_half = (u / k) * ln(2)  # 半衰距离

#### 考虑扩散

完整解析解（复杂，通常数值求解）。

### 4. 污染物叠加效应

#### 线性叠加

**假设条件**: 污染物无相互作用

```
C_total(x) = C_background(x) + Σ C_source_i(x)
```

#### 非线性叠加

**考虑因素**:
- 污染物相互作用
- 水力条件变化
- 降解速率变化

### 5. 达标距离

#### 定义

从排污口到水质达标的距离。

**计算方法**:
```
找到 x 使得 C(x) ≤ C_standard
```

#### 影响因素

1. **排放强度**: 
   - 排放浓度 ↑ → 达标距离 ↑
   - 排放流量 ↑ → 达标距离 ↑

2. **水力条件**:
   - 河流流量 ↑ → 达标距离 ↓（稀释能力强）
   - 流速 ↑ → 达标距离 ↑（污染带延长）

3. **降解能力**:
   - 降解系数 ↑ → 达标距离 ↓

### 6. 排放控制方案

#### 总量控制

**目标**: 确保河段水质达标

**方法**:
1. 计算环境容量
2. 分配各点源排放量
3. 优化排放时序

#### 浓度控制

**目标**: 控制排放浓度

**方法**:
```
C_waste_max = (C_standard * Q_total - C_upstream * Q_river) / Q_waste
```

#### 流量控制

**目标**: 限制排放流量

**方法**:
- 枯水期削减排放
- 丰水期适当放宽

## 计算任务

### 任务1：单点源水质模拟

建立单点源模型：
1. 设置河流参数
2. 添加1个点源
3. 求解水质分布
4. 绘制浓度曲线

### 任务2：多点源叠加模拟

模拟4个点源叠加效应：
1. 添加所有点源
2. 求解多点源水质
3. 分析叠加效应
4. 识别最不利河段

### 任务3：达标距离计算

计算各点源下游达标距离：
1. 设定水质标准（20 mg/L）
2. 计算各点源达标距离
3. 识别超标河段
4. 提出控制建议

### 任务4：排放方案优化

优化排放浓度以满足标准：
1. 识别关键点源
2. 反推允许排放浓度
3. 计算削减比例
4. 制定分配方案

### 任务5：敏感性分析

分析关键参数影响：
1. 河流流量（±20%）
2. 降解系数（±30%）
3. 排放浓度（±50%）
4. 绘制敏感性图表

## 使用方法

```bash
# 运行主程序
python main.py
```

## 文件说明

- `main.py` - 主程序（多点源模拟、达标分析、方案优化）
- `README.md` - 本文件

## 预期结果

### 单点源模拟

**典型结果**:
- 排污口下游浓度快速上升
- 随距离逐渐降解
- 达标距离 ~3-5 km

### 多点源叠加

**叠加特征**:
- 第一个点源: 浓度最高（稀释能力弱）
- 后续点源: 叠加效应明显
- 污水厂: 虽浓度低但流量大

**最不利河段**:
- 污水厂下游 0-2 km
- 浓度可能超标

### 达标距离

**预期结果**:
```
排污口1下游: 4.5 km
排污口2下游: 3.2 km
排污口3下游: 2.8 km
污水厂下游: 5.0 km
```

### 排放优化

**建议方案**:
- 排污口1: 削减30%
- 排污口2: 削减20%
- 排污口3: 满足要求
- 污水厂: 削减15%

## 工程意义

### 1. 排污口规划

**选址原则**:
- 避免密集布置
- 考虑叠加效应
- 留足达标距离
- 避开敏感水域

**间距要求**:
- 相邻排污口间距 > 达标距离
- 重点保护区上游禁止排放

### 2. 总量控制

**分配原则**:
- 按环境容量分配
- 考虑叠加效应
- 优先保护断面达标

**动态管理**:
- 枯水期: 严格控制（稀释能力弱）
- 丰水期: 适当放宽（稀释能力强）

### 3. 应急管理

**预警机制**:
- 实时监测关键断面
- 超标立即溯源
- 快速响应削减

**应急措施**:
- 临时削减排放
- 增加河流流量（闸门调度）
- 污染物拦截

### 4. 环境监测

**监测布点**:
- 每个排污口下游100m
- 达标断面
- 控制断面
- 敏感水域

**监测频次**:
- 常规: 每月1次
- 重点: 每周1次
- 应急: 实时监测

### 5. 污染治理

**工程措施**:
- 提标改造（减少排放浓度）
- 中水回用（减少排放流量）
- 人工湿地（增强自净）

**管理措施**:
- 排污许可
- 总量控制
- 达标考核
- 经济激励

## 关键概念

### 多点源叠加
多个污染源共同作用的效应

### 达标距离
污染物浓度降至标准的距离

### 环境容量
水体能容纳的最大污染物量

### 混合过程
污染物横向和纵向扩散混合

### 衰减规律
污染物沿程浓度变化规律

### 总量控制
基于环境容量的排放管理

## 案例意义

**规划依据**:
- 多点源叠加是实际河流常见情况
- 单点源分析无法反映真实影响
- 需要综合考虑叠加效应

**决策支持**:
- 排污口选址规划
- 排放总量分配
- 治理方案制定

**环境保护**:
- 避免污染叠加超标
- 保护水环境质量
- 维护生态安全

## 扩展知识

### 1. 二维模拟

**考虑横向扩散**:
```
u * ∂C/∂x = Dx * ∂²C/∂x² + Dy * ∂²C/∂y² - k * C
```

**适用场景**:
- 宽浅河流
- 侧向排放
- 不完全混合

### 2. 动态模拟

**非稳态方程**:
```
∂C/∂t + u * ∂C/∂x = D * ∂²C/∂x² - k * C
```

**适用场景**:
- 流量变化
- 间歇排放
- 突发污染

### 3. 多污染物耦合

**考虑相互作用**:
```
∂C_i/∂t + u * ∂C_i/∂x = D * ∂²C_i/∂x² + R_i(C_1, C_2, ..., C_n)
```

**典型耦合**:
- COD-DO-NH3-N
- 氮磷循环
- 重金属形态

### 4. 不确定性分析

**参数不确定性**:
- Monte Carlo模拟
- 灵敏度分析
- 风险评估

**模型不确定性**:
- 模型结构
- 边界条件
- 初始条件

## 参考资料

1. Thomann, R.V., & Mueller, J.A. (1987). Principles of Surface Water Quality Modeling and Control.
2. Chapra, S.C. (1997). Surface Water-Quality Modeling. McGraw-Hill.
3. 国家环境保护总局. (2008). 水域纳污能力计算规程 GB/T 25173-2010.
4. Fischer, H.B., et al. (1979). Mixing in Inland and Coastal Waters. Academic Press.
5. 郑邦民等. (2010). 河流水质模型与模拟. 中国环境科学出版社.
