# 案例1：污染物在静水中的扩散

## 案例背景

某实验室水槽（长10m，宽2m，深1m），在中心点（x=5m）瞬时投放100g染料，观察扩散过程。

水温20°C，染料的扩散系数 D = 0.01 m²/s。

## 学习目标

1. 理解Fick扩散定律
2. 掌握扩散方程的基本形式
3. 学会显式和隐式有限差分法
4. 理解数值稳定性条件
5. 学会与解析解对比验证

## 核心理论

### 1. Fick第一定律

描述扩散通量：

```python
J = -D * ∂C/∂x
```

其中：
- J: 扩散通量 (kg/m²/s)
- D: 扩散系数 (m²/s)
- C: 浓度 (kg/m³ 或 mg/L)

### 2. Fick第二定律（扩散方程）

描述浓度随时间的变化：

**1D**:
```python
∂C/∂t = D * ∂²C/∂x²
```

**2D**:
```python
∂C/∂t = Dx * ∂²C/∂x² + Dy * ∂²C/∂y²
```

### 3. 解析解

对于无限域中的瞬时点源（高斯解）：

**1D**:
```python
C(x,t) = M / sqrt(4*π*D*t) * exp(-(x-x0)²/(4*D*t))
```

**2D**:
```python
C(x,y,t) = M / (4*π*sqrt(Dx*Dy)*t) * exp(-[(x-x0)²/(4*Dx*t) + (y-y0)²/(4*Dy*t)])
```

其中 M 是总投放质量。

## 数值方法

### 显式格式（FTCS）

```python
C[n+1,i] = C[n,i] + Fo * (C[n,i+1] - 2*C[n,i] + C[n,i-1])
```

其中 Fo = D*dt/dx² 是Fourier数。

**稳定性条件**: Fo ≤ 0.5

### 隐式格式（BTCS）

```python
-Fo*C[n+1,i-1] + (1+2*Fo)*C[n+1,i] - Fo*C[n+1,i+1] = C[n,i]
```

**优点**: 无条件稳定，但需要求解线性方程组。

### Crank-Nicolson格式

时间和空间都是二阶精度，无条件稳定。

## 计算任务

### 任务1：1D扩散模拟

1. 使用显式格式求解
2. 使用隐式格式求解
3. 使用Crank-Nicolson格式求解
4. 与解析解对比

### 任务2：稳定性分析

1. 验证显式格式的稳定性条件（Fo ≤ 0.5）
2. 测试隐式格式在大Fourier数下的稳定性
3. 分析时间步长和空间步长的影响

### 任务3：2D扩散模拟

1. 实现2D扩散模型
2. 可视化浓度分布的时空演化
3. 与2D解析解对比

### 任务4：参数敏感性分析

1. 分析扩散系数D的影响
2. 分析初始投放量的影响
3. 分析网格分辨率的影响

## 使用方法

```bash
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 文件说明

- `main.py` - 主计算程序
- `experiments.py` - 扩展实验
- `README.md` - 本文件

## 预期结果

### 1D扩散
- 浓度峰值随时间降低
- 污染带宽度随时间扩大
- 浓度分布呈高斯形状

### 2D扩散
- 形成圆形扩散区域
- 浓度峰值在中心
- 径向对称分布

### 数值精度
- 显式格式：一阶时间精度，二阶空间精度
- 隐式格式：一阶时间精度，二阶空间精度
- Crank-Nicolson：二阶时间精度，二阶空间精度

## 工程意义

1. **环境影响评估**：预测污染物扩散范围
2. **应急响应**：评估污染事故的影响时间和空间
3. **实验设计**：指导示踪实验的布点
4. **参数反演**：从实测数据推算扩散系数

## 参考资料

1. Crank, J. (1975). The Mathematics of Diffusion. Oxford University Press.
2. Bear, J. (1972). Dynamics of Fluids in Porous Media. Dover Publications.
3. Fischer, H. B., et al. (1979). Mixing in Inland and Coastal Waters. Academic Press.
