# 案例12：河口盐水入侵与水质模拟

## 案例背景

某沿海城市取水口位于河口区域，枯水期海水入侵严重影响取水水质。需要评估盐水入侵范围、取水口安全性，并制定枯水期应对方案。

**河口参数**:
- 河口长度: 30 km
- 平均水深: 5 m
- 河宽: 500 m
- 河流流量: 50 m³/s（枯水期）

**潮汐参数**:
- 潮差: 3 m
- 潮汐周期: 12.4 hour
- 潮型: 半日潮

**水质要求**:
- 取水口盐度 < 0.5 ppt
- 取水口位置: 距河口20 km

## 学习目标

1. 理解河口盐水入侵机理
2. 掌握盐淡水混合模拟
3. 学会潮汐作用处理
4. 理解密度流效应
5. 掌握取水口风险评估

## 核心理论

### 1. 盐水入侵类型

**分层型（Salt Wedge）**:
- 河流流量大
- 密度分层明显
- 盐水楔底层入侵

**部分混合型**:
- 中等流量和潮差
- 垂向部分混合
- 盐度垂向梯度

**充分混合型**:
- 强潮弱径流
- 垂向充分混合
- 盐度横向均匀

### 2. 控制方程

**盐度输运**:
```python
∂S/∂t + u*∂S/∂x = Kx*∂²S/∂x²
```

**密度-盐度关系**:
```python
ρ = ρ0 * (1 + β*S)
β ≈ 0.0008 (kg/m³)/ppt
```

### 3. 盐水楔长度

**Keulegan公式（简化）**:
```python
L_wedge ∝ Q^(-2/3)
```

枯水期河流流量减小，入侵长度增加。

### 4. Richardson数

**分层参数**:
```python
Ri = (g*Δρ*H) / (ρ*u²)
```

- Ri > 1: 强分层
- Ri < 0.25: 充分混合

### 5. 取水口风险

**风险因素**:
- 盐水入侵长度
- 潮汐振荡
- 枯水期流量
- 取水口位置

## 计算任务

### 任务1：盐度场模拟

模拟不同潮时盐度分布：
1. 涨潮高潮位
2. 退潮低潮位
3. 平均盐度

### 任务2：入侵长度分析

计算盐水入侵：
1. 不同流量下入侵长度
2. 潮汐对入侵的影响
3. 季节变化

### 任务3：取水口风险评估

评估取水安全：
1. 当前位置盐度
2. 风险等级
3. 安全裕度

### 任务4：枯水期方案

制定应对措施：
1. 取水口上移
2. 应急调度
3. 水库补水
4. 深层取水

## 使用方法

```bash
python main.py
```

## 预期结果

### 盐水入侵

**丰水期**（Q=200 m³/s）:
- 入侵长度: ~5 km
- 取水口盐度: <0.1 ppt
- 风险: 低

**枯水期**（Q=50 m³/s）:
- 入侵长度: ~15 km
- 取水口盐度: 0.3-1.0 ppt
- 风险: 中-高

### 潮汐影响

**涨潮**:
- 入侵加剧
- 取水口盐度升高

**退潮**:
- 入侵减弱
- 盐度降低

## 工程意义

### 1. 取水口选址

**原则**:
- 远离盐水入侵区
- 考虑枯水期
- 留有安全裕度
- 深层取水

### 2. 应急管理

**措施**:
- 实时监测盐度
- 预警系统
- 上游水库补水
- 备用水源

### 3. 水资源调度

**优化**:
- 枯水期限制用水
- 调配水库流量
- 错峰取水
- 淡化处理

## 关键概念

### 盐水楔
底层盐水以楔形向上游入侵

### 密度流
盐淡水密度差引起的环流

### 往复流
潮汐引起的来回流动

### 分层混合
垂向盐度分层程度

## 参考资料

1. Dyer, K.R. (1997). Estuaries: A Physical Introduction. Wiley.
2. Officer, C.B. (1976). Physical Oceanography of Estuaries. Wiley.
3. 华祖林. (2006). 河口海岸水环境数值模拟. 河海大学出版社.
