# 案例2：示踪剂在渠道中的对流-扩散

## 案例背景

某灌溉渠道（长100m，宽5m，深1.5m），流速 u = 0.5 m/s。在上游（x=10m）处瞬时投放示踪剂（荧光染料），监测下游浓度分布。

**水力参数**:
- 流速: u = 0.5 m/s
- 水深: h = 1.5 m
- 扩散系数: D = 0.1 m²/s
- 一阶衰减系数: k = 0.01 s⁻¹

## 学习目标

1. 理解对流-扩散过程
2. 掌握对流项和扩散项的数值处理
3. 学会分析数值稳定性
4. 理解数值耗散和数值振荡
5. 对比不同数值格式的优缺点

## 核心理论

### 1. 对流-扩散方程

**控制方程**:
```python
∂C/∂t + u * ∂C/∂x = D * ∂²C/∂x² - k*C
```

其中：
- C: 浓度 (mg/L)
- u: 流速 (m/s)
- D: 扩散系数 (m²/s)
- k: 衰减系数 (s⁻¹)

**物理意义**:
- **对流项** (u·∂C/∂x): 水流携带污染物向下游运动
- **扩散项** (D·∂²C/∂x²): 浓度梯度引起的分子扩散
- **反应项** (-k·C): 污染物降解或衰减

### 2. 无量纲数

**Peclet数** (Pe):
```python
Pe = u·L / D
```
- Pe << 1: 扩散主导
- Pe >> 1: 对流主导
- Pe ~ 1: 对流扩散平衡

**Courant数** (Cr):
```python
Cr = u·dt / dx
```
- Cr ≤ 1: 满足CFL条件（对流稳定性）

**Fourier数** (Fo):
```python
Fo = D·dt / dx²
```
- Fo ≤ 0.5: 扩散稳定性条件

### 3. 数值格式对比

#### 迎风格式（Upwind Scheme）

**对流项**: 一阶迎风差分
```python
∂C/∂x ≈ (C[i] - C[i-1]) / dx  (u > 0)
```

**优点**:
- 稳定性好
- 不产生非物理振荡

**缺点**:
- 数值耗散大（一阶精度）
- 污染带扩散过快

**稳定性条件**:
```python
Cr ≤ 1
2*Fo + Cr ≤ 1
```

#### 中心差分格式（Central Difference）

**对流项**: 中心差分
```python
∂C/∂x ≈ (C[i+1] - C[i-1]) / (2*dx)
```

**优点**:
- 二阶精度
- 无数值耗散

**缺点**:
- 容易产生非物理振荡（Pe > 2）
- 稳定性条件苛刻

**稳定性条件**:
```python
Cr ≤ 2*Fo
Pe ≤ 2  (避免振荡)
```

#### QUICK格式

**对流项**: 三点上游二次插值
```python
使用上游3个点进行二次插值
```

**优点**:
- 三阶精度
- 数值耗散小
- 接近真实物理过程

**缺点**:
- 实现复杂
- 边界处理需要特殊处理

#### Lax-Wendroff格式

**特点**: 基于Taylor展开的二阶格式

**优点**:
- 二阶时间精度
- 二阶空间精度

**缺点**:
- 可能产生弱振荡

## 计算任务

### 任务1：数值格式对比

使用4种格式求解同一问题：
1. 迎风格式
2. 中心差分格式
3. QUICK格式
4. Lax-Wendroff格式

**对比指标**:
- 峰值位置
- 峰值大小
- 污染带形状
- 数值耗散程度
- 数值振荡程度

### 任务2：稳定性分析

1. 验证迎风格式的稳定性条件（Cr ≤ 1）
2. 测试中心差分的振荡现象（Pe > 2）
3. 分析不同Courant数下的表现
4. 分析不同Peclet数下的表现

### 任务3：参数敏感性分析

分析以下参数的影响：
1. 流速 u（0.3, 0.5, 0.8 m/s）
2. 扩散系数 D（0.05, 0.1, 0.2 m²/s）
3. 衰减系数 k（0, 0.01, 0.05 s⁻¹）
4. 网格分辨率（nx = 50, 100, 200）

### 任务4：工程应用

**场景**: 上游污水厂排放，预测下游取水口浓度

**任务**:
1. 计算污染物到达取水口的时间
2. 预测取水口最大浓度
3. 计算浓度降至安全值的时间
4. 制定应急响应方案

## 使用方法

```bash
# 运行主程序
python main.py

# 运行扩展实验
python experiments.py
```

## 文件说明

- `main.py` - 主程序（4种格式对比）
- `experiments.py` - 扩展实验（稳定性、参数敏感性）
- `README.md` - 本文件

## 预期结果

### 迎风格式
- ✅ 数值稳定
- ⚠️ 峰值降低（数值耗散）
- ✅ 无振荡

### 中心差分格式
- ⚠️ 可能不稳定（Pe > 2）
- ⚠️ 产生振荡
- ✅ 精度高（无耗散）

### QUICK格式
- ✅ 精度高
- ✅ 数值耗散小
- ✅ 接近真实解

### Lax-Wendroff格式
- ✅ 二阶精度
- ⚠️ 可能有弱振荡
- ✅ 较为稳定

## 工程意义

1. **污染物追踪**: 预测污染物在河流中的迁移
2. **应急响应**: 评估污染事故的影响范围和时间
3. **取水口选址**: 避开污染带
4. **示踪实验**: 测定河流水力特性

## 关键概念

### 数值耗散（Numerical Dissipation）
- 数值格式引入的"人工"扩散
- 使污染带扩散过快、峰值降低
- 一阶格式耗散大，高阶格式耗散小

### 数值振荡（Numerical Oscillation）
- 中心差分等格式产生的非物理振荡
- 在浓度梯度大的地方出现
- 可能产生负浓度（非物理）

### CFL条件
- Courant-Friedrichs-Lewy条件
- 保证数值信息传播不超过物理信息传播
- Cr = u·dt/dx ≤ 1

## 参考资料

1. Hirsch, C. (2007). Numerical Computation of Internal and External Flows.
2. Fletcher, C. A. J. (1991). Computational Techniques for Fluid Dynamics.
3. Zheng, C., & Bennett, G. D. (2002). Applied Contaminant Transport Modeling.
4. Leonard, B. P. (1979). A stable and accurate convective modelling procedure based on quadratic upstream interpolation. Computer Methods in Applied Mechanics and Engineering, 19(1), 59-98.
