# 案例3：河流中的降解反应与参数率定

## 案例背景

某河流接纳污水处理厂尾水，初始COD浓度为50 mg/L。通过沿程监测数据，分析污染物降解规律，率定反应速率常数。

**监测数据**:
- 0 km: C = 50.0 mg/L
- 5 km: C = 38.5 mg/L
- 10 km: C = 29.6 mg/L
- 15 km: C = 22.8 mg/L
- 20 km: C = 17.5 mg/L

**水力条件**:
- 平均流速: u = 0.3 m/s
- 水温: 20°C

## 学习目标

1. 理解不同反应级数的动力学特征
2. 掌握参数率定方法（曲线拟合）
3. 学会温度校正
4. 理解半衰期的概念
5. 掌握反应-迁移耦合模型

## 核心理论

### 1. 反应动力学

#### 零阶反应
```
dC/dt = -k₀
C(t) = C₀ - k₀*t
```
**特点**: 反应速率恒定，与浓度无关

#### 一阶反应
```
dC/dt = -k₁*C
C(t) = C₀ * exp(-k₁*t)
```
**特点**: 
- 最常见的反应级数
- 半衰期恒定: t₁/₂ = ln(2)/k₁
- 常用于BOD、COD降解

#### 二阶反应
```
dC/dt = -k₂*C²
C(t) = C₀ / (1 + k₂*C₀*t)
```
**特点**: 
- 浓度高时反应快
- 浓度低时反应慢

#### Monod动力学
```
dC/dt = -k_max * C / (K_s + C)
```
**特点**:
- 低浓度时近似一阶 (C << K_s)
- 高浓度时近似零阶 (C >> K_s)
- K_s: 半饱和常数

### 2. 参数率定方法

#### 一阶反应率定（线性回归）

**方法**: 对数线性化
```
ln(C) = ln(C₀) - k₁*t
```

**步骤**:
1. 对浓度取对数
2. 线性回归 ln(C) vs t
3. 斜率 = -k₁
4. 计算R²评估拟合优度

#### 非线性最小二乘法

**目标函数**:
```
min Σ[C_obs(i) - C_model(i)]²
```

**方法**:
- Levenberg-Marquardt算法
- scipy.optimize.curve_fit

### 3. 温度校正

**Arrhenius方程简化形式**:
```
k(T) = k(20°C) * θ^(T-20)
```

**典型θ值**:
- BOD降解: θ = 1.047
- 硝化作用: θ = 1.08
- 复氧: θ = 1.024

### 4. 半衰期

**一阶反应**:
```
t₁/₂ = ln(2) / k ≈ 0.693 / k
```

**工程意义**:
- 评估污染物持久性
- 预测达标时间
- 比较不同污染物

## 计算任务

### 任务1：不同反应级数对比

模拟3种反应级数（0阶、1阶、2阶）：
1. 相同初始浓度 C₀ = 50 mg/L
2. 调整速率常数使半衰期相近
3. 对比浓度-时间曲线
4. 分析不同之处

### 任务2：一阶反应参数率定

使用监测数据拟合一阶反应速率常数：
1. 对数线性回归法
2. 计算速率常数 k
3. 计算R²
4. 计算半衰期
5. 绘制观测值vs模型值

### 任务3：温度影响分析

分析温度对反应速率的影响：
1. 计算10°C、20°C、30°C时的速率常数
2. 绘制Arrhenius曲线
3. 预测不同季节的降解情况

### 任务4：反应-迁移耦合

考虑河流中的对流-扩散-反应过程：
1. 建立耦合模型
2. 使用算子分裂方法求解
3. 预测沿程浓度分布
4. 与纯反应模型对比

## 使用方法

```bash
# 运行主程序
python main.py

# 运行扩展实验
python experiments.py
```

## 文件说明

- `main.py` - 主程序（反应动力学、参数率定）
- `experiments.py` - 扩展实验（温度影响、耦合模型）
- `README.md` - 本文件

## 预期结果

### 反应级数对比
- 零阶：线性下降
- 一阶：指数下降（最常见）
- 二阶：开始快，后续慢

### 参数率定
- k₁ ≈ 0.05-0.15 d⁻¹ (COD降解)
- R² > 0.95 (拟合优度好)
- t₁/₂ ≈ 5-15 d

### 温度影响
- 温度每升高10°C，速率约增加1.5-2倍
- 夏季降解快，冬季降解慢

## 工程意义

### 1. 环境容量计算
- 确定河段的最大纳污量
- 保证下游水质达标

### 2. 污水处理厂设计
- 计算所需停留时间
- 确定反应池容积

### 3. 应急响应
- 预测污染物自然降解时间
- 评估是否需要人工干预

### 4. 季节变化影响
- 预测冬季水质风险
- 制定分季节排放标准

## 关键概念

### 反应级数（Reaction Order）
- 反应速率与浓度的关系
- 由实验数据确定
- 影响污染物持久性

### 速率常数（Rate Constant）
- 表征反应快慢的参数
- 受温度、pH等影响
- 需要实验率定

### 半衰期（Half-Life）
- 浓度降至初始值一半的时间
- 评估污染物持久性的指标
- 一阶反应半衰期恒定

### 参数率定（Parameter Calibration）
- 用实测数据确定模型参数
- 最小二乘法
- R²评估拟合优度

## 参考资料

1. Chapra, S. C. (1997). Surface Water-Quality Modeling. McGraw-Hill.
2. Schnoor, J. L. (1996). Environmental Modeling: Fate and Transport of Pollutants in Water, Air, and Soil. Wiley.
3. EPA (1985). Rates, Constants, and Kinetics Formulations in Surface Water Quality Modeling.
4. Thomann, R. V., & Mueller, J. A. (1987). Principles of Surface Water Quality Modeling and Control. Harper & Row.
