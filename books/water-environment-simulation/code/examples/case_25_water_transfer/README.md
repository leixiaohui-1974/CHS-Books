# 案例25：跨流域调水水质风险评估

## 案例简介

本案例演示跨流域调水工程的水质风险评估方法，重点分析输水过程中的藻类生长风险和水源混合水质预测。案例采用水质传输模型（WaterTransferModel）模拟长距离输水渠道中的藻类动力学过程，分析不同光照强度下叶绿素a浓度的变化，并评估藻华暴发风险。同时通过水源混合模型预测不同水源按比例混合后的水质，为调水工程水质安全保障、藻类控制措施优化和水源配置方案制定提供科学依据。

## 理论背景

跨流域调水是解决区域水资源时空分布不均的重要工程措施，但长距离输水过程面临水质恶化风险。输水渠道通常为明渠，水体滞留时间长（数天至数周），加上充足的光照和适宜的温度，容易引发藻类大量繁殖，形成藻华。叶绿素a（Chlorophyll-a）是表征藻类生物量的关键指标，其浓度受光照、营养盐、温度等因素影响。当叶绿素a浓度超过30μg/L时，即认为发生藻华，会导致水质恶化、堵塞管道、影响供水安全。水源混合是调水工程常见的运行方式，通过调配不同水源的比例，可以在保障水量的同时优化水质。混合水质可采用加权平均法估算，但需考虑水化学反应、沉淀等复杂过程。

## 代码说明

### 主要类和函数

1. **WaterTransferModel类**
   - `__init__(channel_length, flow_rate)`: 初始化调水模型，设置渠道长度和流量
   - `simulate_algae_growth_risk(initial_Chl, light_intensity)`: 模拟藻类生长风险，返回最终叶绿素a浓度和风险等级
   - 参数：initial_Chl（初始叶绿素a浓度）、light_intensity（光照强度）

2. **assess_mixing_quality函数**
   - 评估两个水源混合后的水质
   - 参数：source1_quality（水源1水质）、source2_quality（水源2水质）、ratio（混合比例）

3. **主程序流程**
   - 创建调水模型（渠道长度100km，流量50m³/s）
   - 模拟4种光照强度（100、150、200、250 W/m²）
   - 计算对应的藻类生长和叶绿素a浓度
   - 评估藻华暴发风险
   - 计算水源混合水质
   - 生成可视化结果

### 核心算法

```python
# 藻类生长动力学（简化Monod模型）
dChl/dt = μ * Chl - m * Chl
# μ: 生长速率（与光照、营养盐相关）
# m: 死亡速率

# 水源混合水质
mixed_quality = ratio * Q1 + (1-ratio) * Q2
```

## 运行方法

```bash
# 进入案例目录
cd /home/user/CHS-Books/books/water-environment-simulation/code/examples/case_25_water_transfer

# 运行模拟
python main.py
```

## 参数说明

| 参数 | 说明 | 默认值 | 单位 |
|------|------|--------|------|
| channel_length | 输水渠道长度 | 100 | km |
| flow_rate | 流量 | 50 | m³/s |
| initial_Chl | 初始叶绿素a浓度 | 5 | μg/L |
| light_intensities | 光照强度序列 | [100, 150, 200, 250] | W/m² |
| source1_quality | 水源1水质 | 15 | mg/L |
| source2_quality | 水源2水质 | 30 | mg/L |
| ratio | 混合比例 | 0.6 | - |
| bloom_threshold | 藻华阈值 | 30 | μg/L |

## 预期结果说明

程序运行后将生成：

1. **控制台输出**
   - 案例运行状态信息
   - 藻类生长风险评估结果
   - 水源混合水质预测

2. **图表文件**（water_transfer.png）
   - 光照强度-叶绿素a浓度关系曲线
   - 藻华风险阈值线（30μg/L）
   - 风险区域标识

3. **结果特征**
   - 叶绿素a浓度随光照增强而升高
   - 高光照条件下易发生藻华
   - 需要采取遮光或化学控藻措施

## 应用场景

1. **调水工程水质保障**
   - 藻类生长风险预警
   - 输水过程水质演变
   - 水质安全评估

2. **藻类控制措施**
   - 遮光设施设计
   - 化学控藻方案
   - 生态调控策略

3. **水源配置优化**
   - 多水源混合比例优化
   - 水质目标约束下的调度
   - 应急水源切换

4. **工程规划设计**
   - 输水渠道设计（明渠/暗涵）
   - 水力停留时间控制
   - 水质监测布点

## 生态意义

调水工程对水生态系统的影响：

1. **生态风险**：藻华暴发破坏水生态平衡，影响水生生物
2. **水质保障**：控制藻类生长，保障调水水质安全
3. **生态调度**：优化调水时段和流量，减少生态影响
4. **外来物种**：防范跨流域物种入侵风险

## 参考文献

1. Reynolds, C. S. (2006). *The ecology of phytoplankton*. Cambridge University Press.

2. 逄勇, 等. (2011). 南水北调东线工程输水水质数值模拟. 《湖泊科学》, 23(1), 1-6.

3. Mitrovic, S. M., et al. (2003). Use of flow management to control cyanobacterial blooms in the Lower Darling River, Australia. *Regulated Rivers: Research & Management*, 19(5‐6), 549-563.

4. 高俊峰, 等. (2010). 长距离调水工程藻类控制技术研究进展. 《水科学进展》, 21(3), 419-426.
