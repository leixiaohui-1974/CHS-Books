# 案例26：河流生态系统模拟

## 案例简介

本案例演示河流生态系统的动力学模拟方法，通过建立食物链模型分析藻类-浮游动物-鱼类之间的营养级相互作用和能量传递过程。案例采用河流生态系统模型（RiverEcosystemModel）基于常微分方程组模拟三营养级生物量的时间演变，并计算Shannon生物多样性指数评估生态系统健康状况。模拟结果揭示了河流生态系统的动态平衡特征、种群振荡规律和生物多样性变化趋势，为河流生态修复、渔业资源管理和水生态保护提供理论依据。

## 理论背景

河流生态系统是由生产者（藻类）、消费者（浮游动物、鱼类）和分解者组成的复杂网络，各营养级通过捕食-被捕食关系紧密联系。经典的Lotka-Volterra捕食者-猎物模型描述了种群动力学的基本规律：猎物种群增长受食物和捕食压力双重制约，捕食者种群增长依赖于猎物丰度。在河流生态系统中，藻类通过光合作用固定能量，浮游动物以藻类为食，鱼类捕食浮游动物，形成三营养级食物链。能量在营养级间传递效率约为10%（林德曼效率），导致高营养级生物量远小于低营养级。生物多样性是生态系统健康的重要指标，Shannon指数综合考虑物种丰富度和均匀度，指数越高表示生态系统越稳定。

## 代码说明

### 主要类和函数

1. **RiverEcosystemModel类**
   - `__init__()`: 初始化生态系统模型，设置初始生物量和参数
   - `solve(t)`: 求解生态动力学方程组，返回时间序列和各营养级生物量
   - 基于scipy.integrate.odeint求解器

2. **calculate_biodiversity_index函数**
   - 计算Shannon生物多样性指数
   - 参数：biomass_array（各营养级生物量数组）
   - 公式：H = -Σ(p_i * ln(p_i))，p_i为第i种的相对丰度

3. **主程序流程**
   - 创建生态系统模型
   - 设置模拟时间（0-100天，500个时间步）
   - 求解微分方程组
   - 计算生物多样性指数
   - 绘制三营养级生物量时间序列
   - 生成可视化结果

### 核心算法

```python
# 三营养级Lotka-Volterra方程组
dA/dt = r*A - a*A*Z - m_A*A         # 藻类
dZ/dt = b*a*A*Z - c*Z*F - m_Z*Z     # 浮游动物
dF/dt = d*c*Z*F - m_F*F             # 鱼类

# Shannon多样性指数
H = -Σ(p_i * log(p_i))
```

## 运行方法

```bash
# 进入案例目录
cd /home/user/CHS-Books/books/water-environment-simulation/code/examples/case_26_river_ecosystem

# 运行模拟
python main.py
```

## 参数说明

| 参数 | 说明 | 默认值 | 单位 |
|------|------|--------|------|
| t | 模拟时间 | 0-100 | 天 |
| n_steps | 时间步数 | 500 | - |
| r | 藻类生长速率 | 0.5 | /天 |
| a | 浮游动物捕食系数 | 0.02 | - |
| b | 浮游动物转化效率 | 0.1 | - |
| c | 鱼类捕食系数 | 0.01 | - |
| d | 鱼类转化效率 | 0.1 | - |
| m_A, m_Z, m_F | 各营养级死亡率 | 0.1, 0.05, 0.02 | /天 |

## 预期结果说明

程序运行后将生成：

1. **控制台输出**
   - 案例运行状态信息
   - Shannon生物多样性指数

2. **图表文件**（river_ecosystem.png）
   - 三条曲线：藻类（绿色）、浮游动物（蓝色）、鱼类（红色）
   - 展示生物量随时间的动态变化

3. **结果特征**
   - 各营养级生物量呈周期性振荡
   - 捕食者-猎物存在相位差
   - 最终趋向动态平衡状态

## 应用场景

1. **河流生态修复**
   - 生态系统健康评估
   - 生物群落结构优化
   - 食物网完整性分析

2. **渔业资源管理**
   - 鱼类资源量预测
   - 可持续捕捞配额
   - 增殖放流效果评估

3. **水生态保护**
   - 生物多样性监测
   - 关键物种保护
   - 外来物种入侵风险

4. **水质-生态关系研究**
   - 营养盐对藻类的影响
   - 底栖生物群落响应
   - 生态系统服务功能

## 生态意义

河流生态系统模拟的重要意义：

1. **生态平衡**：揭示营养级相互作用和能量流动规律
2. **生物多样性**：评估生态系统稳定性和抗干扰能力
3. **生态修复**：为河流生态修复工程提供理论指导
4. **可持续管理**：实现水资源利用与生态保护的平衡

## 参考文献

1. Jørgensen, S. E., & Fath, B. D. (2011). *Fundamentals of ecological modelling* (4th ed.). Elsevier.

2. Petts, G. E., & Amoros, C. (Eds.). (1996). *Fluvial hydrosystems*. Springer.

3. Shannon, C. E. (1948). A mathematical theory of communication. *Bell System Technical Journal*, 27(3), 379-423.

4. 崔保山, 等. (2009). 河流生态系统健康评价方法. 《生态学报》, 29(6), 3019-3027.
