# 案例8：单元线法河道汇流

## 📖 案例背景

单元线（Unit Hydrograph）是水文学中最经典的河道汇流方法之一，广泛应用于洪水预报、设计洪水计算等领域。本案例系统介绍单元线理论及其工程应用。

## 🎯 学习目标

1. 理解单元线的基本概念和原理
2. 掌握三种经典单元线的构建方法
3. 学会单元线的卷积计算
4. 理解Muskingum河道演进方法
5. 掌握单元线参数的确定方法
6. 学会对比不同汇流方法

## 📊 数据说明

**流域特征**:
- 流域面积: 50-500 km²
- 主河道长度: 10-50 km
- 汇流时间: 3-12 h

**水文数据**:
- 净雨过程
- 实测流量（用于验证）
- 流域地理参数

## 🔬 理论基础

### 1. 单元线定义

单元线是指**单位时段**内**单位净雨**（通常为1mm或1cm）在流域出口产生的**地表径流过程线**。

**三大基本假定**:
1. **线性叠加原理**: 不同净雨产生的径流可线性叠加
2. **时段不变性**: 相同时段的单位净雨产生相同的单元线
3. **比例性**: 净雨深度加倍，单元线纵坐标加倍

### 2. 单元线卷积

**基本公式**:
```python
Q(t) = Σ[R(i) × UH(t-i)]
```

其中：
- Q(t): t时刻的流量 (m³/s)
- R(i): i时刻的净雨深度 (mm)
- UH(t-i): 滞后(t-i)的单元线纵坐标 (m³/s/mm)

### 3. Snyder综合单元线

**适用条件**: 缺乏实测资料的流域

**基本公式**:
```python
tp = Ct × (L × Lc)^0.3
Qp = Cp × A / tp
tb = 3 + tp/8
```

其中：
- tp: 峰现时间 (h)
- Qp: 峰值流量 (m³/s/mm/km²)
- tb: 基流时间 (h)
- L: 主河道长度 (km)
- Lc: 流域重心到出口距离 (km)
- A: 流域面积 (km²)
- Ct, Cp: 地区经验系数

**参数范围**:
- Ct: 1.8-2.2（一般取2.0）
- Cp: 0.4-0.8（一般取0.6）

### 4. SCS无量纲单元线

**特点**: 形状固定，只需流域面积和汇流时间

**基本公式**:
```python
Tp = 0.6 × Tc
Qp = 0.208 × A / Tp
tb = 2.67 × Tp
```

**优点**:
- 参数少
- 易于应用
- 标准化程度高

### 5. Muskingum河道演进

**基本方程**:
```python
S = K[X×I + (1-X)×Q]
Q(t+Δt) = C0×I(t+Δt) + C1×I(t) + C2×Q(t)
```

**参数意义**:
- K: 传播时间 (h)
- X: 蓄量比重系数 (0-0.5)
  - X=0: 水库型
  - X=0.25: 典型河道
  - X=0.5: 纯楔形蓄水

## 🚀 快速开始

### 运行案例

```bash
python main.py
```python

### 查看结果

```bash
ls outputs/
# snyder_uh.png - Snyder单元线
# scs_uh.png - SCS单元线
# uh_comparison.png - 单元线对比
# convolution_demo.png - 卷积演示
# muskingum_routing.png - Muskingum演进
```matlab

## 📈 实验内容

### 实验1：三种单元线对比
对比三角形、Snyder、SCS单元线的形状和特征

### 实验2：单元线卷积计算
演示净雨与单元线的卷积过程

### 实验3：流域特征影响
分析流域面积、河长对单元线的影响

### 实验4：Muskingum河道演进
演示河道对洪水的调蓄作用

### 实验5：完整产汇流过程
从降雨到出口流量的完整模拟

## 💡 方法特点

### 单元线法

**优点**:
✅ 物理概念清晰  
✅ 计算简单快速  
✅ 适用范围广  
✅ 便于工程应用  
✅ 可综合推求

**缺点**:
⚠️ 假设线性  
⚠️ 忽略基流  
⚠️ 需要历史资料  
⚠️ 对大洪水可能误差大

**适用条件**:
- 中小流域（<5000 km²）
- 有一定实测资料
- 或可综合推求参数
- 流域特征相对均一

### Muskingum法

**优点**:
✅ 考虑河道蓄泄  
✅ 削峰作用明显  
✅ 参数物理意义清晰  
✅ 计算稳定

**缺点**:
⚠️ 需要率定参数  
⚠️ 假设简化较多  
⚠️ 对参数敏感

## 🔧 参数确定

### 单元线参数

**1. 从实测资料推求**:
- 选择典型场次
- 分离净雨和基流
- 反求单元线
- 多场次平均

**2. 综合推求**:
- Snyder公式
- SCS方法
- 经验公式

**3. 地区综合**:
- 收集相似流域资料
- 建立区域关系
- 参数移植

### Muskingum参数

**K值确定**:
- 实测：根据洪峰滞时
- 估算：K ≈ L/v（河长/流速）
- 一般：K = 6-24 h

**X值确定**:
- 实测：优化率定
- 经验：0.2-0.3（天然河道）
- 范围：0-0.5

## 📊 预期结果

### 典型流域（A=100km², L=20km）

**Snyder单元线**:
- 峰现时间: 约8h
- 峰值流量: 约0.6 m³/s/mm/km²
- 基流时间: 约20h

**SCS单元线**:
- 峰现时间: 约6h  
- 峰值流量: 约0.7 m³/s/mm/km²
- 基流时间: 约16h

**卷积结果**（10mm净雨）:
- 峰值流量: 约600 m³/s
- 峰现时间: 约8-10h
- 总径流量: 1,000,000 m³

### Muskingum演进

**削峰效果**（K=6h, X=0.25）:
- 削峰率: 15-25%
- 滞时: 2-4h
- 洪峰展宽

## 🎨 可视化说明

### 图1：单元线对比
- 三种单元线形状
- 峰值和峰现时间
- 基流时间对比

### 图2：卷积演示
- 净雨过程
- 单元线
- 卷积结果（流量过程）

### 图3：参数影响
- 流域面积影响
- 河道长度影响
- 汇流时间影响

### 图4：Muskingum演进
- 入流vs出流
- 削峰滞后效果
- 蓄量变化

### 图5：完整模拟
- 降雨→产流→汇流全过程

## 📚 参考文献

1. Sherman, L.K. (1932). Stream flow from rainfall by the unit-graph method. Engineering News Record, 108, 501-505.

2. Snyder, F.F. (1938). Synthetic unit-graphs. Transactions, American Geophysical Union, 19, 447-454.

3. USDA-SCS (1972). National Engineering Handbook, Section 4: Hydrology.

4. McCarthy, G.T. (1938). The unit hydrograph and flood routing. Proceedings of Conference of North Atlantic Division, U.S. Army Corps of Engineers.

5. 芮孝芳. 水文学原理. 中国水利水电出版社, 2004.

## 💡 工程应用提示

### 1. 设计洪水计算

**应用流程**:
```
设计降雨
  ↓
设计净雨（扣除损失）
  ↓
单元线卷积
  ↓
河道演进
  ↓
设计洪水过程
```

### 2. 洪水预报

**实时预报**:
- 实测降雨→预报净雨
- 单元线快速计算
- 河道演进校正
- 发布预报

**超前时间**: 通常等于汇流时间

### 3. 参数率定

**率定步骤**:
1. 收集历史洪水资料
2. 分离净雨和基流
3. 反求单元线
4. 多场次验证
5. 确定代表性单元线

### 4. 模型改进

**可能的改进**:
- 考虑非线性
- 耦合分布式产流
- 多级河道串联
- 考虑水库调节

## 🔗 相关案例

- 案例4: 新安江模型产流计算（产流部分）
- 案例5: Green-Ampt超渗产流（产流部分）
- 案例7: 坡面运动波汇流（坡面汇流）
- 案例10: Muskingum-Cunge方法（高级河道演进）

## 🎓 扩展学习

### 进阶主题

1. **瞬时单元线（IUH）**
   - 理论更严格
   - 可处理任意时段
   - 与单元线的关系

2. **时变增益模型（TVG）**
   - 考虑非线性
   - 流量相关的参数
   - 更精确

3. **分布式单元线**
   - 网格化方法
   - 地形单元线理论
   - GIS集成

4. **地貌瞬时单元线（GIUH）**
   - 基于流域地貌
   - 理论推导
   - 无资料地区应用

### 软件工具

1. HEC-HMS（美国陆军工程师团）
2. SWMM（城市雨洪模型）
3. MIKE系列（丹麦DHI）
4. SWAT（流域模型）

---

**难度**: ⭐⭐  
**所需时间**: 2-3小时  
**前置知识**: Python基础、水文学基础

---

*提示：单元线法是洪水预报的基础方法！*
