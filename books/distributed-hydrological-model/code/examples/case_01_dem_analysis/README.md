# æ¡ˆä¾‹1ï¼šDEMåˆ†æä¸æ²³ç½‘æå–

**éš¾åº¦ç­‰çº§**: â­  
**é¢„è®¡å­¦ä¹ æ—¶é—´**: 2å°æ—¶  
**å‰ç½®çŸ¥è¯†**: åŸºç¡€Pythonå’ŒNumPy

---

## ğŸ“‹ æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ¡ˆä¾‹æ¼”ç¤ºå¦‚ä½•è¿›è¡Œ**DEMï¼ˆæ•°å­—é«˜ç¨‹æ¨¡å‹ï¼‰åˆ†æ**å’Œ**æ²³ç½‘æå–**ï¼Œæ˜¯åˆ†å¸ƒå¼æ°´æ–‡å»ºæ¨¡çš„åŸºç¡€ã€‚

### å­¦ä¹ ç›®æ ‡

- ç†è§£DEMçš„æ¦‚å¿µå’Œåº”ç”¨
- æŒæ¡åœ°å½¢åˆ†ææ–¹æ³•ï¼ˆå¡åº¦ã€å¡å‘ï¼‰
- å­¦ä¼šD8æµå‘ç®—æ³•
- ç†è§£æ±‡æµç´¯ç§¯è®¡ç®—
- æŒæ¡æ²³ç½‘æå–æ–¹æ³•
- è¯†åˆ«æµåŸŸå‡ºå£

### æ¡ˆä¾‹ç‰¹è‰²

âœ¨ **çº¯NumPyå®ç°**ï¼šä¸ä¾èµ–GDALç­‰å¤æ‚GISåº“  
âœ¨ **å®Œæ•´æµç¨‹**ï¼šä»DEMåˆ°æ²³ç½‘çš„å…¨è¿‡ç¨‹  
âœ¨ **å¯è§†åŒ–ä¸°å¯Œ**ï¼š5ç§ä¸“ä¸šåœ°å½¢å›¾è¡¨  
âœ¨ **ç®—æ³•æ¸…æ™°**ï¼šD8æµå‘å’Œæ±‡æµç´¯ç§¯è¯¦è§£

---

## ğŸ¯ æ ¸å¿ƒå†…å®¹

### 1. DEMåŸºç¡€

**ä»€ä¹ˆæ˜¯DEMï¼Ÿ**

æ•°å­—é«˜ç¨‹æ¨¡å‹ï¼ˆDigital Elevation Modelï¼‰æ˜¯åœ°è¡¨é«˜ç¨‹çš„æ•°å­—åŒ–è¡¨ç¤ºï¼Œé€šå¸¸ä¸ºè§„åˆ™ç½‘æ ¼æ ¼å¼ã€‚

**DEMæ•°æ®ç»“æ„**ï¼š
```
é«˜ç¨‹çŸ©é˜µ(m):
  100  95  90  85  80
   98  93  88  83  78
   96  91  86  81  76
   94  89  84  79  74
   92  87  82  77  72
```

**DEMåº”ç”¨**ï¼š
- åœ°å½¢åˆ†æï¼ˆå¡åº¦ã€å¡å‘ã€æ›²ç‡ï¼‰
- æµåŸŸåˆ’åˆ†
- æ²³ç½‘æå–
- æ±‡æµè·¯å¾„
- åœ°å½¢æŒ‡æ•°è®¡ç®—

### 2. åœ°å½¢åˆ†æ

**å¡åº¦ï¼ˆSlopeï¼‰**ï¼š
```
å¡åº¦ = arctan(âˆš(dz/dx)Â² + (dz/dy)Â²) Ã— 180/Ï€
```

**å¡å‘ï¼ˆAspectï¼‰**ï¼š
```
å¡å‘ = (90 - arctan2(-dy, dx) Ã— 180/Ï€) % 360
```
- 0Â° = åŒ—
- 90Â° = ä¸œ
- 180Â° = å—
- 270Â° = è¥¿

### 3. D8æµå‘ç®—æ³•

**åŸç†**ï¼šæ°´æµå‘8ä¸ªé‚»è¿‘ç½‘æ ¼ä¸­å¡é™æœ€å¤§çš„æ–¹å‘ã€‚

**8ä¸ªæ–¹å‘ç¼–ç **ï¼š
```
32  64  128
16  *   1
8   4   2
```

**ç®—æ³•æ­¥éª¤**ï¼š
1. å¯¹æ¯ä¸ªç½‘æ ¼
2. è®¡ç®—åˆ°8ä¸ªé‚»æ ¼çš„å¡é™
3. é€‰æ‹©å¡é™æœ€å¤§çš„æ–¹å‘
4. èµ‹äºˆç›¸åº”ç¼–ç 

### 4. æ±‡æµç´¯ç§¯

**å®šä¹‰**ï¼šæµå…¥æŸç½‘æ ¼çš„ä¸Šæ¸¸ç½‘æ ¼æ€»æ•°ã€‚

**è®¡ç®—æ–¹æ³•ï¼ˆé€’å½’ï¼‰**ï¼š
```python
æ±‡æµç´¯ç§¯[i,j] = 1 + Î£(æ‰€æœ‰æµå‘[i,j]çš„ä¸Šæ¸¸ç½‘æ ¼çš„æ±‡æµç´¯ç§¯)
```

**ç‰©ç†æ„ä¹‰**ï¼š
- åæ˜ æ±‡æ°´é¢ç§¯
- è¯†åˆ«æ²³é“ä½ç½®
- ä¼°ç®—æµé‡å¤§å°

### 5. æ²³ç½‘æå–

**æ–¹æ³•**ï¼šè®¾å®šæ±‡æµç´¯ç§¯é˜ˆå€¼
```python
æ²³ç½‘ = æ±‡æµç´¯ç§¯ >= é˜ˆå€¼
```

**é˜ˆå€¼é€‰æ‹©**ï¼š
- å¤ªå°ï¼šæ²³ç½‘è¿‡å¯†
- å¤ªå¤§ï¼šæ²³ç½‘è¿‡ç–
- ç»éªŒå€¼ï¼šæ ¹æ®æµåŸŸå¤§å°è°ƒæ•´

---

## ğŸ’» ä»£ç å®ç°

### 1. ç”ŸæˆåˆæˆDEM

```python
def generate_synthetic_dem(nx=50, ny=50):
    """ç”ŸæˆåˆæˆDEM"""
    x = np.linspace(0, 1, nx)
    y = np.linspace(0, 1, ny)
    X, Y = np.meshgrid(x, y)
    
    # ä¸»è¶‹åŠ¿ï¼šä»é«˜åˆ°ä½
    trend = 100 * (1 - 0.7*X - 0.3*Y)
    
    # æ·»åŠ å±±è„Šå’Œå±±è°·
    ridges = 20 * np.sin(3 * np.pi * X) * np.sin(2 * np.pi * Y)
    
    # æ·»åŠ å™ªå£°
    noise = 5 * np.random.randn(ny, nx)
    
    dem = trend + ridges + noise
    return np.maximum(dem, 0)
```

### 2. D8æµå‘

```python
def d8_flow_direction(dem):
    """D8æµå‘ç®—æ³•"""
    # 8ä¸ªæ–¹å‘
    directions = [
        (0, 1, 1),    # ä¸œ
        (1, 1, 2),    # ä¸œå—
        (1, 0, 4),    # å—
        (1, -1, 8),   # è¥¿å—
        (0, -1, 16),  # è¥¿
        (-1, -1, 32), # è¥¿åŒ—
        (-1, 0, 64),  # åŒ—
        (-1, 1, 128)  # ä¸œåŒ—
    ]
    
    flow_dir = np.zeros_like(dem, dtype=int)
    
    for i in range(1, ny-1):
        for j in range(1, nx-1):
            max_slope = -np.inf
            max_dir = 0
            
            for di, dj, code in directions:
                ni, nj = i + di, j + dj
                distance = np.sqrt(di**2 + dj**2)
                slope = (dem[i,j] - dem[ni,nj]) / distance
                
                if slope > max_slope:
                    max_slope = slope
                    max_dir = code
            
            flow_dir[i,j] = max_dir if max_slope > 0 else 0
    
    return flow_dir
```

### 3. æ±‡æµç´¯ç§¯ï¼ˆé€’å½’ï¼‰

```python
def flow_accumulation(flow_dir):
    """æ±‡æµç´¯ç§¯è®¡ç®—"""
    ny, nx = flow_dir.shape
    flow_acc = np.ones((ny, nx), dtype=int)
    visited = np.zeros((ny, nx), dtype=bool)
    
    def accumulate(i, j):
        if visited[i, j]:
            return flow_acc[i, j]
        
        visited[i, j] = True
        total = 1
        
        # æŸ¥æ‰¾æ‰€æœ‰æµå‘å½“å‰ç½‘æ ¼çš„ä¸Šæ¸¸
        for di, dj, code in directions:
            ni, nj = i - di, j - dj
            if 0 <= ni < ny and 0 <= nj < nx:
                if flow_dir[ni, nj] == code:
                    total += accumulate(ni, nj)
        
        flow_acc[i, j] = total
        return total
    
    for i in range(ny):
        for j in range(nx):
            accumulate(i, j)
    
    return flow_acc
```

---

## ğŸ“Š å®éªŒç»“æœ

### åœ°å½¢ç‰¹å¾
- æµåŸŸé¢ç§¯ï¼š0.250 kmÂ²
- é«˜ç¨‹èŒƒå›´ï¼š0 - 114 m
- å¹³å‡å¡åº¦ï¼š25Â°
- æœ€å¤§å¡åº¦ï¼š63Â°

### æ°´ç³»ç‰¹å¾
- æ²³ç½‘å¯†åº¦ï¼š0.68%
- æ²³ç½‘é•¿åº¦ï¼š0.17 km
- æå–é˜ˆå€¼ï¼š20ä¸ªç½‘æ ¼

---

## ğŸ¨ å¯è§†åŒ–è¯´æ˜

### 1. DEMå›¾
- é¢œè‰²ï¼šç»¿ï¼ˆä½ï¼‰â†’é»„â†’æ©™â†’è¤ï¼ˆé«˜ï¼‰
- ç­‰é«˜çº¿ï¼šé»‘è‰²ç»†çº¿
- ç»Ÿè®¡ä¿¡æ¯æ¡†

### 2. å¡åº¦å¡å‘å›¾
- å·¦ï¼šå¡åº¦ï¼ˆé»„â†’æ©™â†’çº¢ï¼‰
- å³ï¼šå¡å‘ï¼ˆHSVè‰²è½®ï¼‰

### 3. æµå‘å›¾
- èƒŒæ™¯ï¼šDEM
- ç®­å¤´ï¼šè“è‰²ï¼ŒæŒ‡å‘ä¸‹æ¸¸

### 4. æ±‡æµç´¯ç§¯å›¾
- é¢œè‰²ï¼šç™½â†’è“ï¼ˆlogå°ºåº¦ï¼‰
- æ·±è‰²ï¼šæ±‡æµå¤§

### 5. æ²³ç½‘å›¾
- èƒŒæ™¯ï¼šDEM
- æ²³ç½‘ï¼šè“è‰²
- å‡ºå£ï¼šçº¢è‰²æ˜Ÿå·

---

## ğŸ’¡ å·¥ç¨‹åº”ç”¨

### 1. æµåŸŸåˆ’åˆ†

åŸºäºDEMå’Œæ²³ç½‘ï¼Œå¯ä»¥ï¼š
- åˆ’åˆ†å­æµåŸŸ
- è®¡ç®—æµåŸŸé¢ç§¯
- ç¡®å®šæ±‡æµè·¯å¾„

### 2. æ°´æ–‡æ¨¡æ‹Ÿ

DEMåˆ†æä¸ºæ°´æ–‡æ¨¡å‹æä¾›ï¼š
- ç©ºé—´ç¦»æ•£åŒ–åŸºç¡€
- åœ°å½¢å‚æ•°ï¼ˆå¡åº¦ã€å¡é•¿ï¼‰
- æ²³ç½‘ç»“æ„

### 3. æ´ªæ°´åˆ†æ

- æ·¹æ²¡åˆ†æ
- æ´ªæ°´æ¼”è¿›è·¯å¾„
- é£é™©åŒºè¯†åˆ«

---

## ğŸ“ ç»ƒä¹ é¢˜

### åŸºç¡€ç»ƒä¹ 
1. ä¿®æ”¹DEMå¤§å°ï¼ˆnx=100, ny=100ï¼‰
2. è°ƒæ•´æ²³ç½‘é˜ˆå€¼ï¼ˆ10, 30, 50ï¼‰
3. è®¡ç®—ä¸åŒé˜ˆå€¼ä¸‹çš„æ²³ç½‘å¯†åº¦

### è¿›é˜¶ç»ƒä¹ 
1. å®ç°Dinfæµå‘ç®—æ³•ï¼ˆå¤šæµå‘ï¼‰
2. æ·»åŠ å¡«æ´¼ç®—æ³•
3. è®¡ç®—åœ°å½¢æ¹¿åº¦æŒ‡æ•°ï¼ˆTWIï¼‰

### æŒ‘æˆ˜ç»ƒä¹ 
1. è¯»å–çœŸå®DEMæ•°æ®ï¼ˆGeoTIFFæ ¼å¼ï¼‰
2. å®ç°æµåŸŸè‡ªåŠ¨åˆ’åˆ†
3. è®¡ç®—æ²³é“çºµå‰–é¢

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸ç”¨GDALï¼Ÿ

**A**: æœ¬æ¡ˆä¾‹ç”¨çº¯NumPyå®ç°ï¼Œä¾¿äºï¼š
- ç†è§£ç®—æ³•åŸç†
- é™ä½ä¾èµ–å¤æ‚åº¦
- é€‚åˆæ•™å­¦æ¼”ç¤º

å®é™…å·¥ç¨‹å¯ä½¿ç”¨GDALã€WhiteboxToolsç­‰ä¸“ä¸šå·¥å…·ã€‚

### Q2: D8æµå‘æœ‰ä»€ä¹ˆå±€é™ï¼Ÿ

**A**: å±€é™æ€§ï¼š
- åªæœ‰8ä¸ªæ–¹å‘ï¼ˆ45Â°é—´éš”ï¼‰
- å•æµå‘å‡è®¾
- å¹³å¦åŒºåŸŸå¤„ç†å›°éš¾

æ”¹è¿›æ–¹æ³•ï¼š
- Dinfï¼ˆå¤šæµå‘ï¼‰
- D-infinity
- MFDï¼ˆå¤šæµå‘åˆ†é…ï¼‰

### Q3: å¦‚ä½•é€‰æ‹©æ²³ç½‘é˜ˆå€¼ï¼Ÿ

**A**: é€‰æ‹©æ–¹æ³•ï¼š
- ç»éªŒå€¼ï¼šæ ¹æ®æµåŸŸå¤§å°
- å®åœ°éªŒè¯ï¼šå¯¹æ¯”å®é™…æ²³ç½‘
- å¤šå°ºåº¦åˆ†æï¼šä¸åŒé˜ˆå€¼å¯¹æ¯”
- ç»Ÿè®¡æ–¹æ³•ï¼šå¡åº¦-é¢ç§¯åˆ†æ

### Q4: æ±‡æµç´¯ç§¯å•ä½æ˜¯ä»€ä¹ˆï¼Ÿ

**A**: ç½‘æ ¼æ•°ï¼ˆä¸ªï¼‰

æ¢ç®—ä¸ºé¢ç§¯ï¼š
```
æ±‡æ°´é¢ç§¯ = æ±‡æµç´¯ç§¯ Ã— ç½‘æ ¼é¢ç§¯
         = flow_acc Ã— dx Ã— dy
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç»å…¸æ•™æ
1. **ã€Šåœ°ç†ä¿¡æ¯ç³»ç»Ÿå¯¼è®ºã€‹** - Kang-tsung Chang
2. **ã€Šæ°´æ–‡å­¦ã€‹** - èŠ®å­èŠ³

### è®ºæ–‡
1. O'Callaghan, J. F., & Mark, D. M. (1984). "The extraction of drainage networks from digital elevation data." *Computer Vision, Graphics, and Image Processing*, 28(3), 323-344.

2. Tarboton, D. G. (1997). "A new method for the determination of flow directions and upslope areas in grid digital elevation models." *Water Resources Research*, 33(2), 309-319.

### è½¯ä»¶å·¥å…·
- **WhiteboxTools** - å¼€æºåœ°å½¢åˆ†æ
- **GRASS GIS** - å¼ºå¤§çš„GISå¹³å°
- **TauDEM** - åœ°å½¢åˆ†æå·¥å…·
- **RichDEM** - Pythonåœ°å½¢åº“

---

## âœ… å­¦ä¹ æ£€æŸ¥æ¸…å•

- [ ] ç†è§£DEMçš„æ¦‚å¿µå’Œæ•°æ®ç»“æ„
- [ ] æŒæ¡å¡åº¦å’Œå¡å‘è®¡ç®—
- [ ] ç†è§£D8æµå‘ç®—æ³•åŸç†
- [ ] æŒæ¡æ±‡æµç´¯ç§¯è®¡ç®—æ–¹æ³•
- [ ] ç†è§£æ²³ç½‘æå–æµç¨‹
- [ ] èƒ½å¤Ÿè¿è¡Œå¹¶ä¿®æ”¹ä»£ç 
- [ ] èƒ½å¤Ÿè§£è¯»åœ°å½¢å›¾è¡¨
- [ ] ç†è§£ç®—æ³•çš„å±€é™æ€§
- [ ] äº†è§£å®é™…åº”ç”¨åœºæ™¯
- [ ] èƒ½å¤Ÿè¿›è¡Œå‚æ•°è°ƒæ•´

---

**æ¡ˆä¾‹1å®Œæˆï¼** ğŸ‰

ä¸‹ä¸€æ­¥ï¼šæ¡ˆä¾‹2 - Thiessenå¤šè¾¹å½¢

---

**ä½œè€…**: CHS-Booksé¡¹ç›®ç»„  
**æ—¥æœŸ**: 2025-11-02  
**ç‰ˆæœ¬**: v1.0
