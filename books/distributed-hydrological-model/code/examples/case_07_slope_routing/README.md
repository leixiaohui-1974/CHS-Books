# 案例7：坡面运动波汇流

## 📖 案例背景

坡面汇流是降雨径流形成的重要环节，是连接产流和河道汇流的桥梁。本案例通过运动波理论和线性水库模型，演示不同坡面汇流方法的原理和应用。

## 🎯 学习目标

1. 理解坡面汇流的物理过程
2. 掌握运动波理论的基本原理
3. 学会线性水库模型的应用
4. 理解纳什瀑布模型的特点
5. 掌握汇流时间的估算方法
6. 学会对比不同汇流方法

## 📊 数据说明

**坡面特征**:
- 长度: 50-200 m
- 宽度: 20-100 m
- 坡度: 0.5%-5%
- 糙率: 0.05-0.30

**降雨输入**:
- 净雨过程（产流后）
- 历时: 30-120分钟
- 强度: 10-50 mm/h

## 🔬 理论基础

### 1. 运动波理论

**控制方程**:

**连续性方程**:
```
∂h/∂t + ∂q/∂x = r(x,t)
```

**运动波简化**:
```
q = α × h^m
```

**Manning公式关系**:
```
α = (1/n) × S^0.5
m = 5/3
```

其中：
- h: 水深 (m)
- q: 单宽流量 (m²/s)
- r: 净雨强度 (m/s)
- n: 曼宁糙率
- S: 坡度

### 2. 线性水库模型

**基本方程**:
```
S(t) = K × Q(t)
K × dQ/dt + Q = I(t)
```

**解析解**:
```
Q(t+Δt) = C1×I(t) + C2×Q(t)
C1 = Δt/(K + 0.5×Δt)
C2 = (K - 0.5×Δt)/(K + 0.5×Δt)
```

其中：
- K: 调蓄系数 (s)
- Q: 出流量 (m³/s)
- I: 入流量 (m³/s)

### 3. 纳什瀑布模型

**特点**:
- n个相同线性水库串联
- 每个水库调蓄系数相同

**汇流时间**:
```
tc ≈ n × K
```

### 4. 汇流时间估算

**运动波近似公式**:
```
tc = [(L × n) / S^0.5]^0.6 / 0.6
```

**经验公式（克尔皮奇）**:
```
tc = 0.0195 × L^0.77 × S^(-0.385)
```

## 🚀 快速开始

### 运行案例

```bash
python main.py
```

### 查看结果

```bash
ls outputs/
# kinematic_wave_process.png - 运动波汇流过程
# linear_reservoir_comparison.png - 线性水库对比
# nash_cascade_effect.png - 纳什瀑布效果
# method_comparison.png - 方法对比
# sensitivity_analysis.png - 参数敏感性
```

## 📈 实验内容

### 实验1：运动波汇流过程
演示运动波在坡面上的传播过程

### 实验2：线性水库参数影响
分析调蓄系数K对汇流过程的影响

### 实验3：纳什瀑布串联效果
对比不同水库数量(n)的影响

### 实验4：不同方法对比
对比运动波、线性水库、纳什瀑布三种方法

### 实验5：坡面参数敏感性
分析坡度、长度、糙率的影响

## 💡 模型特点

### 运动波法

**优点**:
✅ 物理意义明确  
✅ 考虑空间分布  
✅ 可模拟水深演进  
✅ 理论基础扎实

**缺点**:
⚠️ 计算复杂  
⚠️ 需要空间离散  
⚠️ 对时间步长敏感  
⚠️ 可能数值不稳定

**适用场景**:
- 详细研究
- 长坡面
- 复杂地形
- 科研应用

### 线性水库法

**优点**:
✅ 计算简单快速  
✅ 参数物理意义清晰  
✅ 数值稳定性好  
✅ 易于率定

**缺点**:
⚠️ 集总式概念  
⚠️ 不考虑空间分布  
⚠️ 精度相对较低

**适用场景**:
- 实时预报
- 小流域
- 概念性模型
- 工程应用

### 纳什瀑布法

**优点**:
✅ 调蓄效果好  
✅ 过程线更真实  
✅ 峰现时间可控  
✅ 参数有物理意义

**缺点**:
⚠️ 参数较多(n, K)  
⚠️ 概念性模型  
⚠️ 率定复杂度增加

**适用场景**:
- 中等流域
- 需要调蓄效果
- 洪水预报
- 概念性建模

## 🔧 模型参数

### 运动波参数

**曼宁糙率 (n)**:

| 地表类型 | 糙率系数n |
|---------|----------|
| 光滑混凝土 | 0.01-0.013 |
| 草地 | 0.10-0.20 |
| 农田 | 0.15-0.25 |
| 灌木林 | 0.20-0.30 |
| 森林 | 0.30-0.40 |

**空间步长 (dx)**:
- 推荐: L/10 到 L/20
- 太大: 精度下降
- 太小: 计算量增加

**时间步长 (dt)**:
- 需满足Courant条件
- C = v×dt/dx < 1
- 推荐: C < 0.5

### 线性水库参数

**调蓄系数 (K)**:

估算方法1（根据汇流时间）:
```
K = tc / (1~3)
```

估算方法2（根据坡面特征）:
```
K ≈ L / (3.6 × v)
v ≈ (1/n) × S^0.5 × h^(2/3)
```

典型值:
- 小坡面(L<100m): K = 300-600 s
- 中坡面(100-200m): K = 600-1200 s
- 大坡面(L>200m): K = 1200-2400 s

### 纳什瀑布参数

**水库个数 (n)**:
- n=1: 线性水库
- n=2-3: 轻度调蓄
- n=4-5: 中度调蓄
- n>5: 强烈调蓄

**调蓄系数 (K)**:
```
K = tc / n
```

## 📊 预期结果

### 典型坡面（L=100m, S=2%, n=0.15）

**运动波法**:
- 汇流时间: 约8-10分钟
- 峰值流量: 0.15-0.20 m³/s
- 峰现时间: 约15分钟

**线性水库法 (K=600s)**:
- 峰值流量: 0.12-0.15 m³/s
- 峰现时间: 约18分钟
- 调蓄作用明显

**纳什瀑布 (n=3, K=200s)**:
- 峰值流量: 0.10-0.13 m³/s
- 峰现时间: 约20分钟
- 调蓄作用最强

### 方法对比

| 方法 | 峰值流量 | 峰现时间 | 计算时间 |
|------|---------|---------|---------|
| 运动波 | 最大 | 最早 | 最长 |
| 线性水库 | 中等 | 中等 | 最短 |
| 纳什瀑布 | 最小 | 最晚 | 短 |

## 🎨 可视化说明

### 图1：运动波过程
- 上图: 水深空间分布演进
- 下图: 出口流量过程线

### 图2：线性水库对比
- 不同K值的出流过程
- 参数影响分析

### 图3：纳什瀑布效果
- 不同n值的对比
- 各级水库出流

### 图4：方法对比
- 三种方法并排对比
- 统计指标对比

### 图5：参数敏感性
- 坡度影响
- 长度影响
- 糙率影响

## 📚 参考文献

1. Woolhiser, D.A., & Liggett, J.A. (1967). Unsteady, one-dimensional flow over a plane. Water Resources Research, 3(3), 753-771.

2. Nash, J.E. (1957). The form of the instantaneous unit hydrograph. IAHS Publ., 45(3), 114-121.

3. Lighthill, M.J., & Whitham, G.B. (1955). On kinematic waves. Proceedings of the Royal Society A, 229(1178), 281-316.

4. Chow, V.T., et al. (1988). Applied Hydrology. McGraw-Hill.

5. 芮孝芳. 水文学原理. 中国水利水电出版社, 2004.

## 💡 工程应用提示

### 1. 方法选择

**详细研究**:
- 使用运动波法
- 考虑空间分布
- 分析水深演进

**实时预报**:
- 使用线性水库
- 参数易于率定
- 计算速度快

**概念建模**:
- 使用纳什瀑布
- 平衡精度与效率
- 物理意义明确

### 2. 参数率定

**运动波法**:
- 糙率n: 根据地表类型查表
- 坡度S: DEM提取
- 长度L: GIS测量

**线性水库法**:
- K: 根据实测流量率定
- 或根据tc估算
- 敏感性分析验证

**纳什瀑布**:
- 先确定n (通常2-5)
- 再率定K
- 保持n×K ≈ tc

### 3. 尺度效应

**小坡面** (<50m):
- 汇流快
- 调蓄小
- 用运动波或线性水库

**中坡面** (50-200m):
- 三种方法都适用
- 根据需求选择

**大坡面** (>200m):
- 汇流慢
- 调蓄显著
- 推荐纳什瀑布

### 4. 与产流耦合

**耦合流程**:
```
降雨
  ↓
[产流计算]
  ↓
净雨过程
  ↓
[坡面汇流] ← 本案例
  ↓
坡面出口流量
  ↓
[河道汇流]
  ↓
流域出口流量
```

## 🔗 相关案例

- 案例4: 新安江模型产流计算（产流部分）
- 案例5: Green-Ampt超渗产流（产流部分）
- 案例8: 单元线法河道汇流（后续汇流）
- 案例10: Muskingum河道洪水演进（河道汇流）

## 🎓 扩展学习

### 进阶主题

1. **扩散波模型**
   - 考虑扩散项
   - 精度更高
   - 计算更复杂

2. **动力波模型**
   - 完整Saint-Venant方程
   - 最高精度
   - 计算量大

3. **分布式汇流**
   - 网格化坡面
   - DEM驱动
   - GIS集成

### 数值方法

1. 显式差分法
2. 隐式差分法
3. 特征线方法
4. 有限元法

### 实际应用

1. 城市内涝模拟
2. 山洪预警
3. 水土保持评估
4. 流域综合建模

---

**难度**: ⭐⭐  
**所需时间**: 2-3小时  
**前置知识**: Python基础、水力学基础

---

*提示：坡面汇流是水文模拟的关键环节！*
