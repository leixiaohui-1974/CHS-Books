# 案例5：Green-Ampt超渗产流模型

## 📖 案例背景

Green-Ampt模型是经典的物理性产流模型，基于达西定律描述降雨入渗过程。本案例通过模拟不同土壤类型和降雨条件下的入渗产流过程，帮助理解超渗产流机理。

## 🎯 学习目标

1. 理解Green-Ampt入渗模型的物理基础
2. 掌握超渗产流的判别条件
3. 学会分析不同土壤参数对产流的影响
4. 理解积水时间的计算方法
5. 掌握入渗率曲线的绘制与分析
6. 对比超渗产流与蓄满产流的差异

## 📊 数据说明

**土壤类型**: 9种典型土壤
- 砂土 (sand)
- 壤砂土 (loamy sand)
- 砂壤土 (sandy loam)
- 壤土 (loam)
- 粉砂壤土 (silt loam)
- 砂黏壤土 (sandy clay loam)
- 黏壤土 (clay loam)
- 粉砂黏壤土 (silty clay loam)
- 黏土 (clay)

**降雨类型**:
- 恒定强度降雨
- 变化强度降雨（暴雨过程）
- 间歇性降雨

## 🔬 理论基础

### 1. Green-Ampt模型

**基本假设**:
- 土壤初始含水率均匀
- 湿润锋为明显界面
- 湿润区饱和
- 湿润锋处吸力恒定

### 2. 入渗率公式

**Green-Ampt方程**:
```python
f(t) = K × [1 + (ψ × Δθ) / F(t)]
```

其中：
- f(t): 入渗率 (mm/h)
- K: 饱和导水率 (mm/h)
- ψ: 湿润锋吸力 (mm)
- Δθ: 含水率差 θs - θi
- F(t): 累积入渗量 (mm)

### 3. 累积入渗量

**隐式方程**:
```python
F(t) = K×t + ψ×Δθ×ln[1 + F(t)/(ψ×Δθ)]
```

需要用数值方法（如牛顿迭代）求解。

### 4. 积水条件

**积水发生条件**:
```python
i(t) ≥ f(t)
```

**积水时刻累积入渗量**:
```python
Fp = (K × ψ × Δθ) / (i - K)
```

### 5. 产流计算

- **入渗前** (i < f): R = 0
- **积水后** (i ≥ f): R = i - f

## 🚀 快速开始

### 运行案例

```bash
python main.py
```python

### 查看结果

```bash
ls outputs/
# infiltration_process.png - 入渗过程
# soil_comparison.png - 不同土壤对比
# rainfall_scenarios.png - 不同降雨情景
# parameter_sensitivity.png - 参数敏感性
# ponding_analysis.png - 积水分析
```matlab

## 📈 实验内容

### 实验1：基本入渗过程
恒定降雨强度下的入渗率变化

### 实验2：不同土壤类型对比
对比砂土、壤土、黏土的入渗特性

### 实验3：降雨强度影响
分析不同降雨强度对产流的影响

### 实验4：参数敏感性
分析K、ψ、Δθ参数的敏感性

### 实验5：积水时间分析
计算和验证积水发生时间

## 💡 模型特点

### 优点

✅ **物理基础清晰**
- 基于达西定律
- 参数物理意义明确
- 可实测土壤参数

✅ **计算相对简单**
- 方程形式简单
- 计算效率高
- 适合实时计算

✅ **适用性广**
- 适用于各种土壤
- 不同降雨条件
- 单次降雨事件

### 缺点

⚠️ **简化假设多**
- 假设湿润锋为明显界面
- 忽略土壤非均质性
- 不考虑滞后效应

⚠️ **参数获取难**
- 需要土壤物理参数
- 现场测定复杂
- 参数空间变异大

⚠️ **应用限制**
- 主要用于单次降雨
- 不适合连续降雨
- 不考虑蒸发过程

## 🔧 模型参数

### 饱和导水率 (K)

**典型值**:
- 砂土: 100-120 mm/h
- 壤土: 3-10 mm/h
- 黏土: 0.2-0.5 mm/h

**影响**: K越大，入渗能力越强

### 湿润锋吸力 (ψ)

**典型值**:
- 砂土: 40-60 mm
- 壤土: 80-120 mm
- 黏土: 250-350 mm

**影响**: ψ越大，入渗能力越强

### 含水率差 (Δθ)

**计算**: Δθ = θs - θi

**典型值**:
- 干燥土壤: 0.30-0.40
- 湿润土壤: 0.10-0.20

**影响**: Δθ越大，入渗能力越强

## 📊 预期结果

### 典型暴雨（壤土）

**输入**:
- 降雨强度: 10-40 mm/h
- 持续时间: 2小时
- 土壤: 壤土

**输出**:
- 累积入渗: 约15-20 mm
- 累积径流: 约20-30 mm
- 径流系数: 约40-55%
- 积水时间: 约0.2-0.5 h

### 不同土壤对比

**相同降雨条件**:
```
砂土:   径流系数 < 10%
壤土:   径流系数 40-60%
黏土:   径流系数 > 80%
```

## 🎨 可视化说明

### 图1：入渗过程
- 上图: 降雨强度和入渗率
- 中图: 累积入渗和累积径流
- 下图: 径流强度

### 图2：土壤对比
- 不同土壤的入渗率曲线
- 累积入渗量对比
- 产流量对比

### 图3：降雨情景
- 恒定降雨
- 变化降雨
- 间歇降雨

### 图4：参数敏感性
- K参数影响
- ψ参数影响
- Δθ参数影响

### 图5：积水分析
- 积水时间计算
- 理论值vs实际值
- 不同降雨强度对比

## 📚 参考文献

1. Green, W.H., & Ampt, G.A. (1911). Studies on soil physics. Part 1. The flow of air and water through soils. Journal of Agricultural Science, 4(1), 1-24.

2. Rawls, W.J., et al. (1983). Green-Ampt Infiltration Parameters from Soils Data. Journal of Hydraulic Engineering, 109(1), 62-70.

3. Chow, V.T., et al. (1988). Applied Hydrology. McGraw-Hill.

4. 芮孝芳. 水文学原理. 中国水利水电出版社, 2004.

## 💡 工程应用提示

### 1. 参数确定

**实测方法**:
- 双环入渗试验
- 张力计测定
- 土壤样品分析

**查表方法**:
- 根据土壤质地
- 参考经验值
- 区域参数库

### 2. 模型校准

**校准数据**:
- 实测径流过程
- 土壤含水率
- 入渗率观测

**校准参数**:
- 主要校准K
- 次要校准ψ
- θi根据实测

### 3. 适用条件

**推荐使用**:
- 透水性好的土壤
- 短历时强降雨
- 初始含水率低
- 单次降雨事件

**不推荐使用**:
- 饱和土壤
- 连续降雨
- 复杂地形
- 需要长期模拟

### 4. 与其他模型结合

**分布式模型**:
- 作为网格产流模块
- 与汇流模块耦合
- 空间参数化

**与新安江模型对比**:
- Green-Ampt: 超渗产流
- 新安江: 蓄满产流
- 可联合使用

## 🔗 相关案例

- 案例4: 新安江模型产流计算（蓄满产流对比）
- 案例6: 分布式产流网格模型（空间化应用）
- 案例7: 坡面运动波汇流（产流后的汇流过程）

## 🎓 扩展学习

### 进阶主题

1. **改进模型**
   - Philip入渗模型
   - Horton入渗模型
   - 分层Green-Ampt模型

2. **数值方法**
   - 牛顿迭代法
   - 龙格-库塔法
   - 有限差分法

3. **参数估计**
   - 传递函数法
   - 土壤水分特征曲线
   - 反演优化方法

### 研究方向

1. 非均质土壤入渗
2. 大孔隙优先流
3. 降雨再分配
4. 结皮效应

---

**难度**: ⭐⭐  
**所需时间**: 2-3小时  
**前置知识**: Python基础、土壤物理基础

---

*提示：Green-Ampt模型是理解超渗产流的经典模型！*
