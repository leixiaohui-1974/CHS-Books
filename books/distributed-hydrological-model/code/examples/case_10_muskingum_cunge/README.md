# 案例10：Muskingum-Cunge河道洪水演进方法

**难度等级**: ⭐⭐  
**预计学习时间**: 3小时  
**前置知识**: 案例8（单元线法），明渠水力学基础

---

## 📋 案例概述

本案例演示**Muskingum-Cunge方法**，这是经典Muskingum方法的物理基础改进版，参数K和X根据河道物理特性动态计算。

### 学习目标

- 理解Muskingum-Cunge方法的物理基础
- 掌握参数K和X的动态计算
- 学会洪波波速估算
- 理解河段长度对削峰的影响
- 掌握多河段串联演进

### 案例特色

✨ **物理参数化**：根据河道特性计算参数  
✨ **动态计算**：参数随流量动态调整  
✨ **多河段串联**：模拟河道系统演进  
✨ **参数敏感性**：分析河段长度影响  
✨ **实用性强**：适合工程应用

---

## 🎯 核心内容

### 1. Muskingum-Cunge方法原理

**经典Muskingum方法的局限**:
- K和X为经验参数
- 需要实测资料率定
- 缺乏物理基础

**Muskingum-Cunge改进**:
- K和X由物理参数计算
- 参数随流量动态调整
- 适用于无资料地区

### 2. 参数物理计算

**传播时间常数K**:
```
K = Δx / c

其中：
- Δx: 河段长度 (m)
- c: 洪波波速 (m/s)
- c ≈ (5/3) × v (v为流速)
```

**蓄量比重系数X**:
```
X = 0.5 × (1 - v/c)

其中：
- v: 平均流速 (m/s)
- c: 洪波波速 (m/s)
- 典型值: 0.1-0.3
```

### 3. 流速和波速计算

**曼宁流速公式**:
```
v = (1/n) × R^(2/3) × S0^(1/2)

简化（矩形断面）：
v ≈ (Q×√S0 / (B×n))^0.6

其中：
- Q: 流量 (m³/s)
- B: 河宽 (m)
- n: 糙率系数
- S0: 河床坡度
```

**动力波波速**:
```
c = dQ/dA ≈ (5/3) × v

物理意义：
- 洪波传播速度
- 大于水流流速
- 随流量变化
```

### 4. 演算系数

与经典Muskingum相同：
```
C0 = (-K×X + 0.5×Δt) / D
C1 = (K×X + 0.5×Δt) / D
C2 = (K - K×X - 0.5×Δt) / D

其中：
D = K - K×X + 0.5×Δt

C0 + C1 + C2 = 1
```

### 5. 演算公式

```
Q(t+Δt) = C0×I(t+Δt) + C1×I(t) + C2×Q(t)

每个时段动态更新K和X
```

---

## 💻 代码实现

### 1. 流速和波速计算

```python
def manning_velocity(Q, B, n, S0):
    """曼宁流速"""
    if Q <= 0 or B <= 0 or S0 <= 0:
        return 0.1
    
    # 简化公式
    v = np.power(Q * np.sqrt(S0) / (B * n), 0.6)
    return max(v, 0.1)

def compute_wave_celerity(Q, B, n, S0):
    """洪波波速"""
    v = manning_velocity(Q, B, n, S0)
    c = (5.0 / 3.0) * v
    return max(c, 0.5)
```

### 2. 参数动态计算

```python
def compute_muskingum_cunge_params(Q, B, n, S0, dx, dt):
    """计算Muskingum-Cunge参数"""
    # 波速
    c = compute_wave_celerity(Q, B, n, S0)
    
    # K = dx / c (小时)
    K = dx / (c * 3600)
    
    # X = 0.5 * (1 - v/c)
    v = manning_velocity(Q, B, n, S0)
    X = 0.5 * (1 - v / c)
    X = np.clip(X, 0, 0.5)
    
    # 演算系数
    denominator = K - K * X + 0.5 * dt
    C0 = (-K * X + 0.5 * dt) / denominator
    C1 = (K * X + 0.5 * dt) / denominator
    C2 = (K - K * X - 0.5 * dt) / denominator
    
    return {'K': K, 'X': X, 'C0': C0, 'C1': C1, 'C2': C2}
```

### 3. 河道演进

```python
def muskingum_cunge_routing(inflow, B, n, S0, dx, dt):
    """Muskingum-Cunge演进"""
    n_steps = len(inflow)
    outflow = np.zeros(n_steps)
    
    Q_prev = inflow[0]
    I_prev = inflow[0]
    
    for t in range(n_steps):
        I = inflow[t]
        
        # 使用平均流量计算参数
        Q_ref = (I + Q_prev) / 2
        params = compute_muskingum_cunge_params(Q_ref, B, n, S0, dx, dt)
        
        # Muskingum演算
        Q_new = params['C0'] * I + params['C1'] * I_prev + params['C2'] * Q_prev
        Q_new = max(Q_new, 0)
        
        outflow[t] = Q_new
        
        # 更新状态
        I_prev = I
        Q_prev = Q_new
    
    return outflow
```

### 4. 多河段串联

```python
def cascade_routing(inflow, reach_params, dt):
    """多河段串联演进"""
    outflows = []
    current_inflow = inflow.copy()
    
    for params in reach_params:
        result = muskingum_cunge_routing(
            current_inflow,
            B=params['B'],
            n=params['n'],
            S0=params['S0'],
            dx=params['dx'],
            dt=dt
        )
        outflows.append(result)
        current_inflow = result.copy()
    
    return outflows
```

---

## 📊 实验结果

### 实验1：单河段演进

**河道参数**:
- 河宽：80 m
- 糙率：0.035
- 坡度：0.0005
- 河段长度：10 km

**演进结果**:
- 入流峰值：1000 m³/s
- 出流峰值：994.5 m³/s
- 削峰率：0.55%
- 滞时：1.0 h
- 平均K：1.48 h
- 平均X：0.200
- 平均波速：2.73 m/s

**结论**:
- 10km河段削峰作用较小
- K和X随流量动态变化
- 波速约为2.7m/s（约0.1m/s流速的1.67倍）

### 实验2：多河段串联

**河段设置**:
1. 河段1：8km, B=100m, S0=0.0008（上游）
2. 河段2：12km, B=120m, S0=0.0005（中游）
3. 河段3：15km, B=150m, S0=0.0003（下游）

**演进结果**:
| 河段 | 峰值(m³/s) | 峰现时刻(h) | 削峰率 |
|------|-----------|-----------|--------|
| 入流 | 1000.0 | 7 | - |
| 河段1 | 997.2 | 8 | 0.28% |
| 河段2 | 993.7 | 9 | 0.63% |
| 河段3 | 969.5 | 11 | 3.05% |

**结论**:
- 总长35km，总削峰率3.05%
- 下游削峰作用更明显（坡度小）
- 滞时累积效应显著

### 实验3：河段长度影响

| 长度(km) | 削峰率 | 滞时(h) |
|---------|-------|---------|
| 5 | 0.13% | 0 |
| 10 | 0.55% | 1 |
| 15 | 0.55% | 1 |
| 20 | 0.96% | 1 |
| 25 | 1.90% | 1 |

**结论**:
- 河段越长，削峰效果越好
- 25km削峰率达1.90%
- 滞时随长度增加

---

## 🎨 可视化说明

### 1. 演进对比图 (`routing_comparison.png`)
- 入流/出流过程线
- 峰值标注
- 削峰效果展示

### 2. 参数演变图 (`parameters_evolution.png`)
- K值动态变化
- X值动态变化
- 波速动态变化
- 3个子图，时间序列

### 3. 串联演进图 (`cascade_routing.png`)
- 初始入流
- 各河段出流
- 颜色区分河段
- 累积演进效果

### 4. 削峰对比图 (`attenuation_comparison.png`)
- 不同河段长度
- 削峰率柱状图
- 数值标注

---

## 💡 工程应用

### 1. 洪水预报

**优势**:
- 无需率定参数
- 适用于无资料河段
- 参数物理意义明确

**应用**:
- 中小河流洪水预报
- 区域洪水演进模拟
- 山洪灾害预警

### 2. 防洪规划

**分析内容**:
- 河道削峰能力
- 滞洪作用评估
- 河道整治效果

**决策支持**:
- 河道断面设计
- 堤防高度确定
- 分洪区布置

### 3. 水库调度

**上下游协调**:
- 水库下泄流量
- 河道传播时间
- 下游断面流量

**调度优化**:
- 考虑河道滞后
- 协调多水库
- 降低洪峰

---

## 📝 练习题

### 基础练习

1. **参数计算**:
   - 计算Q=500m³/s, B=100m, n=0.03, S0=0.001时的v和c
   - 如果dx=8000m, dt=1h，计算K和X

2. **削峰分析**:
   - 修改河段长度为20km
   - 计算削峰率
   - 分析滞时变化

3. **参数敏感性**:
   - 改变糙率n (0.03, 0.04, 0.05)
   - 观察K和X的变化
   - 分析对削峰的影响

### 进阶练习

1. **串联河段**:
   - 设计5个河段参数
   - 模拟完整演进过程
   - 分析累积削峰效果

2. **坡度影响**:
   - 保持其他参数不变
   - 改变坡度 (0.0002, 0.0005, 0.001)
   - 对比削峰效果

3. **实际河道**:
   - 收集实际河道参数
   - 应用Muskingum-Cunge方法
   - 与实测对比验证

### 挑战练习

1. **参数优化**:
   - 实现参数自动率定
   - 使用SCE-UA算法
   - 提高模拟精度

2. **耦合模型**:
   - 与坡面汇流耦合
   - 构建完整流域模型
   - 模拟降雨-径流-演进全过程

3. **不确定性分析**:
   - 分析参数不确定性
   - 蒙特卡洛模拟
   - 置信区间估计

---

## 🔍 常见问题

### Q1: Muskingum-Cunge与经典Muskingum有何区别？

**A**: 主要区别：

| 方面 | 经典Muskingum | Muskingum-Cunge |
|------|--------------|----------------|
| 参数来源 | 经验率定 | 物理计算 |
| 数据需求 | 需实测资料 | 仅需河道特性 |
| 适用性 | 已有资料河段 | 无资料河段 |
| 动态性 | 参数固定 | 参数动态 |
| 物理意义 | 经验性 | 物理基础 |

### Q2: 如何选择合适的河段长度？

**A**: 考虑因素：
- **精度要求**：长度越小精度越高
- **计算效率**：过短增加计算量
- **经验值**：5-20km较合适
- **稳定性**：满足CFL条件
- **实际情况**：结合河道特点

建议：
```
dx ≈ c × dt × (10-20)
```

### Q3: 参数动态计算是否必要？

**A**: 视情况而定：

**必要情况**:
- 流量变化大（数倍）
- 河道几何变化大
- 坡度变化显著

**可简化情况**:
- 流量变化小
- 河道均匀
- 对精度要求不高

实践中可用平均流量计算参数。

### Q4: 如何验证模拟结果？

**A**: 验证方法：

1. **水量平衡**:
   ```
   Σ(入流) ≈ Σ(出流) + ΔS
   ```

2. **物理合理性**:
   - 削峰率 < 10%（单河段）
   - 滞时 = K ≈ dx/c
   - 0 < X < 0.5

3. **实测对比**:
   - NSE > 0.7
   - 峰值误差 < 15%
   - 峰现时间误差 < 1时段

---

## 📚 参考资料

### 经典文献

1. **Cunge, J. A. (1969)**. "On the subject of a flood propagation computation method (Muskingum method)." *Journal of Hydraulic Research*, 7(2), 205-230.
   - Muskingum-Cunge方法的原始论文

2. **Ponce, V. M., & Yevjevich, V. (1978)**. "Muskingum-Cunge method with variable parameters." *Journal of the Hydraulics Division*, 104(12), 1663-1667.
   - 变参数Muskingum-Cunge方法

3. **Chow, V. T., Maidment, D. R., & Mays, L. W. (1988)**. *Applied Hydrology*. McGraw-Hill.
   - 第8章详细介绍河道演进方法

### 中文教材

1. **芮孝芳 (2019)**. 《水文学原理》（第3版）. 中国水利水电出版社.
   - 第9章河道洪水演进

2. **王船海、李光炽 (2006)**. 《水文学》. 中国建筑工业出版社.
   - 河道汇流计算方法

### 软件工具

- **HEC-RAS** - 美国陆军工程兵团河道分析软件
- **MIKE 11** - DHI水动力模型
- **SWMM** - 城市雨洪模型（含Muskingum-Cunge）

---

## ✅ 学习检查清单

- [ ] 理解Muskingum-Cunge的物理基础
- [ ] 掌握K和X的物理计算方法
- [ ] 理解洪波波速的概念
- [ ] 会计算曼宁流速
- [ ] 掌握Muskingum-Cunge演算过程
- [ ] 理解河段长度对削峰的影响
- [ ] 会进行多河段串联模拟
- [ ] 能解释参数的物理意义
- [ ] 了解方法的优缺点
- [ ] 能进行工程应用

---

**案例10完成！** 🎉

下一步：案例11 - 参数率定（SCE-UA算法）

---

**作者**: CHS-Books项目组  
**日期**: 2025-11-02  
**版本**: v1.0
