# æ¡ˆä¾‹9ï¼šå‚æ•°æ•æ„Ÿæ€§åˆ†æ

**éš¾åº¦ç­‰çº§**: â­â­  
**é¢„è®¡å­¦ä¹ æ—¶é—´**: 2-3å°æ—¶  
**å‰ç½®çŸ¥è¯†**: æ¡ˆä¾‹4ï¼ˆæ–°å®‰æ±Ÿæ¨¡å‹ï¼‰

---

## ğŸ“‹ æ¡ˆä¾‹æ¦‚è¿°

æœ¬æ¡ˆä¾‹æ¼”ç¤ºå¦‚ä½•å¯¹æ°´æ–‡æ¨¡å‹è¿›è¡Œ**å‚æ•°æ•æ„Ÿæ€§åˆ†æ**ï¼Œè¯†åˆ«å…³é”®å‚æ•°ï¼Œä¸ºå‚æ•°ç‡å®šå’Œæ¨¡å‹ä¼˜åŒ–æä¾›ä¾æ®ã€‚

### å­¦ä¹ ç›®æ ‡

- ç†è§£å‚æ•°æ•æ„Ÿæ€§åˆ†æçš„æ„ä¹‰
- æŒæ¡ä¸‰ç§æ•æ„Ÿæ€§åˆ†ææ–¹æ³•
- å­¦ä¼šè®¡ç®—æ•æ„Ÿæ€§æŒ‡æ ‡
- ç†è§£æ•æ„Ÿæ€§å¯è§†åŒ–æ–¹æ³•
- å­¦ä¼šå‚æ•°é‡è¦æ€§æ’åº

---

## ğŸ¯ æ ¸å¿ƒå†…å®¹

### 1. å‚æ•°æ•æ„Ÿæ€§åˆ†ææ¦‚å¿µ

#### ä»€ä¹ˆæ˜¯æ•æ„Ÿæ€§åˆ†æï¼Ÿ

æ•æ„Ÿæ€§åˆ†æè¯„ä¼°æ¨¡å‹è¾“å…¥å‚æ•°å¯¹è¾“å‡ºç»“æœçš„å½±å“ç¨‹åº¦ï¼Œå¸®åŠ©ï¼š
- **è¯†åˆ«å…³é”®å‚æ•°**ï¼šå“ªäº›å‚æ•°æœ€é‡è¦
- **æŒ‡å¯¼ç‡å®š**ï¼šä¼˜å…ˆç‡å®šæ•æ„Ÿå‚æ•°
- **ç®€åŒ–æ¨¡å‹**ï¼šå»é™¤ä¸æ•æ„Ÿå‚æ•°
- **ä¸ç¡®å®šæ€§åˆ†æ**ï¼šè¯„ä¼°å‚æ•°ä¸ç¡®å®šæ€§å½±å“

#### æ•æ„Ÿæ€§ç±»å‹

**å±€éƒ¨æ•æ„Ÿæ€§ï¼ˆOATï¼‰**ï¼š
- ä¸€æ¬¡æ”¹å˜ä¸€ä¸ªå‚æ•°
- å…¶ä»–å‚æ•°ä¿æŒä¸å˜
- è®¡ç®—ç®€å•ï¼Œç»“æœç›´è§‚

**å…¨å±€æ•æ„Ÿæ€§ï¼ˆMorris, Sobolï¼‰**ï¼š
- åŒæ—¶å˜åŒ–å¤šä¸ªå‚æ•°
- è€ƒè™‘å‚æ•°äº¤äº’ä½œç”¨
- æ›´å…¨é¢ä½†è®¡ç®—é‡å¤§

---

## ğŸ”¬ ä¸‰ç§åˆ†ææ–¹æ³•

### æ–¹æ³•1ï¼šOATï¼ˆOne-At-a-Timeï¼‰

**åŸç†**ï¼šå›ºå®šå…¶ä»–å‚æ•°ï¼Œé€ä¸ªæ”¹å˜ç›®æ ‡å‚æ•°ï¼Œè§‚å¯Ÿè¾“å‡ºå˜åŒ–ã€‚

**æ•æ„Ÿæ€§æŒ‡æ ‡**ï¼š
```
ç›¸å¯¹æ•æ„Ÿæ€§ç³»æ•° S = (Î”Y/Yâ‚€) / (Î”X/Xâ‚€)
```

**ä¼˜ç‚¹**ï¼š
- ç®€å•ç›´è§‚
- æ˜“äºå®ç°
- ç»“æœæ¸…æ™°

**ç¼ºç‚¹**ï¼š
- åªè€ƒè™‘å•å‚æ•°æ•ˆåº”
- å¿½ç•¥å‚æ•°äº¤äº’

### æ–¹æ³•2ï¼šMorrisç­›é€‰æ³•

**åŸç†**ï¼šé€šè¿‡éšæœºè½¨è¿¹é‡‡æ ·ï¼Œä¼°è®¡å‚æ•°çš„å¹³å‡æ•ˆåº”å’Œäº¤äº’ä½œç”¨ã€‚

**MorrisæŒ‡æ ‡**ï¼š
- **Î¼\* (mu-star)**ï¼šå¹³å‡ç»å¯¹æ•ˆåº”ï¼Œè¡¡é‡é‡è¦æ€§
- **Ïƒ (sigma)**ï¼šæ ‡å‡†å·®ï¼Œè¡¡é‡äº¤äº’ä½œç”¨æˆ–éçº¿æ€§

**åˆ†ç±»**ï¼š
- é«˜Î¼\*, ä½Ïƒï¼šçº¿æ€§ä¸”é‡è¦
- é«˜Î¼\*, é«˜Ïƒï¼šéçº¿æ€§æˆ–æœ‰äº¤äº’
- ä½Î¼\*ï¼šä¸é‡è¦

### æ–¹æ³•3ï¼šç›¸å…³ç³»æ•°æ³•

**åŸç†**ï¼šå¤§é‡éšæœºé‡‡æ ·ï¼Œè®¡ç®—å‚æ•°ä¸è¾“å‡ºçš„ç›¸å…³ç³»æ•°ã€‚

**æŒ‡æ ‡**ï¼š
- **Pearsonç›¸å…³**ï¼šçº¿æ€§ç›¸å…³
- **Spearmanç§©ç›¸å…³**ï¼šå•è°ƒç›¸å…³

**é‡‡æ ·æ–¹æ³•**ï¼š
- ç®€åŒ–æ‹‰ä¸è¶…ç«‹æ–¹é‡‡æ ·ï¼ˆLHSï¼‰
- å‡åŒ€åˆ†å¸ƒæˆ–æ­£æ€åˆ†å¸ƒ

---

## ğŸ’» ä»£ç å®ç°

### 1. OATæ•æ„Ÿæ€§åˆ†æ

```python
def one_at_a_time_sensitivity(model_func, base_params, param_ranges, 
                               rainfall, n_samples=10):
    """
    å•å‚æ•°æ•æ„Ÿæ€§åˆ†æ
    """
    results = {'param_values': {}, 'outputs': {}, 'sensitivity_indices': {}}
    
    # åŸºå‡†è¾“å‡º
    base_output = np.sum(model_func(base_params, rainfall))
    
    # å¯¹æ¯ä¸ªå‚æ•°
    for param_name, (pmin, pmax) in param_ranges.items():
        # å‚æ•°å€¼åºåˆ—
        param_values = np.linspace(pmin, pmax, n_samples)
        outputs = []
        
        for param_value in param_values:
            test_params = base_params.copy()
            test_params[param_name] = param_value
            output = np.sum(model_func(test_params, rainfall))
            outputs.append(output)
        
        # è®¡ç®—æ•æ„Ÿæ€§ç³»æ•°
        relative_change = (outputs - base_output) / base_output
        param_relative_change = (param_values - base_params[param_name]) / base_params[param_name]
        sensitivity_coef = np.polyfit(param_relative_change, relative_change, 1)[0]
        
        results['param_values'][param_name] = param_values
        results['outputs'][param_name] = outputs
        results['sensitivity_indices'][param_name] = {
            'coefficient': sensitivity_coef,
            'output_range': (np.max(outputs) - np.min(outputs)) / base_output
        }
    
    return results
```

### 2. Morrisç­›é€‰æ³•

```python
def morris_screening(model_func, param_ranges, rainfall, 
                     n_trajectories=10, n_levels=4):
    """
    Morrisç­›é€‰æ³•
    """
    param_names = list(param_ranges.keys())
    elementary_effects = {name: [] for name in param_names}
    
    for _ in range(n_trajectories):
        # ç”ŸæˆåŸºç¡€ç‚¹
        base_point = {}
        for name, (pmin, pmax) in param_ranges.items():
            level = np.random.randint(0, n_levels)
            base_point[name] = pmin + (pmax - pmin) * level / (n_levels - 1)
        
        base_output = np.sum(model_func(base_point, rainfall))
        
        # æ‰°åŠ¨æ¯ä¸ªå‚æ•°
        for param_name in param_names:
            delta_point = base_point.copy()
            pmin, pmax = param_ranges[param_name]
            delta = (pmax - pmin) / (n_levels - 1)
            delta_point[param_name] = min(delta_point[param_name] + delta, pmax)
            
            delta_output = np.sum(model_func(delta_point, rainfall))
            ee = (delta_output - base_output) / delta
            elementary_effects[param_name].append(ee)
    
    # è®¡ç®—MorrisæŒ‡æ ‡
    results = {}
    for param_name in param_names:
        ee_array = np.array(elementary_effects[param_name])
        results[param_name] = {
            'mu_star': np.mean(np.abs(ee_array)),
            'sigma': np.std(ee_array)
        }
    
    return results
```

### 3. ç›¸å…³ç³»æ•°æ³•

```python
def correlation_based_sensitivity(model_func, param_ranges, rainfall, n_samples=1000):
    """
    åŸºäºç›¸å…³ç³»æ•°çš„æ•æ„Ÿæ€§åˆ†æ
    """
    param_names = list(param_ranges.keys())
    n_params = len(param_names)
    
    # LHSé‡‡æ ·
    param_samples = np.zeros((n_samples, n_params))
    for i, (name, (pmin, pmax)) in enumerate(param_ranges.items()):
        intervals = np.linspace(0, 1, n_samples + 1)
        samples = np.random.uniform(intervals[:-1], intervals[1:])
        np.random.shuffle(samples)
        param_samples[:, i] = pmin + samples * (pmax - pmin)
    
    # è¿è¡Œæ¨¡å‹
    outputs = np.zeros(n_samples)
    for i in range(n_samples):
        params = {name: param_samples[i, j] for j, name in enumerate(param_names)}
        outputs[i] = np.sum(model_func(params, rainfall))
    
    # è®¡ç®—ç›¸å…³ç³»æ•°
    results = {}
    for i, param_name in enumerate(param_names):
        pearson_r = np.corrcoef(param_samples[:, i], outputs)[0, 1]
        rank_param = np.argsort(np.argsort(param_samples[:, i]))
        rank_output = np.argsort(np.argsort(outputs))
        spearman_r = np.corrcoef(rank_param, rank_output)[0, 1]
        
        results[param_name] = {
            'pearson': pearson_r,
            'spearman': spearman_r
        }
    
    return results
```

---

## ğŸ“Š å®éªŒç»“æœ

### æ–°å®‰æ±Ÿæ¨¡å‹å‚æ•°æ•æ„Ÿæ€§æ’åº

#### OATæ–¹æ³•ï¼ˆè¾“å‡ºå˜åŒ–èŒƒå›´ï¼‰
1. **WM (è“„æ°´å®¹é‡)**: 50.23% - æé«˜æ•æ„Ÿ
2. **IM (ä¸é€æ°´é¢ç§¯æ¯”)**: 0.55% - ä½æ•æ„Ÿ
3. **B (è“„æ°´å®¹é‡æ›²çº¿æŒ‡æ•°)**: 0.08% - æä½æ•æ„Ÿ
4. **SM, KG, KI**: <0.01% - å‡ ä¹ä¸æ•æ„Ÿ

#### Morrisæ–¹æ³•ï¼ˆÎ¼\*æŒ‡æ ‡ï¼‰
1. **IM**: 6.603 - æœ€é«˜
2. **WM**: 0.213
3. **B**: 0.076
4. **SM, KG, KI**: 0.000

#### ç›¸å…³ç³»æ•°æ³•ï¼ˆPearsonï¼‰
1. **WM**: 0.995 - æå¼ºæ­£ç›¸å…³
2. **B**: 0.082 - å¼±æ­£ç›¸å…³
3. **IM**: 0.044 - å¼±æ­£ç›¸å…³
4. **KI, SM, KG**: <0.04

### ç»“æœè§£è¯»

**ä¸€è‡´æ€§ç»“è®º**ï¼š
- **WMæ˜¯æœ€æ•æ„Ÿå‚æ•°**ï¼ˆæ‰€æœ‰æ–¹æ³•ä¸€è‡´ï¼‰
- åŸå› ï¼šç›´æ¥æ§åˆ¶æµåŸŸè“„æ°´èƒ½åŠ›
- å»ºè®®ï¼šç‡å®šæ—¶ä¼˜å…ˆè°ƒæ•´WM

**æ–¹æ³•å·®å¼‚**ï¼š
- OATå’Œç›¸å…³ç³»æ•°æ³•ï¼šWMæœ€æ•æ„Ÿ
- Morrisæ³•ï¼šIMæœ€æ•æ„Ÿï¼ˆå¯èƒ½å› äº¤äº’ä½œç”¨ï¼‰
- è¯´æ˜ï¼šéœ€ç»¼åˆå¤šç§æ–¹æ³•åˆ¤æ–­

---

## ğŸ¨ å¯è§†åŒ–è¯´æ˜

### 1. OATæ•æ„Ÿæ€§æ›²çº¿å›¾
- 6ä¸ªå­å›¾ï¼Œæ¯ä¸ªå‚æ•°ä¸€æ¡æ›²çº¿
- xè½´ï¼šå‚æ•°å€¼
- yè½´ï¼šç´¯è®¡å¾„æµ(mm)
- çº¢è‰²è™šçº¿ï¼šåŸºå‡†è¾“å‡º

### 2. é¾™å·é£å›¾ï¼ˆTornado Chartï¼‰
- å‚æ•°æŒ‰æ•æ„Ÿæ€§æ’åº
- æŸ±é•¿ï¼šè¾“å‡ºå˜åŒ–å¹…åº¦
- é¢œè‰²ï¼šæ•æ„Ÿæ€§é«˜ä½ï¼ˆçº¢â†’é»„â†’ç»¿ï¼‰

### 3. Morrisæ•£ç‚¹å›¾
- xè½´ï¼šÎ¼\* (é‡è¦æ€§)
- yè½´ï¼šÏƒ (äº¤äº’ä½œç”¨)
- å³ä¸ŠåŒºåŸŸï¼šé‡è¦ä¸”æœ‰äº¤äº’
- å³ä¸‹åŒºåŸŸï¼šé‡è¦ä½†çº¿æ€§

### 4. ç›¸å…³ç³»æ•°æ•£ç‚¹å›¾
- 6ä¸ªå­å›¾
- æ¯ä¸ªå‚æ•°1000ä¸ªé‡‡æ ·ç‚¹
- çº¢è‰²è™šçº¿ï¼šçº¿æ€§æ‹Ÿåˆ
- æ ‡é¢˜æ˜¾ç¤ºPearsonå’ŒSpearmanç³»æ•°

### 5. ç»¼åˆæ•æ„Ÿæ€§æ’å
- ä¸‰ç§æ–¹æ³•å¹¶æ’å¯¹æ¯”
- å½’ä¸€åŒ–åˆ°0-1èŒƒå›´
- ç›´è§‚æ¯”è¾ƒæ–¹æ³•å·®å¼‚

---

## ğŸ’¡ å·¥ç¨‹åº”ç”¨

### 1. å‚æ•°ç‡å®šæŒ‡å¯¼

**ç‡å®šç­–ç•¥**ï¼š
```
ç¬¬ä¸€æ­¥ï¼šç‡å®šWMï¼ˆæœ€æ•æ„Ÿï¼‰
ç¬¬äºŒæ­¥ï¼šç‡å®šIMå’ŒBï¼ˆä¸­ç­‰æ•æ„Ÿï¼‰
ç¬¬ä¸‰æ­¥ï¼šå›ºå®šSM, KG, KIï¼ˆä¸æ•æ„Ÿï¼‰
```

**å¥½å¤„**ï¼š
- å‡å°‘ç‡å®šå‚æ•°æ•°é‡
- æé«˜ç‡å®šæ•ˆç‡
- é¿å…è¿‡åº¦æ‹Ÿåˆ

### 2. æ¨¡å‹ç®€åŒ–

**ç®€åŒ–åŸåˆ™**ï¼š
- å»é™¤ä¸æ•æ„Ÿå‚æ•°
- ä½¿ç”¨åŒºåŸŸç»éªŒå€¼
- å‡å°‘è®¡ç®—é‡

### 3. ä¸ç¡®å®šæ€§åˆ†æ

**åº”ç”¨**ï¼š
- è¯†åˆ«ä¸ç¡®å®šæ€§æ¥æº
- ä¼˜å…ˆå‡å°æ•æ„Ÿå‚æ•°ä¸ç¡®å®šæ€§
- Monte Carloæ¨¡æ‹Ÿè¾“å…¥è®¾è®¡

---

## ğŸ“ ç»ƒä¹ é¢˜

### åŸºç¡€ç»ƒä¹ 
1. è¿è¡Œä»£ç ï¼Œè§‚å¯Ÿ6ä¸ªå‚æ•°çš„æ•æ„Ÿæ€§æ’åº
2. ä¿®æ”¹å‚æ•°å˜åŒ–èŒƒå›´ï¼Œè§‚å¯Ÿç»“æœå˜åŒ–
3. å¢åŠ é‡‡æ ·ç‚¹æ•°é‡ï¼ˆOATï¼š15â†’30ï¼‰

### è¿›é˜¶ç»ƒä¹ 
1. æ·»åŠ æ–°å‚æ•°ï¼ˆå¦‚EX, KG_baseï¼‰è¿›è¡Œåˆ†æ
2. å°è¯•ä¸åŒé™é›¨æƒ…æ™¯ï¼ˆå¤§é›¨ã€å°é›¨ï¼‰
3. å¯¹æ¯”ä¸åŒæµåŸŸå‚æ•°çš„æ•æ„Ÿæ€§

### æŒ‘æˆ˜ç»ƒä¹ 
1. å®ç°Sobolå…¨å±€æ•æ„Ÿæ€§åˆ†æ
2. åˆ†æå‚æ•°äº¤äº’ä½œç”¨ï¼ˆäºŒé˜¶æ•ˆåº”ï¼‰
3. å¯¹æ¯”ä¸åŒæ¨¡å‹çš„å‚æ•°æ•æ„Ÿæ€§

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: ä¸åŒæ–¹æ³•ç»“æœä¸ä¸€è‡´æ€ä¹ˆåŠï¼Ÿ

**A**: è¿™æ˜¯æ­£å¸¸çš„ï¼š
- OATï¼šå±€éƒ¨çº¿æ€§å‡è®¾
- Morrisï¼šè€ƒè™‘å‚æ•°ç©ºé—´å…¨å±€ç‰¹æ€§
- ç›¸å…³ç³»æ•°ï¼šåŸºäºå¤§é‡é‡‡æ ·

**å»ºè®®**ï¼šç»¼åˆåˆ¤æ–­ï¼Œé‡ç‚¹å…³æ³¨æ‰€æœ‰æ–¹æ³•éƒ½æ˜¾ç¤ºæ•æ„Ÿçš„å‚æ•°ã€‚

### Q2: å¦‚ä½•é€‰æ‹©å‚æ•°å˜åŒ–èŒƒå›´ï¼Ÿ

**A**: åŸåˆ™ï¼š
- ç‰©ç†æ„ä¹‰ï¼šä¸èƒ½è¶…å‡ºç‰©ç†åˆç†èŒƒå›´
- æ–‡çŒ®ç»éªŒï¼šå‚è€ƒå·²å‘è¡¨ç ”ç©¶
- Â±20-50%ï¼šåŸºå‡†å€¼çš„åˆç†å˜åŒ–
- å®é™…è§‚æµ‹ï¼šå¦‚æœ‰å®æµ‹æ•°æ®ï¼ŒåŸºäºå®æµ‹èŒƒå›´

### Q3: é‡‡æ ·æ•°é‡å¦‚ä½•ç¡®å®šï¼Ÿ

**A**: å‚è€ƒå€¼ï¼š
- OATï¼š10-20ä¸ªç‚¹/å‚æ•°
- Morrisï¼š10-50æ¡è½¨è¿¹
- ç›¸å…³ç³»æ•°æ³•ï¼š500-2000ä¸ªæ ·æœ¬

**åŸåˆ™**ï¼šæ ·æœ¬è¶Šå¤šè¶Šå‡†ç¡®ï¼Œä½†è®¡ç®—é‡å¢å¤§ã€‚

### Q4: æ•æ„Ÿæ€§ä¼šéšæµåŸŸå˜åŒ–å—ï¼Ÿ

**A**: ä¼šçš„ï¼š
- æ¹¿æ¶¦æµåŸŸï¼šWMå¯èƒ½æ›´æ•æ„Ÿ
- å¹²æ—±æµåŸŸï¼šIMå¯èƒ½æ›´é‡è¦
- å±±åŒºæµåŸŸï¼šåœ°å½¢å‚æ•°æ›´æ•æ„Ÿ

å»ºè®®ï¼šå¯¹æ¯ä¸ªæµåŸŸå•ç‹¬åˆ†æã€‚

---

## ğŸ“š å‚è€ƒèµ„æ–™

### ç»å…¸æ–‡çŒ®
1. Morris, M. D. (1991). "Factorial sampling plans for preliminary computational experiments." *Technometrics*, 33(2), 161-174.

2. Saltelli, A., et al. (2008). *Global Sensitivity Analysis: The Primer*. John Wiley & Sons.

3. Sobol', I. M. (2001). "Global sensitivity indices for nonlinear mathematical models." *Mathematics and Computers in Simulation*, 55(1-3), 271-280.

### æ°´æ–‡åº”ç”¨
1. van Griensven, A., et al. (2006). "A global sensitivity analysis tool for the parameters of multi-variable catchment models." *Journal of Hydrology*, 324(1-4), 10-23.

2. Tang, Y., et al. (2007). "Comparing sensitivity analysis methods to advance lumped watershed model identification and evaluation." *Hydrology and Earth System Sciences*, 11(2), 793-817.

---

## âœ… å­¦ä¹ æ£€æŸ¥æ¸…å•

- [ ] ç†è§£æ•æ„Ÿæ€§åˆ†æçš„ç›®çš„å’Œæ„ä¹‰
- [ ] æŒæ¡OATæ–¹æ³•çš„åŸç†å’Œåº”ç”¨
- [ ] ç†è§£Morrisæ–¹æ³•çš„æŒ‡æ ‡ï¼ˆÎ¼\*, Ïƒï¼‰
- [ ] å­¦ä¼šä½¿ç”¨ç›¸å…³ç³»æ•°è¯„ä¼°æ•æ„Ÿæ€§
- [ ] èƒ½å¤Ÿè§£è¯»é¾™å·é£å›¾
- [ ] ç†è§£ä¸åŒæ–¹æ³•çš„ä¼˜ç¼ºç‚¹
- [ ] èƒ½å¤Ÿè¿è¡Œå¹¶ä¿®æ”¹ä»£ç 
- [ ] å­¦ä¼šç»¼åˆå¤šç§æ–¹æ³•åˆ¤æ–­
- [ ] ç†è§£æ•æ„Ÿæ€§åœ¨ç‡å®šä¸­çš„åº”ç”¨
- [ ] èƒ½å¤Ÿå¯¹æ–°æ¨¡å‹è¿›è¡Œæ•æ„Ÿæ€§åˆ†æ

---

**æ¡ˆä¾‹9å®Œæˆï¼** ğŸ‰

ä¸‹ä¸€æ­¥ï¼šæ¡ˆä¾‹10 - Muskingum-Cungeæ–¹æ³•

---

**ä½œè€…**: CHS-Booksé¡¹ç›®ç»„  
**æ—¥æœŸ**: 2025-11-02  
**ç‰ˆæœ¬**: v1.0
