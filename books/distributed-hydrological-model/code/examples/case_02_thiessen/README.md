# 案例2：Thiessen多边形降雨插值

## 📖 案例背景

Thiessen多边形法（又称泰森多边形、Voronoi图）是水文学中最简单、最常用的降雨空间插值方法。本案例通过一个典型流域的多站点降雨数据，演示如何使用Thiessen多边形法计算流域面雨量。

## 🎯 学习目标

1. 理解Thiessen多边形的几何原理
2. 掌握流域面雨量计算方法
3. 学会Voronoi图的构建和可视化
4. 理解不同站点布局对结果的影响
5. 掌握Python空间分析的基本方法

## 📊 数据说明

**流域特征**:
- 流域面积: 500 km²
- 流域形状: 近似矩形
- 雨量站: 5-8个

**降雨事件**:
- 类型: 暴雨事件
- 时长: 6小时
- 范围: 局地性暴雨

**站点数据**:
- 站点坐标: (x, y) km
- 降雨量: mm
- 观测时间: 同步观测

## 🔬 理论基础

### 1. Thiessen多边形原理

Thiessen多边形将流域空间划分为若干个区域，每个区域内的点到该站点的距离最近。

**核心思想**:
```python
任一点的降雨量 = 最近站点的降雨量
```

### 2. 面雨量计算

**面积加权法**:
```python
P_mean = Σ(Ai × Pi) / A_total
```

其中：
- P_mean: 流域平均降雨量（面雨量）
- Ai: 第i个Thiessen多边形面积
- Pi: 第i个站点的降雨量
- A_total: 流域总面积

### 3. Voronoi图

Thiessen多边形在数学上称为Voronoi图，具有以下性质：
- 每个多边形包含一个站点
- 多边形内任意点到该站点的距离最近
- 相邻多边形的公共边是两站点连线的垂直平分线

## 🚀 快速开始

### 运行案例

```bash
python main.py
```python

### 查看结果

```bash
ls outputs/
# thiessen_polygon.png - Thiessen多边形图
# rainfall_distribution.png - 降雨空间分布
# sensitivity_analysis.png - 站点数量敏感性分析
# comparison.png - 不同方法对比
```matlab

## 📈 实验内容

### 实验1：基础Thiessen多边形
构建5个站点的Thiessen多边形，计算面雨量

### 实验2：站点数量影响
对比3、5、8个站点下的面雨量计算结果

### 实验3：站点布局影响
分析均匀布局 vs 集中布局的影响

### 实验4：与其他方法对比
对比Thiessen、算术平均、IDW三种方法

## 💡 优缺点分析

### 优点
✅ 计算简单，易于理解  
✅ 不需要假设空间连续性  
✅ 适合站点分布不均匀的情况  
✅ 几何意义明确  
✅ 计算速度快

### 缺点
⚠️ 假设突变，不考虑距离衰减  
⚠️ 对站点数量和位置敏感  
⚠️ 无法外推到流域边界外  
⚠️ 不提供不确定性估计  
⚠️ 不考虑地形影响

## 🔧 适用条件

**推荐使用**:
- 站点分布较均匀
- 降雨空间分布相对均匀
- 需要快速估算
- 站点数量有限（3-10个）

**不推荐使用**:
- 站点分布极不均匀
- 降雨空间变异性大
- 需要高精度插值
- 地形复杂

## 📊 预期结果

### 典型暴雨事件

**站点降雨量**:
- 站点1: 45 mm
- 站点2: 52 mm
- 站点3: 38 mm
- 站点4: 48 mm
- 站点5: 41 mm

**计算结果**:
- 算术平均: 44.8 mm
- Thiessen多边形: 45.3 mm
- 相对差异: 约1%

### 误差分析

**站点数量影响**:
```
3个站点: 误差 ±5-10%
5个站点: 误差 ±3-5%
8个站点: 误差 ±2-3%
```

## 🎨 可视化说明

### 图1：Thiessen多边形
- 蓝色线: 多边形边界
- 红色点: 雨量站
- 颜色填充: 降雨量大小

### 图2：降雨空间分布
- 热力图显示降雨分布
- 等值线显示降雨梯度

### 图3：敏感性分析
- x轴: 站点数量
- y轴: 计算的面雨量
- 展示收敛特性

## 📚 参考文献

1. Thiessen, A.H. (1911). Precipitation averages for large areas. Monthly Weather Review, 39(7), 1082-1089.
2. Okabe, A., et al. (2000). Spatial Tessellations: Concepts and Applications of Voronoi Diagrams. Wiley.
3. 芮孝芳. 水文学原理. 中国水利水电出版社, 2004.

## 💡 工程应用提示

1. **站点布局优化**
   - 尽量均匀分布
   - 考虑地形代表性
   - 关注降雨中心区域

2. **实际应用注意**
   - 考虑流域边界
   - 处理缺测数据
   - 质量控制检查

3. **与其他方法结合**
   - 小流域用Thiessen
   - 大流域可考虑IDW或Kriging
   - 结合雷达降雨

## 🔗 相关案例

- 案例3: IDW与Kriging空间插值对比
- 案例6: 分布式产流网格模型
- 案例11: Penman-Monteith蒸散发计算

---

**难度**: ⭐  
**所需时间**: 1-2小时  
**前置知识**: Python基础、空间几何基础

---

*提示：本案例代码可直接用于实际工程项目！*
