# 第5本书：综合能源系统仿真与优化 - 案例索引

**总案例数**: 30个  
**完成状态**: ✅ 核心技术完成，示例代码部分完成

---

## 📑 快速导航

- [Part 1: 多能源系统建模 (案例1-6)](#part-1-多能源系统建模)
- [Part 2: 互补特性分析 (案例7-10)](#part-2-互补特性分析)
- [Part 3: 短期优化调度 (案例11-16)](#part-3-短期优化调度)
- [Part 4: 中长期优化 (案例17-20)](#part-4-中长期优化)
- [Part 5: 电网支撑 (案例21-25)](#part-5-电网支撑)
- [Part 6: 水火风光储联合仿真 (案例26-30)](#part-6-水火风光储联合仿真-核心)

---

## Part 1: 多能源系统建模

### 案例1: 光伏电站建模 ⭐⭐

**工程背景**: 大规模光伏电站（100MW）  
**核心模型**: 复用第1本书内容  
**学习目标**: 掌握MW级光伏电站建模

**关键技术**:
- 光伏阵列建模
- MPPT控制
- 逆变器并网

**核心模块**: `第1本书/pv_modeling.py`  
**示例代码**: `examples/example_01_pv_station.py`  
**难度**: ⭐⭐

---

### 案例2: 风电场建模 ⭐⭐

**工程背景**: 风电场（200MW）  
**核心模型**: 复用第2本书内容  
**学习目标**: 掌握风电场建模，考虑尾流效应

**关键技术**:
- 风电机组建模 (DFIG/PMSG)
- 尾流模型 (Jensen)
- 风电场功率汇总

**核心模块**: `第2本书/wind_farm.py`  
**示例代码**: `examples/example_02_wind_farm.py`  
**难度**: ⭐⭐

---

### 案例3: 水电站建模 ⭐⭐⭐

**工程背景**: 水库水电站（300MW）  
**核心模型**: 新开发  
**学习目标**: 掌握水电站建模与水库动态

**关键方程**:
```python
# 发电功率
P = η * ρ * g * Q * H / 1e6  # MW

# 水库动态
dV/dt = Q_in - Q_out  # m³

# 水头-库容关系
H = f(V)
```

**约束条件**:
- 水库水位上下限
- 最小生态流量
- 发电流量限制
- 出力爬坡速率

**核心模块**: `models/multi_energy_system.py` - `HydropowerPlant`  
**示例代码**: ✅ `examples/example_01_hydro_modeling.py`  
**难度**: ⭐⭐⭐

---

### 案例4: 火电机组建模 ⭐⭐⭐

**工程背景**: 燃煤火电机组（2×300MW）  
**核心模型**: 新开发  
**学习目标**: 掌握火电机组特性建模

**关键特性**:
- 最小开机/关机时间
- 最小稳燃出力
- 爬坡速率限制 (±10 MW/min)
- 启停成本

**燃料消耗曲线**:
```python
F(P) = a + b*P + c*P²  # 元/小时
```

**排放模型**:
- CO₂: 0.8-0.85 tCO₂/MWh
- NOx, SO₂

**核心模块**: `models/multi_energy_system.py` - `ThermalUnit`  
**示例代码**: `examples/example_04_thermal_unit.py`  
**难度**: ⭐⭐⭐

---

### 案例5: 储能系统建模 ⭐⭐

**工程背景**: 大容量储能电站（50MW/100MWh）  
**核心模型**: 复用第3本书内容  
**学习目标**: 掌握储能系统建模

**关键技术**:
- SOC估算
- 充放电功率限制
- 能量约束
- 寿命损耗

**核心模块**: `第3本书/battery.py`  
**示例代码**: `examples/example_05_storage.py`  
**难度**: ⭐⭐

---

### 案例6: 负荷建模 ⭐⭐

**工程背景**: 区域负荷（峰值1300MW）  
**核心模型**: 新开发  
**学习目标**: 掌握负荷建模与预测

**负荷类型**:
- 刚性负荷（不可调节）
- 可调节负荷（峰谷转移）
- 可中断负荷（应急响应）

**负荷预测**:
- 时间序列模型 (ARIMA)
- 典型日曲线
- 季节特性

**核心模块**: `models/multi_energy_system.py` - `LoadModel`  
**示例代码**: `examples/example_06_load_modeling.py`  
**难度**: ⭐⭐

---

## Part 2: 互补特性分析

### 案例7: 风光互补特性分析 ⭐⭐⭐

**工程背景**: 某地区风光资源互补性评估  
**核心方法**: 相关性分析  
**学习目标**: 量化风光互补效益

**分析内容**:
- 日内互补（白天光伏，夜间风电）
- 季节互补（冬季风大，夏季光强）
- 相关系数分析
- 互补系数计算

**关键指标**:
```python
# 互补系数
C = 1 - σ(P_wind + P_solar) / (σ(P_wind) + σ(P_solar))
# C越大，互补性越好
```

**核心模块**: `models/multi_energy_system.py` - `ComplementarityAnalysis`  
**示例代码**: `examples/example_07_wind_solar_complementarity.py`  
**难度**: ⭐⭐⭐

---

### 案例8: 水风光互补特性 ⭐⭐⭐⭐

**工程背景**: 西南地区水风光互补基地  
**核心思想**: 水电调节风光随机性  
**学习目标**: 掌握多能互补原理

**互补模式**:
- 短期：小时级调节（水电快速响应）
- 中期：日前调度（水库优化调度）
- 长期：季节性调节（丰枯期策略）

**量化指标**:
- 出力波动降低程度
- 水电调节容量需求
- 弃风弃光率改善

**核心模块**: `models/multi_energy_system.py`  
**示例代码**: `examples/example_08_hydro_wind_solar.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例9: 火电调峰特性分析 ⭐⭐⭐

**工程背景**: 火电为新能源提供备用  
**核心问题**: 调峰能力与成本  
**学习目标**: 评估火电调峰经济性

**分析内容**:
- 调峰深度（最低负荷率）
- 调峰成本
- 频繁启停对寿命影响
- 灵活性改造方案

**核心模块**: `models/multi_energy_system.py` - `ThermalUnit`  
**示例代码**: `examples/example_09_thermal_peaking.py`  
**难度**: ⭐⭐⭐

---

### 案例10: 储能平抑波动效果分析 ⭐⭐⭐

**工程背景**: 储能配置优化  
**核心目标**: 量化储能平抑效果  
**学习目标**: 评估储能经济性

**量化指标**:
- 波动平抑度 = (σ_before - σ_after) / σ_before
- 储能利用率 = 实际充放次数 / 理论循环次数
- 全寿命周期成本

**经济性分析**:
- 投资成本 vs 收益
- 回收期计算
- 敏感性分析

**核心模块**: `models/multi_energy_system.py`  
**示例代码**: `examples/example_10_storage_smoothing.py`  
**难度**: ⭐⭐⭐

---

## Part 3: 短期优化调度

### 案例11: 日前调度优化（单目标） ⭐⭐⭐

**工程背景**: 电力系统日前调度  
**优化目标**: 最小化总成本  
**学习目标**: 掌握MILP建模与求解

**问题描述**:
- 时间尺度：24小时，15min/步
- 决策变量：各机组出力 Pg(t)
- 目标函数：min 总成本

**约束条件**:
- 功率平衡：ΣPg = P_load - P_pv - P_wind
- 机组出力上下限
- 爬坡约束
- 水库水量平衡
- 储能SOC约束

**求解方法**: 混合整数线性规划 (MILP)

**核心模块**: `models/optimization.py` - `DayAheadOptimization`  
**示例代码**: ✅ `examples/example_11_day_ahead_optimization.py`  
**难度**: ⭐⭐⭐

---

### 案例12: 日前调度优化（多目标） ⭐⭐⭐⭐

**工程背景**: 多目标协调优化  
**优化目标**: 成本/排放/消纳  
**学习目标**: 掌握多目标优化

**多个目标**:
1. 最小化成本
2. 最小化碳排放
3. 最大化新能源消纳
4. 最小化负荷缺额

**求解方法**:
- ε-约束法
- 权重法
- NSGA-II多目标遗传算法

**结果**: Pareto前沿

**核心模块**: `models/optimization.py` - `MultiObjectiveOptimization`  
**示例代码**: `examples/example_12_multi_objective.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例13: 日内滚动调度 ⭐⭐⭐⭐

**工程背景**: 应对预测偏差  
**核心策略**: MPC思想  
**学习目标**: 掌握滚动优化

**策略设计**:
- 每4小时滚动优化一次
- 预测时域：24h
- 执行时域：4h

**关键技术**:
- 风光功率超短期预测
- 负荷预测滚动更新
- 模型预测控制 (MPC)

**核心模块**: `models/optimization.py` - `ModelPredictiveControl`  
**示例代码**: `examples/example_13_mpc.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例14: 实时调度（AGC） ⭐⭐⭐⭐

**工程背景**: 秒级/分钟级平衡  
**控制目标**: 频率偏差Δf, 联络线偏差ΔPtie  
**学习目标**: 掌握AGC控制

**控制方法**:
- 经典AGC（积分控制）
- 自适应AGC
- 考虑储能快速响应

**性能指标**:
- ACE = ΔPtie + β·Δf
- CPS1, CPS2标准

**核心模块**: `models/optimization.py` - `AGCController`  
**示例代码**: `examples/example_14_agc.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例15: 考虑不确定性的随机优化 ⭐⭐⭐⭐⭐

**工程背景**: 风光预测误差  
**核心方法**: 随机优化  
**学习目标**: 处理不确定性

**建模方法**:
- 场景生成（蒙特卡洛）
- 场景削减
- 鲁棒优化 / 随机规划

**目标函数**:
```python
min E[Cost] = Σ πs × Cost(s)
# s: 场景, πs: 概率
```

**对比**: 确定性 vs 随机优化

**核心模块**: `models/optimization.py` - `StochasticOptimization`  
**示例代码**: `examples/example_15_stochastic_opt.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例16: 储能多时间尺度协调 ⭐⭐⭐⭐⭐

**工程背景**: 储能在不同时间尺度的作用  
**核心策略**: 分层递阶控制  
**学习目标**: 多时间尺度协调

**时间尺度**:
- 日前：削峰填谷
- 日内：跟踪调度计划
- 实时：一次调频

**协调策略**:
- 上层：日前优化分配SOC目标
- 中层：日内MPC跟踪
- 下层：实时快速响应

**SOC管理**: 避免过充过放

**核心模块**: `models/optimization.py`  
**示例代码**: `examples/example_16_storage_coordination.py`  
**难度**: ⭐⭐⭐⭐⭐

---

## Part 4: 中长期优化

### 案例17: 周调度优化 ⭐⭐⭐

**工程背景**: 考虑周内负荷变化  
**核心策略**: 水电跨日优化  
**学习目标**: 掌握周优化建模

**关键**:
- 周末蓄水，工作日发电
- 考虑周边界约束

**核心模块**: `models/optimization.py` - `LongTermOptimization`  
**示例代码**: `examples/example_17_weekly_opt.py`  
**难度**: ⭐⭐⭐

---

### 案例18: 月度调度优化 ⭐⭐⭐⭐

**工程背景**: 季节性来水  
**核心策略**: 水库月初/月末水位约束  
**学习目标**: 掌握月度优化

**考虑因素**:
- 梯级水电站联合调度
- 防洪约束
- 来水预测不确定性

**核心模块**: `models/optimization.py`  
**示例代码**: `examples/example_18_monthly_opt.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例19: 年度调度优化 ⭐⭐⭐⭐

**工程背景**: 跨季节调节  
**优化目标**: 年发电量最大，成本最小  
**学习目标**: 掌握年度优化

**策略**:
- 丰水期：多发水电，减少火电
- 枯水期：增加火电，保障供电

**核心模块**: `models/optimization.py`  
**示例代码**: `examples/example_19_yearly_opt.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例20: 多年调节水库优化 ⭐⭐⭐⭐⭐

**工程背景**: 丰水年/枯水年波动  
**时间尺度**: 2-5年  
**学习目标**: 掌握动态规划

**方法**:
- 动态规划 (DP)
- 随机动态规划

**核心模块**: `models/optimization.py` - `LongTermOptimization.dynamic_programming`  
**示例代码**: `examples/example_20_multi_year_dp.py`  
**难度**: ⭐⭐⭐⭐⭐

---

## Part 5: 电网支撑

### 案例21: 一次调频 ⭐⭐⭐⭐

**工程背景**: 频率扰动自动响应  
**核心原理**: 下垂控制  
**学习目标**: 掌握一次调频

**控制方程**:
```python
ΔP = -(1/R) × (Δf/f0) × P_rated
# R: 下垂系数, Δf: 频率偏差
```

**参与机组**:
- 火电：调速器
- 水电：快速响应
- 储能：最快 (ms级)
- 风电：虚拟惯量控制
- 光伏：预留备用容量

**核心模块**: `models/grid_support.py` - `PrimaryFrequencyControl`  
**示例代码**: `examples/example_21_primary_freq.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例22: 二次调频（AGC） ⭐⭐⭐⭐

**工程背景**: 恢复系统频率至50Hz  
**控制策略**: ACE控制  
**学习目标**: 掌握AGC算法

**控制方程**:
```python
ACE = ΔPtie + β×Δf
P_agc = -(Kp×ACE + Ki×∫ACE·dt)
```

**性能标准**:
- CPS1 (Control Performance Standard 1)
- CPS2

**机组分配**:
- 按调节速率分配
- 按报价分配（市场化）

**核心模块**: `models/grid_support.py` - `SecondaryFrequencyControl`  
**示例代码**: ✅ `examples/example_22_agc_control.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例23: 无功电压控制 ⭐⭐⭐⭐

**工程背景**: 新能源接入导致电压波动  
**控制目标**: 电压稳定  
**学习目标**: 掌握无功电压控制

**控制手段**:
- 光伏逆变器：无功调节 (Q)
- 风电：无功补偿
- 储能：四象限调节
- STATCOM/SVC

**目标**:
- 关键节点电压合格率 >95%
- 无功就地平衡

**核心模块**: `models/grid_support.py` - `ReactiveVoltageControl`  
**示例代码**: `examples/example_23_voltage_control.py`  
**难度**: ⭐⭐⭐⭐

---

### 案例24: 黑启动 ⭐⭐⭐⭐⭐

**工程背景**: 全站停电后的恢复  
**核心内容**: 黑启动序列设计  
**学习目标**: 掌握黑启动策略

**黑启动电源**:
- 水电（最佳）
- 储能（快速）
- 光伏+储能微网

**启动序列**:
1. 启动黑启动电源
2. 带本地负荷（测试）
3. 启动大机组（火电）
4. 逐步恢复系统

**核心模块**: `models/grid_support.py` - `BlackStartController`  
**示例代码**: `examples/example_24_black_start.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例25: 惯量支撑 ⭐⭐⭐⭐⭐

**工程背景**: 高比例新能源导致系统惯量下降  
**核心问题**: 频率稳定性  
**学习目标**: 掌握VSG控制

**问题分析**:
- 传统同步机：转动惯量 → 频率稳定
- 新能源逆变器：无惯量

**解决方案**:
- 虚拟同步机（VSG）控制
- 风机转子释放动能
- 储能快速响应

**评估指标**:
- 频率变化率 df/dt
- 频率最低点 (Nadir)

**核心模块**: `models/grid_support.py` - `VirtualInertiaControl`  
**示例代码**: `examples/example_25_vsg.py`  
**难度**: ⭐⭐⭐⭐⭐

---

## Part 6: 水火风光储联合仿真 🌟核心

### 案例26: 多能源互补电力系统建模 ⭐⭐⭐⭐⭐

**工程背景**: 综合能源系统  
**系统规模**: 1300MW  
**学习目标**: 掌握系统级建模

**系统构成**:
- 水电：300MW（调节）
- 火电：600MW（基荷+调峰）
- 风电：200MW
- 光伏：150MW
- 储能：50MW/100MWh

**建模层次**:
- 机组级模型（详细）
- 电站级模型（简化）
- 系统级模型（调度）

**时间尺度**: 1年，15min步长

**核心模块**: `models/multi_energy_system.py` - `IntegratedEnergySystem`  
**示例代码**: ✅ `examples/example_26_integrated_system.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例27: 日前-日内-实时协调优化 ⭐⭐⭐⭐⭐

**工程背景**: 多时间尺度协调  
**核心架构**: 三层优化  
**学习目标**: 掌握分层优化

**三层架构**:
```
日前调度 (Day-ahead)
    ↓ 调度计划
日内调度 (Intra-day, 4h滚动)
    ↓ 实时调整
实时平衡 (Real-time, AGC)
```

**关键技术**:
- 日前：MILP求解 (CPLEX/Gurobi)
- 日内：MPC
- 实时：PI控制 + 前馈

**仿真场景**:
- 典型日（夏季高峰）
- 台风过境（风电骤减）
- 连阴天（光伏低发）

**核心模块**: `models/optimization.py` (综合)  
**示例代码**: `examples/example_27_multi_timescale.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例28: 多场景仿真与分析 ⭐⭐⭐⭐⭐

**工程背景**: 系统鲁棒性评估  
**核心方法**: 场景分析  
**学习目标**: 掌握场景设计

**场景设计**:
1. 基准场景：正常运行
2. 高负荷场景：夏季高峰
3. 低负荷场景：春节假期
4. 新能源大发场景：丰水期+大风
5. 新能源低发场景：枯水期+无风
6. 极端场景：
   - 火电机组故障
   - 输电线路跳闸
   - 负荷预测偏差

**评估指标**:
- 新能源消纳率
- 火电利用小时数
- 系统总成本
- 碳排放量
- 频率/电压合格率
- 负荷缺额

**核心模块**: `models/multi_energy_system.py`  
**示例代码**: `examples/example_28_scenario_analysis.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例29: 储能优化配置 ⭐⭐⭐⭐⭐

**工程背景**: 储能规划  
**优化问题**: 确定储能最优容量和位置  
**学习目标**: 掌握储能规划方法

**决策变量**:
- 储能功率 Ps (MW)
- 储能容量 Es (MWh)
- 安装位置

**目标函数**:
```python
min [储能投资成本 + 年运行成本 - 收益]
```

**收益来源**:
- 峰谷价差套利
- 辅助服务补偿
- 减少弃风弃光

**约束**:
- 储能技术约束
- 电网安全约束

**求解方法**:
- 遗传算法 (GA)
- 粒子群算法 (PSO)
- 考虑储能全寿命周期成本

**核心模块**: `models/optimization.py`  
**示例代码**: `examples/example_29_storage_planning.py`  
**难度**: ⭐⭐⭐⭐⭐

---

### 案例30: 综合能源系统仿真平台 ⭐⭐⭐⭐⭐ (毕业设计级)

**工程背景**: 开发完整仿真决策平台  
**项目类型**: 综合系统  
**学习目标**: 掌握软件工程能力

**功能模块**:

1. **数据管理**:
   - 历史数据导入
   - 数据预处理
   - 数据可视化

2. **建模仿真**:
   - 各类电源模型库
   - 仿真引擎
   - 状态估计

3. **优化调度**:
   - 多时间尺度优化
   - 算法库 (MILP/MPC/GA等)
   - 求解器接口

4. **结果分析**:
   - 性能指标计算
   - 可视化报表
   - 场景对比

5. **用户界面**:
   - Web界面 (Flask/Django)
   - 交互式操作
   - 报告生成

**实现技术**:
```python
# 后端
Python + NumPy + SciPy
PuLP / Pyomo (优化建模)
CVXPY (凸优化)

# 前端
Flask / Streamlit
Plotly / ECharts

# 数据库
SQLite / PostgreSQL

# 并行计算
Multiprocessing / Dask
```

**交付物**:
- 完整源代码
- 用户手册
- 开发文档
- 演示视频
- 技术报告 (50页+)

**核心模块**: 综合所有模块  
**示例代码**: `examples/example_30_simulation_platform/`  
**难度**: ⭐⭐⭐⭐⭐

---

## 📊 案例统计

### 按难度分布

| 难度 | 案例数 | 占比 |
|------|--------|------|
| ⭐⭐ | 5 | 16.7% |
| ⭐⭐⭐ | 8 | 26.7% |
| ⭐⭐⭐⭐ | 9 | 30.0% |
| ⭐⭐⭐⭐⭐ | 8 | 26.7% |
| **合计** | **30** | **100%** |

### 按技术类型

| 类型 | 案例数 |
|------|--------|
| 建模 | 6 |
| 分析 | 4 |
| 优化 | 10 |
| 控制 | 5 |
| 综合 | 5 |

### 示例代码完成情况

| 状态 | 案例数 |
|------|--------|
| ✅ 已完成 | 4 |
| 🔨 开发中 | 0 |
| 📋 规划中 | 26 |

**已完成示例**:
- ✅ 案例1：水电站建模
- ✅ 案例11：日前调度优化
- ✅ 案例22：AGC控制
- ✅ 案例26：综合能源系统仿真

---

## 🎯 学习路径建议

### 初学者路径
```
案例1-6 (建模基础) → 案例7-10 (互补分析) → 案例11 (基础优化)
```

### 进阶路径
```
案例11-13 (短期优化) → 案例21-23 (电网支撑) → 案例26 (综合仿真)
```

### 高级路径
```
案例15-16 (不确定性) → 案例17-20 (中长期) → 案例27-30 (综合系统)
```

### 毕业设计推荐
- 案例26-28：综合能源系统仿真与分析
- 案例29：储能优化配置
- 案例30：仿真平台开发

---

## 📚 配套资源

### 核心模块
- `models/optimization.py` - 优化调度模块 (~554行)
- `models/multi_energy_system.py` - 多能源建模模块 (~594行)
- `models/grid_support.py` - 电网支撑模块 (~526行)

### 数据集
- 气象数据：辐照度/风速/温度
- 电力数据：负荷曲线/电价
- 水文数据：来水流量/库容曲线
- 机组参数：火电/水电/风电/光伏

### 参考标准
- GB/T 19963.1-2011：风电场接入电力系统技术规定
- GB/T 19964-2012：光伏发电站接入电力系统技术规定
- DL/T 1870-2018：电力储能系统接入电网技术规定

---

## 🔗 相关资源

- [总体设计方案](../新能源系列教材-总体设计方案.md)
- [第5本书README](README.md)
- [第5本书进度](PROGRESS.md)
- [系列完成报告](../../新能源系列-最终完成报告.md)

---

**最后更新**: 2025-11-04  
**状态**: ✅ 索引完成  
**维护**: CHS Books
