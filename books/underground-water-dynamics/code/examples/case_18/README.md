# 案例18：污染物运移模拟

**难度**: ⭐⭐⭐⭐⭐  
**前置案例**: 案例2, 案例4, 案例16  
**预计学习时间**: 6-8小时

---

## 📚 学习目标

通过本案例，你将学会：

1. ✅ 理解对流-弥散过程
2. ✅ 掌握ADE方程
3. ✅ 应用解析解
4. ✅ 分析吸附与衰减影响
5. ✅ 预测污染羽演化
6. ✅ 设计修复方案
7. ✅ 评估污染风险

---

## 🎯 物理背景

### 为什么研究污染物运移？

**现实问题**：
- 工业泄漏事故
- 垃圾填埋场渗漏
- 农药化肥污染
- 地下储罐泄漏
- 矿山废水污染

**需要回答的问题**：
1. **污染羽在哪**：空间分布
2. **扩散多快**：时间演化
3. **浓度多高**：风险评估
4. **何时到达**：预警时间
5. **如何修复**：方案设计

### 运移过程

**三大机制**：
```
1. 对流（Advection）：
   随地下水流动迁移
   
2. 弥散（Dispersion）：
   机械弥散 + 分子扩散
   
3. 反应（Reaction）：
   吸附、衰减、降解
```

**综合过程**：
```
污染源 → 对流输送 → 弥散扩散 → 吸附/衰减 → 污染羽
```

---

## 📐 理论基础

### 1. 对流-弥散方程（ADE）

**完整形式**：
```
∂C/∂t = Dx∂²C/∂x² + Dy∂²C/∂y² + Dz∂²C/∂z²
        - vx∂C/∂x - vy∂C/∂y - vz∂C/∂z
        - λC + S/R

C: 浓度 [kg/m³]
Dx,Dy,Dz: 弥散系数 [m²/day]
vx,vy,vz: 流速 [m/day]
λ: 衰减系数 [1/day]
S: 源项 [kg/m³/day]
R: 阻滞因子 [-]
```

**一维简化**：
```
∂C/∂t = D∂²C/∂x² - v∂C/∂x - λC
```

**物理意义**：
- `D∂²C/∂x²`: 弥散项（扩散）
- `-v∂C/∂x`: 对流项（平流）
- `-λC`: 衰减项（反应）

### 2. 弥散系数

**组成**：
```
D = D_mech + D_mol

D_mech: 机械弥散（主要）
D_mol: 分子扩散（次要）
```

**机械弥散**：
```
Dx = αL * vx + αT * vy  （纵向）
Dy = αT * vx + αL * vy  （横向）

αL: 纵向弥散度 [m]（通常几米到几十米）
αT: 横向弥散度 [m]（αT ≈ 0.1*αL）
```

**尺度效应**：
- 实验室：αL ~ 0.01 m
- 场地：αL ~ 1-10 m
- 区域：αL ~ 100 m

### 3. 吸附与阻滞

**线性吸附**：
```
S = Kd * C

S: 固相浓度 [kg/kg]
Kd: 分配系数 [m³/kg]
```

**阻滞因子**：
```
R = 1 + (ρb/n) * Kd

ρb: 土壤干密度 [kg/m³]
n: 孔隙度 [-]
```

**效果**：
```
v_eff = v / R  （有效速度降低）
D_eff = D / R  （有效弥散降低）
```

**非线性吸附**：

1. **Freundlich**：
   ```
   S = Kf * C^n
   n < 1: 吸附随浓度降低
   ```

2. **Langmuir**：
   ```
   S = (Qmax * b * C) / (1 + b * C)
   Qmax: 最大吸附量
   ```

### 4. 衰减动力学

**一级动力学**：
```
dC/dt = -λC

C(t) = C0 * exp(-λt)
```

**半衰期**：
```
t1/2 = ln(2) / λ
```

**来源**：
- 生物降解
- 化学反应
- 放射性衰变

### 5. 解析解

**Ogata-Banks**（一维，连续源）：
```
C(x,t) = (C0/2) * [erfc((x-vt/R)/(2√(Dt/R))) + 
                   exp(vx/D) * erfc((x+vt/R)/(2√(Dt/R)))]
```

**二维瞬时点源**：
```
C(x,y,t) = (M / (4πt√(Dx*Dy))) * 
           exp(-((x-vx*t)²/(4Dx*t) + (y-vy*t)²/(4Dy*t)))
```

### 6. Peclet数

**定义**：
```
Pe = vL / D

L: 特征长度
```

**意义**：
- Pe >> 1: 对流主导
- Pe << 1: 弥散主导
- Pe ≈ 1: 两者都重要

---

## 💻 代码实现

### 解析解

```python
def ogata_banks_solution(x, t, C0, v, D, R=1.0):
    """
    Ogata-Banks解（一维连续源）
    """
    from scipy import special
    
    v_eff = v / R
    D_eff = D / R
    
    term1 = special.erfc((x - v_eff * t) / (2 * np.sqrt(D_eff * t)))
    term2 = np.exp(v * x / D) * special.erfc((x + v_eff * t) / (2 * np.sqrt(D_eff * t)))
    
    C = (C0 / 2) * (term1 + term2)
    return C
```

### 吸附

```python
def retardation_factor(rho_b, n, Kd):
    """阻滞因子"""
    R = 1 + (rho_b / n) * Kd
    return R

# 示例
rho_b = 1500  # kg/m³
n = 0.3
Kd = 0.005  # m³/kg

R = retardation_factor(rho_b, n, Kd)
print(f"阻滞因子: {R:.2f}")  # 26
print(f"速度降低为原来的: {1/R:.3f}")  # 0.038
```

### 数值求解

```python
def solve_ade_1d_implicit(C0, dx, dt, n_steps, v, D):
    """
    隐式求解一维ADE
    
    使用Crank-Nicolson格式
    """
    nx = len(C0)
    C_history = np.zeros((n_steps + 1, nx))
    C_history[0, :] = C0
    
    # Courant数
    Cr = v * dt / dx
    Cd = D * dt / dx**2
    
    # 构建系数矩阵...
    # 求解线性方程组...
    
    return C_history
```

---

## 📊 运行案例

### 执行命令

```bash
cd code/examples/case_18
python3 case_18_contaminant_transport.py
```

### 预期输出（节选）

```
============================================================
案例18：污染物运移模拟
============================================================

实验1：一维对流-弥散解析解
============================================================

参数：
  流速 v = 0.5 m/day
  弥散系数 D = 0.1 m²/day
  时间 t = 50 day

Peclet数：
  Pe = vL/D = 5.0
  对流和弥散都重要

连续源（Ogata-Banks）：
  边界浓度 C0 = 100 kg/m³
  中心位置 x ≈ 25.0 m
  最大浓度 99.9 kg/m³

瞬时源：
  总质量 M = 10 kg
  中心位置 x ≈ 25.0 m
  峰值浓度 1.26 kg/m³

实验2：吸附作用影响
============================================================

土壤参数：
  干密度 ρb = 1500 kg/m³
  孔隙度 n = 0.3

不同吸附强度的影响：
Kd (m³/kg)      阻滞因子R        速度(m/day)    
---------------------------------------------
0.000           1.00            0.500          
0.001           6.00            0.083          
0.005           26.00           0.019          
0.010           51.00           0.010          

物理意义：
  Kd=0: 无吸附，保守运移
  Kd↑: 阻滞因子R↑，运移速度↓
  吸附作用延缓污染扩散

实验3：衰减作用影响
============================================================

衰减动力学：
  C(t) = C0 * exp(-λt)
  半衰期 t1/2 = ln(2)/λ

不同衰减系数的影响：
λ (1/day)       半衰期(day)     最大浓度       
---------------------------------------------
0.00            inf             99.9           
0.01            69.3            60.6           
0.05            13.9            8.2            
0.10            6.9             0.7            

应用：
  生物降解：λ较大
  放射性衰变：λ固定
  化学反应：λ取决于条件

实验4：二维污染羽演化
============================================================

参数：
  流速 vx = 0.5 m/day
  纵向弥散度 αL = 5.0 m
  横向弥散度 αT = 0.5 m
  Dx = 2.51 m²/day
  Dy = 0.26 m²/day

污染羽特征：
时间(day)    中心x(m)     长度(m)      宽度(m)     
------------------------------------------------
10           5.0          20.0         6.5         
30           15.0         34.6         11.2        
50           25.0         44.7         14.4        
100          50.0         63.2         20.4        

特征：
  污染羽沿流向拉长
  纵向扩散 > 横向扩散
  浓度峰值随时间降低

实验6：抽取修复方案
============================================================

污染状况：
  时间：t = 50 day
  饮用水井位置：(40, 5)
  井处浓度：0.0234 kg/m³
  标准限值：0.0100 kg/m³
  ⚠️ 超标2.3倍！需要修复

修复方案设计：
1. 抽取修复（Pump & Treat）
   - 在污染源设置抽水井
   - 形成捕获带，拦截污染羽
   - 处理抽出的污染水

2. 监测自然衰减（MNA）
   - 依靠自然衰减过程
   - 定期监测
   - 适用于低风险情况

3. 反应墙（PRB）
   - 在污染羽前方设置反应墙
   - 原位处理
   - 被动修复

✅ 案例18执行完成！

🎉🎉🎉 第四篇全部完成！🎉🎉🎉
```

### 生成图片

程序会生成 `case_18_contaminant_transport_results.png`，包含9个子图：

1. **一维解析解**（连续源vs瞬时源）
2. **吸附作用影响**（不同Kd）
3. **衰减作用影响**（不同λ）
4-7. **二维污染羽演化**（4个时刻）
8. **数值稳定性**（不同时间步长）
9. **修复方案设计**（污染羽与饮用水井）

---

## 📈 结果分析

### 1. 对流vs弥散

**Peclet数分析**：
- Pe = 5: 对流和弥散都重要
- 污染羽既向前推进（对流），又横向扩展（弥散）

**特征**：
- 对流：确定性输送
- 弥散：随机性扩展
- 合力：拉长的椭圆羽

### 2. 吸附的巨大影响

**Kd从0增到0.01**：
- R从1增到51
- 速度降低50倍！
- 污染羽大幅延缓

**工程意义**：
- 粘土层：Kd大，天然屏障
- 砂层：Kd小，快速运移
- 原位修复：增强吸附

### 3. 衰减的关键作用

**λ=0.05 (t1/2≈14天)**：
- 50天后浓度降至8%
- 长期预测：污染自然消退

**应用**：
- 生物降解污染物：λ大，可等待
- 持久性污染物：λ≈0，必须修复
- 放射性污染：λ固定，可预测

### 4. 二维污染羽形态

**特征尺度**：
```
长度 L ∝ 4√(Dx*t)
宽度 W ∝ 4√(Dy*t)

长宽比 L/W = √(Dx/Dy) ≈ 3
```

**演化规律**：
- 尺度 ∝ √t（扩散）
- 中心 = vx*t（对流）
- 峰值 ∝ 1/t（质量守恒）

### 5. 数值稳定性

**稳定性条件**：
- Courant数 Cr = v*dt/dx ≤ 1
- 扩散数 Cd = D*dt/dx² ≤ 0.5

**隐式方法优势**：
- 无条件稳定
- 可用大时间步长
- 计算高效

### 6. 修复方案

**Pump & Treat**：
- 优点：可靠，适用范围广
- 缺点：成本高，时间长

**MNA**：
- 优点：成本低
- 缺点：慢，需长期监测

**PRB**：
- 优点：原位，被动
- 缺点：仅适用特定污染物

---

## 🔬 实验探索

### 实验1: 不同Peclet数

**目标**：理解对流-弥散相对重要性

```python
Pe_values = [0.1, 1, 10, 100]

for Pe in Pe_values:
    D = v * L / Pe
    C = ogata_banks_solution(x, t, C0, v, D)
    # 分析形态
```

**预期**：
- Pe小：宽缓，弥散主导
- Pe大：陡峭，对流主导

### 实验2: 非线性吸附

**目标**：对比线性vs非线性吸附

```python
# Freundlich
S_freundlich = Kf * C**n

# Langmuir
S_langmuir = (Qmax * b * C) / (1 + b * C)

# 对比阻滞效应
```

**预期**：
- 高浓度：非线性饱和
- 低浓度：接近线性

### 实验3: 多点源叠加

**目标**：模拟多个污染源

```python
sources = [
    (x1, y1, M1),
    (x2, y2, M2),
]

C_total = sum(analytical_2d(xi, yi, Mi) for xi, yi, Mi in sources)
```

**预期**：
- 污染羽合并
- 总浓度叠加

### 实验4: 捕获带分析

**目标**：设计抽水井捕获污染羽

```python
# 抽水井在(x_well, y_well)，流量Q
# 计算捕获宽度
W_capture = Q / (n * b * v)

# 需要：W_capture > 污染羽宽度
```

---

## 🤔 常见问题

### Q1: 为什么需要阻滞因子？

**A**: 吸附改变运移速度

**物理过程**：
1. 污染物在液相（孔隙水）和固相（土粒）间分配
2. 固相吸附 → 减缓液相运移
3. 表观速度降低

**数学描述**：
```
总质量 = 液相 + 固相
       = nC + ρb*S
       = nC + ρb*Kd*C
       = nC(1 + ρb*Kd/n)
       = nRC
```

### Q2: 如何选择弥散度？

**A**: 尺度依赖，经验估计

**文献值**：
- 实验室（cm）：αL ~ 0.001-0.01 m
- 场地（m）：αL ~ 1-10 m
- 区域（km）：αL ~ 100-1000 m

**经验关系**：
```
αL ≈ 0.1 * L_scale

αT ≈ 0.1 * αL
```

**确定方法**：
- 示踪试验
- 参数反演
- 经验公式

### Q3: 数值方法vs解析解？

**A**: 各有优劣

**解析解**：
- 优点：精确、快速、洞察
- 缺点：限制条件多

**数值方法**：
- 优点：灵活，复杂边界
- 缺点：耗时，可能不稳定

**使用建议**：
- 初步分析：解析解
- 详细设计：数值方法
- 相互验证

### Q4: 如何估计半衰期？

**A**: 多种方法

**实验室测定**：
- 生物降解试验
- 化学反应动力学
- 最准确

**文献查询**：
- 典型污染物的λ值
- 参考值

**现场监测**：
- 浓度时间序列
- 拟合指数曲线
- C(t) = C0 * exp(-λt)

**典型值**：
- 石油烃：λ ~ 0.001-0.1 /day
- 有机溶剂：λ ~ 0.01-0.5 /day
- 重金属：λ ≈ 0（保守）

### Q5: 修复需要多长时间？

**A**: 取决于多个因素

**Pump & Treat**：
- 通常需要几年到几十年
- 不对称性：抽取易，清洁难
- 尾效应：残余浓度难降

**估算**：
```
清洁时间 ≈ V / Q * ln(C0 / C_target)

V: 污染体积
Q: 抽水流量
```

**加速策略**：
- 增加抽水井
- 提高流量
- 原位增强（表面活性剂）

---

## 📚 扩展阅读

### 经典文献

1. **Ogata, A. and Banks, R.B. (1961)**. "A solution of the differential equation of longitudinal dispersion in porous media". USGS Prof. Paper 411-A.
   - Ogata-Banks解
   - ADE基础

2. **Bear, J. (1972)**. Dynamics of Fluids in Porous Media. Dover.
   - 第10章：Transport phenomena
   - 理论全面

3. **Zheng, C. and Bennett, G.D. (2002)**. Applied Contaminant Transport Modeling (2nd ed.). Wiley.
   - 实用指南
   - MT3DMS软件

### 软件工具

1. **MT3DMS**：
   - 污染运移模拟
   - 与MODFLOW耦合
   - 工业标准

2. **PHREEQC**：
   - 地球化学反应
   - 运移+反应
   - 开源

3. **Python工具**：
   - `flopy`: MODFLOW+MT3D接口
   - 本案例的`gwflow.transport`

### 案例研究

1. **Love Canal** (NY, USA)：
   - 化学废物场污染
   - 大规模修复
   - 历史教训

2. **Woburn** (MA, USA)：
   - 工业溶剂污染
   - 法律诉讼案例
   - "民事诉讼"电影

3. **深圳大亚湾**（中国）：
   - 地下水污染修复
   - 原位化学氧化
   - 成功案例

---

## ✅ 学习检查

完成本案例后，你应该能够：

- [ ] 写出对流-弥散方程
- [ ] 解释对流、弥散、反应机制
- [ ] 应用解析解求解简单问题
- [ ] 计算阻滞因子
- [ ] 分析吸附和衰减影响
- [ ] 预测污染羽空间分布
- [ ] 估计污染物到达时间
- [ ] 设计抽取修复方案
- [ ] 评估数值稳定性
- [ ] 进行风险评估

---

## 🎊 第四篇完成总结

**恭喜！完成案例18，第四篇全部完成！**

你已经掌握了人类活动对地下水影响的定量评估：
- ✅ 地下水开采优化（案例16）
- ✅ 地面沉降预测（案例17）
- ✅ 污染运移模拟（案例18）

**完整的应用评估能力**！

---

## 🚀 下一步

**第五篇：智能化与数字孪生**（案例19-20）

将学习：
- 数字孪生架构
- 数据同化
- 机器学习代理模型
- 智能决策支持系统

**最后两个案例，即将完成全书！** 🎉

---

**Happy Transport Modeling! 💧🧪**
