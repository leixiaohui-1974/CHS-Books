# 第四篇设计方案：人类活动影响评估

**版本**: v1.0  
**创建日期**: 2025-11-02  
**目标版本**: v0.8.0-release

---

## 📋 总体目标

### 核心目标

构建**人类活动对地下水系统影响的定量评估体系**，重点包括：

1. **地下水开采**：抽水井模拟与优化管理
2. **地面沉降**：固结压缩与沉降预测
3. **污染运移**：污染物迁移转化模拟

### 能力目标

学生完成本篇后应该能够：
- ✅ 模拟抽水井及多井系统
- ✅ 优化地下水开采方案
- ✅ 预测地面沉降
- ✅ 模拟污染物运移
- ✅ 评估人类活动的环境影响
- ✅ 设计地下水管理策略

---

## 📚 三个案例详细设计

### 案例16：地下水开采优化 ⭐⭐⭐⭐⭐

**难度**: ⭐⭐⭐⭐⭐  
**预计学习时间**: 6-8小时  
**代码量**: ~800行  
**文档量**: ~10,000字

#### 学习目标

1. 理解抽水井水力学
2. 掌握Theis解析解
3. 应用叠加原理
4. 优化开采方案
5. 考虑约束条件

#### 物理场景

**问题描述**：
某含水层计划新建多个抽水井，需要：
- 确定合理的抽水量
- 评估对周边水位的影响
- 优化井位布置
- 满足生态水位约束

**关键要素**：
- 含水层参数（T, S）
- 抽水井参数（位置、流量）
- 边界条件（河流、湖泊）
- 约束条件（最小水位、最大降深）

#### 理论基础

**1. Theis解（瞬态）**

非稳定流井流方程：
```
s(r,t) = (Q / 4πT) * W(u)

u = r²S / 4Tt

W(u) = ∫[u,∞] (e^(-x) / x) dx  (井函数)
```

**2. Cooper-Jacob近似**

当u < 0.01时（大时间/小距离）：
```
s = (Q / 4πT) * ln(2.25Tt / r²S)
```

**3. Thiem解（稳态）**

稳定流井流方程：
```
s(r) = (Q / 2πT) * ln(R / r)

R: 影响半径
```

**4. 叠加原理**

多井系统：
```
s_total(x,y,t) = Σ s_i(x,y,t)

每个井独立贡献
```

**5. 优化问题**

目标函数：
```
max Σ Q_i  (总开采量)

约束条件：
  h(x,y) ≥ h_min  (最小水位)
  Q_i ≥ 0         (非负)
  Q_i ≤ Q_max,i   (单井上限)
```

#### 代码实现计划

**gwflow/pumping 模块**（新建）：

1. **wells.py** (~200行)
   ```python
   class PumpingWell:
       """抽水井类"""
       def __init__(self, x, y, Q, r_well):
           pass
       
       def theis_drawdown(self, r, t, T, S):
           """Theis解"""
           pass
       
       def cooper_jacob_drawdown(self, r, t, T, S):
           """Cooper-Jacob近似"""
           pass
       
       def thiem_drawdown(self, r, T, R):
           """Thiem稳态解"""
           pass
   
   class WellField:
       """井群管理"""
       def __init__(self):
           self.wells = []
       
       def add_well(self, well):
           pass
       
       def compute_total_drawdown(self, x, y, t, T, S):
           """叠加计算"""
           pass
   ```

2. **analytical.py** (~150行)
   ```python
   def theis_well_function(u):
       """Theis井函数W(u)"""
       pass
   
   def theis_solution(r, t, Q, T, S):
       """完整Theis解"""
       pass
   
   def cooper_jacob_solution(r, t, Q, T, S):
       """Cooper-Jacob解"""
       pass
   
   def thiem_solution(r, Q, T, R):
       """Thiem解"""
       pass
   
   def superposition_principle(wells, x, y, t, T, S):
       """叠加原理"""
       pass
   ```

3. **optimization.py** (~250行)
   ```python
   def optimize_pumping_rates(
       well_locations,
       T, S,
       h0,
       h_min,
       Q_max,
       constraint_points
   ):
       """优化抽水量"""
       # 线性规划或非线性优化
       pass
   
   def optimize_well_locations(
       n_wells,
       feasible_region,
       total_demand,
       T, S,
       constraints
   ):
       """优化井位"""
       pass
   ```

**案例代码**：case_16_pumping_optimization.py (~800行)

实验内容：
1. 单井Theis解与Cooper-Jacob对比
2. 多井系统降落漏斗
3. 井间干扰分析
4. 抽水量优化（线性规划）
5. 井位优化（遗传算法）
6. 考虑河流边界的开采优化

#### 可视化

9-12个子图：
1. 单井降深vs时间
2. 单井降深vs距离
3. Theis vs Cooper-Jacob对比
4. 多井降落漏斗2D
5. 多井降落漏斗3D
6. 井间干扰分析
7. 优化前后水位对比
8. 约束满足情况
9. 不同方案对比
10. 敏感性分析
11. 影响半径分析
12. 时间演化动画（optional）

---

### 案例17：地面沉降模拟

**难度**: ⭐⭐⭐⭐  
**预计学习时间**: 5-7小时  
**代码量**: ~650行  
**文档量**: ~9,000字

#### 学习目标

1. 理解Terzaghi固结理论
2. 计算有效应力变化
3. 预测地面沉降
4. 评估沉降风险
5. 分析时间过程

#### 物理场景

**问题描述**：
由于地下水过度开采，地下水位下降导致：
- 有效应力增加
- 土层压缩
- 地面沉降
- 工程损害

**关键要素**：
- 水位变化历史
- 土层参数（压缩系数、厚度）
- 先期固结压力
- 压缩模量

#### 理论基础

**1. Terzaghi有效应力原理**

总应力 = 有效应力 + 孔隙水压力
```
σ = σ' + u

Δσ' = -Δu  (排水条件)
```

水位下降 → 孔压降低 → 有效应力增加 → 压缩

**2. 压缩变形**

压缩量：
```
ΔH = Δε * H

Δε = av * Δσ'  (线性)
Δε = Cc / (1+e0) * log(σ'_f / σ'_0)  (对数)

av: 压缩系数
Cc: 压缩指数
```

**3. 先期固结**

- 正常固结：σ'_0 = σ'_c
- 超固结：σ'_0 < σ'_c
- 再压缩 vs 正常压缩

**4. 多层土层**

总沉降：
```
S = Σ ΔH_i  (各层叠加)
```

**5. 固结时间过程**

Terzaghi一维固结方程：
```
∂u/∂t = Cv * ∂²u/∂z²

Cv = k / (γw * mv)  (固结系数)
```

固结度：
```
U(t) = 1 - Σ (2/M²) * exp(-M² * Tv)

Tv = Cv*t / H²  (时间因子)
```

#### 代码实现计划

**gwflow/subsidence 模块**（新建）：

1. **consolidation.py** (~250行)
   ```python
   class SoilLayer:
       """土层类"""
       def __init__(self, top, bottom, av, Cc, e0, sigma_c):
           pass
       
       def compute_compression(self, delta_sigma):
           """计算压缩量"""
           pass
   
   def terzaghi_consolidation_1d(
       u0, z, t, Cv, drainage
   ):
       """1D固结解析解"""
       pass
   
   def consolidation_degree(Tv):
       """固结度U(t)"""
       pass
   ```

2. **subsidence_model.py** (~250行)
   ```python
   class SubsidenceModel:
       """沉降模型"""
       def __init__(self, layers):
           self.layers = layers
       
       def compute_head_change(self, gw_model, scenario):
           """计算水位变化"""
           pass
       
       def compute_stress_change(self, head_change):
           """有效应力变化"""
           pass
       
       def compute_subsidence(self, stress_change):
           """计算沉降"""
           pass
       
       def time_series_simulation(self, head_history):
           """时间序列模拟"""
           pass
   ```

**案例代码**：case_17_subsidence.py (~650行)

实验内容：
1. 单层土压缩计算
2. 多层土总沉降
3. 正常固结vs超固结
4. 固结时间过程
5. 开采情景分析
6. 沉降风险评估

#### 可视化

8-10个子图：
1. 水位变化历史
2. 有效应力变化
3. 各层压缩量
4. 总沉降vs时间
5. 固结度vs时间
6. 沉降空间分布2D
7. 不同情景对比
8. 风险区划
9. e-logσ'曲线
10. 固结等时线

---

### 案例18：污染物运移模拟 ⭐⭐⭐⭐⭐

**难度**: ⭐⭐⭐⭐⭐  
**预计学习时间**: 6-8小时  
**代码量**: ~850行  
**文档量**: ~11,000字

#### 学习目标

1. 理解对流-弥散方程
2. 模拟污染羽演化
3. 考虑吸附与衰减
4. 设计修复方案
5. 评估污染风险

#### 物理场景

**问题描述**：
某地发生地下水污染事故，需要：
- 预测污染羽扩散
- 评估饮用水井风险
- 设计抽取修复方案
- 估计修复时间

**关键要素**：
- 污染源（位置、浓度、持续时间）
- 地下水流场
- 污染物性质（扩散系数、衰减系数）
- 土壤性质（吸附系数）

#### 理论基础

**1. 对流-弥散方程（ADE）**

二维：
```
∂C/∂t = Dx*∂²C/∂x² + Dy*∂²C/∂y² - vx*∂C/∂x - vy*∂C/∂y - λC + R*S

C: 浓度
Dx, Dy: 弥散系数
vx, vy: 流速
λ: 衰减系数
R: 阻滞因子
S: 源汇项
```

**2. 弥散系数**

水动力弥散：
```
Dx = αL*vx + αT*vy + D*
Dy = αT*vx + αL*vy + D*

αL: 纵向弥散度
αT: 横向弥散度
D*: 分子扩散系数
```

**3. 阻滞因子**

吸附作用：
```
R = 1 + (ρb/n) * Kd

ρb: 土壤密度
n: 孔隙度
Kd: 分配系数（线性吸附）
```

**4. 衰减**

一级动力学：
```
∂C/∂t|_decay = -λC

C(t) = C0 * exp(-λt)

半衰期：t_1/2 = ln(2) / λ
```

**5. 解析解**

1D连续点源（稳态）：
```
C(x) = (C0 / 2) * exp((x - x0) / (2αL)) * erfc((x - x0) / (2√(αL*x)))
```

2D瞬时点源：
```
C(x,y,t) = (M / (4πt√(Dx*Dy))) * 
           exp(-((x-vx*t)²/(4Dx*t) + y²/(4Dy*t))) *
           exp(-λt)

M: 总质量
```

#### 代码实现计划

**gwflow/transport 模块**（新建）：

1. **advection_dispersion.py** (~300行)
   ```python
   class ADESolver:
       """对流-弥散求解器"""
       def __init__(self, grid, flow_field):
           pass
       
       def solve_implicit(self, C0, dt, n_steps, D, v, lambda_, R, source):
           """隐式求解"""
           # 使用有限差分或有限体积
           pass
       
       def solve_explicit(self, C0, dt, n_steps, D, v, lambda_, R, source):
           """显式求解（可能不稳定）"""
           pass
   ```

2. **analytical.py** (~200行)
   ```python
   def analytical_1d_continuous(x, t, C0, v, D, lambda_=0):
       """1D连续源解析解"""
       pass
   
   def analytical_2d_instantaneous(x, y, t, M, vx, vy, Dx, Dy, lambda_=0):
       """2D瞬时源解析解"""
       pass
   
   def ogata_banks_solution(x, t, C0, v, D, R=1):
       """Ogata-Banks解（1D脉冲）"""
       pass
   ```

3. **sorption.py** (~100行)
   ```python
   def retardation_factor(rho_b, n, Kd):
       """阻滞因子"""
       pass
   
   def linear_sorption(C, Kd):
       """线性吸附"""
       pass
   
   def freundlich_sorption(C, Kf, n):
       """Freundlich非线性吸附"""
       pass
   
   def langmuir_sorption(C, Qmax, b):
       """Langmuir吸附"""
       pass
   ```

4. **remediation.py** (~150行)
   ```python
   def pump_and_treat_optimization(
       contamination_field,
       well_locations,
       pump_rates,
       target_cleanup_level,
       max_time
   ):
       """抽取修复优化"""
       pass
   
   def capture_zone_analysis(wells, flow_field):
       """捕获带分析"""
       pass
   ```

**案例代码**：case_18_contaminant_transport.py (~850行)

实验内容：
1. 1D对流-弥散解析解验证
2. 2D污染羽演化
3. 吸附作用影响
4. 衰减作用影响
5. 数值方法稳定性
6. 抽取修复方案设计
7. 风险评估

#### 可视化

10-12个子图：
1. 1D浓度剖面vs时间
2. 解析解vs数值解对比
3. 污染羽2D演化（多时刻）
4. 浓度等值线图
5. 吸附影响对比
6. 衰减影响对比
7. 抽取井捕获带
8. 修复方案效果
9. 风险区划图
10. 饮用水井风险曲线
11. 修复时间预测
12. 敏感性分析

---

## 💻 代码架构

### 新增模块总览

```
gwflow/
├── pumping/              # 新增：抽水井
│   ├── __init__.py
│   ├── wells.py         # 井类与井群
│   ├── analytical.py    # 解析解
│   └── optimization.py  # 开采优化
├── subsidence/           # 新增：沉降
│   ├── __init__.py
│   ├── consolidation.py # 固结理论
│   └── subsidence_model.py
└── transport/            # 新增：运移
    ├── __init__.py
    ├── advection_dispersion.py
    ├── analytical.py
    ├── sorption.py
    └── remediation.py
```

### 预计代码量

```
gwflow/pumping/          ~600行
gwflow/subsidence/       ~500行
gwflow/transport/        ~750行
───────────────────────────────
模块总计                 ~1,850行

案例代码：
case_16                  ~800行
case_17                  ~650行
case_18                  ~850行
───────────────────────────────
案例总计                 ~2,300行

总计                     ~4,150行
```

### 文档量

```
案例16 README            ~10,000字
案例17 README            ~9,000字
案例18 README            ~11,000字
设计方案                 ~8,000字（本文档）
完成总结                 ~10,000字
───────────────────────────────────────
总计                     ~48,000字
```

---

## 📚 理论深度

### 对标国际

| 软件/课程 | 本教材覆盖 | 备注 |
|-----------|-----------|------|
| MODFLOW WEL Package | ✅ 完整 | 抽水井模拟 |
| MT3DMS | ✅ 核心功能 | 污染运移 |
| MODFLOW SUB Package | 🔶 简化版 | 沉降基本原理 |
| Visual MODFLOW | ✅ 主要功能 | 可视化与优化 |
| HYDRUS | 🔶 部分 | 非饱和带暂不涉及 |

### 知识覆盖

**水文地质**：
- ✅ 井流理论（Theis, Cooper-Jacob, Thiem）
- ✅ 叠加原理
- ✅ 影响半径
- ✅ 井间干扰

**土力学**：
- ✅ Terzaghi固结理论
- ✅ 有效应力原理
- ✅ 压缩特性
- ✅ 固结度

**环境水文地质**：
- ✅ 对流-弥散方程
- ✅ 吸附理论
- ✅ 衰减动力学
- ✅ 修复技术

**优化理论**：
- ✅ 线性规划（LP）
- ✅ 非线性规划（NLP）
- ✅ 遗传算法（GA）
- ✅ 约束优化

---

## 🎯 学习成果

### 完成本篇后的能力

**基础能力**：
- [x] 模拟单井和多井系统
- [x] 应用Theis等解析解
- [x] 理解地面沉降机理
- [x] 模拟污染物运移

**高级能力**：
- [x] 优化地下水开采方案
- [x] 预测地面沉降风险
- [x] 设计污染修复方案
- [x] 评估人类活动影响
- [x] 进行多目标优化

**工程能力**：
- [x] 水源地规划
- [x] 开采管理
- [x] 沉降风险评估
- [x] 污染应急响应
- [x] 修复方案设计

---

## 🚀 实施计划

### 开发顺序

**Week 1-1.5**：案例16（抽水井优化）
- Day 1-2: gwflow/pumping模块
- Day 3-4: 案例代码
- Day 5-6: 文档与测试
- Day 7: 调试与完善

**Week 2-2.5**：案例17（地面沉降）
- Day 1-2: gwflow/subsidence模块
- Day 3-4: 案例代码
- Day 4-5: 文档与测试

**Week 3-3.5**：案例18（污染运移）
- Day 1-2: gwflow/transport模块
- Day 3-5: 案例代码
- Day 6-7: 文档与测试

**Week 4**：总结与优化
- Day 1-2: 第四篇完成总结
- Day 3-4: 代码优化
- Day 5: 整合测试

**总计**：约4周

---

## ✅ 质量标准

### 代码质量

- [ ] 完整类型注解
- [ ] 详细Docstrings
- [ ] 单元测试（关键函数）
- [ ] 与解析解对比验证
- [ ] 数值稳定性检查

### 文档质量

- [ ] 理论推导完整
- [ ] 代码逐行讲解
- [ ] 结果分析透彻
- [ ] 扩展实验建议
- [ ] 常见问题解答

### 教学效果

- [ ] 案例独立可运行
- [ ] 10-20分钟完成
- [ ] 可视化直观
- [ ] 难度递进合理
- [ ] 实际问题导向

---

## 🎓 教学建议

### 课程安排

**研究生专题课（24学时）**：
```
第1-2次：案例16（抽水井）
第3次：  案例17（沉降）
第4-5次：案例18（污染）
第6次：  综合项目
```

### 作业设计

**基础作业**：
1. 运行所有案例
2. 修改参数观察结果
3. 回答思考题

**进阶作业**：
1. 完成实验探索
2. 应用到新问题
3. 对比不同方法

**大作业**：
某地区地下水管理综合方案：
- 开采规划
- 沉降预测
- 污染风险评估
- 管理策略建议

---

## 📈 预期成果

### v0.8.0-release

**完成标志**：
- ✅ 案例16-18全部完成
- ✅ 3个新模块开发完成
- ✅ ~4,150行新代码
- ✅ ~48,000字新文档
- ✅ 所有案例可运行

**整体进度**：
- 完成案例：18/20 (90%)
- 代码总量：~14,900行
- 文档总量：~200,000字

---

## 🔗 与前三篇的衔接

### 知识依赖

**案例16** 依赖：
- 案例2: 2D网格（井位布置）
- 案例4: 瞬态模拟（时间演化）
- 案例10: 优化方法（方案优化）

**案例17** 依赖：
- 案例1-4: 地下水流动（水位变化）
- 案例11-12: 耦合系统（固结）
- 案例15: 不确定性（风险评估）

**案例18** 依赖：
- 案例2-4: 数值方法（ADE求解）
- 案例11-15: 耦合系统（流场）
- 案例16: 抽水井（修复方案）

### 技能递进

```
第一篇：基础建模能力
   ↓
第二篇：参数识别能力
   ↓
第三篇：耦合系统能力
   ↓
第四篇：应用评估能力 ← 当前
   ↓
第五篇：智能管理能力
```

---

## 💡 创新点

### 1. 三位一体设计

```
开采 → 沉降 → 污染
 ↓      ↓      ↓
都是人类活动的不同影响方面
可以综合评估
```

### 2. 优化导向

不仅模拟，更要优化：
- 开采方案优化
- 修复方案设计
- 风险管理策略

### 3. 实际问题驱动

每个案例都对应真实工程问题：
- 水源地规划
- 城市沉降
- 污染应急

---

## 🎊 总结

第四篇将使学生具备：
- **完整的地下水管理能力**
- **定量评估人类活动影响**
- **设计管理和修复方案**

是从**理论学习**到**工程应用**的关键桥梁！

---

**准备开始实施！Let's Build Phase 4! 🚀**

---

**文档版本**: v1.0  
**创建日期**: 2025-11-02  
**作者**: gwflow开发团队
