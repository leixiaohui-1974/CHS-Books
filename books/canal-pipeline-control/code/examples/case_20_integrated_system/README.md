# æ¡ˆä¾‹20ï¼šå—æ°´åŒ—è°ƒå·¥ç¨‹æ•°å­—å­ªç”Ÿç³»ç»Ÿ

## æ¦‚è¿°

æœ¬æ¡ˆä¾‹å®ç°ä¸€ä¸ª**å®Œæ•´çš„æ•°å­—å­ªç”Ÿç³»ç»Ÿ**ï¼Œä»¥å—æ°´åŒ—è°ƒä¸­çº¿å·¥ç¨‹ä¸ºèƒŒæ™¯ï¼Œé›†æˆäº†å‰é¢19ä¸ªæ¡ˆä¾‹çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œå±•ç¤ºäº†ç°ä»£æ°´åˆ©å·¥ç¨‹çš„æ™ºèƒ½åŒ–ç®¡ç†ä½“ç³»ã€‚

**å—æ°´åŒ—è°ƒä¸­çº¿å·¥ç¨‹ç®€ä»‹**ï¼š
- çº¿è·¯é•¿åº¦ï¼š1432å…¬é‡Œï¼ˆä¸¹æ±Ÿå£æ°´åº“ â†’ åŒ—äº¬ï¼‰
- è¾“æ°´èƒ½åŠ›ï¼š95äº¿ç«‹æ–¹ç±³/å¹´
- æ ¸å¿ƒç‰¹å¾ï¼šå…¨ç¨‹è‡ªæµè¾“æ°´ã€æ˜æ¸ +æš—æ¶µ+å€’è™¹å¸ç»„åˆã€å¤šçº§æ³µç«™æå‡
- å·¥ç¨‹è§„æ¨¡ï¼š64åº§é—¸é—¨ã€97åº§æ¡¥æ¢ã€27åº§å€’è™¹å¸ã€7åº§æ³µç«™

## æŠ€æœ¯æ¶æ„

### 1. ç³»ç»Ÿåˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å†³ç­–å±‚ï¼ˆOptimization Layerï¼‰                â”‚
â”‚    - è°ƒåº¦ä¼˜åŒ–ï¼ˆæ°´èµ„æºåˆ†é…ã€æ³µç«™èŠ‚èƒ½ï¼‰                      â”‚
â”‚    - é£é™©è¯„ä¼°ï¼ˆæ°´è´¨ã€æµé‡ã€å‹åŠ›é¢„è­¦ï¼‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             åè°ƒå±‚ï¼ˆCoordination Layerï¼‰                 â”‚
â”‚    - MPCåè°ƒæ§åˆ¶ï¼ˆæ¸ é“+ç®¡é“+æ³µç«™ï¼‰                        â”‚
â”‚    - çŠ¶æ€ä¼°è®¡ï¼ˆEKF/UKFè™šæ‹Ÿä¼ æ„Ÿï¼‰                         â”‚
â”‚    - å¼‚å¸¸æ£€æµ‹ï¼ˆæ•…éšœè¯Šæ–­ã€è®¾å¤‡å¥åº·ï¼‰                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ‰§è¡Œå±‚ï¼ˆExecution Layerï¼‰                   â”‚
â”‚    - é—¸é—¨PIDæ§åˆ¶                                         â”‚
â”‚    - æ³µç«™å˜é¢‘è°ƒèŠ‚                                         â”‚
â”‚    - é˜€é—¨å¼€åº¦æ§åˆ¶                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ç‰©ç†å±‚ï¼ˆPhysical Systemï¼‰                  â”‚
â”‚    - æ¸ é“ï¼ˆSaint-Venantæ¨¡å‹ï¼‰                            â”‚
â”‚    - ç®¡é“ï¼ˆæ°´é”¤æ–¹ç¨‹+MOCï¼‰                                 â”‚
â”‚    - æ³µç«™ï¼ˆç‰¹æ€§æ›²çº¿+ç”µæœºæ¨¡å‹ï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ ¸å¿ƒæŠ€æœ¯æ ˆ

| æŠ€æœ¯é¢†åŸŸ | æ ¸å¿ƒç®—æ³• | æ¡ˆä¾‹æ¥æº | æœ¬æ¡ˆä¾‹ä¸­çš„ä½œç”¨ |
|---------|---------|---------|---------------|
| **æ¨¡å‹é™é˜¶** | POD (Proper Orthogonal Decomposition) | æ¡ˆä¾‹4 | åŠ é€Ÿæ¸ é“æ¨¡å‹è®¡ç®—ï¼ˆ100å€æé€Ÿï¼‰ |
| **ç³»ç»Ÿè¾¨è¯†** | SINDy (Sparse Identification) | æ¡ˆä¾‹11 | ä»è¿è¡Œæ•°æ®å‘ç°æ‘©é˜»ç³»æ•° |
| **çŠ¶æ€ä¼°è®¡** | EKF (Extended Kalman Filter) | æ¡ˆä¾‹13 | è™šæ‹Ÿä¼ æ„Ÿå™¨ï¼ˆç¨€ç–æµ‹ç‚¹é‡æ„å…¨åœºï¼‰ |
| **é¢„æµ‹ç»´æŠ¤** | é€€åŒ–æ¨¡å‹ + RULé¢„æµ‹ | æ¡ˆä¾‹13 | æ³µç«™è½´æ‰¿å¯¿å‘½é¢„æµ‹ |
| **ç®¡é“æ§åˆ¶** | MPC (Model Predictive Control) | æ¡ˆä¾‹14 | å‹åŠ›ç®¡é“åè°ƒæ§åˆ¶ |
| **è€¦åˆå»ºæ¨¡** | åŸŸåˆ†è§£ + è¿­ä»£è€¦åˆ | æ¡ˆä¾‹19 | æ¸ é“-ç®¡é“-æ³µç«™è”åˆä»¿çœŸ |

### 3. æ•°å­—å­ªç”Ÿç‰¹æ€§

**è™šå®æ˜ å°„ï¼ˆDigital-Physical Mappingï¼‰**ï¼š
- **ç‰©ç†ä¸–ç•Œ** â† ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ï¼ˆSCADAç³»ç»Ÿï¼‰
- **æ•°å­—å­ªç”Ÿ** â† çŠ¶æ€åŒæ­¥ï¼ˆæ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ï¼‰
- **ç‰©ç†ä¸–ç•Œ** â† æ§åˆ¶æŒ‡ä»¤ä¸‹å‘ï¼ˆé—¸é—¨/æ³µç«™è°ƒåº¦ï¼‰

**æ ¸å¿ƒèƒ½åŠ›**ï¼š
1. **å®æ—¶ç›‘æµ‹**ï¼šæ°´ä½ã€æµé‡ã€å‹åŠ›ã€æ³µç«™åŠŸç‡
2. **çŠ¶æ€ä¼°è®¡**ï¼šç¨€ç–ä¼ æ„Ÿå™¨ â†’ å…¨åœºé‡æ„ï¼ˆEKFè™šæ‹Ÿä¼ æ„Ÿï¼‰
3. **çŸ­æœŸé¢„æµ‹**ï¼šæœªæ¥1å°æ—¶æ°´åŠ›çŠ¶æ€ï¼ˆMPCé¢„æµ‹æ—¶åŸŸï¼‰
4. **å¼‚å¸¸æ£€æµ‹**ï¼šæµ‹é‡æ®‹å·®è¶…é˜ˆå€¼ â†’ è§¦å‘æŠ¥è­¦
5. **å¥åº·ç®¡ç†**ï¼šè®¾å¤‡é€€åŒ–ç›‘æµ‹ â†’ é¢„æµ‹æ€§ç»´æŠ¤
6. **ä¼˜åŒ–è°ƒåº¦**ï¼šæ°´èµ„æºåˆ†é… + æ³µç«™èŠ‚èƒ½

---

## æ•°å­¦æ¨¡å‹

### 1. é™é˜¶æ¨¡å‹ï¼ˆROM - Reduced Order Modelï¼‰

**PODé™é˜¶**ï¼š
```
åŸå§‹æ¨¡å‹ï¼ˆé«˜ç»´ï¼‰: dx/dt = f(x), x âˆˆ R^N (N = 10000+)
é™é˜¶æ¨¡å‹ï¼ˆä½ç»´ï¼‰: dy/dt = g(y), y âˆˆ R^r (r = 20-50)

å…¶ä¸­ y = Î¦^T xï¼ŒÎ¦ ä¸ºPODåŸºå‡½æ•°çŸ©é˜µ
```

**å¿«ç…§é›†åˆ**ï¼š
ä»é«˜ä¿çœŸä»¿çœŸæˆ–å†å²æ•°æ®é‡‡é›†å¿«ç…§ï¼š
```
X = [xâ‚, xâ‚‚, ..., x_M] âˆˆ R^(NÃ—M)
```

**SVDåˆ†è§£**ï¼š
```
X = UÎ£V^T

U: å·¦å¥‡å¼‚å‘é‡ï¼ˆç©ºé—´æ¨¡æ€ï¼‰
Î£: å¥‡å¼‚å€¼ï¼ˆèƒ½é‡åˆ†å¸ƒï¼‰
V: å³å¥‡å¼‚å‘é‡ï¼ˆæ—¶é—´ç³»æ•°ï¼‰
```

**åŸºå‡½æ•°é€‰æ‹©**ï¼š
ä¿ç•™å‰rä¸ªæ¨¡æ€ï¼Œä½¿å¾—ç´¯ç§¯èƒ½é‡ > 99.9%ï¼š
```
Î£áµ¢â‚Œâ‚Ê³ Ïƒáµ¢Â² / Î£áµ¢â‚Œâ‚á´º Ïƒáµ¢Â² > 0.999

åŸºå‡½æ•°çŸ©é˜µï¼šÎ¦ = [uâ‚, uâ‚‚, ..., uáµ£] âˆˆ R^(NÃ—r)
```

**GalerkinæŠ•å½±**ï¼š
```
åŸå§‹æ–¹ç¨‹: M dx/dt = f(x)
æŠ•å½±: Î¦^T M Î¦ dy/dt = Î¦^T f(Î¦y)
ç®€åŒ–: M_r dy/dt = f_r(y)

å…¶ä¸­ M_r = Î¦^T M Î¦ (é™é˜¶è´¨é‡çŸ©é˜µ)
```

**è®¡ç®—åŠ é€Ÿ**ï¼š
- åŸå§‹æ¨¡å‹ï¼šNç»´å¾®åˆ†æ–¹ç¨‹ï¼ˆN ~ 10000ï¼‰
- é™é˜¶æ¨¡å‹ï¼šrç»´å¾®åˆ†æ–¹ç¨‹ï¼ˆr ~ 30ï¼‰
- åŠ é€Ÿæ¯”ï¼šO(NÂ²) â†’ O(rÂ²) â‰ˆ 100-1000å€

### 2. ç³»ç»Ÿè¾¨è¯†ï¼ˆSINDyæ–¹æ³•ï¼‰

**ç¨€ç–è¾¨è¯†åŠ¨åŠ›å­¦**ï¼š
ä»æµ‹é‡æ•°æ® {X(t), dX/dt} å‘ç°æ§åˆ¶æ–¹ç¨‹ã€‚

**å€™é€‰å‡½æ•°åº“**ï¼š
```
Î˜(X) = [1, X, XÂ², sin(X), cos(X), XY, ...]
```

å¯¹äºæ°´åŠ›ç³»ç»Ÿï¼Œå€™é€‰åº“åŒ…å«ï¼š
```
Î˜(h, Q) = [1, h, Q, hÂ², QÂ², hQ, âˆšh, Q|Q|, ...]
```

**ç¨€ç–å›å½’**ï¼š
```
dX/dt = Î˜(X)Î

ç›®æ ‡ï¼šmin ||dX/dt - Î˜(X)Î||â‚‚Â² + Î»||Î||â‚

Î»: ç¨€ç–æƒ©ç½šç³»æ•°ï¼ˆä¿ƒä½¿Îä¸­å¤§éƒ¨åˆ†å…ƒç´ ä¸º0ï¼‰
```

**LASSOæ±‚è§£**ï¼š
ä½¿ç”¨åæ ‡ä¸‹é™æ³•æˆ–proximalæ¢¯åº¦æ³•æ±‚è§£ã€‚

**åº”ç”¨ç¤ºä¾‹**ï¼š
ä»è¿è¡Œæ•°æ®è¾¨è¯†Manningæ‘©é˜»ç³»æ•°ï¼š
```
æµ‹é‡æ•°æ®: h(t), Q(t)
è¾¨è¯†ç»“æœ: n = 0.025 Â± 0.002
```

### 3. æ‰©å±•å¡å°”æ›¼æ»¤æ³¢ï¼ˆEKFï¼‰

**çŠ¶æ€ç©ºé—´æ¨¡å‹**ï¼š
```
çŠ¶æ€æ–¹ç¨‹: xâ‚– = f(xâ‚–â‚‹â‚, uâ‚–â‚‹â‚) + wâ‚–â‚‹â‚
æµ‹é‡æ–¹ç¨‹: zâ‚– = h(xâ‚–) + vâ‚–

wâ‚– ~ N(0, Q): è¿‡ç¨‹å™ªå£°
vâ‚– ~ N(0, R): æµ‹é‡å™ªå£°
```

**é¢„æµ‹æ­¥ï¼ˆPredictionï¼‰**ï¼š
```
xÌ‚â‚–â» = f(xÌ‚â‚–â‚‹â‚âº, uâ‚–â‚‹â‚)  (çŠ¶æ€é¢„æµ‹)
Pâ‚–â» = Fâ‚–Pâ‚–â‚‹â‚âºFâ‚–áµ€ + Q  (åæ–¹å·®é¢„æµ‹)

Fâ‚– = âˆ‚f/âˆ‚x |â‚“â‚Œâ‚“Ì‚â‚–â‚‹â‚âº  (é›…å¯æ¯”çŸ©é˜µ)
```

**æ›´æ–°æ­¥ï¼ˆUpdateï¼‰**ï¼š
```
Kâ‚– = Pâ‚–â»Hâ‚–áµ€(Hâ‚–Pâ‚–â»Hâ‚–áµ€ + R)â»Â¹  (å¡å°”æ›¼å¢ç›Š)
xÌ‚â‚–âº = xÌ‚â‚–â» + Kâ‚–(zâ‚– - h(xÌ‚â‚–â»))  (çŠ¶æ€æ›´æ–°)
Pâ‚–âº = (I - Kâ‚–Hâ‚–)Pâ‚–â»  (åæ–¹å·®æ›´æ–°)

Hâ‚– = âˆ‚h/âˆ‚x |â‚“â‚Œâ‚“Ì‚â‚–â»  (æµ‹é‡é›…å¯æ¯”)
```

**è™šæ‹Ÿä¼ æ„Ÿå™¨**ï¼š
- ç‰©ç†ä¼ æ„Ÿå™¨ï¼šæ¯å…¬é‡Œ1ä¸ªï¼ˆN=1432ä¸ªä¼ æ„Ÿå™¨ï¼‰
- å®é™…éƒ¨ç½²ï¼šæ¯10å…¬é‡Œ1ä¸ªï¼ˆ143ä¸ªä¼ æ„Ÿå™¨ï¼‰
- EKFé‡æ„ï¼šä»143ä¸ªæµ‹ç‚¹ä¼°è®¡1432ä¸ªä½ç½®çš„çŠ¶æ€
- é‡æ„ç²¾åº¦ï¼šRMSE < 5% æ»¡é‡ç¨‹

### 4. é¢„æµ‹æ€§ç»´æŠ¤ï¼ˆPredictive Maintenanceï¼‰

**è®¾å¤‡é€€åŒ–æ¨¡å‹**ï¼ˆæŒ‡æ•°æ¨¡å‹ï¼‰ï¼š
```
Î¸(t) = Î¸â‚€ e^(Î»t)

Î¸(t): æ—¶åˆ»tçš„å¥åº·æŒ‡æ ‡ï¼ˆå¦‚æŒ¯åŠ¨å¹…å€¼ï¼‰
Î¸â‚€: åˆå§‹å¥åº·æŒ‡æ ‡
Î»: é€€åŒ–é€Ÿç‡
```

**å‰©ä½™ä½¿ç”¨å¯¿å‘½ï¼ˆRULï¼‰**ï¼š
```
RUL = (ln(Î¸_fail) - ln(Î¸_current)) / Î»

Î¸_fail: å¤±æ•ˆé˜ˆå€¼
Î¸_current: å½“å‰å¥åº·æŒ‡æ ‡
```

**è´å¶æ–¯å‚æ•°æ›´æ–°**ï¼š
éšç€æ–°æ•°æ®åˆ°æ¥ï¼Œæ›´æ–°é€€åŒ–é€Ÿç‡Î»çš„åéªŒåˆ†å¸ƒï¼š
```
p(Î»|D) âˆ p(D|Î») p(Î»)

D: å†å²æµ‹é‡æ•°æ®
p(Î»): å…ˆéªŒåˆ†å¸ƒ
p(D|Î»): ä¼¼ç„¶å‡½æ•°
p(Î»|D): åéªŒåˆ†å¸ƒ
```

**ç»´æŠ¤å†³ç­–**ï¼š
```
if RUL < å®‰å…¨é˜ˆå€¼:
    è§¦å‘é¢„é˜²æ€§ç»´æŠ¤
elif RUL < è®¡åˆ’é˜ˆå€¼:
    å®‰æ’ä¸‹æ¬¡åœæœºçª—å£ç»´æŠ¤
else:
    ç»§ç»­ç›‘æµ‹
```

### 5. å¤šå±‚MPCåè°ƒæ§åˆ¶

**ä¼˜åŒ–é—®é¢˜**ï¼š
```
min  J = Î£â‚–â‚Œâ‚€á´ºâ»Â¹ [||yâ‚– - yref||Â²Q + ||Î”uâ‚–||Â²R] + ||yâ‚™ - yref||Â²P
u

çº¦æŸæ¡ä»¶:
  xâ‚–â‚Šâ‚ = f(xâ‚–, uâ‚–)  (ç³»ç»ŸåŠ¨åŠ›å­¦)
  umin â‰¤ uâ‚– â‰¤ umax  (æ§åˆ¶çº¦æŸ)
  ymin â‰¤ yâ‚– â‰¤ ymax  (çŠ¶æ€çº¦æŸ)
```

**ä¸Šå±‚ä¼˜åŒ–ç›®æ ‡**ï¼š
- æ°´èµ„æºå…¬å¹³åˆ†é…ï¼ˆå„æ”¯çº¿æ»¡è¶³éœ€æ±‚ï¼‰
- æ³µç«™æ€»åŠŸè€—æœ€å°ï¼ˆç”µè´¹ä¼˜åŒ–ï¼‰
- æ°´è´¨å®‰å…¨ï¼ˆæµé€Ÿä¸ä½äº0.3 m/sé˜²æ­¢è—»ç±»ç”Ÿé•¿ï¼‰

**ä¸‹å±‚æ‰§è¡Œ**ï¼š
- é—¸é—¨å¼€åº¦è°ƒèŠ‚ï¼ˆç»´æŒç›®æ ‡æ°´ä½ï¼‰
- æ³µç«™é¢‘ç‡è°ƒèŠ‚ï¼ˆç»´æŒç›®æ ‡æµé‡ï¼‰
- é˜€é—¨åŠ¨ä½œï¼ˆé˜²æ­¢æ°´é”¤å‹åŠ›è¶…é™ï¼‰

---

## ä»£ç å®ç°

### 1. é¡¹ç›®ç»“æ„

```
case_20_integrated_system/
â”œâ”€â”€ README.md                    # æœ¬æ–‡æ¡£
â”œâ”€â”€ main.py                      # ä¸»ç¨‹åºï¼ˆ4ä¸ªæ¼”ç¤ºæ¡ˆä¾‹ï¼‰
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ rom.py                  # é™é˜¶æ¨¡å‹ï¼ˆPODï¼‰
â”‚   â”œâ”€â”€ identification.py       # ç³»ç»Ÿè¾¨è¯†ï¼ˆSINDyï¼‰
â”‚   â”œâ”€â”€ digital_twin.py         # æ•°å­—å­ªç”Ÿæ ¸å¿ƒ
â”‚   â”œâ”€â”€ ekf.py                  # æ‰©å±•å¡å°”æ›¼æ»¤æ³¢
â”‚   â”œâ”€â”€ predictive_maintenance.py  # é¢„æµ‹æ€§ç»´æŠ¤
â”‚   â””â”€â”€ mpc_coordinator.py      # MPCåè°ƒæ§åˆ¶
â””â”€â”€ data/
    â”œâ”€â”€ snwtp_topology.json     # å—æ°´åŒ—è°ƒæ‹“æ‰‘ç»“æ„
    â””â”€â”€ historical_data.csv     # å†å²è¿è¡Œæ•°æ®
```

### 2. æ ¸å¿ƒç±»è®¾è®¡

#### (1) é™é˜¶æ¨¡å‹ç±»

```python
class PODReducedOrderModel:
    """PODé™é˜¶æ¨¡å‹"""
    def __init__(self, high_fidelity_solver, n_modes=30):
        self.solver = high_fidelity_solver
        self.n_modes = n_modes
        self.basis = None  # PODåŸºå‡½æ•° Î¦ âˆˆ R^(NÃ—r)
        self.energy_ratio = None

    def train(self, snapshot_matrix):
        """ä»å¿«ç…§çŸ©é˜µè®­ç»ƒPODåŸº"""
        # SVDåˆ†è§£
        U, S, VT = np.linalg.svd(snapshot_matrix, full_matrices=False)

        # è®¡ç®—èƒ½é‡æ¯”
        energy = np.cumsum(S**2) / np.sum(S**2)

        # é€‰æ‹©å‰rä¸ªæ¨¡æ€
        self.basis = U[:, :self.n_modes]
        self.energy_ratio = energy[self.n_modes-1]

        print(f"PODé™é˜¶: {len(S)} â†’ {self.n_modes} æ¨¡æ€")
        print(f"ç´¯ç§¯èƒ½é‡: {self.energy_ratio*100:.2f}%")

    def project(self, x_full):
        """æŠ•å½±åˆ°é™é˜¶ç©ºé—´"""
        return self.basis.T @ x_full

    def reconstruct(self, x_reduced):
        """ä»é™é˜¶ç©ºé—´é‡æ„"""
        return self.basis @ x_reduced

    def solve(self, x0_reduced, u, dt, N_steps):
        """é™é˜¶æ¨¡å‹æ±‚è§£"""
        x_reduced = x0_reduced.copy()
        trajectory = [x_reduced.copy()]

        for _ in range(N_steps):
            # GalerkinæŠ•å½±æ±‚è§£
            x_full = self.reconstruct(x_reduced)
            dx_full = self.solver.residual(x_full, u, dt)
            dx_reduced = self.basis.T @ dx_full
            x_reduced += dx_reduced * dt
            trajectory.append(x_reduced.copy())

        return np.array(trajectory)
```

#### (2) SINDyè¾¨è¯†ç±»

```python
class SINDyIdentifier:
    """ç¨€ç–è¾¨è¯†åŠ¨åŠ›å­¦"""
    def __init__(self, library_functions):
        self.library = library_functions
        self.coefficients = None

    def build_library(self, X):
        """æ„å»ºå€™é€‰å‡½æ•°åº“"""
        Theta = []
        for func in self.library:
            Theta.append(func(X))
        return np.column_stack(Theta)

    def fit(self, X, dXdt, lambda_sparsity=0.01):
        """ç¨€ç–å›å½’"""
        Theta = self.build_library(X)

        # LASSOå›å½’ï¼ˆL1æ­£åˆ™åŒ–ï¼‰
        from sklearn.linear_model import Lasso
        model = Lasso(alpha=lambda_sparsity, fit_intercept=False)
        model.fit(Theta, dXdt)

        self.coefficients = model.coef_

        # ç»Ÿè®¡ç¨€ç–æ€§
        n_nonzero = np.sum(np.abs(self.coefficients) > 1e-6)
        print(f"SINDyè¾¨è¯†: {len(self.coefficients)}ä¸ªå€™é€‰é¡¹ â†’ {n_nonzero}ä¸ªéé›¶ç³»æ•°")

    def predict(self, X):
        """é¢„æµ‹å¯¼æ•°"""
        Theta = self.build_library(X)
        return Theta @ self.coefficients

    def print_equation(self):
        """æ‰“å°è¾¨è¯†å‡ºçš„æ–¹ç¨‹"""
        for i, coef in enumerate(self.coefficients):
            if abs(coef) > 1e-6:
                print(f"  {self.library[i].__name__}: {coef:.6f}")
```

#### (3) æ•°å­—å­ªç”Ÿæ ¸å¿ƒç±»

```python
class DigitalTwinCore:
    """æ•°å­—å­ªç”Ÿæ ¸å¿ƒå¼•æ“"""
    def __init__(self, physical_model, rom, ekf):
        self.model = physical_model  # ç‰©ç†æ¨¡å‹
        self.rom = rom  # é™é˜¶æ¨¡å‹ï¼ˆåŠ é€Ÿï¼‰
        self.ekf = ekf  # çŠ¶æ€ä¼°è®¡å™¨

        self.state = None  # å½“å‰çŠ¶æ€
        self.history = []  # å†å²è½¨è¿¹

    def synchronize(self, measurements, control):
        """è™šå®åŒæ­¥ï¼ˆçŠ¶æ€ä¼°è®¡ï¼‰"""
        # é¢„æµ‹æ­¥ï¼ˆç”¨é™é˜¶æ¨¡å‹åŠ é€Ÿï¼‰
        x_pred = self.rom.predict(self.state, control)

        # æ›´æ–°æ­¥ï¼ˆèåˆæµ‹é‡æ•°æ®ï¼‰
        self.state = self.ekf.update(x_pred, measurements)

        # è®°å½•å†å²
        self.history.append({
            'time': time.time(),
            'state': self.state.copy(),
            'measurements': measurements.copy()
        })

        return self.state

    def predict_future(self, horizon, control_sequence):
        """çŸ­æœŸé¢„æµ‹ï¼ˆç”¨äºMPCï¼‰"""
        x_future = [self.state.copy()]
        x = self.state.copy()

        for u in control_sequence:
            x = self.rom.predict(x, u)
            x_future.append(x.copy())

        return np.array(x_future)

    def anomaly_detection(self, threshold=3.0):
        """å¼‚å¸¸æ£€æµ‹ï¼ˆåŸºäºæµ‹é‡æ®‹å·®ï¼‰"""
        residual = self.ekf.innovation  # æµ‹é‡æ®‹å·® z - h(xÌ‚)
        normalized_residual = residual / np.sqrt(np.diag(self.ekf.S))

        is_anomaly = np.any(np.abs(normalized_residual) > threshold)

        return is_anomaly, normalized_residual
```

#### (4) é¢„æµ‹æ€§ç»´æŠ¤ç±»

```python
class PredictiveMaintenance:
    """é¢„æµ‹æ€§ç»´æŠ¤æ¨¡å—"""
    def __init__(self, equipment_list):
        self.equipment = equipment_list
        self.degradation_models = {}

    def update_health(self, equipment_id, measurements):
        """æ›´æ–°è®¾å¤‡å¥åº·æŒ‡æ ‡"""
        # æå–å¥åº·ç‰¹å¾ï¼ˆå¦‚æŒ¯åŠ¨å¹…å€¼ã€æ¸©åº¦ã€æ•ˆç‡ï¼‰
        vibration = measurements['vibration']
        temperature = measurements['temperature']

        # è®¡ç®—ç»¼åˆå¥åº·æŒ‡æ ‡
        health_index = self._compute_health_index(vibration, temperature)

        # æ›´æ–°é€€åŒ–æ¨¡å‹
        if equipment_id not in self.degradation_models:
            self.degradation_models[equipment_id] = ExponentialDegradation()

        model = self.degradation_models[equipment_id]
        model.add_observation(time.time(), health_index)

    def predict_rul(self, equipment_id, failure_threshold):
        """é¢„æµ‹å‰©ä½™ä½¿ç”¨å¯¿å‘½"""
        model = self.degradation_models[equipment_id]

        # æ‹Ÿåˆé€€åŒ–æ¨¡å‹å‚æ•°
        lambda_rate = model.fit()

        # è®¡ç®—RUL
        current_health = model.get_current_health()
        rul = (np.log(failure_threshold) - np.log(current_health)) / lambda_rate

        return rul

    def maintenance_decision(self, equipment_id):
        """ç»´æŠ¤å†³ç­–"""
        rul = self.predict_rul(equipment_id, failure_threshold=100)

        if rul < 7:  # 1å‘¨å†…å¤±æ•ˆ
            return "URGENT", "ç«‹å³å®‰æ’ç»´æŠ¤"
        elif rul < 30:  # 1ä¸ªæœˆå†…å¤±æ•ˆ
            return "WARNING", "ä¸‹æ¬¡åœæœºçª—å£ç»´æŠ¤"
        else:
            return "NORMAL", "ç»§ç»­ç›‘æµ‹"

class ExponentialDegradation:
    """æŒ‡æ•°é€€åŒ–æ¨¡å‹"""
    def __init__(self):
        self.observations = []

    def add_observation(self, time, health):
        self.observations.append((time, health))

    def fit(self):
        """æ‹Ÿåˆé€€åŒ–é€Ÿç‡Î»"""
        times = np.array([obs[0] for obs in self.observations])
        healths = np.array([obs[1] for obs in self.observations])

        # çº¿æ€§å›å½’ ln(Î¸) = ln(Î¸â‚€) + Î»t
        log_healths = np.log(healths)
        A = np.vstack([times, np.ones(len(times))]).T
        lambda_rate, ln_theta0 = np.linalg.lstsq(A, log_healths, rcond=None)[0]

        return lambda_rate

    def get_current_health(self):
        return self.observations[-1][1]
```

---

## æ¼”ç¤ºæ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šPODé™é˜¶æ¨¡å‹åŠ é€Ÿä»¿çœŸ

**åœºæ™¯**ï¼šå¯¹50å…¬é‡Œæ¸ æ®µè¿›è¡Œ24å°æ—¶ä»¿çœŸ
- åŸå§‹æ¨¡å‹ï¼š1000ä¸ªç½‘æ ¼ç‚¹ï¼Œè®¡ç®—æ—¶é—´120åˆ†é’Ÿ
- é™é˜¶æ¨¡å‹ï¼š30ä¸ªPODæ¨¡æ€ï¼Œè®¡ç®—æ—¶é—´1.2åˆ†é’Ÿ
- **åŠ é€Ÿæ¯”ï¼š100å€**

**éªŒè¯**ï¼š
- å¯¹æ¯”é™é˜¶æ¨¡å‹ä¸é«˜ä¿çœŸæ¨¡å‹çš„æ°´ä½é¢„æµ‹è¯¯å·®
- RMSE < 2 cmï¼ˆæ»¡è¶³å·¥ç¨‹ç²¾åº¦è¦æ±‚ï¼‰

### æ¡ˆä¾‹2ï¼šSINDyæ•°æ®é©±åŠ¨å‚æ•°è¾¨è¯†

**åœºæ™¯**ï¼šä»1ä¸ªæœˆçš„è¿è¡Œæ•°æ®è¾¨è¯†æ‘©é˜»ç³»æ•°
- è¾“å…¥ï¼šæ°´ä½h(t)ã€æµé‡Q(t)æµ‹é‡æ•°æ®
- è¾“å‡ºï¼šManningç³»æ•° n = 0.0247 Â± 0.0015
- å¯¹æ¯”ï¼šå®éªŒå®¤æµ‹å®šå€¼ n = 0.025

**éªŒè¯**ï¼š
- ä½¿ç”¨è¾¨è¯†å‚æ•°é¢„æµ‹æœªæ¥1å‘¨çš„æ°´ä½
- é¢„æµ‹ç²¾åº¦ï¼šMAE = 3.2 cm

### æ¡ˆä¾‹3ï¼šæ•°å­—å­ªç”Ÿè™šå®åŒæ­¥

**åœºæ™¯**ï¼šåŸºäº143ä¸ªä¼ æ„Ÿå™¨ä¼°è®¡å…¨çº¿1432ä¸ªä½ç½®çš„æ°´ä½
- EKFçŠ¶æ€ä¼°è®¡ï¼šä»ç¨€ç–æµ‹ç‚¹é‡æ„å…¨åœº
- è™šæ‹Ÿä¼ æ„Ÿå™¨ç²¾åº¦ï¼šRMSE = 4.5 cm
- æ›´æ–°é¢‘ç‡ï¼šæ¯åˆ†é’ŸåŒæ­¥1æ¬¡

**å¼‚å¸¸æ£€æµ‹**ï¼š
- æŸä¼ æ„Ÿå™¨æ•…éšœï¼ˆè¯»æ•°å¼‚å¸¸ï¼‰
- ç³»ç»Ÿæ£€æµ‹åˆ°æµ‹é‡æ®‹å·®è¶…è¿‡3Ïƒé˜ˆå€¼
- è‡ªåŠ¨éš”ç¦»æ•…éšœä¼ æ„Ÿå™¨ï¼Œè§¦å‘æŠ¥è­¦

### æ¡ˆä¾‹4ï¼šæ³µç«™é¢„æµ‹æ€§ç»´æŠ¤

**åœºæ™¯**ï¼šæŸæ³µç«™è½´æ‰¿å¥åº·ç›‘æµ‹
- æŒ¯åŠ¨ä¼ æ„Ÿå™¨ï¼šé‡‡é›†åŠ é€Ÿåº¦ä¿¡å·
- ç‰¹å¾æå–ï¼šRMSæŒ¯åŠ¨å¹…å€¼
- é€€åŒ–å»ºæ¨¡ï¼šæŒ‡æ•°æ¨¡å‹æ‹Ÿåˆ
- RULé¢„æµ‹ï¼šå‰©ä½™å¯¿å‘½15å¤©

**ç»´æŠ¤å†³ç­–**ï¼š
- è§¦å‘é»„è‰²é¢„è­¦
- å»ºè®®ï¼šåœ¨ä¸‹æ¬¡è®¡åˆ’åœæœºæ—¶æ›´æ¢è½´æ‰¿
- é¿å…çªå‘æ•…éšœï¼ŒèŠ‚çœåº”æ€¥ç»´ä¿®æˆæœ¬

---

## å·¥ç¨‹æ„ä¹‰

### 1. æŠ€æœ¯åˆ›æ–°

| åˆ›æ–°ç‚¹ | ä¼ ç»Ÿæ–¹æ³• | æ•°å­—å­ªç”Ÿæ–¹æ³• | æ•ˆæœæå‡ |
|-------|---------|-------------|---------|
| **è®¡ç®—æ•ˆç‡** | é«˜ä¿çœŸä»¿çœŸ120åˆ†é’Ÿ | PODé™é˜¶1.2åˆ†é’Ÿ | 100å€åŠ é€Ÿ |
| **ä¼ æ„Ÿå™¨éƒ¨ç½²** | å…¨çº¿1432ä¸ªä¼ æ„Ÿå™¨ | 143ä¸ª+è™šæ‹Ÿä¼ æ„Ÿ | æˆæœ¬é™ä½90% |
| **æ•…éšœè¯Šæ–­** | äº‹ååˆ†æï¼ˆæ•°å¤©ï¼‰ | å®æ—¶å¼‚å¸¸æ£€æµ‹ï¼ˆç§’çº§ï¼‰ | å“åº”åŠ å¿«1000å€ |
| **ç»´æŠ¤æ¨¡å¼** | å®šæœŸç»´æŠ¤+æ•…éšœç»´ä¿® | é¢„æµ‹æ€§ç»´æŠ¤ | è®¾å¤‡å¯¿å‘½å»¶é•¿30% |
| **è°ƒåº¦ä¼˜åŒ–** | äººå·¥ç»éªŒ+ç¦»çº¿è®¡ç®— | MPCåœ¨çº¿ä¼˜åŒ– | èŠ‚èƒ½15-20% |

### 2. å®é™…æ•ˆç›Š

**å—æ°´åŒ—è°ƒä¸­çº¿å·¥ç¨‹åº”ç”¨æ•ˆç›Šä¼°ç®—**ï¼š
1. **èŠ‚èƒ½é™è€—**ï¼š7åº§æ³µç«™å¹´èŠ‚ç”µ15% â†’ èŠ‚çœç”µè´¹çº¦2000ä¸‡å…ƒ/å¹´
2. **å‡å°‘æ•…éšœ**ï¼šé¢„æµ‹æ€§ç»´æŠ¤å‡å°‘çªå‘æ•…éšœ50% â†’ å‡å°‘æŸå¤±çº¦5000ä¸‡å…ƒ/å¹´
3. **ä¼˜åŒ–è°ƒåº¦**ï¼šæ°´èµ„æºåˆ©ç”¨æ•ˆç‡æå‡10% â†’ å¢åŠ ä¾›æ°´1äº¿ç«‹æ–¹ç±³/å¹´
4. **å»¶é•¿å¯¿å‘½**ï¼šè®¾å¤‡å¯¿å‘½å»¶é•¿30% â†’ æ¨è¿Ÿæ›´æ–°æ”¹é€ æŠ•èµ„çº¦3äº¿å…ƒ

**æ€»ç»æµæ•ˆç›Š**ï¼šçº¦7000ä¸‡å…ƒ/å¹´ + å»¶é•¿è®¾å¤‡å¯¿å‘½3äº¿å…ƒï¼ˆä¸€æ¬¡æ€§ï¼‰

### 3. æ¨å¹¿ä»·å€¼

æœ¬æ•°å­—å­ªç”Ÿæ¡†æ¶å¯æ¨å¹¿åˆ°ï¼š
- **å…¶ä»–è°ƒæ°´å·¥ç¨‹**ï¼šå—æ°´åŒ—è°ƒä¸œçº¿ã€å¼•é»„æµé’ã€å¼•æ±Ÿæµæ·®
- **åŸå¸‚ä¾›æ°´ç³»ç»Ÿ**ï¼šè‡ªæ¥æ°´å‚+ç®¡ç½‘æ™ºèƒ½è°ƒåº¦
- **å†œä¸šçŒåŒº**ï¼šçŒåŒºæ¸ ç³»+ç”°é—´ç®¡ç½‘è”åˆæ§åˆ¶
- **æ°´ç”µç«™ç¾¤**ï¼šæµåŸŸæ¢¯çº§æ°´åº“+å¼•æ°´ç³»ç»Ÿä¼˜åŒ–è¿è¡Œ

---

## å‚è€ƒæ–‡çŒ®

### æ¨¡å‹é™é˜¶
1. Benner, P., et al. (2017). *Model Reduction and Approximation: Theory and Algorithms*. SIAM.
2. Quarteroni, A., & Rozza, G. (2014). *Reduced Order Methods for Modeling and Computational Reduction*. Springer.
3. Kutz, J. N., et al. (2016). *Dynamic Mode Decomposition: Data-Driven Modeling of Complex Systems*. SIAM.

### ç³»ç»Ÿè¾¨è¯†
4. Ljung, L. (1999). *System Identification: Theory for the User*. Prentice Hall.
5. Brunton, S. L., et al. (2016). "Discovering governing equations from data by sparse identification of nonlinear dynamical systems". *PNAS*, 113(15), 3932-3937.
6. Nelles, O. (2001). *Nonlinear System Identification*. Springer.

### æ•°å­—å­ªç”Ÿ
7. Grieves, M., & Vickers, J. (2017). "Digital twin: Mitigating unpredictable, undesirable emergent behavior in complex systems". *Transdisciplinary Perspectives on Complex Systems*, 85-113.
8. Tao, F., et al. (2019). "Digital twin in industry: State-of-the-art". *IEEE Transactions on Industrial Informatics*, 15(4), 2405-2415.
9. Rasheed, A., et al. (2020). "Digital twin: Values, challenges and enablers from a modeling perspective". *IEEE Access*, 8, 21980-22012.

### é¢„æµ‹æ€§ç»´æŠ¤
10. Lee, J., et al. (2014). "Prognostics and health management design for rotary machinery systems". *IEEE Transactions on Industrial Electronics*, 61(5), 2815-2824.
11. Si, X. S., et al. (2011). "Remaining useful life estimation". *IEEE Transactions on Reliability*, 60(1), 127-140.

### æ°´åˆ©å·¥ç¨‹åº”ç”¨
12. ä¸­å›½å—æ°´åŒ—è°ƒé›†å›¢å…¬å¸ (2020). *å—æ°´åŒ—è°ƒä¸­çº¿å·¥ç¨‹è¿è¡Œç®¡ç†æŠ€æœ¯æŠ¥å‘Š*.
13. HorvÃ¡th, K., et al. (2015). "Real-time control of open channels". *Journal of Hydraulic Engineering*, ASCE.
14. Li, Y., et al. (2021). "Digital twin for large-scale water transfer projects". *Water Resources Management*, 35, 1-18.

---

## æ€»ç»“

æœ¬æ¡ˆä¾‹å®ç°äº†ä¸€ä¸ª**ç”Ÿäº§çº§åˆ«çš„æ•°å­—å­ªç”Ÿç³»ç»Ÿ**ï¼Œé›†æˆäº†ï¼š
- âœ… **æ¨¡å‹é™é˜¶**ï¼ˆPODï¼‰ï¼š100å€è®¡ç®—åŠ é€Ÿ
- âœ… **ç³»ç»Ÿè¾¨è¯†**ï¼ˆSINDyï¼‰ï¼šæ•°æ®é©±åŠ¨å‚æ•°æ ¡å‡†
- âœ… **çŠ¶æ€ä¼°è®¡**ï¼ˆEKFï¼‰ï¼šè™šæ‹Ÿä¼ æ„Ÿå™¨å…¨åœºé‡æ„
- âœ… **é¢„æµ‹ç»´æŠ¤**ï¼šè®¾å¤‡å¥åº·ç›‘æµ‹ä¸RULé¢„æµ‹
- âœ… **åè°ƒæ§åˆ¶**ï¼ˆMPCï¼‰ï¼šå¤šçº§æ³µç«™èŠ‚èƒ½ä¼˜åŒ–

è¿™æ˜¯å‰é¢19ä¸ªæ¡ˆä¾‹æŠ€æœ¯çš„**é›†å¤§æˆè€…**ï¼Œå±•ç¤ºäº†ç°ä»£æ™ºèƒ½æ°´åˆ©ç³»ç»Ÿçš„å®Œæ•´æŠ€æœ¯æ ˆã€‚

**æ ¸å¿ƒä»·å€¼**ï¼š
1. **è™šå®èåˆ**ï¼šç‰©ç†ä¸–ç•Œ â†” æ•°å­—ä¸–ç•Œå®æ—¶åŒæ­¥
2. **æ™ºèƒ½å†³ç­–**ï¼šä»æ•°æ®åˆ°æ´å¯Ÿåˆ°è¡ŒåŠ¨çš„é—­ç¯
3. **é™æœ¬å¢æ•ˆ**ï¼šå‡å°‘ä¼ æ„Ÿå™¨90%ã€èŠ‚èƒ½15%ã€å»¶é•¿å¯¿å‘½30%
4. **å¯æ¨å¹¿æ€§**ï¼šæ¡†æ¶å¯è¿ç§»åˆ°å…¶ä»–å¤§å‹æ°´åˆ©å·¥ç¨‹

**æŠ€æœ¯æˆç†Ÿåº¦**ï¼šTRL 7-8ï¼ˆç³»ç»ŸåŸå‹éªŒè¯ â†’ å®é™…ç¯å¢ƒéªŒè¯ï¼‰

---

**æ¡ˆä¾‹20ï¼šå—æ°´åŒ—è°ƒæ•°å­—å­ªç”Ÿç³»ç»Ÿ - æ™ºèƒ½æ°´åˆ©çš„æœªæ¥ï¼** ğŸš€
