# 案例9: 传动系统建模

## 简介

本案例研究风力机传动系统的动力学建模与振动分析，这对于疲劳载荷评估和控制系统设计至关重要。采用两质量模型描述风轮惯量、齿轮箱和发电机惯量之间通过弹性轴连接的动力学特性。案例演示传动系统对转矩阶跃的瞬态响应、轴扭振分析、谐振频率识别以及参数敏感性分析。理解传动系统动态特性对于优化控制器参数、减少机械载荷和延长设备寿命具有重要意义。

## 理论背景

两质量模型是风力机传动系统最常用的简化模型。风轮侧惯量Jt(约10^7 kg·m²)和发电机侧惯量Jg(约10^5 kg·m²，折算到低速轴)通过弹性轴连接，轴刚度Ks(约10^8 N·m/rad)和阻尼Cs决定了系统的动态特性。系统存在一个主导的扭振模态，固有频率f_n = (1/2π)√[Ks(Jt+N²Jg)/(JtN²Jg)]，典型值为1-3 Hz。当控制器带宽接近谐振频率时，可能激发轴扭振，导致疲劳损伤加剧。传动系统的动态方程为：Jt·dωt/dt = Tt - Ks·θtwist - Cs·ωtwist，Jg·dωg/dt = Ks·θtwist/N + Cs·ωtwist/N - Tg，其中θtwist = θt - N·θg为扭转角。

## 代码说明

### 主要类

**DrivetrainModel**: 传动系统两质量模型类
- `__init__(Jt, Jg, Ks, Cs, N)`: 初始化传动系统参数
  - Jt: 风轮侧转动惯量 (kg·m²)
  - Jg: 发电机侧转动惯量 (kg·m²)
  - Ks: 轴刚度 (N·m/rad)
  - Cs: 轴阻尼系数 (N·m·s/rad)
  - N: 齿轮箱传动比

- `simulate(t_span, state0, Tt_func, Tg_func, dt)`: 仿真动态响应
  - 输入: 时间范围、初始状态、转矩函数
  - 输出: 时间历程数据(转速、扭转角、轴转矩等)

### 演示函数

- `demo_two_mass_response()`: 阶跃转矩响应分析
  - 转速振荡
  - 轴转矩振荡
  - 扭转角动态
  - FFT频谱分析，识别谐振频率

- `demo_resonance_analysis()`: 谐振频率参数分析
  - 轴刚度Ks对谐振频率的影响
  - 风轮惯量Jt对谐振频率的影响
  - 参数敏感性曲线

## 运行方法

```bash
# 进入案例目录
cd /home/user/CHS-Books/books/wind-power-system-modeling-control/code/examples/case_09_drivetrain

# 运行案例
python main.py
```

## 参数说明

### 传动系统参数
- **Jt**: 风轮惯量 = 10^7 kg·m² (典型2MW机组)
- **Jg**: 发电机惯量 = 10^5 kg·m² (折算到低速轴)
- **Ks**: 轴刚度 = 10^8 N·m/rad
- **Cs**: 轴阻尼 = 10^6 N·m·s/rad
- **N**: 齿轮比 = 100 (低速轴→高速轴)

### 仿真参数
- **初始转速**: 1.0 rad/s (风轮侧)
- **转矩阶跃**: 0.5→1.0 MN·m (t=1s)
- **仿真时间**: 10秒
- **时间步长**: 0.001秒

## 预期结果说明

运行本案例后将生成2张图表：

1. **case09_two_mass_response.png** (四图):
   - 转速响应:
     - 风轮转速和发电机转速(折算)
     - 阶跃后振荡，阻尼衰减
     - 振荡频率约1.5-2.5 Hz

   - 轴转矩振荡:
     - 阶跃瞬间转矩超调
     - 振荡幅值逐渐衰减
     - 稳态值约500 kN·m

   - 扭转角:
     - 轴扭转变形角度
     - 典型幅值0.1-0.5度

   - FFT频谱:
     - 谐振峰值对应固有频率
     - 典型值f_n ≈ 2 Hz

2. **case09_resonance_analysis.png** (两图):
   - 刚度影响:
     - Ks ↑ → f_n ↑
     - 对数坐标，近似f ∝ √Ks

   - 惯量影响:
     - Jt ↑ → f_n ↓
     - 惯量增加降低固有频率

### 控制台输出
- 传动系统参数总结
- 谐振频率识别结果
- 阻尼比估算
- 振荡幅值统计

## 工程应用

传动系统建模的实际应用：

### 疲劳载荷评估
1. **扭振载荷**: 轴扭转疲劳
2. **齿轮箱载荷**: 齿轮接触疲劳
3. **轴承载荷**: 轴承寿命预测

### 控制器设计
1. **带宽限制**: 避开谐振频率
2. **陷波滤波器**: 抑制特定频率
3. **阻尼控制**: 主动抑制扭振

### 参数优化
1. **刚度优化**: 调整谐振频率
2. **阻尼优化**: 提高衰减速度
3. **惯量匹配**: 优化动态响应

### 典型谐振频率
- **2MW机组**: 1.5-2.5 Hz
- **5MW机组**: 1.0-2.0 Hz
- **10MW海上机组**: 0.8-1.5 Hz

## 故障诊断

传动系统常见故障特征：
1. **齿轮箱磨损**: 振动频率改变
2. **轴承故障**: 特征频率出现
3. **联轴器失效**: 扭振加剧
4. **不平衡**: 1P频率振动

## 参考文献

1. Pao, L. Y., & Johnson, K. E. (2011). Control of wind turbines. *IEEE Control Systems Magazine*, 31(2), 44-62.
2. Bossanyi, E. A. (2000). The design of closed loop controllers for wind turbines. *Wind Energy*, 3(3), 149-163.
3. Hansen, M. H., et al. (2007). Two methods for estimating aeroelastic damping of operational wind turbine modes from experiments. *Wind Energy*, 10(6), 551-583.
