# 第7章：重积分计算速算

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、二重积分速算

### 1.1 直角坐标系

**X型区域**（上下型）：$a \leq x \leq b, \varphi_1(x) \leq y \leq \varphi_2(x)$

$$\iint_D f(x,y)\mathrm{d}x\mathrm{d}y = \int_a^b \left[\int_{\varphi_1(x)}^{\varphi_2(x)} f(x,y)\mathrm{d}y\right]\mathrm{d}x$$

**Y型区域**（左右型）：$c \leq y \leq d, \psi_1(y) \leq x \leq \psi_2(y)$

$$\iint_D f(x,y)\mathrm{d}x\mathrm{d}y = \int_c^d \left[\int_{\psi_1(y)}^{\psi_2(y)} f(x,y)\mathrm{d}x\right]\mathrm{d}y$$

**例题1**：计算$\iint_D xy\mathrm{d}x\mathrm{d}y$，$D: 0 \leq x \leq 1, 0 \leq y \leq x^2$

**解**（X型）：
$$\int_0^1 \left[\int_0^{x^2} xy\mathrm{d}y\right]\mathrm{d}x = \int_0^1 x \cdot \frac{y^2}{2}\bigg|_0^{x^2}\mathrm{d}x$$
$$= \int_0^1 \frac{x^5}{2}\mathrm{d}x = \frac{x^6}{12}\bigg|_0^1 = \frac{1}{12}$$

---

### 1.2 极坐标变换

**变换公式**：$x=r\cos\theta, y=r\sin\theta$，$\mathrm{d}x\mathrm{d}y = r\mathrm{d}r\mathrm{d}\theta$

**适用情况**：
1. 积分域是圆、扇形、环形
2. 被积函数含$x^2+y^2$

**标准型**：
$$\iint_D f(x,y)\mathrm{d}x\mathrm{d}y = \int_{\alpha}^{\beta} \left[\int_{r_1(\theta)}^{r_2(\theta)} f(r\cos\theta,r\sin\theta) \cdot r\mathrm{d}r\right]\mathrm{d}\theta$$

**例题2**：计算$\iint_D e^{-(x^2+y^2)}\mathrm{d}x\mathrm{d}y$，$D: x^2+y^2 \leq 1$

**解**：
$$= \int_0^{2\pi} \left[\int_0^1 e^{-r^2} \cdot r\mathrm{d}r\right]\mathrm{d}\theta$$
$$= 2\pi \int_0^1 re^{-r^2}\mathrm{d}r$$

令$t=-r^2$，$\mathrm{d}t=-2r\mathrm{d}r$：
$$= 2\pi \cdot \left(-\frac{1}{2}\right) \int_0^{-1} e^t\mathrm{d}t = -\pi(e^{-1}-1) = \pi(1-e^{-1})$$

---

### 1.3 对称性与奇偶性

**技巧1：对称性**

若$D$关于$y$轴对称：
- $f(-x,y)=f(x,y)$（偶）：$\iint_D = 2\iint_{D_右}$
- $f(-x,y)=-f(x,y)$（奇）：$\iint_D = 0$

**例题3**：计算$\iint_D x^3y\mathrm{d}x\mathrm{d}y$，$D: x^2+y^2 \leq 1$

**解**：
$D$关于$x$轴和$y$轴对称

$f(x,y)=x^3y$，$f(-x,y)=-x^3y=-f(x,y)$（关于$x$奇）

$$\iint_D x^3y\mathrm{d}x\mathrm{d}y = 0$$

---

**技巧2：轮换对称**

若$D$关于$y=x$对称，则：
$$\iint_D f(x,y)\mathrm{d}x\mathrm{d}y = \iint_D f(y,x)\mathrm{d}x\mathrm{d}y$$

**推论**：
$$\iint_D f(x,y)\mathrm{d}x\mathrm{d}y = \frac{1}{2}\iint_D [f(x,y)+f(y,x)]\mathrm{d}x\mathrm{d}y$$

**例题4**：计算$\iint_D \frac{x^2}{x^2+y^2}\mathrm{d}x\mathrm{d}y$，$D: x^2+y^2 \leq 1$

**解**：
$D$关于$y=x$对称，利用轮换：
$$I = \iint_D \frac{y^2}{x^2+y^2}\mathrm{d}x\mathrm{d}y$$

$$2I = \iint_D \frac{x^2+y^2}{x^2+y^2}\mathrm{d}x\mathrm{d}y = \iint_D 1\mathrm{d}x\mathrm{d}y = \pi$$

$$I = \frac{\pi}{2}$$

---

## 二、三重积分速算

### 2.1 直角坐标系

**投影法**（先一后二）：

$$\iiint_\Omega f(x,y,z)\mathrm{d}V = \iint_{D_{xy}} \left[\int_{z_1(x,y)}^{z_2(x,y)} f(x,y,z)\mathrm{d}z\right]\mathrm{d}x\mathrm{d}y$$

**例题5**：计算$\iiint_\Omega z\mathrm{d}V$，$\Omega: x^2+y^2+z^2 \leq 1, z \geq 0$

**解**（先$z$后$xy$）：
投影$D_{xy}: x^2+y^2 \leq 1$

$$= \iint_{D_{xy}} \left[\int_0^{\sqrt{1-x^2-y^2}} z\mathrm{d}z\right]\mathrm{d}x\mathrm{d}y$$
$$= \iint_{D_{xy}} \frac{(1-x^2-y^2)}{2}\mathrm{d}x\mathrm{d}y$$

极坐标：
$$= \int_0^{2\pi} \int_0^1 \frac{1-r^2}{2} \cdot r\mathrm{d}r\mathrm{d}\theta$$
$$= 2\pi \cdot \frac{1}{2} \int_0^1 (r-r^3)\mathrm{d}r$$
$$= \pi \left(\frac{1}{2}-\frac{1}{4}\right) = \frac{\pi}{4}$$

---

### 2.2 柱坐标变换

**变换公式**：
$$\begin{cases}
x = r\cos\theta \\
y = r\sin\theta \\
z = z
\end{cases}, \quad \mathrm{d}V = r\mathrm{d}r\mathrm{d}\theta\mathrm{d}z$$

**适用情况**：旋转体（轴为$z$轴）

**例题6**：计算$\iiint_\Omega (x^2+y^2)\mathrm{d}V$，$\Omega: x^2+y^2 \leq z \leq 1$

**解**（柱坐标）：
$$= \int_0^{2\pi} \int_0^1 \int_{r^2}^1 r^2 \cdot r\mathrm{d}z\mathrm{d}r\mathrm{d}\theta$$
$$= 2\pi \int_0^1 r^3(1-r^2)\mathrm{d}r$$
$$= 2\pi \int_0^1 (r^3-r^5)\mathrm{d}r$$
$$= 2\pi \left(\frac{1}{4}-\frac{1}{6}\right) = \frac{\pi}{6}$$

---

### 2.3 球坐标变换

**变换公式**：
$$\begin{cases}
x = \rho\sin\varphi\cos\theta \\
y = \rho\sin\varphi\sin\theta \\
z = \rho\cos\varphi
\end{cases}, \quad \mathrm{d}V = \rho^2\sin\varphi\mathrm{d}\rho\mathrm{d}\varphi\mathrm{d}\theta$$

**适用情况**：球体、球壳、锥面

**例题7**：计算$\iiint_\Omega (x^2+y^2+z^2)\mathrm{d}V$，$\Omega: x^2+y^2+z^2 \leq R^2$

**解**（球坐标）：
$$= \int_0^{2\pi} \int_0^\pi \int_0^R \rho^2 \cdot \rho^2\sin\varphi\mathrm{d}\rho\mathrm{d}\varphi\mathrm{d}\theta$$
$$= 2\pi \cdot 2 \int_0^R \rho^4\mathrm{d}\rho$$
$$= 4\pi \cdot \frac{R^5}{5} = \frac{4\pi R^5}{5}$$

---

## 三、重积分应用

### 3.1 几何应用

**1. 体积**：
$$V = \iiint_\Omega \mathrm{d}V$$

**2. 曲面面积**：
$$A = \iint_D \sqrt{1 + \left(\frac{\partial z}{\partial x}\right)^2 + \left(\frac{\partial z}{\partial y}\right)^2}\mathrm{d}x\mathrm{d}y$$

**例题8**：求球面$x^2+y^2+z^2=R^2$的表面积

**解**：
上半球：$z=\sqrt{R^2-x^2-y^2}$

$$\frac{\partial z}{\partial x} = -\frac{x}{\sqrt{R^2-x^2-y^2}}$$
$$\frac{\partial z}{\partial y} = -\frac{y}{\sqrt{R^2-x^2-y^2}}$$

$$\sqrt{1+z_x^2+z_y^2} = \frac{R}{\sqrt{R^2-x^2-y^2}}$$

$$A = 2\iint_{D} \frac{R}{\sqrt{R^2-x^2-y^2}}\mathrm{d}x\mathrm{d}y$$

极坐标：
$$= 2\int_0^{2\pi} \int_0^R \frac{R}{\sqrt{R^2-r^2}} \cdot r\mathrm{d}r\mathrm{d}\theta$$
$$= 4\pi R \int_0^R \frac{r}{\sqrt{R^2-r^2}}\mathrm{d}r$$
$$= 4\pi R \cdot R = 4\pi R^2$$

---

### 3.2 物理应用

**1. 质量**：
$$M = \iiint_\Omega \rho(x,y,z)\mathrm{d}V$$

**2. 质心**：
$$\bar{x} = \frac{1}{M}\iiint_\Omega x\rho(x,y,z)\mathrm{d}V$$

**3. 转动惯量**：
$$I_z = \iiint_\Omega (x^2+y^2)\rho(x,y,z)\mathrm{d}V$$

**例题9**：均匀半球体（$x^2+y^2+z^2 \leq R^2, z \geq 0$，$\rho=1$）的质心

**解**：
对称性：$\bar{x}=\bar{y}=0$

$$\bar{z} = \frac{\iiint_\Omega z\mathrm{d}V}{\iiint_\Omega \mathrm{d}V}$$

分母：$V = \frac{2\pi R^3}{3}$

分子（例题5已算）：$\iiint z\mathrm{d}V = \frac{\pi R^4}{4}$

$$\bar{z} = \frac{\pi R^4/4}{2\pi R^3/3} = \frac{3R}{8}$$

---

## 四、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from scipy import integrate

class MultipleIntegral:
    """重积分计算工具"""
    
    @staticmethod
    def double_integral_rectangular(f, x_range, y_func):
        """
        二重积分（直角坐标）
        
        参数:
            f: 被积函数f(x,y)
            x_range: (x_min, x_max)
            y_func: (y_lower(x), y_upper(x))
        """
        def integrand_y(y, x):
            return f(x, y)
        
        def integrand_x(x):
            y_lower, y_upper = y_func[0](x), y_func[1](x)
            result, _ = integrate.quad(integrand_y, y_lower, y_upper, args=(x,))
            return result
        
        result, error = integrate.quad(integrand_x, x_range[0], x_range[1])
        return result, error
    
    @staticmethod
    def double_integral_polar(f, theta_range, r_func):
        """
        二重积分（极坐标）
        
        参数:
            f: 被积函数f(r,theta)
            theta_range: (theta_min, theta_max)
            r_func: (r_min(theta), r_max(theta))
        """
        def integrand_r(r, theta):
            return f(r, theta) * r  # 雅可比行列式
        
        def integrand_theta(theta):
            r_min, r_max = r_func[0](theta), r_func[1](theta)
            result, _ = integrate.quad(integrand_r, r_min, r_max, args=(theta,))
            return result
        
        result, error = integrate.quad(integrand_theta, 
                                      theta_range[0], theta_range[1])
        return result, error
    
    @staticmethod
    def triple_integral_cylindrical(f, theta_range, r_range, z_func):
        """
        三重积分（柱坐标）
        
        参数:
            f: 被积函数f(r,theta,z)
            theta_range: (theta_min, theta_max)
            r_range: (r_min, r_max)
            z_func: (z_lower(r,theta), z_upper(r,theta))
        """
        def integrand_z(z, r, theta):
            return f(r, theta, z) * r  # 雅可比行列式
        
        def integrand_r(r, theta):
            z_lower = z_func[0](r, theta)
            z_upper = z_func[1](r, theta)
            result, _ = integrate.quad(integrand_z, z_lower, z_upper,
                                      args=(r, theta))
            return result
        
        def integrand_theta(theta):
            result, _ = integrate.dblquad(
                lambda r, th: integrand_r(r, th),
                theta, theta,  # theta固定
                r_range[0], r_range[1]
            )
            return result
        
        result, error = integrate.quad(integrand_theta,
                                      theta_range[0], theta_range[1])
        return result, error
    
    @staticmethod
    def volume_under_surface(f, x_range, y_range):
        """
        计算曲面下方的体积
        
        参数:
            f: 函数z=f(x,y)
            x_range, y_range: 积分区域
        """
        result, error = integrate.dblquad(
            f,
            x_range[0], x_range[1],
            y_range[0], y_range[1]
        )
        return result
    
    @staticmethod
    def plot_integration_domain_2d(x_range, y_func, title='积分区域'):
        """绘制二维积分区域"""
        fig, ax = plt.subplots(figsize=(8, 6))
        
        x = np.linspace(x_range[0], x_range[1], 200)
        y_lower = np.array([y_func[0](xi) for xi in x])
        y_upper = np.array([y_func[1](xi) for xi in x])
        
        ax.fill_between(x, y_lower, y_upper, alpha=0.3, color='blue',
                       label='积分区域D')
        ax.plot(x, y_lower, 'b-', linewidth=2, label='下界')
        ax.plot(x, y_upper, 'r-', linewidth=2, label='上界')
        
        ax.set_xlabel('x', fontsize=11)
        ax.set_ylabel('y', fontsize=11)
        ax.set_title(title, fontsize=13, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('integration_domain_2d.png', dpi=300)
        plt.show()
    
    @staticmethod
    def plot_integration_volume_3d(f, x_range, y_range):
        """绘制三维积分体积"""
        fig = plt.figure(figsize=(12, 5))
        
        x = np.linspace(x_range[0], x_range[1], 50)
        y = np.linspace(y_range[0], y_range[1], 50)
        X, Y = np.meshgrid(x, y)
        Z = np.zeros_like(X)
        
        for i in range(X.shape[0]):
            for j in range(X.shape[1]):
                Z[i,j] = f(X[i,j], Y[i,j])
        
        # 3D视图
        ax1 = fig.add_subplot(121, projection='3d')
        surf = ax1.plot_surface(X, Y, Z, cmap='viridis', alpha=0.8)
        ax1.plot_wireframe(X, Y, Z, color='black', linewidth=0.3,
                          alpha=0.3)
        ax1.set_xlabel('x')
        ax1.set_ylabel('y')
        ax1.set_zlabel('z = f(x,y)')
        ax1.set_title('曲面z=f(x,y)', fontweight='bold')
        fig.colorbar(surf, ax=ax1, shrink=0.5)
        
        # 投影视图
        ax2 = fig.add_subplot(122)
        contour = ax2.contourf(X, Y, Z, levels=15, cmap='viridis')
        ax2.contour(X, Y, Z, levels=15, colors='black',
                   linewidths=0.5, alpha=0.3)
        ax2.set_xlabel('x')
        ax2.set_ylabel('y')
        ax2.set_title('俯视图（等值线）', fontweight='bold')
        fig.colorbar(contour, ax=ax2)
        
        plt.tight_layout()
        plt.savefig('integration_volume_3d.png', dpi=300)
        plt.show()

# 示例使用
print("="*60)
print("重积分计算器")
print("="*60)

mi = MultipleIntegral()

# 例题1：二重积分（直角坐标）
print("\n例题1：∫∫ xy dxdy, D: 0≤x≤1, 0≤y≤x²")

def f1(x, y):
    return x * y

result1, error1 = mi.double_integral_rectangular(
    f1,
    (0, 1),
    (lambda x: 0, lambda x: x**2)
)

print(f"  数值结果 = {result1:.10f}")
print(f"  理论结果 = {1/12:.10f}")
print(f"  误差 = {abs(result1 - 1/12):.2e}")

# 可视化积分区域
mi.plot_integration_domain_2d(
    (0, 1),
    (lambda x: 0, lambda x: x**2),
    '例题1积分区域'
)

# 例题2：二重积分（极坐标）
print("\n例题2：∫∫ exp(-(x²+y²)) dxdy, D: x²+y²≤1")

def f2_polar(r, theta):
    return np.exp(-r**2)

result2, error2 = mi.double_integral_polar(
    f2_polar,
    (0, 2*np.pi),
    (lambda theta: 0, lambda theta: 1)
)

theoretical2 = np.pi * (1 - np.exp(-1))
print(f"  数值结果 = {result2:.10f}")
print(f"  理论结果 = {theoretical2:.10f}")
print(f"  误差 = {abs(result2 - theoretical2):.2e}")

# 例题3：体积计算
print("\n例题3：抛物面z=1-x²-y²与xy平面围成的体积")

def f3(x, y):
    return max(0, 1 - x**2 - y**2)

# 使用极坐标更方便
def f3_polar(r, theta):
    return 1 - r**2

volume, error = mi.double_integral_polar(
    f3_polar,
    (0, 2*np.pi),
    (lambda theta: 0, lambda theta: 1)
)

print(f"  数值结果 = {volume:.10f}")
print(f"  理论结果 = {np.pi/2:.10f}")

# 可视化
print("\n绘制三维体积...")
mi.plot_integration_volume_3d(f3, (-1.5, 1.5), (-1.5, 1.5))
```

---

## 五、典型例题精选

### 例题10：交换积分次序

**题**：交换积分次序$\int_0^1 \mathrm{d}y \int_y^1 f(x,y)\mathrm{d}x$

**解**：
原积分区域：$0 \leq y \leq 1, y \leq x \leq 1$

改为X型：$0 \leq x \leq 1, 0 \leq y \leq x$

$$= \int_0^1 \mathrm{d}x \int_0^x f(x,y)\mathrm{d}y$$

---

### 例题11：积分不等式

**题**：证明$\iiint_\Omega f(x,y,z)\mathrm{d}V \leq V_\Omega \cdot \max f$

**解**：
$$\iiint_\Omega f(x,y,z)\mathrm{d}V \leq \iiint_\Omega \max f \mathrm{d}V = \max f \cdot V_\Omega$$

---

**本章重点**：
- 二重积分（直角、极坐标）
- 三重积分（柱坐标、球坐标）
- 对称性与奇偶性利用
- 体积与曲面积分应用

**下一章**：曲线曲面积分
