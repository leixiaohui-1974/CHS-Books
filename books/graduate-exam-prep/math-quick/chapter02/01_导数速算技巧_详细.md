# 第2章：导数速算15招

**目标**: 20秒内完成基本求导  
**技巧数**: 15个

---

## 技巧1：基本公式背诵

**必背15个**：

| 函数 | 导数 |
|------|------|
| $c$ | $0$ |
| $x^n$ | $nx^{n-1}$ |
| $\sin x$ | $\cos x$ |
| $\cos x$ | $-\sin x$ |
| $\tan x$ | $\sec^2 x$ |
| $e^x$ | $e^x$ |
| $a^x$ | $a^x \ln a$ |
| $\ln x$ | $\frac{1}{x}$ |
| $\log_a x$ | $\frac{1}{x\ln a}$ |
| $\arcsin x$ | $\frac{1}{\sqrt{1-x^2}}$ |
| $\arccos x$ | $-\frac{1}{\sqrt{1-x^2}}$ |
| $\arctan x$ | $\frac{1}{1+x^2}$ |

**记忆口诀**：
> 幂降次，指不变  
> 三角函数互余反  
> 对数倒数加ln底  
> 反三角根式记心间

---

## 技巧2：四则运算

$$(u \pm v)' = u' \pm v'$$
$$(uv)' = u'v + uv'$$
$$\left(\frac{u}{v}\right)' = \frac{u'v - uv'}{v^2}$$

**【例】**：
$$\left(x^2 \sin x\right)' = 2x \sin x + x^2 \cos x$$

---

## 技巧3：复合函数链式法则

$$[f(g(x))]' = f'(g(x)) \cdot g'(x)$$

**口诀**：先外后内，逐层求导

**【例】**：
$$(\sin 2x)' = \cos 2x \cdot 2 = 2\cos 2x$$

$$(\ln(1+x^2))' = \frac{1}{1+x^2} \cdot 2x = \frac{2x}{1+x^2}$$

---

## 技巧4：隐函数求导

**直接对两边求导，注意$\frac{dy}{dx}$**

**【例】**：$x^2 + y^2 = 1$，求$\frac{dy}{dx}$

$$2x + 2y\frac{dy}{dx} = 0$$

$$\frac{dy}{dx} = -\frac{x}{y}$$

---

## 技巧5：参数方程求导

$$\frac{dy}{dx} = \frac{dy/dt}{dx/dt} = \frac{y'_t}{x'_t}$$

**【例】**：$\begin{cases} x = t^2 \\ y = t^3 \end{cases}$

$$\frac{dy}{dx} = \frac{3t^2}{2t} = \frac{3t}{2}$$

---

## 技巧6：对数求导法

**适用**：幂指函数、连乘连除

**步骤**：
1. 两边取ln
2. 求导
3. 解出$y'$

**【例】**：$y = x^{\sin x}$

$$\ln y = \sin x \cdot \ln x$$

$$\frac{y'}{y} = \cos x \cdot \ln x + \sin x \cdot \frac{1}{x}$$

$$y' = x^{\sin x}\left(\cos x \ln x + \frac{\sin x}{x}\right)$$

---

## 技巧7：高阶导数公式

**莱布尼茨公式**：
$$(uv)^{(n)} = \sum_{k=0}^{n} C_n^k u^{(k)} v^{(n-k)}$$

**常用高阶导数**：
- $(e^{ax})^{(n)} = a^n e^{ax}$
- $(\sin ax)^{(n)} = a^n \sin(ax + \frac{n\pi}{2})$
- $(\ln x)^{(n)} = \frac{(-1)^{n-1}(n-1)!}{x^n}$

---

## Python速算工具

```python
import sympy as sp
import numpy as np
import matplotlib.pyplot as plt

class DerivativeQuick:
    """导数快速计算"""
    
    @staticmethod
    def basic_derivative(expr_str, var='x'):
        """
        基本求导
        
        参数:
            expr_str: 表达式字符串
            var: 变量
        """
        x = sp.Symbol(var)
        expr = sp.sympify(expr_str)
        
        # 求导
        deriv = sp.diff(expr, x)
        
        # 简化
        deriv_simplified = sp.simplify(deriv)
        
        print(f"f(x) = {expr}")
        print(f"f'(x) = {deriv_simplified}")
        
        return deriv_simplified
    
    @staticmethod
    def implicit_derivative(equation_str, var='x', dep_var='y'):
        """
        隐函数求导
        
        例: "x**2 + y**2 - 1"
        """
        x = sp.Symbol(var)
        y = sp.Function(dep_var)(x)
        
        # 解析方程
        eq = sp.sympify(equation_str)
        
        # 对x求导
        eq_diff = sp.diff(eq, x)
        
        # 解出dy/dx
        dy_dx = sp.solve(eq_diff, sp.diff(y, x))[0]
        
        print(f"方程: {eq} = 0")
        print(f"dy/dx = {dy_dx}")
        
        return dy_dx
    
    @staticmethod
    def parametric_derivative(x_t_str, y_t_str, t_var='t'):
        """
        参数方程求导
        
        dy/dx = (dy/dt) / (dx/dt)
        """
        t = sp.Symbol(t_var)
        
        x_t = sp.sympify(x_t_str)
        y_t = sp.sympify(y_t_str)
        
        dx_dt = sp.diff(x_t, t)
        dy_dt = sp.diff(y_t, t)
        
        dy_dx = sp.simplify(dy_dt / dx_dt)
        
        print(f"x(t) = {x_t}")
        print(f"y(t) = {y_t}")
        print(f"dy/dx = {dy_dx}")
        
        return dy_dx
    
    @staticmethod
    def logarithmic_derivative(expr_str, var='x'):
        """
        对数求导法
        
        适用于幂指函数
        """
        x = sp.Symbol(var)
        expr = sp.sympify(expr_str)
        
        # ln两边
        ln_expr = sp.log(expr)
        
        # 对ln(y)求导
        d_ln = sp.diff(ln_expr, x)
        
        # y' = y * (ln y)'
        deriv = sp.simplify(expr * d_ln)
        
        print(f"y = {expr}")
        print(f"ln(y) = {ln_expr}")
        print(f"(ln y)' = {d_ln}")
        print(f"y' = {deriv}")
        
        return deriv
    
    @staticmethod
    def plot_derivative(expr_str, x_range=(-5, 5)):
        """绘制函数及其导数"""
        x = sp.Symbol('x')
        expr = sp.sympify(expr_str)
        deriv = sp.diff(expr, x)
        
        # 转为数值函数
        f = sp.lambdify(x, expr, 'numpy')
        f_prime = sp.lambdify(x, deriv, 'numpy')
        
        x_vals = np.linspace(x_range[0], x_range[1], 200)
        
        try:
            y_vals = f(x_vals)
            y_prime_vals = f_prime(x_vals)
            
            fig, axes = plt.subplots(1, 2, figsize=(14, 5))
            
            # 原函数
            axes[0].plot(x_vals, y_vals, 'b-', linewidth=2, label='f(x)')
            axes[0].axhline(0, color='k', linewidth=0.5)
            axes[0].axvline(0, color='k', linewidth=0.5)
            axes[0].set_xlabel('x', fontsize=12)
            axes[0].set_ylabel('y', fontsize=12)
            axes[0].set_title(f'f(x) = {expr}', fontsize=14)
            axes[0].legend()
            axes[0].grid(True, alpha=0.3)
            
            # 导数
            axes[1].plot(x_vals, y_prime_vals, 'r-', linewidth=2, 
                        label="f'(x)")
            axes[1].axhline(0, color='k', linewidth=0.5)
            axes[1].axvline(0, color='k', linewidth=0.5)
            
            # 标注零点
            zeros_idx = np.where(np.diff(np.sign(y_prime_vals)))[0]
            for idx in zeros_idx[:3]:  # 最多标3个
                axes[1].plot(x_vals[idx], 0, 'go', markersize=10)
            
            axes[1].set_xlabel('x', fontsize=12)
            axes[1].set_ylabel("y'", fontsize=12)
            axes[1].set_title(f"f'(x) = {deriv}", fontsize=14)
            axes[1].legend()
            axes[1].grid(True, alpha=0.3)
            
            plt.tight_layout()
            plt.savefig('derivative_plot.png', dpi=300)
            plt.show()
            
        except Exception as e:
            print(f"绘图错误: {e}")

# 示例1：基本求导
print("="*60)
print("示例1：基本求导")
print("="*60)

calc = DerivativeQuick()

examples_basic = [
    "x**3 + 2*x**2 - 5*x + 1",
    "sin(x) * cos(x)",
    "exp(x) / (1 + x**2)",
    "ln(x**2 + 1)",
    "x**x"
]

for expr in examples_basic:
    calc.basic_derivative(expr)
    print()

# 示例2：隐函数求导
print("="*60)
print("示例2：隐函数求导")
print("="*60)

# x² + y² = 1
calc.implicit_derivative("x**2 + y**2 - 1")

# 示例3：参数方程
print("\n" + "="*60)
print("示例3：参数方程求导")
print("="*60)

# 摆线
calc.parametric_derivative("t - sin(t)", "1 - cos(t)")

# 示例4：对数求导
print("\n" + "="*60)
print("示例4：对数求导法")
print("="*60)

# y = x^sin(x)
calc.logarithmic_derivative("x**sin(x)")

# 可视化
print("\n" + "="*60)
print("示例5：可视化")
print("="*60)

calc.plot_derivative("x**3 - 3*x", x_range=(-3, 3))
```

---

## 10道速算练习

1. $(x^5)' = $ **5x⁴**

2. $(\sin 3x)' = $ **3cos 3x**

3. $(e^{2x})' = $ **2e^(2x)**

4. $(\ln(1+x))' = $ **1/(1+x)**

5. $(x^2 e^x)' = $ **(2x + x²)e^x**

6. $(\frac{\sin x}{x})' = $ **(x cos x - sin x)/x²**

7. $(x^x)' = $ **x^x(ln x + 1)**

8. $x^2 + xy + y^2 = 1, \frac{dy}{dx} = $ **-(2x+y)/(x+2y)**

9. $\begin{cases} x=\cos t \\ y=\sin t \end{cases}, \frac{dy}{dx} = $ **-cot t**

10. $((\sin x)^x)' = $ **...**（对数求导）

---

**时间目标**：
- 基本求导：≤15秒
- 复合函数：≤25秒
- 隐函数/参数方程：≤40秒

**下一章**：积分速算12法
