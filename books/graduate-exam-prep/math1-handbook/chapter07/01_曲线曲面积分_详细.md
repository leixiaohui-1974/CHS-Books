# 第7章：曲线曲面积分速解

**学习时间**: 5小时  
**难度**: ⭐⭐⭐⭐⭐  
**考试权重**: 12%

---

## 一、第一类曲线积分

### 1.1 定义

**对弧长的曲线积分**：
$$\int_L f(x,y)ds$$

**几何意义**：曲面面积

### 1.2 计算方法

**参数方程**：$x=x(t)$，$y=y(t)$，$t \in [\alpha, \beta]$

$$\int_L f(x,y)ds = \int_{\alpha}^{\beta} f(x(t), y(t))\sqrt{x'^2(t) + y'^2(t)}dt$$

**直角坐标**：$y=y(x)$，$x \in [a, b]$

$$\int_L f(x,y)ds = \int_a^b f(x, y(x))\sqrt{1 + y'^2}dx$$

---

## 二、第二类曲线积分

### 2.1 定义

**对坐标的曲线积分**：
$$\int_L P(x,y)dx + Q(x,y)dy$$

**物理意义**：变力做功

### 2.2 计算方法

**参数方程法**：
$$\int_L Pdx + Qdy = \int_{\alpha}^{\beta}[P(x(t),y(t))x'(t) + Q(x(t),y(t))y'(t)]dt$$

### 2.3 格林公式

**条件**：L为封闭曲线，D为L围成的区域

$$\oint_L Pdx + Qdy = \iint_D \left(\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}\right)dxdy$$

**路径无关条件**：
$$\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x}$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import quad, dblquad
from mpl_toolkits.mplot3d import Axes3D

class CurveIntegral:
    """
    曲线积分计算
    """
    
    @staticmethod
    def first_kind_parametric(f, x_func, y_func, t_range):
        """
        第一类曲线积分（参数方程）
        
        ∫_L f(x,y)ds
        
        参数:
            f: 被积函数 f(x, y)
            x_func, y_func: 参数方程 x(t), y(t)
            t_range: (t_min, t_max)
        """
        def integrand(t):
            x = x_func(t)
            y = y_func(t)
            
            # 数值导数
            h = 1e-6
            dx_dt = (x_func(t + h) - x_func(t - h)) / (2 * h)
            dy_dt = (y_func(t + h) - y_func(t - h)) / (2 * h)
            
            ds_dt = np.sqrt(dx_dt**2 + dy_dt**2)
            
            return f(x, y) * ds_dt
        
        result, error = quad(integrand, t_range[0], t_range[1])
        
        return result
    
    @staticmethod
    def second_kind_parametric(P, Q, x_func, y_func, t_range):
        """
        第二类曲线积分（参数方程）
        
        ∫_L Pdx + Qdy
        
        参数:
            P, Q: 被积函数 P(x,y), Q(x,y)
            x_func, y_func: 参数方程
            t_range: (t_min, t_max)
        """
        def integrand(t):
            x = x_func(t)
            y = y_func(t)
            
            # 数值导数
            h = 1e-6
            dx_dt = (x_func(t + h) - x_func(t - h)) / (2 * h)
            dy_dt = (y_func(t + h) - y_func(t - h)) / (2 * h)
            
            return P(x, y) * dx_dt + Q(x, y) * dy_dt
        
        result, error = quad(integrand, t_range[0], t_range[1])
        
        return result
    
    @staticmethod
    def green_formula(P, Q, region_bounds):
        """
        格林公式
        
        ∮_L Pdx + Qdy = ∬_D (∂Q/∂x - ∂P/∂y)dxdy
        
        参数:
            P, Q: 函数
            region_bounds: 区域边界 (x_min, x_max, y_min_func, y_max_func)
        """
        def integrand(y, x):
            # 数值偏导数
            h = 1e-6
            
            dQ_dx = (Q(x + h, y) - Q(x - h, y)) / (2 * h)
            dP_dy = (P(x, y + h) - P(x, y - h)) / (2 * h)
            
            return dQ_dx - dP_dy
        
        x_min, x_max, y_min_func, y_max_func = region_bounds
        
        result, error = dblquad(
            integrand,
            x_min, x_max,
            y_min_func, y_max_func
        )
        
        return result
    
    @staticmethod
    def plot_vector_field(P, Q, x_range=(-2, 2), y_range=(-2, 2)):
        """
        绘制向量场
        """
        x = np.linspace(x_range[0], x_range[1], 20)
        y = np.linspace(y_range[0], y_range[1], 20)
        X, Y = np.meshgrid(x, y)
        
        U = np.zeros_like(X)
        V = np.zeros_like(Y)
        
        for i in range(X.shape[0]):
            for j in range(X.shape[1]):
                U[i, j] = P(X[i, j], Y[i, j])
                V[i, j] = Q(X[i, j], Y[i, j])
        
        plt.figure(figsize=(10, 8))
        plt.quiver(X, Y, U, V, alpha=0.6)
        plt.xlabel('x')
        plt.ylabel('y')
        plt.title('向量场')
        plt.grid(True, alpha=0.3)
        plt.axis('equal')
        plt.savefig('vector_field.png', dpi=300, bbox_inches='tight')
        plt.show()


# 示例1：第一类曲线积分
print("="*60)
print("示例1：第一类曲线积分")
print("="*60)

# 计算 ∫_L (x+y)ds，L: x²+y²=1（上半圆）

def f(x, y):
    return x + y

# 参数方程：x=cos(t), y=sin(t), t∈[0,π]
def x_circle(t):
    return np.cos(t)

def y_circle(t):
    return np.sin(t)

result1 = CurveIntegral.first_kind_parametric(
    f, x_circle, y_circle, (0, np.pi)
)

print(f"∫_L (x+y)ds = {result1:.6f}")
print(f"理论值: 0 (对称性)")

# 示例2：第二类曲线积分
print("\n" + "="*60)
print("示例2：第二类曲线积分")
print("="*60)

# ∫_L y²dx + x²dy，L: 从(0,0)到(1,1)的直线

def P(x, y):
    return y**2

def Q(x, y):
    return x**2

# 参数方程：x=t, y=t, t∈[0,1]
def x_line(t):
    return t

def y_line(t):
    return t

result2 = CurveIntegral.second_kind_parametric(
    P, Q, x_line, y_line, (0, 1)
)

print(f"∫_L y²dx + x²dy = {result2:.6f}")
print(f"理论值: 2/3 ≈ {2/3:.6f}")

# 示例3：格林公式
print("\n" + "="*60)
print("示例3：格林公式验证")
print("="*60)

# ∮_L (-y)dx + xdy，L: 单位圆

# 方法1：直接计算
def P_green(x, y):
    return -y

def Q_green(x, y):
    return x

# 参数方程：圆周
result_direct = CurveIntegral.second_kind_parametric(
    P_green, Q_green,
    lambda t: np.cos(t),
    lambda t: np.sin(t),
    (0, 2*np.pi)
)

# 方法2：格林公式
# ∂Q/∂x - ∂P/∂y = 1 - (-1) = 2
# ∬_D 2dxdy = 2·π·1² = 2π

result_green = CurveIntegral.green_formula(
    P_green, Q_green,
    (-1, 1, lambda x: -np.sqrt(1-x**2), lambda x: np.sqrt(1-x**2))
)

print(f"直接计算: {result_direct:.6f}")
print(f"格林公式: {result_green:.6f}")
print(f"理论值: {2*np.pi:.6f}")

# 可视化向量场
CurveIntegral.plot_vector_field(P_green, Q_green)
```

---

## 三、曲面积分

### 3.1 第一类曲面积分

$$\iint_{\Sigma} f(x,y,z)dS$$

**计算**（曲面$z=z(x,y)$）：
$$\iint_{\Sigma} f dS = \iint_D f(x,y,z(x,y))\sqrt{1 + z_x^2 + z_y^2}dxdy$$

### 3.2 第二类曲面积分

$$\iint_{\Sigma} Pdydz + Qdzdx + Rdxdy$$

**高斯公式**：
$$\oiint_{\Sigma} Pdydz + Qdzdx + Rdxdy = \iiint_{\Omega}\left(\frac{\partial P}{\partial x} + \frac{\partial Q}{\partial y} + \frac{\partial R}{\partial z}\right)dV$$

---

## 四、典型考题

### 考题1：计算曲线积分

**【题目】**计算 $\int_L (x^2+y^2)ds$，L为圆$x^2+y^2=a^2$

**【解答】**

参数方程：$x=a\cos t$，$y=a\sin t$，$t \in [0, 2\pi]$

$$ds = a dt$$

$$\int_L (x^2+y^2)ds = \int_0^{2\pi} a^2 \cdot a dt = 2\pi a^3$$

---

### 考题2：格林公式

**【题目】**用格林公式计算 $\oint_L xdy - ydx$，L为椭圆$\frac{x^2}{a^2}+\frac{y^2}{b^2}=1$

**【解答】**

$$P = -y, \quad Q = x$$

$$\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y} = 1 - (-1) = 2$$

$$\oint_L = \iint_D 2dxdy = 2 \times \pi ab = 2\pi ab$$

---

## 五、速记口诀

> 第一类积分对弧长  
> 第二类积分对坐标  
> 格林公式连二重  
> 高斯公式通三重

---

**本章重点**：
- 第二类曲线积分最常考
- 格林公式应用广泛
- 参数方程计算法
- 路径无关条件

**下一章**：场论初步（梯度、散度、旋度）
