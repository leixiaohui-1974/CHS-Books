# 第1章：高等数学核心定理与速算技巧

**学习时间**: 6小时  
**难度**: ⭐⭐⭐⭐  
**考试权重**: 25%

---

## 一、极限与连续

### 1.1 重要极限（背诵）

#### 两个重要极限

$$\lim_{x \to 0}\frac{\sin x}{x} = 1$$

$$\lim_{x \to \infty}\left(1 + \frac{1}{x}\right)^x = e$$

#### Python验证

```python
import numpy as np
import matplotlib.pyplot as plt

def verify_important_limits():
    """
    验证两个重要极限
    """
    # 第一个重要极限
    x1 = np.linspace(-0.5, 0.5, 1000)
    x1 = x1[x1 != 0]  # 移除0点
    y1 = np.sin(x1) / x1
    
    # 第二个重要极限
    x2 = np.logspace(0, 3, 1000)  # 1到1000
    y2 = (1 + 1/x2)**x2
    
    # 绘图
    fig, axes = plt.subplots(1, 2, figsize=(12, 5))
    
    # 第一个极限
    axes[0].plot(x1, y1, 'b-', linewidth=2)
    axes[0].axhline(1, color='r', linestyle='--', label='y=1')
    axes[0].set_xlabel('x')
    axes[0].set_ylabel('sin(x)/x')
    axes[0].set_title('第一重要极限')
    axes[0].grid(True, alpha=0.3)
    axes[0].legend()
    axes[0].set_ylim([0.9, 1.1])
    
    # 第二个极限
    axes[1].semilogx(x2, y2, 'b-', linewidth=2)
    axes[1].axhline(np.e, color='r', linestyle='--', label=f'y=e≈{np.e:.4f}')
    axes[1].set_xlabel('x')
    axes[1].set_ylabel('(1+1/x)^x')
    axes[1].set_title('第二重要极限')
    axes[1].grid(True, alpha=0.3)
    axes[1].legend()
    
    plt.tight_layout()
    plt.savefig('important_limits.png', dpi=300, bbox_inches='tight')
    plt.show()
    
    print(f"第一重要极限验证:")
    print(f"  x→0时, sin(x)/x → {y1[len(y1)//2]:.6f}")
    print(f"\n第二重要极限验证:")
    print(f"  x→∞时, (1+1/x)^x → {y2[-1]:.6f}")
    print(f"  e的准确值: {np.e:.6f}")

verify_important_limits()
```

### 1.2 等价无穷小（必背）

当$x \to 0$时：

| 函数 | 等价无穷小 | 应用场景 |
|------|-----------|---------|
| $\sin x$ | $x$ | 三角极限 |
| $\tan x$ | $x$ | 三角极限 |
| $\arcsin x$ | $x$ | 反三角 |
| $\arctan x$ | $x$ | 反三角 |
| $\ln(1+x)$ | $x$ | 对数极限 |
| $e^x - 1$ | $x$ | 指数极限 |
| $1 - \cos x$ | $\frac{x^2}{2}$ | **高频** |
| $(1+x)^a - 1$ | $ax$ | 幂函数 |

#### 典型例题

**【例1】**计算 $\lim_{x \to 0}\frac{\sin 3x}{x}$

**解**：
$$\lim_{x \to 0}\frac{\sin 3x}{x} = \lim_{x \to 0}\frac{\sin 3x}{3x} \cdot 3 = 1 \times 3 = 3$$

**【例2】**计算 $\lim_{x \to 0}\frac{e^x - 1 - x}{x^2}$

**解**：泰勒展开
$$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots$$

$$\frac{e^x - 1 - x}{x^2} = \frac{\frac{x^2}{2} + \frac{x^3}{6} + \cdots}{x^2} = \frac{1}{2} + \frac{x}{6} + \cdots$$

$$\lim_{x \to 0}\frac{e^x - 1 - x}{x^2} = \frac{1}{2}$$

#### Python实现

```python
import sympy as sp

def equivalent_infinitesimal_calculator():
    """
    等价无穷小计算器
    """
    x = sp.Symbol('x')
    
    # 常见函数的泰勒展开
    functions = {
        'sin(x)': sp.sin(x),
        'tan(x)': sp.tan(x),
        'ln(1+x)': sp.ln(1+x),
        'e^x - 1': sp.exp(x) - 1,
        '1 - cos(x)': 1 - sp.cos(x),
        '(1+x)^2 - 1': (1+x)**2 - 1
    }
    
    print("常见函数的泰勒展开（x→0）:")
    print("=" * 60)
    
    for name, func in functions.items():
        # 泰勒展开到x^3
        taylor = sp.series(func, x, 0, n=4).removeO()
        print(f"{name:<15} ≈ {taylor}")
        
        # 主项（最低次幂）
        leading_term = sp.series(func, x, 0, n=2).removeO()
        print(f"{'':15} ~ {leading_term} (主项)")
        print()

equivalent_infinitesimal_calculator()
```

---

## 二、导数与微分

### 2.1 常见函数导数表（必背）

| 原函数 | 导数 | 记忆技巧 |
|--------|------|---------|
| $x^n$ | $nx^{n-1}$ | 指数下降 |
| $\sin x$ | $\cos x$ | 正变余 |
| $\cos x$ | $-\sin x$ | 余变负正 |
| $e^x$ | $e^x$ | 不变 |
| $a^x$ | $a^x \ln a$ | 加ln |
| $\ln x$ | $\frac{1}{x}$ | 倒数 |
| $\log_a x$ | $\frac{1}{x\ln a}$ | 加lna |
| $\arcsin x$ | $\frac{1}{\sqrt{1-x^2}}$ | 开方 |
| $\arctan x$ | $\frac{1}{1+x^2}$ | 平方加1 |

### 2.2 求导技巧

#### 技巧1：对数求导法

适用于**幂指函数** $y = u(x)^{v(x)}$

步骤：
1. 两边取对数：$\ln y = v(x)\ln u(x)$
2. 两边求导：$\frac{y'}{y} = v'(x)\ln u(x) + v(x)\frac{u'(x)}{u(x)}$
3. 整理：$y' = y\left[v'(x)\ln u(x) + v(x)\frac{u'(x)}{u(x)}\right]$

**【例3】**求 $y = x^x$ 的导数

**解**：
$$\ln y = x\ln x$$

$$\frac{y'}{y} = \ln x + 1$$

$$y' = x^x(\ln x + 1)$$

#### 技巧2：参数方程求导

若 $\begin{cases} x = \varphi(t) \\ y = \psi(t) \end{cases}$

则：
$$\frac{dy}{dx} = \frac{dy/dt}{dx/dt} = \frac{\psi'(t)}{\varphi'(t)}$$

$$\frac{d^2y}{dx^2} = \frac{d}{dx}\left(\frac{dy}{dx}\right) = \frac{d}{dt}\left(\frac{dy}{dx}\right) \cdot \frac{dt}{dx} = \frac{\frac{d}{dt}\left(\frac{\psi'(t)}{\varphi'(t)}\right)}{\varphi'(t)}$$

#### Python实现

```python
import sympy as sp

class DerivativeCalculator:
    """
    导数计算器
    """
    
    def __init__(self):
        self.x = sp.Symbol('x')
        self.t = sp.Symbol('t')
    
    def logarithmic_differentiation(self, base, exponent):
        """
        对数求导法
        
        参数:
            base: 底数函数（关于x的表达式）
            exponent: 指数函数（关于x的表达式）
        
        返回:
            导数
        """
        y = base ** exponent
        
        # 方法1：直接求导
        dy_direct = sp.diff(y, self.x)
        
        # 方法2：对数求导
        ln_y = exponent * sp.ln(base)
        d_ln_y = sp.diff(ln_y, self.x)
        dy_log = sp.simplify(y * d_ln_y)
        
        return {
            'function': y,
            'derivative_direct': dy_direct,
            'derivative_logarithmic': dy_log,
            'simplified': sp.simplify(dy_direct)
        }
    
    def parametric_derivative(self, x_expr, y_expr, order=1):
        """
        参数方程求导
        
        参数:
            x_expr: x(t)
            y_expr: y(t)
            order: 导数阶数 (1或2)
        """
        dx_dt = sp.diff(x_expr, self.t)
        dy_dt = sp.diff(y_expr, self.t)
        
        # 一阶导数
        dy_dx = dy_dt / dx_dt
        
        if order == 1:
            return sp.simplify(dy_dx)
        
        # 二阶导数
        d2y_dx2 = sp.diff(dy_dx, self.t) / dx_dt
        
        return sp.simplify(dy_dx), sp.simplify(d2y_dx2)
    
    def implicit_derivative(self, equation):
        """
        隐函数求导
        
        参数:
            equation: 方程 F(x,y)=0
        """
        y = sp.Function('y')(self.x)
        
        # 对x求导
        eq_diff = sp.diff(equation, self.x)
        
        # 解出dy/dx
        dy_dx = sp.solve(eq_diff, sp.diff(y, self.x))
        
        return dy_dx

# 示例
calc = DerivativeCalculator()
x = calc.x
t = calc.t

print("="*50)
print("示例1：对数求导法 - y = x^x")
print("="*50)
result = calc.logarithmic_differentiation(x, x)
print(f"函数: {result['function']}")
print(f"导数: {result['simplified']}")

print("\n"+"="*50)
print("示例2：参数方程求导")
print("="*50)
# 椭圆参数方程
x_param = sp.cos(t)
y_param = sp.sin(t)
dy_dx, d2y_dx2 = calc.parametric_derivative(x_param, y_param, order=2)
print(f"x = cos(t), y = sin(t)")
print(f"dy/dx = {dy_dx}")
print(f"d²y/dx² = {d2y_dx2}")

print("\n"+"="*50)
print("示例3：常见函数导数验证")
print("="*50)

test_functions = [
    (x**2, '幂函数'),
    (sp.sin(x), '正弦'),
    (sp.exp(x), '指数'),
    (sp.ln(x), '对数'),
    (x**x, '幂指函数')
]

for func, name in test_functions:
    deriv = sp.diff(func, x)
    print(f"{name:<10} f(x)={func:<15} f'(x)={deriv}")
```

---

## 三、积分技巧

### 3.1 基本积分表（必背前10个）

| 原函数 | 不定积分 | 备注 |
|--------|---------|------|
| $x^n$ | $\frac{x^{n+1}}{n+1} + C$ | $n \neq -1$ |
| $\frac{1}{x}$ | $\ln|x| + C$ | **高频** |
| $e^x$ | $e^x + C$ | 不变 |
| $a^x$ | $\frac{a^x}{\ln a} + C$ | 除以lna |
| $\sin x$ | $-\cos x + C$ | 负号 |
| $\cos x$ | $\sin x + C$ | 无负号 |
| $\frac{1}{1+x^2}$ | $\arctan x + C$ | 反正切 |
| $\frac{1}{\sqrt{1-x^2}}$ | $\arcsin x + C$ | 反正弦 |
| $\tan x$ | $-\ln|\cos x| + C$ | 记忆 |
| $\cot x$ | $\ln|\sin x| + C$ | 记忆 |

### 3.2 分部积分法

公式：
$$\int u\,dv = uv - \int v\,du$$

**口诀**："反对幂三指"
- 反：反三角函数
- 对：对数函数
- 幂：幂函数
- 三：三角函数
- 指：指数函数

选择$u$的优先级：反 > 对 > 幂 > 三 > 指

**【例4】**计算 $\int x\ln x\,dx$

**解**：
$$u = \ln x, \quad dv = x\,dx$$

$$du = \frac{1}{x}dx, \quad v = \frac{x^2}{2}$$

$$\int x\ln x\,dx = \frac{x^2}{2}\ln x - \int \frac{x^2}{2} \cdot \frac{1}{x}dx$$

$$= \frac{x^2}{2}\ln x - \frac{1}{2}\int x\,dx$$

$$= \frac{x^2}{2}\ln x - \frac{x^2}{4} + C$$

---

## 四、高频考点速查表

### 4.1 Taylor公式（考点⭐⭐⭐⭐⭐）

| 函数 | 泰勒展开（$x \to 0$） |
|------|---------------------|
| $e^x$ | $1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots$ |
| $\sin x$ | $x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots$ |
| $\cos x$ | $1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \cdots$ |
| $\ln(1+x)$ | $x - \frac{x^2}{2} + \frac{x^3}{3} - \cdots$ |
| $(1+x)^a$ | $1 + ax + \frac{a(a-1)}{2!}x^2 + \cdots$ |

---

**本章习题**: 见配套练习册  
**下一章**: 线性代数核心定理
