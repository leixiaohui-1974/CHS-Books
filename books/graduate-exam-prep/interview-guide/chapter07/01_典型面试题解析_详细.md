# 第7章：典型面试题解析

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、水力学基础问题

### 【问题1】伯努利方程的应用条件

**题目**：请说明伯努利方程的适用条件，并举例说明如何应用。

**标准答案**：

**适用条件**：
1. 理想流体（不考虑粘性）或实际流体（加入能量损失项）
2. 定常流动
3. 沿流线或微小流束
4. 质量力只有重力

**方程形式**：
$$\frac{p}{\rho g} + \frac{v^2}{2g} + z = C$$

**实际应用**（加损失项）：
$$\frac{p_1}{\rho g} + \frac{v_1^2}{2g} + z_1 = \frac{p_2}{\rho g} + \frac{v_2^2}{2g} + z_2 + h_w$$

**应用示例**：
```
虹吸管问题：
已知：上游水位H1=5m，下游H2=2m，管径d=0.1m，
     损失系数ζ=10
求：流量Q

解：
1) 列伯努利方程（取上下游水面）
   H1 = H2 + v²/(2g) + ζv²/(2g)
   
2) 求流速
   v = √[2g(H1-H2)/(1+ζ)]
     = √[2×9.81×3/11] = 2.29 m/s

3) 求流量
   Q = Av = π×0.1²/4 × 2.29 = 0.018 m³/s
```

**追问处理**：
- "如果考虑沿程损失？" → 加入λL/d·v²/(2g)项
- "如何测量流速？" → 皮托管原理，测动压+静压

---

### 【问题2】明渠临界流判别

**题目**：如何判断明渠流动是缓流还是急流？临界状态有什么特点？

**标准答案**：

**判别标准**：弗劳德数Fr
$$Fr = \frac{v}{\sqrt{gh}}$$

- $Fr < 1$：缓流（河流、运河）
- $Fr = 1$：临界流（宽顶堰、陡坡过渡）
- $Fr > 1$：急流（溢洪道、陡槽）

**临界水深**：
$$h_c = \left(\frac{q^2}{g}\right)^{1/3}$$

**临界流特点**：
1. 比能最小：$E_{min} = \frac{3}{2}h_c$
2. 流速等于波速：$v = \sqrt{gh}$
3. 控制断面（上游影响→下游）

**实例计算**：
```
矩形渠道：b=3m，Q=6m³/s，h=0.8m

1) 单宽流量
   q = Q/b = 6/3 = 2 m²/s

2) 临界水深
   hc = (q²/g)^(1/3) = (4/9.81)^(1/3) = 0.74 m

3) 实际流速
   v = Q/(bh) = 6/(3×0.8) = 2.5 m/s

4) Fr数
   Fr = v/√(gh) = 2.5/√(9.81×0.8) = 0.89 < 1

判断：缓流
```

**延伸问题**：
- "水跃发生条件？" → 急流→缓流，Fr1>1
- "如何控制流态？" → 调整坡度或设置堰

---

## 二、数值计算问题

### 【问题3】有限差分法基本原理

**题目**：简述有限差分法求解地下水流问题的基本步骤。

**标准答案**：

**控制方程**（二维稳态）：
$$\frac{\partial^2 h}{\partial x^2} + \frac{\partial^2 h}{\partial y^2} = 0$$

**求解步骤**：

**(1) 区域离散**：
- 划分网格：$\Delta x$, $\Delta y$
- 节点编号：$(i,j)$

**(2) 方程离散**：
```
五点差分格式：
(h_{i+1,j} - 2h_{i,j} + h_{i-1,j})/Δx² + 
(h_{i,j+1} - 2h_{i,j} + h_{i,j-1})/Δy² = 0

简化（Δx=Δy）：
h_{i,j} = (h_{i+1,j} + h_{i-1,j} + h_{i,j+1} + h_{i,j-1})/4
```

**(3) 边界条件**：
- 第一类：$h|_{\Gamma} = h_0$（已知水位）
- 第二类：$\partial h/\partial n|_{\Gamma} = 0$（隔水边界）

**(4) 迭代求解**：
```python
# Gauss-Seidel迭代
for k in range(max_iter):
    for i in range(1, nx-1):
        for j in range(1, ny-1):
            h_new[i,j] = 0.25*(h[i+1,j] + h_new[i-1,j] + 
                               h[i,j+1] + h_new[i,j-1])
    
    if max(|h_new - h|) < tol:
        break
```

**(5) 收敛判断**：
$$\max|h_{i,j}^{k+1} - h_{i,j}^k| < \epsilon$$

**代码示例**：
```python
import numpy as np

def solve_laplace_2d(nx, ny, h_boundary, tol=1e-6):
    """
    二维拉普拉斯方程求解
    """
    h = np.zeros((ny, nx))
    
    # 边界条件
    h[:, 0] = h_boundary['west']
    h[:, -1] = h_boundary['east']
    
    # 迭代
    for iteration in range(10000):
        h_old = h.copy()
        
        for i in range(1, ny-1):
            for j in range(1, nx-1):
                h[i,j] = 0.25*(h[i+1,j] + h[i-1,j] + 
                              h[i,j+1] + h[i,j-1])
        
        if np.max(np.abs(h - h_old)) < tol:
            print(f"收敛于第{iteration}次")
            break
    
    return h
```

**追问**：
- "如何加速收敛？" → SOR方法，$\omega=1.5\sim1.9$
- "稳定性条件？" → 显式格式需满足CFL条件

---

## 三、工程实践问题

### 【问题4】水库调度优化

**题目**：水库汛期如何平衡防洪与发电需求？

**标准答案**：

**多目标优化模型**：

**(1) 目标函数**：
```
max Z = w1·E_power + w2·S_flood + w3·W_supply

E_power：发电效益
S_flood：防洪安全度
W_supply：供水保证率
```

**(2) 约束条件**：
```
水量平衡：V_{t+1} = V_t + I_t - Q_t - Loss
水位约束：Z_{dead} ≤ Z_t ≤ Z_{normal}
流量约束：Q_{min} ≤ Q_t ≤ Q_{max}
出力约束：N_t = 9.81·η·Q_t·H_t ≤ N_{install}
```

**(3) 调度策略**：

**汛期（6-9月）**：
- 预泄腾库：腾出防洪库容
- 削峰调蓄：控制下泄流量
- 分级调度：按洪水量级应对

**非汛期（10-5月）**：
- 蓄水保水：维持高水位发电
- 优化调度：梯级联合运行
- 应急储备：保证供水需求

**(4) 典型算法**：
```python
def reservoir_operation(I_forecast, V_current):
    """
    水库调度决策
    
    输入：
        I_forecast：未来入库流量预报
        V_current：当前库容
    
    输出：
        Q_release：下泄流量
    """
    # 1. 判断汛限水位
    if month in [6, 7, 8, 9]:
        Z_limit = Z_flood_limit
    else:
        Z_limit = Z_normal
    
    # 2. 预报洪水总量
    W_flood = sum(I_forecast) * dt
    
    # 3. 计算防洪库容
    V_flood_control = V_normal - V_flood_limit
    
    # 4. 调度决策
    if W_flood < V_flood_control:
        # 小洪水：拦蓄
        Q_release = Q_min
    elif W_flood < V_flood_control * 2:
        # 中洪水：削峰
        Q_release = 0.5 * I_forecast[0]
    else:
        # 大洪水：敞泄
        Q_release = I_forecast[0]
    
    return Q_release
```

**实际案例**：
```
三峡水库2020年汛期调度：
- 7月初：预泄腾库至145m（防洪限制水位）
- 7月中：连续洪峰，削峰3-4万m³/s
- 8月：拦蓄洪水200亿m³
- 9月：逐步蓄至175m（正常蓄水位）
效果：下游防洪+上游发电+航运保障
```

---

### 【问题5】泵站选型设计

**题目**：如何为灌溉工程选择合适的水泵？

**标准答案**：

**设计步骤**：

**(1) 确定设计参数**：
```
设计流量Q：根据灌溉面积、作物需水
设计扬程H：地形高差+管路损失+富余
  H = H_geo + h_loss + h_margin
  
其中：
  H_geo：几何高差
  h_loss = λ(L/d)·v²/(2g) + Σζ·v²/(2g)
  h_margin = 2~3m（富余）
```

**(2) 选泵**：
```
比转速：n_s = 3.65·n·√Q / H^(3/4)

根据n_s选泵型：
  n_s < 60：离心泵
  60 < n_s < 150：混流泵
  n_s > 150：轴流泵
```

**(3) 工况点**：
```
泵特性曲线：H = H(Q)
管路特性曲线：H = H_geo + S·Q²

交点即工作点
```

**(4) 效率校核**：
```
η = ρgQH / (1000P_shaft)

要求η > 70%（高效区）
```

**计算示例**：
```
灌溉面积A=500亩，净灌水定额m=50mm，
灌水周期T=7天，扬程H_geo=15m，
管路总长L=500m，d=0.3m，λ=0.025，
局部损失ζΣ=8

1) 设计流量
   Q = A·m/(T·86400) = 500×667×0.05/(7×86400)
     = 0.028 m³/s = 100 m³/h

2) 管路损失
   v = Q/A_pipe = 0.028/(π×0.15²) = 0.40 m/s
   h_loss = 0.025×(500/0.3)×0.40²/(2×9.81) + 8×0.40²/(2×9.81)
          = 0.14 + 0.07 = 0.21 m

3) 设计扬程
   H = 15 + 0.21 + 2 = 17.2 m

4) 比转速
   取n=1450 r/min
   n_s = 3.65×1450×√0.028 / 17.2^0.75 = 69

5) 选泵
   选混流泵，型号：100HW-5
   Q_rated = 100 m³/h, H_rated = 18m, η=76%
```

---

## 四、综合分析问题

### 【问题6】南水北调工程分析

**题目**：从水力学角度分析南水北调中线工程的技术特点。

**标准答案**：

**工程概况**：
- 路线：丹江口水库→北京
- 总长：1432km
- 设计流量：350m³/s
- 输水方式：明渠自流

**技术特点**：

**(1) 长距离输水**：
```
沿程水头损失：
  h_f = λ(L/d)·v²/(2g)
  
对于明渠：
  h_f = n²·L·v² / R^(4/3)
  
控制措施：
- 减小糙率：混凝土衬砌，n=0.014
- 优化断面：梯形断面，边坡1:2
- 合理流速：v=1.0~1.5 m/s（不冲不淤）
```

**(2) 跨流域调水**：
```
关键构筑物：
- 渡槽：穿越河流，135座
- 倒虹吸：穿越道路、铁路
- 退水闸：洪水时排水
- 节制闸：分段控制水位
```

**(3) 水质保护**：
```
措施：
- 封闭输水：防止污染
- 清污设施：格栅、沉砂池
- 流速控制：防止藻类繁殖（v>0.3m/s）
- 生态流量：保障沿线生态需水
```

**(4) 冰期输水**：
```
北方冬季结冰问题：
- 冰盖下输水：减小过流面积
- 冰下流速：v_ice = v_0·(A_0/A_ice)
- 防冰措施：保温、增大断面
```

**数值分析**：
```python
def nanshui_canal_analysis():
    """南水北调中线输水分析"""
    
    # 参数
    Q = 350  # m³/s
    n = 0.014  # 糙率
    i = 1/20000  # 坡度
    b = 20  # 底宽(m)
    m = 2  # 边坡系数
    
    # 迭代求正常水深
    for h in np.linspace(0.1, 10, 1000):
        A = b*h + m*h**2
        P = b + 2*h*np.sqrt(1+m**2)
        R = A/P
        Q_calc = (1/n) * A * R**(2/3) * np.sqrt(i)
        
        if abs(Q_calc - Q) < 0.1:
            print(f"正常水深h = {h:.2f}m")
            print(f"流速v = {Q/A:.2f}m/s")
            print(f"水面宽度B = {b+2*m*h:.1f}m")
            break
    
    # 沿程损失
    L = 1432000  # m
    h_loss = n**2 * L * (Q/A)**2 / R**(4/3)
    print(f"总水头损失 = {h_loss:.1f}m")

nanshui_canal_analysis()
```

输出：
```
正常水深h = 4.82m
流速v = 3.47m/s
水面宽度B = 39.3m
总水头损失 = 约100m（实际通过多级泵站提升）
```

---

## 五、Python面试题

### 【问题7】数据处理与可视化

**题目**：给定一组水位流量数据，编写Python代码拟合水位流量关系并绘图。

**标准答案**：

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def rating_curve_analysis():
    """水位流量关系分析"""
    
    # 实测数据
    H_obs = np.array([10.5, 11.0, 11.5, 12.0, 12.5, 13.0, 13.5, 14.0])
    Q_obs = np.array([100, 180, 280, 400, 550, 730, 950, 1200])
    
    # 拟合模型：Q = a(H - H0)^b
    def model(H, a, b, H0):
        return a * (H - H0)**b
    
    # 拟合
    params, covariance = curve_fit(model, H_obs, Q_obs,
                                   p0=[50, 2, 9])
    
    a, b, H0 = params
    
    print(f"拟合结果:")
    print(f"  Q = {a:.1f}(H - {H0:.2f})^{b:.2f}")
    
    # 计算R²
    Q_fit = model(H_obs, a, b, H0)
    SS_res = np.sum((Q_obs - Q_fit)**2)
    SS_tot = np.sum((Q_obs - np.mean(Q_obs))**2)
    R2 = 1 - SS_res/SS_tot
    
    print(f"  R² = {R2:.4f}")
    
    # 绘图
    fig, axes = plt.subplots(1, 2, figsize=(14, 6))
    
    # 水位流量关系
    ax1 = axes[0]
    
    H_curve = np.linspace(H_obs.min(), H_obs.max(), 100)
    Q_curve = model(H_curve, a, b, H0)
    
    ax1.scatter(H_obs, Q_obs, s=100, color='blue',
               label='实测点', zorder=3)
    ax1.plot(H_curve, Q_curve, 'r-', linewidth=2.5,
            label=f'拟合曲线 R²={R2:.3f}')
    
    ax1.set_xlabel('水位 H (m)', fontsize=11)
    ax1.set_ylabel('流量 Q (m³/s)', fontsize=11)
    ax1.set_title('水位流量关系', fontsize=13, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)
    
    # 残差分析
    ax2 = axes[1]
    
    residuals = Q_obs - Q_fit
    
    ax2.scatter(Q_fit, residuals, s=100, color='purple')
    ax2.axhline(0, color='r', linestyle='--', linewidth=2)
    
    ax2.set_xlabel('拟合值 Q_fit (m³/s)', fontsize=11)
    ax2.set_ylabel('残差 (m³/s)', fontsize=11)
    ax2.set_title('残差分析', fontsize=13, fontweight='bold')
    ax2.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.savefig('rating_curve.png', dpi=300)
    plt.show()

# 执行
rating_curve_analysis()
```

**输出**：
```
拟合结果:
  Q = 62.3(H - 9.48)^2.12
  R² = 0.9997
```

**追问**：
- "如何处理洪水期绳套曲线？" → 分段拟合，涨落水分开
- "低水位数据缺失怎么办？" → 外推需谨慎，结合物理模型

---

**本章重点**：
- 水力学基础理论应答
- 数值计算方法讲解
- 工程实践案例分析
- Python编程能力展示

**下一章**：综合面试案例
