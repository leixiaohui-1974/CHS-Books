# 第3章：水体富营养化

**环境问题**: 湖泊、水库突出  
**危害**: 水华、赤潮

---

## 一、基本概念

### 1.1 定义

**富营养化（Eutrophication）**：水体中氮、磷等营养物质过量积累，导致藻类及其他浮游生物过度繁殖的现象。

**水华（Bloom）**：淡水中藻类大量繁殖  
**赤潮（Red Tide）**：海水中浮游生物大量繁殖

### 1.2 成因

**自然因素**：
- 流域地质背景
- 气候条件（温度、光照）
- 水体滞留时间长

**人为因素**（主要）：
- 农业面源污染（化肥流失）
- 生活污水排放（洗涤剂）
- 工业废水（食品、造纸）

### 1.3 危害

1. **生态危害**：
   - 水体溶解氧下降
   - 鱼类窒息死亡
   - 生物多样性降低

2. **水质危害**：
   - 色度、臭味增加
   - 堵塞滤池
   - 影响供水

3. **健康危害**：
   - 蓝藻毒素（肝毒素、神经毒素）

---

## 二、营养状态评价

### 2.1 营养状态指数（TSI）

**Carlson指数**：
$$TSI(\text{Chl-a}) = 10 \times (6 - \frac{2.04 - 0.68 \ln \text{Chl-a}}{\ln 2})$$

$$TSI(\text{TP}) = 10 \times (6 - \frac{\ln(48/\text{TP})}{\ln 2})$$

$$TSI(\text{SD}) = 10 \times (6 - \frac{\ln \text{SD}}{\ln 2})$$

**综合指数**：
$$TSI = \frac{TSI(\text{Chl-a}) + TSI(\text{TP}) + TSI(\text{SD})}{3}$$

**分级**：
- TSI < 30：贫营养
- 30 ≤ TSI < 50：中营养
- 50 ≤ TSI < 70：富营养
- TSI ≥ 70：重富营养

### 2.2 关键指标

| 指标 | 符号 | 单位 | 富营养阈值 |
|------|------|------|-----------|
| 叶绿素a | Chl-a | μg/L | > 10 |
| 总磷 | TP | mg/L | > 0.05 |
| 总氮 | TN | mg/L | > 1.0 |
| 透明度 | SD | m | < 1.0 |
| N/P比 | N/P | - | 10-16（最易爆发）|

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class EutrophicationAnalysis:
    """富营养化分析"""
    
    @staticmethod
    def carlson_tsi_chla(chla):
        """
        Carlson TSI (叶绿素a)
        
        参数:
            chla: 叶绿素a浓度 (μg/L)
        """
        tsi = 10 * (6 - (2.04 - 0.68*np.log(chla)) / np.log(2))
        return tsi
    
    @staticmethod
    def carlson_tsi_tp(tp):
        """
        Carlson TSI (总磷)
        
        参数:
            tp: 总磷浓度 (μg/L)
        """
        tsi = 10 * (6 - np.log(48/tp) / np.log(2))
        return tsi
    
    @staticmethod
    def carlson_tsi_sd(sd):
        """
        Carlson TSI (透明度)
        
        参数:
            sd: 透明度 (m)
        """
        tsi = 10 * (6 - np.log(sd) / np.log(2))
        return tsi
    
    @staticmethod
    def comprehensive_tsi(chla, tp, sd):
        """
        综合营养状态指数
        
        参数:
            chla: 叶绿素a (μg/L)
            tp: 总磷 (μg/L)
            sd: 透明度 (m)
        
        返回:
            tsi: 综合TSI
            status: 营养状态
        """
        tsi_chla = EutrophicationAnalysis.carlson_tsi_chla(chla)
        tsi_tp = EutrophicationAnalysis.carlson_tsi_tp(tp)
        tsi_sd = EutrophicationAnalysis.carlson_tsi_sd(sd)
        
        tsi = (tsi_chla + tsi_tp + tsi_sd) / 3
        
        if tsi < 30:
            status = '贫营养'
        elif tsi < 50:
            status = '中营养'
        elif tsi < 70:
            status = '富营养'
        else:
            status = '重富营养'
        
        return tsi, status
    
    @staticmethod
    def limiting_factor(tn, tp):
        """
        判断限制性营养元素
        
        N/P比（摩尔比）：
        - < 7: 氮限制
        - 7-10: 共同限制
        - > 10: 磷限制
        
        参数:
            tn: 总氮 (mg/L)
            tp: 总磷 (mg/L)
        
        返回:
            ratio: N/P摩尔比
            limiting: 限制因子
        """
        # 转换为摩尔浓度
        # N: 14 g/mol, P: 31 g/mol
        n_mol = tn / 14
        p_mol = tp / 31
        
        ratio = n_mol / p_mol if p_mol > 0 else np.inf
        
        if ratio < 7:
            limiting = '氮限制'
        elif ratio < 10:
            limiting = 'N、P共同限制'
        else:
            limiting = '磷限制'
        
        return ratio, limiting
    
    @staticmethod
    def algae_growth_model(N, P, T, I, t_max=30):
        """
        藻类生长模型（Monod方程）
        
        dX/dt = μ·X - k_d·X
        
        μ = μ_max · (N/(K_N+N)) · (P/(K_P+P)) · f(T) · f(I)
        
        参数:
            N: 氮浓度 (mg/L)
            P: 磷浓度 (mg/L)
            T: 温度 (°C)
            I: 光照强度 (W/m²)
            t_max: 模拟天数
        
        返回:
            t: 时间数组 (day)
            X: 藻类浓度 (μg/L Chl-a)
        """
        # 参数
        mu_max = 0.8  # 最大比生长速率 (1/day)
        K_N = 0.025   # 氮半饱和常数 (mg/L)
        K_P = 0.001   # 磷半饱和常数 (mg/L)
        k_d = 0.1     # 死亡率 (1/day)
        T_opt = 25    # 最适温度 (°C)
        I_opt = 150   # 最适光照 (W/m²)
        
        # 温度影响
        f_T = np.exp(-((T - T_opt)/10)**2)
        
        # 光照影响
        f_I = I / (I + I_opt)
        
        # 生长速率
        mu = mu_max * (N/(K_N+N)) * (P/(K_P+P)) * f_T * f_I
        
        # 数值求解
        dt = 0.1  # day
        t = np.arange(0, t_max, dt)
        X = np.zeros_like(t)
        X[0] = 1.0  # 初始浓度 (μg/L)
        
        for i in range(len(t)-1):
            dXdt = mu * X[i] - k_d * X[i]
            X[i+1] = X[i] + dXdt * dt
            
            # 营养限制（简化）
            if X[i+1] > 100:
                X[i+1] = 100  # 达到环境容量
        
        return t, X
    
    @staticmethod
    def plot_tsi_sensitivity():
        """TSI对参数的敏感性分析"""
        fig, axes = plt.subplots(1, 3, figsize=(18, 5))
        
        # (a) 叶绿素a
        chla_range = np.logspace(-0.5, 2, 100)
        tsi_chla = [EutrophicationAnalysis.carlson_tsi_chla(c) 
                    for c in chla_range]
        
        axes[0].plot(chla_range, tsi_chla, 'g-', linewidth=2)
        axes[0].axhline(30, color='b', linestyle='--', label='贫营养')
        axes[0].axhline(50, color='orange', linestyle='--', label='中营养')
        axes[0].axhline(70, color='r', linestyle='--', label='富营养')
        axes[0].set_xlabel('叶绿素a (μg/L)', fontsize=12)
        axes[0].set_ylabel('TSI', fontsize=12)
        axes[0].set_title('TSI vs 叶绿素a', fontsize=13)
        axes[0].set_xscale('log')
        axes[0].legend()
        axes[0].grid(True, alpha=0.3)
        
        # (b) 总磷
        tp_range = np.logspace(0, 2.5, 100)
        tsi_tp = [EutrophicationAnalysis.carlson_tsi_tp(t) 
                  for t in tp_range]
        
        axes[1].plot(tp_range, tsi_tp, 'b-', linewidth=2)
        axes[1].axhline(30, color='b', linestyle='--')
        axes[1].axhline(50, color='orange', linestyle='--')
        axes[1].axhline(70, color='r', linestyle='--')
        axes[1].set_xlabel('总磷 (μg/L)', fontsize=12)
        axes[1].set_ylabel('TSI', fontsize=12)
        axes[1].set_title('TSI vs 总磷', fontsize=13)
        axes[1].set_xscale('log')
        axes[1].grid(True, alpha=0.3)
        
        # (c) 透明度
        sd_range = np.logspace(-0.5, 1, 100)
        tsi_sd = [EutrophicationAnalysis.carlson_tsi_sd(s) 
                  for s in sd_range]
        
        axes[2].plot(sd_range, tsi_sd, 'c-', linewidth=2)
        axes[2].axhline(30, color='b', linestyle='--')
        axes[2].axhline(50, color='orange', linestyle='--')
        axes[2].axhline(70, color='r', linestyle='--')
        axes[2].set_xlabel('透明度 (m)', fontsize=12)
        axes[2].set_ylabel('TSI', fontsize=12)
        axes[2].set_title('TSI vs 透明度', fontsize=13)
        axes[2].set_xscale('log')
        axes[2].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('tsi_sensitivity.png', dpi=300)
        plt.show()

# 示例1：湖泊营养状态评价
print("="*60)
print("示例1：某湖泊营养状态评价")
print("="*60)

# 监测数据
chla = 25  # μg/L
tp = 80    # μg/L
sd = 0.8   # m
tn = 1.5   # mg/L
tp_mg = tp / 1000  # 转为mg/L

print(f"监测数据:")
print(f"  叶绿素a: {chla} μg/L")
print(f"  总磷 TP: {tp} μg/L = {tp_mg} mg/L")
print(f"  总氮 TN: {tn} mg/L")
print(f"  透明度 SD: {sd} m")

# TSI计算
ea = EutrophicationAnalysis()

tsi_chla = ea.carlson_tsi_chla(chla)
tsi_tp = ea.carlson_tsi_tp(tp)
tsi_sd = ea.carlson_tsi_sd(sd)

tsi, status = ea.comprehensive_tsi(chla, tp, sd)

print(f"\nTSI分项:")
print(f"  TSI(Chl-a) = {tsi_chla:.1f}")
print(f"  TSI(TP) = {tsi_tp:.1f}")
print(f"  TSI(SD) = {tsi_sd:.1f}")

print(f"\n综合评价:")
print(f"  综合TSI = {tsi:.1f}")
print(f"  营养状态: {status}")

# 限制因子
ratio, limiting = ea.limiting_factor(tn, tp_mg)

print(f"\n限制因子分析:")
print(f"  N/P摩尔比 = {ratio:.1f}")
print(f"  限制因子: {limiting}")

# 示例2：藻类生长模拟
print("\n" + "="*60)
print("示例2：藻类生长模拟")
print("="*60)

# 不同营养条件
scenarios = [
    {'name': '低营养', 'N': 0.5, 'P': 0.02, 'T': 20, 'I': 100},
    {'name': '中营养', 'N': 1.0, 'P': 0.05, 'T': 25, 'I': 150},
    {'name': '高营养', 'N': 2.0, 'P': 0.10, 'T': 30, 'I': 200}
]

fig, ax = plt.subplots(figsize=(12, 7))

for scenario in scenarios:
    t, X = ea.algae_growth_model(
        scenario['N'], scenario['P'], 
        scenario['T'], scenario['I'])
    
    ax.plot(t, X, linewidth=2,
           label=f"{scenario['name']} (N={scenario['N']}, P={scenario['P']})")
    
    print(f"{scenario['name']}:")
    print(f"  N={scenario['N']} mg/L, P={scenario['P']} mg/L")
    print(f"  最大藻类浓度: {np.max(X):.1f} μg/L")

ax.set_xlabel('时间 (day)', fontsize=12)
ax.set_ylabel('叶绿素a浓度 (μg/L)', fontsize=12)
ax.set_title('不同营养条件下的藻类生长', fontsize=14)
ax.legend()
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('algae_growth_simulation.png', dpi=300)
plt.show()

# TSI敏感性分析
print("\nTSI敏感性分析...")
ea.plot_tsi_sensitivity()
```

---

## 三、控制措施

### 3.1 外源控制

1. **点源控制**：
   - 污水处理厂提标改造（一级A→地表IV类）
   - 工业废水深度处理

2. **面源控制**：
   - 测土配方施肥
   - 生态沟渠、湿地缓冲带
   - 禁养区划定

### 3.2 内源控制

1. **底泥疏浚**：去除历史积累营养物质
2. **生态修复**：
   - 水生植物恢复（沉水植物、挺水植物）
   - 生物操纵（鲢鱼、鳙鱼控藻）

### 3.3 生态工程

**人工湿地**：N、P去除率>60%

**生态浮床**：植物吸收N、P

---

## 四、典型案例

### 太湖蓝藻爆发（2007年）

**背景**：
- TSI > 60（富营养）
- TP = 0.08 mg/L，TN = 2.0 mg/L
- 2007年5月，蓝藻大规模爆发

**影响**：
- 无锡市供水危机
- 经济损失数十亿元

**治理措施**：
- "控源截污、清淤疏浚、生态修复"
- 关停污染企业、污水处理厂提标
- 引江济太（稀释）

**效果**（2020年）：
- TSI降至55
- TP降至0.06 mg/L

---

## 五、典型考题

### 【例题】营养状态评价

**题目**（20分）

某湖泊监测数据：Chl-a=30μg/L，TP=100μg/L，SD=0.6m。
求：1) 综合TSI；2) 营养状态；3) 主要控制措施。

**【解答】**（见Python示例）

---

**本章重点**：
- TSI计算
- N/P比判断限制因子
- 控制措施（外源+内源）

**下一章**：地下水污染
