# 第5章：河流水质模型

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、河流水质模型分类

### 1.1 按空间维度

**一维模型**：只考虑纵向扩散，适用于窄深河流
$$\frac{\partial C}{\partial t} + u\frac{\partial C}{\partial x} = D_x\frac{\partial^2 C}{\partial x^2} - KC$$

**二维模型**：考虑纵向+横向扩散，适用于宽浅河流
$$\frac{\partial C}{\partial t} + u\frac{\partial C}{\partial x} + v\frac{\partial C}{\partial y} = D_x\frac{\partial^2 C}{\partial x^2} + D_y\frac{\partial^2 C}{\partial y^2} - KC$$

**三维模型**：全空间模拟，用于复杂水体

### 1.2 按污染物类型

- **保守物质**：不发生化学反应（如盐度、氯离子）
- **非保守物质**：发生降解（BOD、COD、NH₃-N）
- **营养盐模型**：N、P循环（藻类生长）

---

## 二、一维稳态河流水质模型

### 2.1 河段混合模型

**完全混合假设**：污染物瞬间均匀分布在断面上

$$C = \frac{C_u Q_u + C_w Q_w}{Q_u + Q_w}$$

**参数说明**：
- $C$：混合后浓度（mg/L）
- $C_u$：上游河水浓度（mg/L）
- $C_w$：污水浓度（mg/L）
- $Q_u$：上游流量（m³/s）
- $Q_w$：污水流量（m³/s）

### 2.2 一维稳态降解模型

**基本方程**：
$$u\frac{dC}{dx} = -KC$$

**解析解**：
$$C(x) = C_0 \exp\left(-\frac{K}{u}x\right)$$

**简化为时间形式**：
$$C(t) = C_0 e^{-Kt}$$

其中，$t = x/u$（水流到达$x$处的时间）

**参数说明**：
- $K$：综合降解系数（1/d）
- $u$：河流流速（m/s）
- $x$：距离排污口的距离（m）
- $C_0$：初始浓度（mg/L）

### 2.3 Streeter-Phelps氧垂曲线模型（DO-BOD模型）

**BOD衰减方程**：
$$\frac{dL}{dt} = -K_1 L$$

**DO变化方程**：
$$\frac{dD}{dt} = K_1 L - K_2 D + K_3(D_s - D) - K_4$$

**参数说明**：
- $L$：BOD浓度（mg/L）
- $D$：溶解氧亏损（$D = D_s - DO$）（mg/L）
- $D_s$：饱和溶解氧（mg/L）
- $K_1$：BOD降解系数（1/d）
- $K_2$：复氧系数（1/d）
- $K_3$：大气复氧系数（1/d）
- $K_4$：底泥耗氧速率（mg/L/d）

**简化模型**（忽略$K_3$和$K_4$）：
$$D(t) = \frac{K_1 L_0}{K_2 - K_1}\left(e^{-K_1 t} - e^{-K_2 t}\right) + D_0 e^{-K_2 t}$$

**临界点（最低DO点）**：
$$t_c = \frac{1}{K_2 - K_1}\ln\left[\frac{K_2}{K_1}\left(1 - \frac{D_0(K_2-K_1)}{K_1 L_0}\right)\right]$$

$$D_c = \frac{K_1 L_0}{K_2}e^{-K_1 t_c}$$

---

## 三、污染物迁移转化

### 3.1 对流-扩散方程

**一维非稳态**：
$$\frac{\partial C}{\partial t} + u\frac{\partial C}{\partial x} = D_x\frac{\partial^2 C}{\partial x^2} - KC + S$$

**参数说明**：
- $D_x$：纵向扩散系数（m²/s）
- $S$：源汇项（mg/L/s）

### 3.2 纵向扩散系数

**Elder公式**（河流）：
$$D_x = 5.93 H u_*$$

**Fischer公式**（更精确）：
$$D_x = 0.011 \frac{u^2 B^2}{H u_*}$$

**参数说明**：
- $H$：水深（m）
- $B$：河宽（m）
- $u$：平均流速（m/s）
- $u_* = \sqrt{gHI}$：摩阻流速（m/s）
- $I$：水力坡度

### 3.3 降解系数确定

**BOD降解系数$K_1$**：
- 清洁水体：$K_1 = 0.1 \sim 0.2$ /d（20°C）
- 轻污染水体：$K_1 = 0.2 \sim 0.3$ /d
- 重污染水体：$K_1 = 0.3 \sim 0.5$ /d

**温度修正**：
$$K_T = K_{20} \theta^{T-20}$$

常用$\theta = 1.047$

**复氧系数$K_2$**：
- 静止水体：$K_2 = 0.1 \sim 0.2$ /d
- 缓流河流：$K_2 = 0.2 \sim 0.5$ /d
- 急流河流：$K_2 = 0.5 \sim 2.0$ /d

**O'Connor-Dobbins公式**：
$$K_2 = 3.93 \frac{u^{0.5}}{H^{1.5}} \quad (H < 0.6 \text{ m})$$

---

## 四、数值求解方法

### 4.1 有限差分法

**对流项（上风格式）**：
$$u\frac{\partial C}{\partial x} \approx u\frac{C_i - C_{i-1}}{\Delta x}$$

**扩散项（中心差分）**：
$$D_x\frac{\partial^2 C}{\partial x^2} \approx D_x\frac{C_{i+1} - 2C_i + C_{i-1}}{\Delta x^2}$$

**时间项（向前差分）**：
$$\frac{\partial C}{\partial t} \approx \frac{C_i^{n+1} - C_i^n}{\Delta t}$$

### 4.2 稳定性条件

**Courant条件**：
$$\Delta t \leq \frac{\Delta x}{u}$$

**扩散稳定性**：
$$\Delta t \leq \frac{\Delta x^2}{2D_x}$$

---

## 五、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

class RiverWaterQualityModel:
    """河流水质模型"""
    
    def __init__(self):
        self.g = 9.81
    
    def mixing_model(self, Cu, Qu, Cw, Qw):
        """
        完全混合模型
        
        参数:
            Cu: 上游浓度 (mg/L)
            Qu: 上游流量 (m³/s)
            Cw: 污水浓度 (mg/L)
            Qw: 污水流量 (m³/s)
        """
        C = (Cu * Qu + Cw * Qw) / (Qu + Qw)
        return C
    
    def steady_degradation(self, C0, K, u, x):
        """
        一维稳态降解模型
        
        C(x) = C0 * exp(-K*x/u)
        
        参数:
            C0: 初始浓度 (mg/L)
            K: 降解系数 (1/d)
            u: 流速 (m/s)
            x: 距离 (m)
        """
        # 转换单位：K从1/d转为1/s
        K_s = K / 86400
        C = C0 * np.exp(-K_s * x / u)
        return C
    
    def streeter_phelps(self, L0, D0, K1, K2, t):
        """
        Streeter-Phelps氧垂曲线
        
        参数:
            L0: 初始BOD (mg/L)
            D0: 初始DO亏损 (mg/L)
            K1: BOD降解系数 (1/d)
            K2: 复氧系数 (1/d)
            t: 时间 (d)
        """
        if K1 == K2:
            # 特殊情况
            D = (D0 + K1 * L0 * t) * np.exp(-K1 * t)
        else:
            term1 = (K1 * L0 / (K2 - K1)) * (np.exp(-K1 * t) - np.exp(-K2 * t))
            term2 = D0 * np.exp(-K2 * t)
            D = term1 + term2
        
        return D
    
    def critical_point(self, L0, D0, K1, K2):
        """
        计算临界点（最低DO点）
        
        返回:
            tc: 临界时间 (d)
            Dc: 最大DO亏损 (mg/L)
        """
        if K1 == K2:
            tc = D0 / (K1 * L0)
        else:
            argument = (K2 / K1) * (1 - D0 * (K2 - K1) / (K1 * L0))
            
            if argument <= 0:
                # 无临界点，DO单调变化
                return None, None
            
            tc = np.log(argument) / (K2 - K1)
        
        Dc = self.streeter_phelps(L0, D0, K1, K2, tc)
        
        return tc, Dc
    
    def longitudinal_dispersion(self, H, B, u, I):
        """
        纵向扩散系数（Fischer公式）
        
        参数:
            H: 水深 (m)
            B: 河宽 (m)
            u: 流速 (m/s)
            I: 水力坡度
        """
        u_star = np.sqrt(self.g * H * I)
        Dx = 0.011 * (u**2 * B**2) / (H * u_star)
        return Dx
    
    def temperature_correction(self, K20, T, theta=1.047):
        """
        温度修正
        
        K(T) = K(20°C) * θ^(T-20)
        """
        KT = K20 * theta**(T - 20)
        return KT
    
    def advection_diffusion_1d(self, C0, u, Dx, K, L, T, nx=100, nt=1000):
        """
        一维对流-扩散方程数值求解
        
        参数:
            C0: 初始浓度分布
            u: 流速 (m/s)
            Dx: 扩散系数 (m²/s)
            K: 降解系数 (1/s)
            L: 河段长度 (m)
            T: 模拟时间 (s)
            nx: 空间网格数
            nt: 时间步数
        """
        dx = L / (nx - 1)
        dt = T / nt
        
        # 稳定性检查
        courant = u * dt / dx
        diffusion = Dx * dt / dx**2
        
        if courant > 1:
            print(f"警告：Courant数={courant:.2f} > 1，可能不稳定")
        if diffusion > 0.5:
            print(f"警告：扩散数={diffusion:.2f} > 0.5，可能不稳定")
        
        # 初始化
        C = np.zeros((nt, nx))
        C[0, :] = C0
        
        # 时间推进
        for n in range(nt - 1):
            for i in range(1, nx - 1):
                # 对流项（上风格式）
                advection = -u * (C[n, i] - C[n, i-1]) / dx
                
                # 扩散项（中心差分）
                diffusion_term = Dx * (C[n, i+1] - 2*C[n, i] + C[n, i-1]) / dx**2
                
                # 降解项
                reaction = -K * C[n, i]
                
                # 更新
                C[n+1, i] = C[n, i] + dt * (advection + diffusion_term + reaction)
            
            # 边界条件
            C[n+1, 0] = C[n, 0]  # 上游边界（固定浓度）
            C[n+1, -1] = C[n+1, -2]  # 下游边界（零梯度）
        
        return C
    
    def plot_streeter_phelps(self, L0, D0, K1, K2, Ds=9.0):
        """绘制Streeter-Phelps氧垂曲线"""
        fig, axes = plt.subplots(2, 2, figsize=(16, 12))
        
        # 1. 标准氧垂曲线
        ax1 = axes[0, 0]
        
        t = np.linspace(0, 10, 500)
        D = self.streeter_phelps(L0, D0, K1, K2, t)
        DO = Ds - D
        
        tc, Dc = self.critical_point(L0, D0, K1, K2)
        
        ax1.plot(t, DO, 'b-', linewidth=2.5, label='DO曲线')
        ax1.axhline(Ds, color='g', linestyle='--', linewidth=2, label=f'饱和DO={Ds}mg/L')
        
        if tc is not None:
            DO_c = Ds - Dc
            ax1.scatter([tc], [DO_c], color='r', s=150, zorder=5, marker='v')
            ax1.axvline(tc, color='r', linestyle=':', alpha=0.5)
            ax1.text(tc + 0.3, DO_c, f'临界点\nt={tc:.2f}d\nDO={DO_c:.2f}mg/L',
                    fontsize=10, va='center')
        
        ax1.set_xlabel('时间 (天)', fontsize=11)
        ax1.set_ylabel('溶解氧 DO (mg/L)', fontsize=11)
        ax1.set_title(f'Streeter-Phelps氧垂曲线\nL₀={L0}mg/L, D₀={D0}mg/L, K₁={K1}/d, K₂={K2}/d',
                     fontsize=13, fontweight='bold')
        ax1.legend()
        ax1.grid(True, alpha=0.3)
        ax1.set_ylim([0, Ds + 1])
        
        # 2. BOD衰减曲线
        ax2 = axes[0, 1]
        
        L = L0 * np.exp(-K1 * t)
        
        ax2.plot(t, L, 'orange', linewidth=2.5, label='BOD衰减')
        ax2.set_xlabel('时间 (天)', fontsize=11)
        ax2.set_ylabel('BOD (mg/L)', fontsize=11)
        ax2.set_title(f'BOD衰减曲线 (K₁={K1}/d)', fontsize=13, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        
        # 3. 不同K2的影响
        ax3 = axes[1, 0]
        
        K2_values = [0.2, 0.5, 1.0, 2.0]
        colors = plt.cm.viridis(np.linspace(0.2, 0.9, len(K2_values)))
        
        for K2_val, color in zip(K2_values, colors):
            D_val = self.streeter_phelps(L0, D0, K1, K2_val, t)
            DO_val = Ds - D_val
            ax3.plot(t, DO_val, color=color, linewidth=2, label=f'K₂={K2_val}/d')
        
        ax3.axhline(Ds, color='g', linestyle='--', linewidth=1.5, alpha=0.5)
        ax3.set_xlabel('时间 (天)', fontsize=11)
        ax3.set_ylabel('溶解氧 DO (mg/L)', fontsize=11)
        ax3.set_title('复氧系数K₂对DO的影响', fontsize=13, fontweight='bold')
        ax3.legend()
        ax3.grid(True, alpha=0.3)
        
        # 4. 不同L0的影响
        ax4 = axes[1, 1]
        
        L0_values = [10, 20, 30, 40]
        colors2 = plt.cm.coolwarm(np.linspace(0.2, 0.9, len(L0_values)))
        
        for L0_val, color in zip(L0_values, colors2):
            D_val = self.streeter_phelps(L0_val, D0, K1, K2, t)
            DO_val = Ds - D_val
            ax4.plot(t, DO_val, color=color, linewidth=2, label=f'L₀={L0_val}mg/L')
        
        ax4.axhline(Ds, color='g', linestyle='--', linewidth=1.5, alpha=0.5)
        ax4.set_xlabel('时间 (天)', fontsize=11)
        ax4.set_ylabel('溶解氧 DO (mg/L)', fontsize=11)
        ax4.set_title('初始BOD对DO的影响', fontsize=13, fontweight='bold')
        ax4.legend()
        ax4.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('streeter_phelps_model.png', dpi=300)
        plt.show()

# 示例1：完全混合模型
print("="*60)
print("示例1：河流-污水混合模型")
print("="*60)

model = RiverWaterQualityModel()

Cu = 5.0    # mg/L
Qu = 50.0   # m³/s
Cw = 120.0  # mg/L
Qw = 2.0    # m³/s

C_mixed = model.mixing_model(Cu, Qu, Cw, Qw)

print(f"上游河水:")
print(f"  浓度 Cu = {Cu} mg/L")
print(f"  流量 Qu = {Qu} m³/s")

print(f"\n污水排放:")
print(f"  浓度 Cw = {Cw} mg/L")
print(f"  流量 Qw = {Qw} m³/s")

print(f"\n混合后浓度: C = {C_mixed:.2f} mg/L")

# 稀释倍数
dilution = (Qu + Qw) / Qw
print(f"稀释倍数: {dilution:.1f}")

# 示例2：一维稳态降解
print("\n" + "="*60)
print("示例2：污染物沿程衰减")
print("="*60)

C0 = C_mixed
K = 0.3  # 1/d
u = 0.5  # m/s

x_values = [0, 1000, 5000, 10000, 20000]

print(f"初始浓度 C0 = {C0:.2f} mg/L")
print(f"降解系数 K = {K} /d")
print(f"流速 u = {u} m/s")

print(f"\n{'距离(m)':<12s} {'时间(h)':<12s} {'浓度(mg/L)':<15s}")
print("-" * 42)

for x in x_values:
    t_hours = x / u / 3600
    C = model.steady_degradation(C0, K, u, x)
    print(f"{x:<12d} {t_hours:<12.1f} {C:<15.2f}")

# 示例3：Streeter-Phelps模型
print("\n" + "="*60)
print("示例3：Streeter-Phelps氧垂曲线")
print("="*60)

L0 = 25.0  # mg/L
D0 = 2.0   # mg/L
K1 = 0.25  # /d
K2 = 0.4   # /d
Ds = 9.0   # mg/L

print(f"初始条件:")
print(f"  BOD L0 = {L0} mg/L")
print(f"  DO亏损 D0 = {D0} mg/L")
print(f"  饱和DO Ds = {Ds} mg/L")
print(f"  初始DO = {Ds - D0:.2f} mg/L")

print(f"\n动力学参数:")
print(f"  BOD降解系数 K1 = {K1} /d")
print(f"  复氧系数 K2 = {K2} /d")

tc, Dc = model.critical_point(L0, D0, K1, K2)

if tc is not None:
    DO_c = Ds - Dc
    print(f"\n临界点:")
    print(f"  时间 tc = {tc:.2f} 天")
    print(f"  DO亏损 Dc = {Dc:.2f} mg/L")
    print(f"  最低DO = {DO_c:.2f} mg/L")
    
    if DO_c < 2:
        print(f"  ⚠️ 警告：DO < 2 mg/L，水质严重恶化！")
    elif DO_c < 5:
        print(f"  ⚠️ 注意：DO较低，水质较差")
    else:
        print(f"  ✓ DO充足，水质良好")
else:
    print(f"\n无临界点，DO单调变化")

# 示例4：温度修正
print("\n" + "="*60)
print("示例4：温度对降解系数的影响")
print("="*60)

K1_20 = 0.25  # /d at 20°C
K2_20 = 0.40  # /d at 20°C

temperatures = [10, 15, 20, 25, 30]

print(f"基准温度20°C: K1 = {K1_20} /d, K2 = {K2_20} /d")
print(f"\n{'温度(°C)':<12s} {'K1(/d)':<12s} {'K2(/d)':<12s}")
print("-" * 38)

for T in temperatures:
    K1_T = model.temperature_correction(K1_20, T)
    K2_T = model.temperature_correction(K2_20, T)
    print(f"{T:<12d} {K1_T:<12.3f} {K2_T:<12.3f}")

# 绘制氧垂曲线
print("\n绘制Streeter-Phelps氧垂曲线...")
model.plot_streeter_phelps(L0, D0, K1, K2, Ds)
```

---

## 六、典型考题

### 【例题1】混合模型（10分）

**题目**：河流流量$Q_u=80$m³/s，BOD浓度$C_u=3$mg/L；污水流量$Q_w=5$m³/s，BOD浓度$C_w=150$mg/L。求混合后浓度。

**【解答】**

$$C = \frac{C_u Q_u + C_w Q_w}{Q_u + Q_w} = \frac{3 \times 80 + 150 \times 5}{80 + 5} = \frac{990}{85} = 11.6 \text{ mg/L}$$

---

### 【例题2】临界点计算（15分）

**题目**：$L_0=30$mg/L，$D_0=1$mg/L，$K_1=0.2$/d，$K_2=0.5$/d，$D_s=9$mg/L。求临界时间和最低DO。

**【解答】**

$$t_c = \frac{1}{K_2 - K_1}\ln\left[\frac{K_2}{K_1}\left(1 - \frac{D_0(K_2-K_1)}{K_1 L_0}\right)\right]$$

$$= \frac{1}{0.3}\ln\left[\frac{0.5}{0.2}\left(1 - \frac{1 \times 0.3}{0.2 \times 30}\right)\right] = 3.03 \text{ d}$$

$$D_c = \frac{K_1 L_0}{K_2}e^{-K_1 t_c} = \frac{0.2 \times 30}{0.5}e^{-0.2 \times 3.03} = 6.57 \text{ mg/L}$$

$$DO_c = D_s - D_c = 9 - 6.57 = 2.43 \text{ mg/L}$$

---

**本章重点**：
- 完全混合模型
- 一维稳态降解
- Streeter-Phelps氧垂曲线
- 临界点计算

**下一章**：湖泊水质模型
