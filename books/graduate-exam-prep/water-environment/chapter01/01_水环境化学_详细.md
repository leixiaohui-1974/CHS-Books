# 第1章：水环境化学基础

**交叉学科**: 环境化学 + 水力学  
**重要性**: ⭐⭐⭐⭐

---

## 一、水质指标

### 1.1 物理指标

| 指标 | 含义 | 标准 |
|------|------|------|
| 温度 | 影响化学反应、DO | - |
| 浊度 | 悬浮物含量 | <1 NTU(饮用水) |
| 色度 | 有机物、铁锰 | <15度 |
| 透明度 | 水体清澈度 | >30cm |

### 1.2 化学指标

**溶解氧(DO)**：
- 饱和DO：8-14 mg/L（随温度变化）
- 标准：>5 mg/L

**生化需氧量(BOD₅)**：
- 有机物污染指标
- 清洁水体：<3 mg/L

**化学需氧量(COD)**：
- 总有机物
- COD > BOD

**氨氮(NH₃-N)**：
- 营养盐
- 标准：<0.5 mg/L（I类水）

---

## 二、水体自净

### 2.1 物理净化

1. **稀释**：污染物浓度降低
2. **沉淀**：悬浮物沉降
3. **挥发**：溶解气体逸散

### 2.2 化学净化

1. **氧化还原**
2. **酸碱中和**
3. **络合沉淀**

### 2.3 生物净化

1. **好氧分解**：有机物→CO₂+H₂O
2. **厌氧分解**：有机物→CH₄+H₂S
3. **硝化反硝化**：氮循环

---

## 三、Streeter-Phelps氧垂曲线

### 3.1 模型方程

$$\frac{dL}{dt} = -K_1 L$$
$$\frac{dD}{dt} = K_1 L - K_2 D$$

- $L$：BOD浓度
- $D$：溶解氧亏损
- $K_1$：脱氧系数（0.1-0.5 d⁻¹）
- $K_2$：复氧系数（0.2-1.0 d⁻¹）

### 3.2 解析解

$$D(t) = \frac{K_1 L_0}{K_2 - K_1}(e^{-K_1 t} - e^{-K_2 t}) + D_0 e^{-K_2 t}$$

### 3.3 临界点

**最大氧亏时间**：
$$t_c = \frac{1}{K_2 - K_1} \ln\left[\frac{K_2}{K_1}\left(1 - \frac{D_0(K_2-K_1)}{K_1 L_0}\right)\right]$$

**最大氧亏**：
$$D_c = \frac{K_1 L_0}{K_2} e^{-K_1 t_c}$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class WaterQualityModel:
    """水质模型"""
    
    def __init__(self, K1=0.2, K2=0.4):
        """
        参数:
            K1: 脱氧系数 (1/d)
            K2: 复氧系数 (1/d)
        """
        self.K1 = K1
        self.K2 = K2
    
    def streeter_phelps(self, L0, D0, t):
        """
        Streeter-Phelps氧垂曲线
        
        参数:
            L0: 初始BOD (mg/L)
            D0: 初始氧亏 (mg/L)
            t: 时间数组 (d)
        
        返回:
            BOD, 氧亏, DO
        """
        # BOD衰减
        L = L0 * np.exp(-self.K1 * t)
        
        # 氧亏
        if abs(self.K2 - self.K1) < 1e-6:
            # K1 ≈ K2特殊情况
            D = (self.K1 * L0 * t + D0) * np.exp(-self.K1 * t)
        else:
            term1 = (self.K1 * L0 / (self.K2 - self.K1)) * \
                    (np.exp(-self.K1 * t) - np.exp(-self.K2 * t))
            term2 = D0 * np.exp(-self.K2 * t)
            D = term1 + term2
        
        # DO（假设饱和DO=10 mg/L）
        DO_sat = 10
        DO = DO_sat - D
        
        return L, D, DO
    
    def critical_point(self, L0, D0):
        """
        临界点（最大氧亏）
        
        返回:
            临界时间, 最大氧亏
        """
        if self.K2 <= self.K1:
            return None, None
        
        # 临界时间
        ratio = (self.K2 / self.K1) * \
                (1 - D0 * (self.K2 - self.K1) / (self.K1 * L0))
        
        if ratio <= 0:
            return None, None
        
        t_c = np.log(ratio) / (self.K2 - self.K1)
        
        # 最大氧亏
        D_c = (self.K1 * L0 / self.K2) * np.exp(-self.K1 * t_c)
        
        return t_c, D_c
    
    def plot_oxygen_sag(self, L0, D0, t_max=10):
        """绘制氧垂曲线"""
        t = np.linspace(0, t_max, 200)
        L, D, DO = self.streeter_phelps(L0, D0, t)
        
        # 临界点
        t_c, D_c = self.critical_point(L0, D0)
        
        fig, axes = plt.subplots(3, 1, figsize=(12, 10))
        
        # BOD
        axes[0].plot(t, L, 'b-', linewidth=2)
        axes[0].set_ylabel('BOD (mg/L)', fontsize=12)
        axes[0].set_title('BOD衰减曲线', fontsize=14)
        axes[0].grid(True, alpha=0.3)
        
        # 氧亏
        axes[1].plot(t, D, 'r-', linewidth=2)
        if t_c is not None:
            axes[1].plot(t_c, D_c, 'ro', markersize=10,
                        label=f'临界点: t={t_c:.2f}d, D={D_c:.2f}mg/L')
            axes[1].legend()
        axes[1].set_ylabel('氧亏 (mg/L)', fontsize=12)
        axes[1].set_title('氧亏曲线', fontsize=14)
        axes[1].grid(True, alpha=0.3)
        
        # DO
        axes[2].plot(t, DO, 'g-', linewidth=2)
        axes[2].axhline(5, color='orange', linestyle='--',
                       label='水质标准(5 mg/L)')
        if t_c is not None:
            DO_min = 10 - D_c
            axes[2].plot(t_c, DO_min, 'go', markersize=10,
                        label=f'最低DO: {DO_min:.2f}mg/L')
        axes[2].legend()
        axes[2].set_xlabel('时间 (天)', fontsize=12)
        axes[2].set_ylabel('DO (mg/L)', fontsize=12)
        axes[2].set_title('溶解氧曲线（氧垂曲线）', fontsize=14)
        axes[2].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('oxygen_sag_curve.png', dpi=300)
        plt.show()

# 示例
print("="*60)
print("水环境化学模拟")
print("="*60)

# 创建模型
model = WaterQualityModel(K1=0.3, K2=0.5)

# 初始条件
L0 = 20  # mg/L
D0 = 2   # mg/L

print(f"模型参数:")
print(f"  脱氧系数 K1 = {model.K1} /d")
print(f"  复氧系数 K2 = {model.K2} /d")
print(f"\n初始条件:")
print(f"  初始BOD = {L0} mg/L")
print(f"  初始氧亏 = {D0} mg/L")

# 临界点
t_c, D_c = model.critical_point(L0, D0)

if t_c is not None:
    print(f"\n临界点:")
    print(f"  时间 = {t_c:.2f} 天")
    print(f"  最大氧亏 = {D_c:.2f} mg/L")
    print(f"  最低DO = {10 - D_c:.2f} mg/L")
    
    if 10 - D_c < 5:
        print(f"  ⚠️ 警告：低于水质标准(5 mg/L)")
    else:
        print(f"  ✓ 满足水质标准")

# 可视化
model.plot_oxygen_sag(L0, D0, t_max=15)

# 不同K2的对比
print("\n" + "="*60)
print("复氧系数影响分析")
print("="*60)

K2_values = [0.3, 0.5, 0.8, 1.0]

fig, ax = plt.subplots(figsize=(10, 6))

for K2_val in K2_values:
    model_temp = WaterQualityModel(K1=0.3, K2=K2_val)
    t = np.linspace(0, 15, 200)
    _, _, DO = model_temp.streeter_phelps(L0, D0, t)
    
    ax.plot(t, DO, linewidth=2, label=f'K₂={K2_val} /d')

ax.axhline(5, color='red', linestyle='--', 
          linewidth=2, label='水质标准')
ax.set_xlabel('时间 (天)', fontsize=12)
ax.set_ylabel('DO (mg/L)', fontsize=12)
ax.set_title('不同复氧系数下的DO变化', fontsize=14)
ax.legend()
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('K2_comparison.png', dpi=300)
plt.show()
```

---

## 四、富营养化

### 4.1 定义

水体氮、磷等营养盐过多，藻类大量繁殖

### 4.2 指标

- 总氮(TN) > 0.2 mg/L
- 总磷(TP) > 0.02 mg/L
- 叶绿素a > 10 μg/L

### 4.3 防治

1. 控制点源污染（污水处理）
2. 控制面源污染（农业径流）
3. 生态修复（人工湿地）

---

## 五、典型考题

### 【例题】氧垂曲线计算

**题目**：河流排污后，L₀=30mg/L，D₀=1mg/L，K₁=0.25/d，K₂=0.4/d，求最大氧亏及发生时间

**解**：

$$t_c = \frac{1}{0.4-0.25}\ln\left[\frac{0.4}{0.25}\left(1-\frac{1\times(0.4-0.25)}{0.25\times30}\right)\right] = 3.27 \text{ d}$$

$$D_c = \frac{0.25 \times 30}{0.4}e^{-0.25 \times 3.27} = 8.58 \text{ mg/L}$$

$$DO_{min} = 10 - 8.58 = 1.42 \text{ mg/L}$$

**结论**：低于5mg/L标准，需采取措施

---

**本章重点**：
- 水质指标
- Streeter-Phelps模型
- 富营养化
- 水体自净
