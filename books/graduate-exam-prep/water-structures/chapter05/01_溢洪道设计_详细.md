# 第5章：溢洪道设计

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、溢洪道的作用与分类

### 1.1 基本作用

**溢洪道（Spillway）**：水库大坝的泄洪建筑物，安全宣泄洪水，防止漫顶。

**核心功能**：
- 控制水库水位
- 保障大坝安全
- 消减洪峰流量
- 防止下游冲刷

### 1.2 分类

#### (1) 按工作原理

- **正槽溢洪道**：与河床在同一轴线
- **侧槽溢洪道**：与河床垂直布置
- **井式溢洪道**：竖井进水，隧洞泄流
- **虹吸式溢洪道**：利用虹吸作用自动启闭

#### (2) 按控制段型式

- **堰式溢洪道**：宽顶堰、实用堰、WES堰
- **闸门控制**：平板闸门、弧形闸门

---

## 二、堰流计算

### 2.1 宽顶堰流量公式

$$Q = m b \sqrt{2g} H^{1.5}$$

**简化形式**：
$$Q = m b H^{1.5}$$

（取$\sqrt{2g} \approx 4.43$，合并到流量系数$m$中）

**参数说明**：
- $Q$：过堰流量（m³/s）
- $m$：流量系数（0.32~0.50，常取0.40~0.45）
- $b$：堰宽（m）
- $H$：堰上水头（m），$H = z_{up} - z_{crest}$

### 2.2 WES堰（溢流坝面曲线）

**设计水头下**：
$$Q = C_d L H_d^{1.5}$$

**非设计水头**：需修正流量系数$C_d$

**WES曲线方程**：
$$\frac{x^n}{H_d^{n-1}} = K y$$

**标准参数**（铅直上游面，1:3下游坡）：
- $n = 1.85$
- $K = 2.0$

### 2.3 淹没系数

当下游水位壅高，形成淹没出流：

$$Q = \sigma m b H^{1.5}$$

**淹没系数**：
$$\sigma = f\left(\frac{h_s}{H}\right)$$

- $h_s$：淹没水深（下游水位超过堰顶的高度）
- $\sigma < 1$，淹没程度越深，$\sigma$越小

---

## 三、溢洪道水力设计

### 3.1 控制段设计

**堰顶高程**：
$$z_{crest} = z_{normal} + \Delta z_{safety}$$

**安全加高**：一般0.5~1.0m

**堰宽确定**：
$$b = \frac{Q_{design}}{m H_{design}^{1.5}}$$

### 3.2 泄槽设计

**断面形式**：矩形、梯形、U形

**底坡**：$i = 0.05 \sim 0.20$（陡槽）

**水流状态**：急流（$Fr > 1$）

**弗劳德数**：
$$Fr = \frac{v}{\sqrt{gh}}$$

**流速计算**：
$$v = \frac{1}{n} R^{2/3} \sqrt{i}$$

### 3.3 挑流消能

**挑射角**：$\theta = 20° \sim 45°$（常用30°~35°）

**挑距**：
$$L = \frac{v_0^2 \sin 2\theta}{g} + \frac{v_0 \cos\theta}{g}\sqrt{v_0^2\sin^2\theta + 2g(z_0 - z_t)}$$

**简化公式**（平抛）：
$$L = v_0 \sqrt{\frac{2(z_0 - z_t)}{g}}$$

**参数说明**：
- $v_0$：挑流鼻坎处流速（m/s）
- $z_0$：鼻坎高程（m）
- $z_t$：下游水面高程（m）
- $\theta$：挑射角（°）

### 3.4 底流消能（消力池）

**池深计算**：
$$d = h_c'' - h_t + \Delta d$$

**参数说明**：
- $h_c''$：共轭水深（下游）
- $h_t$：下游水深
- $\Delta d$：安全超深（0.5~1.0m）

**共轭水深公式**：
$$h_c'' = \frac{h_c'}{2}\left(\sqrt{1 + 8Fr_1^2} - 1\right)$$

---

## 四、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class SpillwayDesign:
    """溢洪道设计计算"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def weir_flow(self, m, b, H):
        """
        宽顶堰流量
        
        参数:
            m: 流量系数
            b: 堰宽 (m)
            H: 堰上水头 (m)
        """
        Q = m * b * np.sqrt(2 * self.g) * H**1.5
        return Q
    
    def weir_head(self, Q, m, b):
        """
        已知流量求堰上水头
        
        Q = mb√(2g) H^1.5
        => H = (Q / (mb√(2g)))^(2/3)
        """
        H = (Q / (m * b * np.sqrt(2 * self.g)))**(2/3)
        return H
    
    def weir_width(self, Q, m, H):
        """
        已知流量和水头求堰宽
        """
        b = Q / (m * np.sqrt(2 * self.g) * H**1.5)
        return b
    
    def froude_number(self, v, h):
        """弗劳德数"""
        return v / np.sqrt(self.g * h)
    
    def chute_velocity(self, n, R, i):
        """
        泄槽流速（曼宁公式）
        
        参数:
            n: 糙率
            R: 水力半径 (m)
            i: 坡度
        """
        v = (1 / n) * R**(2/3) * np.sqrt(i)
        return v
    
    def ski_jump_distance(self, v0, theta, z0, zt):
        """
        挑流距离
        
        参数:
            v0: 挑流鼻坎流速 (m/s)
            theta: 挑射角 (度)
            z0: 鼻坎高程 (m)
            zt: 下游水面高程 (m)
        """
        theta_rad = np.radians(theta)
        
        # 完整公式
        h_drop = z0 - zt
        
        term1 = (v0**2 * np.sin(2 * theta_rad)) / self.g
        term2 = (v0 * np.cos(theta_rad) / self.g) * \
                np.sqrt(v0**2 * np.sin(theta_rad)**2 + 2 * self.g * h_drop)
        
        L = term1 + term2
        
        return L
    
    def stilling_basin_depth(self, hc1, v1, ht):
        """
        消力池深度
        
        参数:
            hc1: 跃前水深 (m)
            v1: 跃前流速 (m/s)
            ht: 下游水深 (m)
        
        返回:
            d: 池深 (m)
            hc2: 跃后水深 (m)
        """
        Fr1 = self.froude_number(v1, hc1)
        
        # 共轭水深
        hc2 = (hc1 / 2) * (np.sqrt(1 + 8 * Fr1**2) - 1)
        
        # 池深（安全超深取0.5m）
        d = hc2 - ht + 0.5
        
        return d, hc2
    
    def wes_profile(self, Hd, x_max=20):
        """
        WES溢流面曲线
        
        参数:
            Hd: 设计水头 (m)
            x_max: 最大x坐标 (m)
        
        返回:
            x, y坐标数组
        """
        # WES标准曲线 x^1.85 = 2.0 * Hd^0.85 * y
        n = 1.85
        K = 2.0
        
        x = np.linspace(0, x_max, 200)
        y = (x**n) / (K * Hd**(n - 1))
        
        return x, y
    
    def plot_spillway_design(self, Q_design, m, H_design, theta=30):
        """绘制溢洪道设计图"""
        fig, axes = plt.subplots(2, 2, figsize=(16, 12))
        
        # 1. 堰流流量关系曲线
        ax1 = axes[0, 0]
        
        b_values = [20, 30, 40, 50]
        colors = plt.cm.viridis(np.linspace(0.2, 0.9, len(b_values)))
        
        H_range = np.linspace(0.5, 10, 100)
        
        for b, color in zip(b_values, colors):
            Q_values = self.weir_flow(m, b, H_range)
            ax1.plot(H_range, Q_values, color=color, linewidth=2, label=f'b={b}m')
        
        ax1.axhline(Q_design, color='r', linestyle='--', linewidth=2,
                   label=f'设计流量={Q_design}m³/s')
        ax1.set_xlabel('堰上水头 H (m)', fontsize=11)
        ax1.set_ylabel('过堰流量 Q (m³/s)', fontsize=11)
        ax1.set_title(f'堰流曲线 (m={m})', fontsize=13, fontweight='bold')
        ax1.legend()
        ax1.grid(True, alpha=0.3)
        
        # 2. WES溢流面曲线
        ax2 = axes[0, 1]
        
        Hd_values = [3, 5, 7]
        colors2 = plt.cm.coolwarm(np.linspace(0.2, 0.9, len(Hd_values)))
        
        for Hd, color in zip(Hd_values, colors2):
            x, y = self.wes_profile(Hd, x_max=15)
            ax2.plot(x, -y, color=color, linewidth=2.5, label=f'Hd={Hd}m')
        
        ax2.axhline(0, color='k', linewidth=1)
        ax2.set_xlabel('水平距离 x (m)', fontsize=11)
        ax2.set_ylabel('高程 y (m)', fontsize=11)
        ax2.set_title('WES溢流面曲线', fontsize=13, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        ax2.set_ylim([-20, 5])
        
        # 3. 挑流距离vs角度
        ax3 = axes[1, 0]
        
        v0 = 20  # m/s
        z0 = 50  # m
        zt = 10  # m
        
        theta_range = np.linspace(10, 60, 100)
        L_values = [self.ski_jump_distance(v0, theta, z0, zt) for theta in theta_range]
        
        ax3.plot(theta_range, L_values, 'b-', linewidth=2.5)
        
        # 标注最大挑距
        L_max = max(L_values)
        theta_max = theta_range[np.argmax(L_values)]
        ax3.scatter([theta_max], [L_max], color='r', s=150, zorder=5, marker='*')
        ax3.text(theta_max + 2, L_max, f'最大：θ={theta_max:.1f}°\nL={L_max:.1f}m',
                fontsize=10, va='center')
        
        ax3.set_xlabel('挑射角 θ (度)', fontsize=11)
        ax3.set_ylabel('挑距 L (m)', fontsize=11)
        ax3.set_title(f'挑流距离 (v₀={v0}m/s, Δz={z0-zt}m)', fontsize=13, fontweight='bold')
        ax3.grid(True, alpha=0.3)
        
        # 4. 消力池深度vs弗劳德数
        ax4 = axes[1, 1]
        
        hc1 = 2.0  # m
        ht = 5.0   # m
        
        Fr1_range = np.linspace(2, 10, 100)
        d_values = []
        hc2_values = []
        
        for Fr1 in Fr1_range:
            v1 = Fr1 * np.sqrt(self.g * hc1)
            d, hc2 = self.stilling_basin_depth(hc1, v1, ht)
            d_values.append(d)
            hc2_values.append(hc2)
        
        ax4_twin = ax4.twinx()
        
        line1 = ax4.plot(Fr1_range, d_values, 'b-', linewidth=2.5, label='池深 d')
        line2 = ax4_twin.plot(Fr1_range, hc2_values, 'r-', linewidth=2.5, label='跃后水深 hc2')
        
        ax4.set_xlabel('跃前弗劳德数 Fr₁', fontsize=11)
        ax4.set_ylabel('池深 d (m)', fontsize=11, color='b')
        ax4_twin.set_ylabel('跃后水深 hc2 (m)', fontsize=11, color='r')
        ax4.set_title(f'消力池设计 (hc1={hc1}m, ht={ht}m)', fontsize=13, fontweight='bold')
        
        lines = line1 + line2
        labels = [l.get_label() for l in lines]
        ax4.legend(lines, labels, loc='upper left')
        ax4.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('spillway_design.png', dpi=300)
        plt.show()

# 示例1：堰流计算
print("="*60)
print("示例1：宽顶堰流量计算")
print("="*60)

spillway = SpillwayDesign()

m = 0.42
b = 30  # m
H = 5.0  # m

Q = spillway.weir_flow(m, b, H)

print(f"输入参数:")
print(f"  流量系数 m = {m}")
print(f"  堰宽 b = {b} m")
print(f"  堰上水头 H = {H} m")

print(f"\n计算结果:")
print(f"  过堰流量 Q = {Q:.2f} m³/s")

# 反算堰宽
Q_design = 500  # m³/s
H_design = 4.0  # m

b_required = spillway.weir_width(Q_design, m, H_design)

print(f"\n设计工况:")
print(f"  设计流量 Q_design = {Q_design} m³/s")
print(f"  设计水头 H_design = {H_design} m")
print(f"  所需堰宽 b = {b_required:.2f} m")

# 示例2：挑流消能
print("\n" + "="*60)
print("示例2：挑流消能计算")
print("="*60)

v0 = 25  # m/s
theta = 35  # 度
z0 = 60  # m
zt = 20  # m

L = spillway.ski_jump_distance(v0, theta, z0, zt)

print(f"挑流参数:")
print(f"  鼻坎流速 v₀ = {v0} m/s")
print(f"  挑射角 θ = {theta}°")
print(f"  鼻坎高程 z₀ = {z0} m")
print(f"  下游水面高程 z_t = {zt} m")
print(f"  高差 Δz = {z0 - zt} m")

print(f"\n计算结果:")
print(f"  挑距 L = {L:.2f} m")

# 对比不同角度
print(f"\n不同挑射角对比:")
print(f"{'角度(°)':<10s} {'挑距(m)':<12s}")
print("-" * 25)

for theta_test in [20, 25, 30, 35, 40, 45]:
    L_test = spillway.ski_jump_distance(v0, theta_test, z0, zt)
    print(f"{theta_test:<10d} {L_test:<12.2f}")

# 示例3：消力池设计
print("\n" + "="*60)
print("示例3：消力池深度计算")
print("="*60)

hc1 = 1.8  # m
v1 = 18.0  # m/s
ht = 6.0   # m

d, hc2 = spillway.stilling_basin_depth(hc1, v1, ht)

Fr1 = spillway.froude_number(v1, hc1)

print(f"水跃参数:")
print(f"  跃前水深 hc1 = {hc1} m")
print(f"  跃前流速 v1 = {v1} m/s")
print(f"  跃前弗劳德数 Fr1 = {Fr1:.2f}")
print(f"  下游水深 ht = {ht} m")

print(f"\n计算结果:")
print(f"  跃后水深 hc2 = {hc2:.2f} m")
print(f"  消力池深度 d = {d:.2f} m （含0.5m安全超深）")

# 能量损失
E1 = v1**2 / (2 * spillway.g) + hc1
E2 = hc2  # 跃后流速很小，忽略
E_loss = E1 - E2

print(f"\n能量分析:")
print(f"  跃前单位能量 E1 = {E1:.2f} m")
print(f"  跃后单位能量 E2 ≈ {E2:.2f} m")
print(f"  能量损失 ΔE = {E_loss:.2f} m ({E_loss/E1*100:.1f}%)")

# 示例4：WES溢流面
print("\n" + "="*60)
print("示例4：WES溢流面曲线")
print("="*60)

Hd = 6.0  # m

print(f"设计水头 Hd = {Hd} m")
print(f"\nWES曲线方程: x^1.85 = 2.0 × Hd^0.85 × y")
print(f"\n部分坐标点:")
print(f"{'x(m)':<10s} {'y(m)':<10s}")
print("-" * 22)

x_samples = [0, 2, 4, 6, 8, 10]
for x_val in x_samples:
    if x_val == 0:
        y_val = 0
    else:
        x_arr, y_arr = spillway.wes_profile(Hd, x_max=10)
        idx = np.argmin(np.abs(x_arr - x_val))
        y_val = y_arr[idx]
    print(f"{x_val:<10.1f} {y_val:<10.3f}")

# 绘制设计图
print("\n绘制溢洪道设计图...")
spillway.plot_spillway_design(Q_design=500, m=0.42, H_design=4.0, theta=35)
```

---

## 五、典型考题

### 【例题1】堰流计算（12分）

**题目**：宽顶堰，$b=40$m，$m=0.40$，设计泄洪$Q=600$m³/s，求堰上水头$H$。

**【解答】**

$$Q = mb\sqrt{2g} H^{1.5}$$

$$600 = 0.40 \times 40 \times \sqrt{2 \times 9.81} \times H^{1.5}$$

$$H^{1.5} = \frac{600}{0.40 \times 40 \times 4.43} = 8.47$$

$$H = 8.47^{2/3} = 4.16 \text{ m}$$

---

### 【例题2】挑流距离（15分）

**题目**：鼻坎流速$v_0=22$m/s，挑射角$\theta=30°$，$z_0=55$m，$z_t=15$m，求挑距。

**【解答】**

$$L = \frac{v_0^2 \sin 2\theta}{g} + \frac{v_0 \cos\theta}{g}\sqrt{v_0^2\sin^2\theta + 2g(z_0 - z_t)}$$

$$\sin 2\theta = \sin 60° = 0.866$$
$$\cos\theta = \cos 30° = 0.866$$
$$\sin\theta = \sin 30° = 0.5$$

$$L = \frac{22^2 \times 0.866}{9.81} + \frac{22 \times 0.866}{9.81}\sqrt{22^2 \times 0.25 + 2 \times 9.81 \times 40}$$

$$= 41.9 + 1.94 \times \sqrt{121 + 784.8} = 41.9 + 58.3 = 100.2 \text{ m}$$

---

**本章重点**：
- 宽顶堰流量公式
- WES溢流面曲线
- 挑流消能计算
- 消力池设计

**下一章**：水闸设计
