# 第7章：水电站建筑物

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐

---

## 一、水电站概述

### 1.1 水电站类型

**按水头分类**：
- 高水头：$H > 70$ m（坝式、引水式）
- 中水头：$30 < H < 70$ m（混合式）
- 低水头：$H < 30$ m（径流式）

**按开发方式**：
- **坝式**：河床筑坝，厂房紧靠坝址
- **引水式**：引水渠道，厂房远离坝址
- **混合式**：坝+引水隧洞
- **抽水蓄能**：双向机组，调峰调频

### 1.2 水电站基本组成

```
上游水库
   ↓
拦河坝/进水口
   ↓
引水系统（渠道/隧洞/压力管道）
   ↓
前池/调压室
   ↓
水轮机/发电机
   ↓
尾水系统
   ↓
下游河道
```

---

## 二、引水系统

### 2.1 进水口

**功能**：
- 控制引水流量
- 拦截漂浮物
- 排沙冲污

**类型**：
- 深式进水口（水库）
- 浅式进水口（河床）
- 岸边进水口

**设计要点**：
1. 进口高程：低于死水位1-2m
2. 拦污栅：栅条间距50-100mm
3. 闸门：事故闸门+检修闸门

**流速控制**：
$$v_{进口} = 0.5 \sim 1.0 \text{ m/s}$$

### 2.2 引水隧洞

**断面选择**：
- 圆形：全衬砌，适合高压
- 城门洞形：部分衬砌，适合中低压
- 马蹄形：便于施工

**水力计算**（满流）：
$$Q = A \cdot v = A \cdot \frac{1}{n} R^{2/3} i^{1/2}$$

**流速限制**：
- 无压隧洞：$v < 3$ m/s
- 有压隧洞：$v = 3 \sim 6$ m/s

**沿程损失**：
$$h_f = \lambda \frac{L}{D} \frac{v^2}{2g}$$

### 2.3 压力管道

**材料选择**：
| 管径 | 水头 | 材料 |
|------|------|------|
| $< 2$ m | $< 50$ m | 钢筋混凝土 |
| $> 2$ m | $> 50$ m | 钢管 |

**壁厚计算**：
$$\delta = \frac{p D}{2[\sigma] \eta}$$

其中：
- $p$：内水压力（MPa）
- $D$：管径（m）
- $[\sigma]$：许用应力（MPa）
- $\eta$：焊接系数（0.85-0.95）

**支墩间距**：
$$l = \sqrt{\frac{8 E I}{q D}}$$

**例题1**：钢管直径$D=2$ m，内水压$p=1.5$ MPa，
钢材$[\sigma]=150$ MPa，$\eta=0.9$，求壁厚

**解**：
$$\delta = \frac{1.5 \times 2}{2 \times 150 \times 0.9} = \frac{3}{270} = 0.011 \text{ m} = 11 \text{ mm}$$

考虑腐蚀余量2mm，取$\delta = 14$ mm。

---

## 三、调压室

### 3.1 作用与类型

**作用**：
- 平缓水锤波动
- 改善机组调节性能
- 缩短压力管道长度

**类型**：
- 简单圆筒式
- 差动式（上室+下室）
- 气垫式

### 3.2 位置选择

**最优位置**：
$$L_{opt} = \frac{2H}{3}$$

**稳定断面**（Thoma准则）：
$$F \geq F_{crit} = \frac{A_c L v^2}{2g H}$$

其中：
- $A_c$：隧洞断面积
- $L$：调压室至机组长度
- $v$：流速
- $H$：水头

### 3.3 涌浪计算

**最高涌浪**（骤然关机）：
$$Z_{max} \approx \frac{Q_0^2}{2gF^2}$$

**最低涌浪**（骤然开机）：
$$Z_{min} = -\frac{Q_0^2 L}{2gF \cdot H}$$

---

## 四、厂房设计

### 4.1 厂房类型

**按位置**：
- 河床式：低水头，径流式电站
- 坝后式：中高水头，与坝一体
- 地下式：高水头，岩石地质
- 岸边式：引水式电站

**按结构**：
- 开敞式
- 半开敞式
- 封闭式

### 4.2 主厂房布置

**尺寸确定**：
- 跨度：根据机组直径，$B = D + (6 \sim 8)$ m
- 长度：$L = n \cdot l + 2 \cdot l_0$（$n$为机组数）
- 高度：吊车起吊高度+机组高度+余量

**典型布置**（单列式）：
```
安装间 | 机组1 | 机组2 | ... | 机组n
```

### 4.3 副厂房与辅助设施

- 变压器室
- 配电装置室
- 中控室
- 维修间
- 生活设施

---

## 五、尾水系统

### 5.1 尾水管

**作用**：
- 排水
- 回收动能（扩散段）
- 提高水轮机安装高程

**类型**：
- 直锥形
- 肘形

**出口扩散角**：
$$\alpha = 6° \sim 8°$$

### 5.2 尾水渠

**功能**：引导尾水回归河道

**设计流速**：
$$v_{尾水} = 1 \sim 2 \text{ m/s}$$

---

## 六、水锤与调节保证

### 6.1 水锤现象

**直接水锤**（快关阀）：
$$\Delta p = \rho c \Delta v$$

其中：
- $c$：水击波速，$c \approx 1000$ m/s
- $\Delta v$：流速变化

**间接水锤**（慢关阀）：
$$\Delta p = \rho g \frac{L \Delta v}{g T_c}$$

### 6.2 调节保证计算

**保证出力**：
$$N_{保证} = \eta \cdot 9.81 \cdot Q_{枯水} \cdot H_{设计}$$

**年发电量**：
$$E_{年} = \sum N_i \cdot T_i$$

---

## 七、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class HydropowerPlantDesign:
    """水电站设计工具"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def penstock_thickness(self, p, D, sigma_allow, eta=0.9):
        """
        压力管道壁厚计算
        
        参数:
            p: 内水压力(MPa)
            D: 管径(m)
            sigma_allow: 许用应力(MPa)
            eta: 焊接系数
        
        返回:
            delta: 壁厚(mm)
        """
        delta_m = p * D / (2 * sigma_allow * eta)
        delta_mm = delta_m * 1000
        
        # 考虑腐蚀余量
        delta_mm += 2
        
        return delta_mm
    
    def penstock_head_loss(self, L, D, Q, lambda_val=0.025):
        """
        压力管道沿程损失
        
        参数:
            L: 管长(m)
            D: 管径(m)
            Q: 流量(m³/s)
            lambda_val: 沿程阻力系数
        
        返回:
            h_f: 沿程损失(m)
        """
        A = np.pi * D**2 / 4
        v = Q / A
        
        h_f = lambda_val * (L / D) * (v**2 / (2 * self.g))
        
        return h_f
    
    def surge_tank_area(self, A_tunnel, L, v, H):
        """
        调压室临界断面积（Thoma准则）
        
        参数:
            A_tunnel: 隧洞断面积(m²)
            L: 压力管道长度(m)
            v: 流速(m/s)
            H: 水头(m)
        
        返回:
            F_crit: 临界断面积(m²)
        """
        F_crit = A_tunnel * L * v**2 / (2 * self.g * H)
        return F_crit
    
    def max_surge(self, Q0, F):
        """
        最高涌浪（骤然关机）
        
        参数:
            Q0: 初始流量(m³/s)
            F: 调压室断面积(m²)
        
        返回:
            Z_max: 最高涌浪(m)
        """
        Z_max = Q0**2 / (2 * self.g * F**2)
        return Z_max
    
    def water_hammer_pressure(self, c, delta_v):
        """
        水锤压力（直接水锤）
        
        参数:
            c: 水击波速(m/s)
            delta_v: 流速变化(m/s)
        
        返回:
            delta_p: 压力升高(kPa)
        """
        rho = 1000  # kg/m³
        delta_p = rho * c * delta_v / 1000  # 转kPa
        
        return delta_p
    
    def power_output(self, Q, H, eta):
        """
        发电出力
        
        参数:
            Q: 流量(m³/s)
            H: 净水头(m)
            eta: 综合效率
        
        返回:
            N: 出力(kW)
        """
        N = eta * 9.81 * Q * H
        return N
    
    def annual_energy(self, Q_monthly, H, eta):
        """
        年发电量计算
        
        参数:
            Q_monthly: 月平均流量数组(12个月, m³/s)
            H: 平均水头(m)
            eta: 综合效率
        
        返回:
            E_annual: 年发电量(MWh)
        """
        days_per_month = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]
        
        E_total = 0
        for Q, days in zip(Q_monthly, days_per_month):
            N = self.power_output(Q, H, eta)
            E_month = N * 24 * days / 1000  # MWh
            E_total += E_month
        
        return E_total
    
    def plot_surge_tank_oscillation(self, F, Q0, H, t_max=200):
        """绘制调压室涌浪过程"""
        fig, axes = plt.subplots(2, 1, figsize=(12, 10))
        
        # 简化模型（线性化）
        T_period = 2 * np.pi * np.sqrt(F / (self.g * np.pi * 2))
        
        t = np.linspace(0, t_max, 1000)
        
        # 水位振荡（衰减振荡）
        Z_max_init = self.max_surge(Q0, F)
        damping = 0.02
        Z = Z_max_init * np.exp(-damping * t) * np.cos(2*np.pi*t/T_period)
        
        ax1 = axes[0]
        ax1.plot(t, Z, 'b-', linewidth=2)
        ax1.axhline(0, color='k', linestyle='--', linewidth=1)
        ax1.set_xlabel('时间 (s)', fontsize=11)
        ax1.set_ylabel('涌浪高度 Z (m)', fontsize=11)
        ax1.set_title('调压室涌浪过程', fontsize=13, fontweight='bold')
        ax1.grid(True, alpha=0.3)
        
        # 标注最大值
        idx_max = np.argmax(np.abs(Z))
        ax1.plot(t[idx_max], Z[idx_max], 'ro', markersize=10)
        ax1.text(t[idx_max], Z[idx_max]*1.1,
                f'Zmax={Z[idx_max]:.2f}m',
                ha='center', fontsize=10)
        
        # 流量变化
        Q = Q0 * (1 - np.exp(-0.05*t)) * np.cos(2*np.pi*t/T_period)
        
        ax2 = axes[1]
        ax2.plot(t, Q, 'r-', linewidth=2)
        ax2.axhline(0, color='k', linestyle='--', linewidth=1)
        ax2.set_xlabel('时间 (s)', fontsize=11)
        ax2.set_ylabel('流量 Q (m³/s)', fontsize=11)
        ax2.set_title('隧洞流量变化', fontsize=13, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('surge_tank_oscillation.png', dpi=300)
        plt.show()

# 示例使用
print("="*60)
print("水电站设计工具")
print("="*60)

hpd = HydropowerPlantDesign()

# 1. 压力管道设计
print("\n1. 压力管道设计")
p = 1.5  # MPa
D = 2.0  # m
sigma = 150  # MPa

delta = hpd.penstock_thickness(p, D, sigma)
print(f"  内水压力 p = {p} MPa")
print(f"  管径 D = {D} m")
print(f"  许用应力 [σ] = {sigma} MPa")
print(f"  计算壁厚 δ = {delta:.1f} mm")

# 沿程损失
L = 500  # m
Q = 50   # m³/s

h_f = hpd.penstock_head_loss(L, D, Q)
print(f"\n  管长 L = {L} m")
print(f"  流量 Q = {Q} m³/s")
print(f"  沿程损失 hf = {h_f:.2f} m")

# 2. 调压室设计
print("\n" + "="*60)
print("2. 调压室设计")

A_tunnel = 10  # m²
L_pressure = 200  # m
v = 5  # m/s
H = 100  # m

F_crit = hpd.surge_tank_area(A_tunnel, L_pressure, v, H)
print(f"  隧洞断面积 A = {A_tunnel} m²")
print(f"  压力管道长度 L = {L_pressure} m")
print(f"  流速 v = {v} m/s")
print(f"  水头 H = {H} m")
print(f"  临界断面积 Fcrit = {F_crit:.2f} m²")

# 取安全系数1.3
F_design = 1.3 * F_crit
print(f"  设计断面积 F = {F_design:.2f} m²")
print(f"  对应直径 D = {np.sqrt(4*F_design/np.pi):.2f} m")

# 最高涌浪
Q0 = A_tunnel * v
Z_max = hpd.max_surge(Q0, F_design)
print(f"\n  初始流量 Q₀ = {Q0} m³/s")
print(f"  最高涌浪 Zmax = {Z_max:.2f} m")

# 绘制涌浪过程
print("\n绘制调压室涌浪过程...")
hpd.plot_surge_tank_oscillation(F_design, Q0, H)

# 3. 水锤计算
print("\n" + "="*60)
print("3. 水锤计算")

c = 1000  # m/s
delta_v = 2  # m/s（关阀引起的流速变化）

delta_p = hpd.water_hammer_pressure(c, delta_v)
print(f"  水击波速 c = {c} m/s")
print(f"  流速变化 Δv = {delta_v} m/s")
print(f"  水锤压力升高 Δp = {delta_p:.0f} kPa = {delta_p/100:.2f} MPa")

# 4. 发电量计算
print("\n" + "="*60)
print("4. 发电量计算")

Q_design = 50  # m³/s
H_design = 100  # m
eta = 0.85

N = hpd.power_output(Q_design, H_design, eta)
print(f"  设计流量 Q = {Q_design} m³/s")
print(f"  设计水头 H = {H_design} m")
print(f"  综合效率 η = {eta}")
print(f"  装机容量 N = {N/1000:.1f} MW")

# 年发电量
Q_monthly = [30, 25, 40, 60, 80, 70, 55, 45, 40, 35, 30, 28]  # m³/s

E_annual = hpd.annual_energy(Q_monthly, H_design, eta)
print(f"\n  年发电量 E = {E_annual/1000:.1f} GWh")
print(f"  年利用小时数 = {E_annual/(N/1000):.0f} h")
```

---

## 八、典型工程案例

### 案例1：某高水头引水式电站

**工程概况**：
- 水头：$H = 400$ m
- 流量：$Q = 30$ m³/s
- 装机容量：$N = 100$ MW

**引水系统**：
- 进水口：深式，设拦污栅
- 引水隧洞：城门洞形，$L = 5000$ m
- 调压室：差动式，$F = 80$ m²
- 压力管道：钢管，$D = 2.2$ m，$\delta = 18$ mm

**厂房**：
- 类型：地下式
- 机组：2×50 MW，混流式水轮机

---

**本章重点**：
- 水电站类型与组成
- 引水系统设计（隧洞、压力管道）
- 调压室作用与涌浪计算
- 厂房布置
- 水锤与调节保证

**下一章**：水工建筑物综合设计
