# 第3章第1节：土石坝设计

**学习时间**: 6小时  
**难度**: ⭐⭐⭐⭐  
**工程重要性**: ⭐⭐⭐⭐⭐

---

## 一、土石坝类型与构造

### 1.1 主要类型

1. **均质坝**
   - 全部用同一种土料填筑
   - 结构最简单
   - 适用于小型工程

2. **心墙坝**
   - 中间有防渗心墙
   - 两侧为透水性坝壳
   - **最常用类型**

3. **斜墙坝**
   - 上游面有防渗斜墙
   - 坝体为透水材料

### 1.2 基本构造

```
           坝顶
    |----------------|
    |\\\\\\|////|\\\\|  <- 防浪墙
    | \\\ |/// | \\ |
    |  \\|//  |  \\ |  <- 心墙
    |   \|/   |   \\|
    |    V    |    \|
    +---下游坝坡---+
```

---

## 二、坝体剖面设计

### 2.1 坝顶高程

$$Z_{坝顶} = Z_{水库} + h_浪 + h_安 + h_沉$$

其中：
- $h_浪$：波浪爬高
- $h_安$：安全加高（0.5-1.5m）
- $h_沉$：沉陷量

### 2.2 波浪爬高

**官厅公式**（小型水库）：
$$h_浪 = K \cdot h_波$$

**普希金公式**（大中型）：
$$h_浪 = K_r \cdot K_p \cdot h_{1\%}$$

其中：
- $h_{1\%}$：累积频率1%的波高
- $K_r$：糙率系数
- $K_p$：坡度系数

### 2.3 坝坡设计

**稳定条件**：
$$\text{抗滑稳定安全系数} K \geq [K]$$

一般：
- 上游坝坡：1:2.5 ~ 1:3.5
- 下游坝坡：1:2.0 ~ 1:2.5

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class EarthDamDesign:
    """
    土石坝设计计算
    """
    
    def __init__(self, H, reservoir_level):
        """
        参数:
            H: 坝高 (m)
            reservoir_level: 设计水位 (m)
        """
        self.H = H
        self.reservoir_level = reservoir_level
    
    def wave_height(self, V, F, method='guan_ting'):
        """
        波浪要素计算
        
        参数:
            V: 风速 (m/s)
            F: 吹程 (km)
            method: 计算方法
        
        返回:
            平均波高, 1%波高
        """
        if method == 'guan_ting':
            # 官厅公式（简化）
            h_mean = 0.0166 * V * np.sqrt(F)
            h_1_percent = 1.5 * h_mean
        else:
            # 其他方法可扩展
            h_mean = 0.0166 * V * np.sqrt(F)
            h_1_percent = 1.5 * h_mean
        
        return h_mean, h_1_percent
    
    def wave_run_up(self, h_wave, slope_ratio=2.5, K_r=0.8):
        """
        波浪爬高
        
        参数:
            h_wave: 波高 (m)
            slope_ratio: 坝坡坡比（1:m）
            K_r: 糙率系数（土坝0.7-0.9）
        
        返回:
            爬高
        """
        # 普希金公式简化
        K_p = 1.0 if slope_ratio >= 2.5 else 0.8
        h_run_up = K_r * K_p * h_wave
        return h_run_up
    
    def crest_elevation(self, h_wave, safety_height=1.0, settlement=0.5):
        """
        坝顶高程
        
        参数:
            h_wave: 波浪爬高 (m)
            safety_height: 安全加高 (m)
            settlement: 预留沉陷 (m)
        
        返回:
            坝顶高程
        """
        Z_crest = self.reservoir_level + h_wave + safety_height + settlement
        return Z_crest
    
    def cross_section(self, crest_width, upstream_slope, downstream_slope):
        """
        生成坝体断面坐标
        
        参数:
            crest_width: 坝顶宽度 (m)
            upstream_slope: 上游坝坡（1:m）
            downstream_slope: 下游坝坡（1:m）
        
        返回:
            x, y坐标数组
        """
        # 坝高
        H = self.H
        
        # 上游坡脚
        x_upstream = -upstream_slope * H
        
        # 下游坡脚
        x_downstream = crest_width + downstream_slope * H
        
        # 坐标点
        x = [x_upstream, 0, crest_width, x_downstream]
        y = [0, H, H, 0]
        
        return np.array(x), np.array(y)
    
    def seepage_analysis_simple(self, k, upstream_slope, downstream_slope):
        """
        渗流分析（简化Dupuit公式）
        
        参数:
            k: 渗透系数 (m/s)
            upstream_slope: 上游坡比
            downstream_slope: 下游坡比
        
        返回:
            渗流量, 浸润线
        """
        # 简化假设：坝体均质，水平不透水基础
        H_up = self.reservoir_level  # 上游水位
        H_down = 0  # 下游无水
        
        # 渗流路径长度（近似）
        L = upstream_slope * self.H + downstream_slope * self.H
        
        # 渗流量（Dupuit公式简化）
        q = k * (H_up**2 - H_down**2) / (2 * L)
        
        # 浸润线（抛物线近似）
        x = np.linspace(0, L, 50)
        y_sat = np.sqrt(H_up**2 - (H_up**2 - H_down**2) * x / L)
        
        return q, x, y_sat
    
    def plot_cross_section(self, crest_width, upstream_slope, downstream_slope):
        """
        绘制坝体断面
        """
        fig, ax = plt.subplots(figsize=(12, 6))
        
        # 坝体轮廓
        x, y = self.cross_section(crest_width, upstream_slope, 
                                  downstream_slope)
        ax.plot(x, y, 'b-', linewidth=2)
        ax.fill_between(x, 0, y, alpha=0.3, color='brown')
        
        # 防渗心墙（简化为中央矩形）
        heart_width = 2  # m
        heart_x = [crest_width/2 - heart_width/2,
                   crest_width/2 + heart_width/2,
                   crest_width/2 + heart_width/2,
                   crest_width/2 - heart_width/2,
                   crest_width/2 - heart_width/2]
        heart_y = [0, 0, self.H, self.H, 0]
        ax.fill(heart_x, heart_y, color='gray', alpha=0.6,
               label='防渗心墙')
        
        # 水位线
        ax.axhline(self.reservoir_level, color='blue',
                  linestyle='--', linewidth=2, label='设计水位')
        
        # 坝顶
        ax.plot([0, crest_width], [self.H, self.H], 'k-',
               linewidth=4, label='坝顶')
        
        # 标注
        ax.text(x[0] - 5, 0, '上游', fontsize=12, ha='right')
        ax.text(x[-1] + 5, 0, '下游', fontsize=12, ha='left')
        ax.text(crest_width/2, self.H + 1, '防浪墙',
               fontsize=10, ha='center')
        
        ax.set_xlabel('距离 (m)', fontsize=12)
        ax.set_ylabel('高程 (m)', fontsize=12)
        ax.set_title(f'土石坝断面设计\n坝高{self.H}m, 上游坡1:{upstream_slope}, 下游坡1:{downstream_slope}',
                    fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        ax.axis('equal')
        
        plt.tight_layout()
        plt.savefig('earth_dam_section.png', dpi=300, bbox_inches='tight')
        plt.show()


# 使用示例
print("="*60)
print("土石坝设计示例")
print("="*60)

# 设计参数
H_dam = 30  # 坝高 (m)
Z_reservoir = 28  # 设计水位 (m)

dam = EarthDamDesign(H_dam, Z_reservoir)

# 波浪计算
V_wind = 20  # 风速 (m/s)
F_fetch = 5  # 吹程 (km)

h_mean, h_1 = dam.wave_height(V_wind, F_fetch)
print(f"风速: {V_wind} m/s, 吹程: {F_fetch} km")
print(f"平均波高: {h_mean:.2f} m")
print(f"1%波高: {h_1:.2f} m")

# 波浪爬高
h_run_up = dam.wave_run_up(h_1, slope_ratio=2.5)
print(f"波浪爬高: {h_run_up:.2f} m")

# 坝顶高程
Z_crest = dam.crest_elevation(h_run_up)
print(f"\n坝顶高程: {Z_crest:.2f} m")
print(f"  设计水位: {Z_reservoir:.2f} m")
print(f"  波浪爬高: {h_run_up:.2f} m")
print(f"  安全加高: 1.00 m")
print(f"  预留沉陷: 0.50 m")

# 断面设计
crest_width = 8  # m
up_slope = 3.0
down_slope = 2.5

print(f"\n断面设计:")
print(f"  坝顶宽度: {crest_width} m")
print(f"  上游坝坡: 1:{up_slope}")
print(f"  下游坝坡: 1:{down_slope}")

# 渗流分析
k = 1e-6  # m/s
q, x_seep, y_sat = dam.seepage_analysis_simple(k, up_slope, down_slope)
print(f"\n渗流分析:")
print(f"  渗透系数: {k:.2e} m/s")
print(f"  单宽渗流量: {q:.2e} m³/s/m")

# 绘图
dam.plot_cross_section(crest_width, up_slope, down_slope)
```

---

## 三、稳定分析

### 3.1 边坡稳定（瑞典圆弧法）

**安全系数**：
$$K = \frac{\sum M_抗}{\sum M_滑} = \frac{\sum [c \cdot l + W \cos\alpha \tan\varphi]}{\sum W \sin\alpha}$$

其中：
- c：粘聚力
- φ：内摩擦角
- W：土条重量
- α：滑动面倾角

**要求**：
- 施工期：K ≥ 1.15
- 稳定渗流期：K ≥ 1.25
- 水位骤降期：K ≥ 1.20

---

## 四、典型考题

### 考题：土石坝设计计算

**【题目】**（35分）

某水库土石坝，设计参数：
- 坝高：H = 35 m
- 设计水位：28 m
- 风速：25 m/s
- 吹程：8 km
- 坝顶宽度：10 m
- 上游坝坡：1:3.0
- 下游坝坡：1:2.5

求：
1. 波浪要素
2. 坝顶高程
3. 绘制断面图

---

## 五、工程要点

| 项目 | 关键要求 |
|------|---------|
| 坝顶高程 | 充分考虑波浪爬高 |
| 防渗体 | 心墙最可靠 |
| 坝坡稳定 | 分期校核 |
| 排水设施 | 必不可少 |

---

**工程实践**：
- 土石坝占全球大坝90%以上
- 施工简便，造价低
- 适应性强
- 安全可靠（正确设计前提下）

**下一节**：拱坝设计
