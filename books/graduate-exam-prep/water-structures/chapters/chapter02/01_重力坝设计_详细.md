# 第2章第1节：重力坝设计理论与计算

**学习目标**：
1. 掌握重力坝荷载计算
2. 理解抗滑稳定分析
3. 掌握应力计算方法
4. 熟悉Python辅助设计

**难度**: ⭐⭐⭐⭐  
**学习时间**: 6小时

---

## 一、重力坝基本概念

### 1.1 定义与特点

**定义**：依靠自重维持稳定的挡水建筑物。

**特点**：
- 结构简单，施工方便
- 对地基要求较高（需岩基）
- 耐久性好，使用寿命长
- 可溢流，兼顾泄洪

### 1.2 分类

| 分类依据 | 类型 | 特点 |
|---------|------|------|
| 结构 | 实体重力坝 | 传统型 |
|  | 宽缝重力坝 | 温控改进 |
|  | 空腔重力坝 | 节省材料 |
| 泄流 | 溢流坝 | 顶部溢流 |
|  | 非溢流坝 | 不过水 |

---

## 二、荷载计算

### 2.1 基本荷载组合

#### 1. 水压力（基本荷载）

**上游水压力**（梯形分布）：
$$P_1 = \frac{1}{2}\gamma_w H_1^2$$

压力中心：
$$y_1 = \frac{H_1}{3}$$

**下游水压力**：
$$P_2 = \frac{1}{2}\gamma_w H_2^2$$

#### 2. 扬压力（关键荷载）

**作用点**：坝底面

**简化计算**：
$$U = \frac{1}{2}(p_上 + p_下) \times B$$

其中：
- $p_上$：上游侧扬压强度
- $p_下$：下游侧扬压强度
- $B$：坝底宽度

**防渗设施影响**：
$$p_上 = \gamma_w H_1 (1 - \alpha)$$

$\alpha$：防渗效率系数（0.25~0.35）

#### 3. 自重

$$G = \gamma_c \times V$$

$\gamma_c = 24$ kN/m³（混凝土）

### 2.2 Python荷载计算器

```python
import numpy as np
import matplotlib.pyplot as plt

class GravityDamLoads:
    """
    重力坝荷载计算
    """
    
    def __init__(self, H1, H2, B, m=0.8, gamma_w=9.8, gamma_c=24):
        """
        初始化
        
        参数:
            H1: 上游水深 (m)
            H2: 下游水深 (m)
            B: 坝底宽度 (m)
            m: 下游坡比
            gamma_w: 水容重 (kN/m³)
            gamma_c: 混凝土容重 (kN/m³)
        """
        self.H1 = H1
        self.H2 = H2
        self.B = B
        self.m = m
        self.gamma_w = gamma_w
        self.gamma_c = gamma_c
    
    def water_pressure_upstream(self):
        """
        上游水压力
        
        返回:
            (总压力, 作用点高度)
        """
        P1 = 0.5 * self.gamma_w * self.H1**2
        y1 = self.H1 / 3
        return P1, y1
    
    def water_pressure_downstream(self):
        """
        下游水压力
        """
        P2 = 0.5 * self.gamma_w * self.H2**2
        y2 = self.H2 / 3
        return P2, y2
    
    def uplift_pressure(self, alpha=0.3):
        """
        扬压力
        
        参数:
            alpha: 防渗效率系数
        """
        # 上游侧扬压强度
        p_up = self.gamma_w * self.H1 * (1 - alpha)
        
        # 下游侧
        p_down = self.gamma_w * self.H2
        
        # 扬压力合力
        U = 0.5 * (p_up + p_down) * self.B
        
        # 作用点（梯形形心）
        x_u = self.B / 3 * (2*p_up + p_down) / (p_up + p_down)
        
        return U, x_u, p_up, p_down
    
    def self_weight(self):
        """
        自重
        """
        # 简化为梯形断面
        H = self.H1  # 坝高
        b_top = self.B - self.m * H  # 坝顶宽
        
        # 面积
        A = 0.5 * (b_top + self.B) * H
        
        # 重量（单位坝长）
        G = self.gamma_c * A
        
        # 重心位置
        x_g = self.B / 3 * (2*b_top + self.B) / (b_top + self.B)
        
        return G, x_g, A
    
    def load_combination(self, alpha=0.3, with_uplift=True):
        """
        荷载组合
        """
        # 水平力
        P1, y1 = self.water_pressure_upstream()
        P2, y2 = self.water_pressure_downstream()
        
        P_h = P1 - P2  # 净水平力
        
        # 竖向力
        G, x_g, A = self.self_weight()
        
        # 扬压力
        if with_uplift:
            U, x_u, p_up, p_down = self.uplift_pressure(alpha)
            P_v = G - U
        else:
            U = 0
            x_u = 0
            P_v = G
        
        # 力矩（绕坝趾O点）
        M_P1 = P1 * y1  # 上游水压力矩
        M_P2 = P2 * y2  # 下游水压力矩
        M_G = G * x_g   # 自重力矩
        M_U = U * x_u if with_uplift else 0  # 扬压力矩
        
        M_total = M_G - M_U - M_P1 + M_P2
        
        return {
            'P1': P1,
            'P2': P2,
            'P_h': P_h,
            'G': G,
            'U': U,
            'P_v': P_v,
            'M_total': M_total,
            'loads': {
                'P1': (P1, y1),
                'P2': (P2, y2),
                'G': (G, x_g),
                'U': (U, x_u) if with_uplift else (0, 0)
            }
        }
    
    def plot_loads(self, alpha=0.3):
        """
        绘制荷载分布图
        """
        loads = self.load_combination(alpha)
        
        fig, ax = plt.subplots(figsize=(10, 8))
        
        # 坝体轮廓
        H = self.H1
        b_top = self.B - self.m * H
        
        x_dam = [0, b_top, self.B, self.B, 0]
        y_dam = [H, H, 0, 0, H]
        
        ax.plot(x_dam[:4], y_dam[:4], 'k-', linewidth=3, label='坝体')
        ax.fill(x_dam[:4], y_dam[:4], color='gray', alpha=0.3)
        
        # 上游水压力
        P1, y1 = loads['loads']['P1']
        ax.arrow(-2, self.H1/2, 2, 0, head_width=0.5, head_length=0.3, 
                 fc='blue', ec='blue', linewidth=2, label=f'P₁={P1:.1f}kN/m')
        
        # 自重
        G, x_g = loads['loads']['G']
        ax.arrow(x_g, H+1, 0, -1, head_width=0.5, head_length=0.3,
                 fc='green', ec='green', linewidth=2, label=f'G={G:.1f}kN/m')
        
        # 扬压力分布
        U, x_u, p_up, p_down = self.uplift_pressure(alpha)
        x_uplift = [0, self.B]
        y_uplift = [p_up/self.gamma_w, p_down/self.gamma_w]
        ax.plot(x_uplift, [-h for h in y_uplift], 'r--', linewidth=2, 
                label=f'扬压力 U={U:.1f}kN/m')
        
        ax.set_xlabel('X (m)', fontsize=12)
        ax.set_ylabel('Y (m)', fontsize=12)
        ax.set_title('重力坝荷载分布', fontsize=14)
        ax.grid(True, alpha=0.3)
        ax.legend()
        ax.axis('equal')
        
        plt.tight_layout()
        plt.savefig('gravity_dam_loads.png', dpi=300, bbox_inches='tight')
        plt.show()

# 使用示例
dam = GravityDamLoads(
    H1=50,     # 上游水深50m
    H2=5,      # 下游水深5m
    B=40,      # 坝底宽40m
    m=0.8      # 下游坡比
)

# 荷载组合
result = dam.load_combination(alpha=0.3, with_uplift=True)

print("="*50)
print("重力坝荷载计算结果")
print("="*50)
print(f"上游水压力 P₁: {result['P1']:.2f} kN/m")
print(f"下游水压力 P₂: {result['P2']:.2f} kN/m")
print(f"净水平力 P_h: {result['P_h']:.2f} kN/m")
print(f"自重 G: {result['G']:.2f} kN/m")
print(f"扬压力 U: {result['U']:.2f} kN/m")
print(f"净竖向力 P_v: {result['P_v']:.2f} kN/m")
print(f"总力矩（绕坝趾）: {result['M_total']:.2f} kN·m/m")

# 绘图
dam.plot_loads(alpha=0.3)
```

---

## 三、抗滑稳定分析

### 3.1 抗滑稳定系数

$$K_s = \frac{f'\sum V + c'A}{\sum H}$$

其中：
- $f'$：摩擦系数（0.6~0.7）
- $c'$：粘聚力（100~200 kPa）
- $A$：坝底面积
- $\sum V$：竖向力合力
- $\sum H$：水平力合力

**规范要求**：
- 基本组合：$K_s \geq 3.0$
- 特殊组合：$K_s \geq 2.5$

### 3.2 Python稳定分析

```python
def sliding_stability(P_h, P_v, A, f_prime=0.65, c_prime=150):
    """
    抗滑稳定计算
    
    参数:
        P_h: 水平力 (kN/m)
        P_v: 竖向力 (kN/m)
        A: 坝底接触面积 (m²/m，单位坝长)
        f_prime: 摩擦系数
        c_prime: 粘聚力 (kPa)
    
    返回:
        抗滑稳定系数
    """
    # 抗滑力
    F_friction = f_prime * P_v
    F_cohesion = c_prime * A
    F_total = F_friction + F_cohesion
    
    # 稳定系数
    K_s = F_total / P_h
    
    return {
        'K_s': K_s,
        'F_friction': F_friction,
        'F_cohesion': F_cohesion,
        'F_total': F_total,
        'P_h': P_h,
        'is_safe': K_s >= 3.0
    }

# 计算
stability = sliding_stability(
    P_h=result['P_h'],
    P_v=result['P_v'],
    A=dam.B,
    f_prime=0.65,
    c_prime=150
)

print("\n"+"="*50)
print("抗滑稳定分析")
print("="*50)
print(f"摩擦力: {stability['F_friction']:.2f} kN/m")
print(f"粘聚力: {stability['F_cohesion']:.2f} kN/m")
print(f"总抗滑力: {stability['F_total']:.2f} kN/m")
print(f"滑动力: {stability['P_h']:.2f} kN/m")
print(f"抗滑稳定系数 K_s: {stability['K_s']:.3f}")
print(f"是否满足规范(≥3.0): {'是' if stability['is_safe'] else '否'}")
```

---

## 四、应力计算

### 4.1 坝底应力

材料力学公式：
$$\sigma = \frac{N}{A} \pm \frac{M}{W}$$

其中：
- $N = \sum V$：法向力
- $M$：弯矩
- $W = \frac{B^2}{6}$：截面模量（单位坝长）

**上游边应力**：
$$\sigma_{max} = \frac{\sum V}{B}\left(1 + \frac{6e}{B}\right)$$

**下游边应力**：
$$\sigma_{min} = \frac{\sum V}{B}\left(1 - \frac{6e}{B}\right)$$

**偏心距**：
$$e = \frac{B}{2} - \frac{M}{\sum V}$$

**无拉应力条件**：
$$e \leq \frac{B}{6}$$

---

## 五、设计实例

**某重力坝设计参数**：
- 坝高：H = 50 m
- 上游水深：H₁ = 48 m
- 下游水深：H₂ = 5 m
- 坝底宽：B = 40 m（待优化）

**要求**：
1. 计算荷载
2. 校核抗滑稳定
3. 校核坝底应力
4. 优化坝底宽度

**完整代码见上文**

---

**本节作业**：
1. 修改参数，重新计算
2. 绘制K_s与B关系曲线
3. 探究防渗系数α的影响

**下一节**：拱坝设计理论
