# 第6章：水闸设计

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐

---

## 一、水闸概述与分类

### 1.1 水闸定义与功能

**水闸**：利用闸门控制流量、调节水位的低水头水工建筑物

**主要功能**：
- 挡水：调节上游水位
- 泄水：控制下泄流量
- 引水：满足灌溉、供水需求
- 冲沙：排除泥沙
- 防洪：配合水库调度

### 1.2 闸型分类

**按闸室结构**：
1. **开敞式**：无胸墙，闸门全开时水流平顺
2. **胸墙式**：设胸墙，减小闸门高度

**按闸门类型**：
- 平板闸门
- 弧形闸门
- 人字闸门
- 翻板闸门

**按工作性质**：
- 节制闸：调节水位
- 进水闸：引水
- 排水闸：排洪排涝

---

## 二、水闸布置与选型

### 2.1 闸址选择

**基本原则**：
1. 地质条件好（承载力强、渗透性小）
2. 河势稳定（无冲刷、淤积）
3. 交通方便
4. 施工条件好

**地质要求**：
- 地基承载力$\geq 150$ kPa
- 渗透系数$k < 10^{-5}$ m/s（防渗要求）
- 无软弱夹层

### 2.2 闸孔布置

**孔数与孔宽**：
$$B = \sum b_i$$

**设计流量**：
$$Q = m b H_0 \sqrt{2g H_0}$$

其中：
- $m$：流量系数（平板闸门0.33-0.38）
- $b$：净宽
- $H_0$：作用水头

**孔宽选择**：
- 单孔：$b < 15$ m
- 多孔：$b = 5 \sim 10$ m

---

## 三、闸室设计

### 3.1 底板设计

**厚度确定**：
$$t \geq \frac{p_{max}}{\gamma_c K_c}$$

其中：
- $p_{max}$：最大扬压力
- $\gamma_c$：混凝土容重
- $K_c$：安全系数（1.2-1.5）

**配筋计算**：
$$M = \frac{q l^2}{8}$$

**排水孔设置**：
- 间距：2-3 m
- 直径：150-200 mm
- 深度：底板厚度的2/3

### 3.2 闸墩设计

**厚度**：
$$d = (0.15 \sim 0.20) b$$

**稳定性校核**：
- 抗滑稳定系数$K_c \geq 1.05$
- 地基应力$\sigma_{max} \leq [\sigma]$

### 3.3 闸门与启闭设备

**闸门选型**：
| 闸门类型 | 适用水头 | 优点 | 缺点 |
|----------|----------|------|------|
| 平板门 | $< 10$ m | 结构简单 | 启闭力大 |
| 弧形门 | $< 50$ m | 启闭力小 | 结构复杂 |

**启闭力计算**（平板门）：
$$T = W + G + F_f - F_p$$

其中：
- $W$：自重
- $G$：水重
- $F_f$：摩阻力
- $F_p$：浮托力

---

## 四、防渗与排水设计

### 4.1 渗流计算

**基本方程**（达西定律）：
$$q = -K \frac{\partial h}{\partial s}$$

**渗流网法**：
- 等势线与流线正交
- 单个网格为"曲线正方形"

**流量计算**：
$$Q = K H \frac{N_f}{N_d}$$

其中：
- $N_f$：流槽数
- $N_d$：等势降数

### 4.2 防渗措施

**(1) 上游铺盖**：
- 长度：$L_s = (1.5 \sim 2.5) H$
- 厚度：0.3-0.5 m

**(2) 下游排水**：
- 反滤层：3-5层
- 粒径比：$d_{15}^{上}/d_{85}^{下} < 5$

**(3) 防渗墙**：
- 深度：$T = (0.5 \sim 1.0) H$
- 位置：上游或中间

**例题1**：水闸上游水头$H=5$ m，地基渗透系数$K=10^{-4}$ m/s，
上游铺盖长$L_s=10$ m，求单宽渗流量

**解**：
采用渗流网法，假设$N_f=4$，$N_d=10$

$$Q = K H \frac{N_f}{N_d} = 10^{-4} \times 5 \times \frac{4}{10} = 2 \times 10^{-4} \text{ m}^3/\text{(s·m)}$$

---

## 五、稳定分析

### 5.1 抗滑稳定

**沿水平面滑动**：
$$K_c = \frac{\sum W \tan\varphi + cA}{\sum P} \geq 1.05$$

其中：
- $\sum W$：竖向力合力
- $\varphi$：内摩擦角
- $c$：粘聚力
- $A$：底面积
- $\sum P$：水平力合力

**例题2**：水闸自重$W=1000$ kN/m，上游水压力$P_1=500$ kN/m，
下游水压力$P_2=100$ kN/m，扬压力$U=300$ kN/m，
$\tan\varphi=0.6$，求抗滑稳定系数

**解**：
$$\sum W' = W - U = 1000 - 300 = 700 \text{ kN/m}$$
$$\sum P = P_1 - P_2 = 500 - 100 = 400 \text{ kN/m}$$
$$K_c = \frac{700 \times 0.6}{400} = 1.05$$

刚好满足要求（临界状态）。

---

### 5.2 抗倾稳定

**绕下游趾点倾覆**：
$$K_0 = \frac{\sum M_{抗}}{\sum M_{倾}} \geq 1.5$$

**偏心距检验**：
$$e = \frac{b}{2} - \frac{\sum M}{\sum W} \leq \frac{b}{6}$$

**例题3**：底板宽$b=10$ m，自重对中心力矩$M_W=0$，
水压力对中心力矩$M_P=2000$ kN·m/m，求偏心距

**解**：
$$e = \frac{10}{2} - \frac{0 - (-2000)}{1000} = 5 - 2 = 3 \text{ m}$$
$$\frac{b}{6} = \frac{10}{6} = 1.67 \text{ m}$$

$e > b/6$，不满足要求，需加宽底板或设置配重。

---

### 5.3 地基应力

**合力作用点**：
$$x_0 = \frac{\sum M}{\sum V}$$

**地基应力**（假设线性分布）：
$$\sigma = \frac{\sum V}{A} \pm \frac{\sum M \cdot y}{I}$$

对矩形底板：
$$\sigma_{max,min} = \frac{\sum V}{b}\left(1 \pm \frac{6e}{b}\right)$$

**要求**：
- $\sigma_{max} \leq [\sigma]$（地基承载力）
- $\sigma_{min} \geq 0$（不脱开）

---

## 六、消能防冲设计

### 6.1 消能方式

**(1) 底流消能**（消力池）：
- 适用：$q < 20$ m²/s
- 池深：$d = h_c \sim 1.5 h_c$
- 池长：$L = 6 \sim 8 h_2$

**(2) 挑流消能**：
- 适用：$q > 50$ m²/s，岩基
- 挑角：$\theta = 15° \sim 30°$
- 射距：$L = \frac{v_0^2 \sin 2\theta}{g}$

### 6.2 海漫与防冲槽

**海漫长度**：
$$L_{h} = (2 \sim 4) (H_1 - H_2)$$

**防冲槽**：
- 深度：$d_s = (0.5 \sim 1.0) (H_1 - H_2)$
- 长度：$l_s = 2 \sim 3$ m

---

## 七、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class SluiceGateDesign:
    """水闸设计工具"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def discharge_coefficient(self, gate_type='flat', H_over_e=None):
        """
        流量系数
        
        参数:
            gate_type: 'flat'平板闸门, 'radial'弧形闸门
            H_over_e: H/e比值
        """
        if gate_type == 'flat':
            return 0.35  # 简化取值
        elif gate_type == 'radial':
            return 0.42
        else:
            return 0.35
    
    def design_discharge(self, Q, H, b=None, n_gates=None):
        """
        设计过流能力
        
        参数:
            Q: 设计流量(m³/s)
            H: 作用水头(m)
            b: 单孔宽度(m)或None
            n_gates: 闸孔数或None
        
        返回:
            b: 单孔宽度
            n: 闸孔数
        """
        m = self.discharge_coefficient()
        
        if b is None and n_gates is not None:
            # 给定孔数，求孔宽
            b = Q / (n_gates * m * np.sqrt(2*self.g*H**3))
        elif n_gates is None and b is not None:
            # 给定孔宽，求孔数
            n_gates = np.ceil(Q / (b * m * np.sqrt(2*self.g*H**3)))
        else:
            # 都未给定，优化设计
            # 单孔宽度取8m
            b = 8.0
            n_gates = np.ceil(Q / (b * m * np.sqrt(2*self.g*H**3)))
        
        return b, int(n_gates)
    
    def seepage_flowrate(self, K, H, Nf, Nd):
        """
        渗流量计算（渗流网法）
        
        参数:
            K: 渗透系数(m/s)
            H: 上下游水头差(m)
            Nf: 流槽数
            Nd: 等势降数
        
        返回:
            Q: 单宽渗流量(m³/(s·m))
        """
        Q = K * H * Nf / Nd
        return Q
    
    def sliding_stability(self, W, U, P_up, P_down, tan_phi, c=0, A=1):
        """
        抗滑稳定分析
        
        参数:
            W: 自重(kN/m)
            U: 扬压力(kN/m)
            P_up: 上游水压力(kN/m)
            P_down: 下游水压力(kN/m)
            tan_phi: 摩擦系数
            c: 粘聚力(kPa)
            A: 底面积(m²/m)
        
        返回:
            Kc: 抗滑稳定系数
        """
        V_eff = W - U  # 有效竖向力
        P_net = P_up - P_down  # 净水平力
        
        Kc = (V_eff * tan_phi + c * A) / P_net
        return Kc
    
    def overturning_stability(self, moments_resisting, moments_overturning):
        """
        抗倾稳定分析
        
        参数:
            moments_resisting: 抗倾力矩列表(kN·m/m)
            moments_overturning: 倾覆力矩列表(kN·m/m)
        
        返回:
            K0: 抗倾稳定系数
        """
        M_resist = sum(moments_resisting)
        M_overt = sum(moments_overturning)
        
        K0 = M_resist / M_overt
        return K0
    
    def foundation_stress(self, V, M, b):
        """
        地基应力计算
        
        参数:
            V: 竖向力(kN/m)
            M: 对底板中心的力矩(kN·m/m)
            b: 底板宽度(m)
        
        返回:
            sigma_max: 最大应力(kPa)
            sigma_min: 最小应力(kPa)
            e: 偏心距(m)
        """
        e = M / V
        
        sigma_max = V / b * (1 + 6*e / b)
        sigma_min = V / b * (1 - 6*e / b)
        
        return sigma_max, sigma_min, e
    
    def stilling_basin_depth(self, h1, Fr1):
        """
        消力池深度（共轭水深）
        
        参数:
            h1: 进口水深(m)
            Fr1: 进口Froude数
        
        返回:
            h2: 出口水深(m)
            d: 池深(m)
        """
        # 共轭水深公式
        h2 = h1 / 2 * (np.sqrt(1 + 8*Fr1**2) - 1)
        
        # 池深取临界水深
        hc = h1 * Fr1**(2/3)
        d = 1.2 * hc
        
        return h2, d
    
    def plot_sluice_design(self, H_up, H_down, b, t_floor, t_pier):
        """绘制水闸剖面图"""
        fig, ax = plt.subplots(figsize=(12, 6))
        
        # 底板
        ax.plot([0, b], [-t_floor, -t_floor], 'k-', linewidth=3,
               label='底板')
        ax.plot([0, 0], [-t_floor, 0], 'k-', linewidth=3)
        ax.plot([b, b], [-t_floor, 0], 'k-', linewidth=3)
        
        # 闸墩
        pier_width = t_pier
        ax.fill([b/2-pier_width/2, b/2+pier_width/2,
                b/2+pier_width/2, b/2-pier_width/2],
               [0, 0, H_up, H_up],
               color='gray', alpha=0.5, label='闸墩')
        
        # 上游水位
        ax.fill([0, 0, b/3, b/3], [-t_floor, H_up, H_up, 0],
               color='blue', alpha=0.3, label='上游水位')
        
        # 下游水位
        ax.fill([2*b/3, 2*b/3, b, b], [0, H_down, H_down, -t_floor],
               color='cyan', alpha=0.3, label='下游水位')
        
        # 闸门（虚线表示）
        ax.plot([b/2-pier_width/2, b/2-pier_width/2],
               [0, H_up*0.6], 'r--', linewidth=2, label='闸门')
        
        # 标注
        ax.text(b/6, H_up/2, f'H₁={H_up:.1f}m',
               fontsize=11, ha='center')
        ax.text(5*b/6, H_down/2, f'H₂={H_down:.1f}m',
               fontsize=11, ha='center')
        ax.text(b/2, -t_floor-0.5, f'底板厚t={t_floor:.1f}m',
               fontsize=11, ha='center')
        
        ax.set_xlabel('水平距离 (m)', fontsize=11)
        ax.set_ylabel('高程 (m)', fontsize=11)
        ax.set_title('水闸设计剖面图', fontsize=13, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        ax.axis('equal')
        
        plt.tight_layout()
        plt.savefig('sluice_gate_design.png', dpi=300)
        plt.show()

# 示例使用
print("="*60)
print("水闸设计工具")
print("="*60)

sgd = SluiceGateDesign()

# 1. 设计流量计算
print("\n1. 设计流量计算")
Q_design = 500  # m³/s
H_design = 5    # m

b, n = sgd.design_discharge(Q_design, H_design, n_gates=5)
print(f"  设计流量 Q = {Q_design} m³/s")
print(f"  设计水头 H = {H_design} m")
print(f"  闸孔数 n = {n}")
print(f"  单孔宽度 b = {b:.2f} m")

# 验证
m = sgd.discharge_coefficient()
Q_check = n * m * b * np.sqrt(2*9.81*H_design**3)
print(f"  验证流量 = {Q_check:.1f} m³/s")

# 2. 渗流分析
print("\n" + "="*60)
print("2. 渗流分析")
K = 1e-4  # m/s
H_seep = 5  # m
Nf, Nd = 4, 10

Q_seep = sgd.seepage_flowrate(K, H_seep, Nf, Nd)
print(f"  渗透系数 K = {K:.2e} m/s")
print(f"  水头差 H = {H_seep} m")
print(f"  流槽数 Nf = {Nf}")
print(f"  等势降数 Nd = {Nd}")
print(f"  单宽渗流量 q = {Q_seep:.2e} m³/(s·m)")

# 3. 稳定性分析
print("\n" + "="*60)
print("3. 稳定性分析")

# 抗滑稳定
W = 1000   # kN/m
U = 300    # kN/m
P_up = 500 # kN/m
P_down = 100 # kN/m
tan_phi = 0.6

Kc = sgd.sliding_stability(W, U, P_up, P_down, tan_phi)
print(f"  自重 W = {W} kN/m")
print(f"  扬压力 U = {U} kN/m")
print(f"  上游水压 P₁ = {P_up} kN/m")
print(f"  下游水压 P₂ = {P_down} kN/m")
print(f"  摩擦系数 tanφ = {tan_phi}")
print(f"  抗滑稳定系数 Kc = {Kc:.2f}")
print(f"  {'✓ 满足要求 (Kc≥1.05)' if Kc >= 1.05 else '✗ 不满足要求'}")

# 地基应力
V_total = W
M_total = P_up * (5/3) - P_down * (2/3) - U * (10/2)
b_floor = 10  # m

sigma_max, sigma_min, e = sgd.foundation_stress(V_total, M_total, b_floor)
print(f"\n  地基应力分析:")
print(f"  底板宽度 b = {b_floor} m")
print(f"  偏心距 e = {e:.2f} m")
print(f"  b/6 = {b_floor/6:.2f} m")
print(f"  {'✓ 满足要求 (e≤b/6)' if e <= b_floor/6 else '✗ 不满足要求'}")
print(f"  最大应力 σmax = {sigma_max:.1f} kPa")
print(f"  最小应力 σmin = {sigma_min:.1f} kPa")

# 4. 消力池设计
print("\n" + "="*60)
print("4. 消力池设计")

h1 = 2.0  # m
Fr1 = 3.0

h2, d = sgd.stilling_basin_depth(h1, Fr1)
print(f"  进口水深 h₁ = {h1} m")
print(f"  进口Froude数 Fr₁ = {Fr1}")
print(f"  出口水深 h₂ = {h2:.2f} m")
print(f"  推荐池深 d = {d:.2f} m")

# 5. 绘制剖面图
print("\n绘制水闸剖面图...")
sgd.plot_sluice_design(H_up=5, H_down=2, b=10, t_floor=1.5, t_pier=1.0)
```

---

## 八、典型工程案例

### 案例1：某灌溉枢纽节制闸

**工程概况**：
- 设计流量：$Q = 300$ m³/s
- 上游水位：$H_1 = 6$ m
- 下游水位：$H_2 = 2$ m
- 地基：砂性土，$K = 10^{-4}$ m/s

**设计方案**：
- 闸孔数：5孔
- 单孔宽度：$b = 8$ m
- 底板厚度：$t = 2.0$ m
- 上游铺盖：$L_s = 12$ m
- 下游海漫：$L_h = 15$ m

---

**本章重点**：
- 水闸分类与布置
- 闸室结构设计
- 防渗排水措施
- 稳定性分析（抗滑、抗倾、地基应力）
- 消能防冲设计

**下一章**：水电站建筑物
