# 第3章：重力坝设计原理

**结构类型**: 混凝土重力坝  
**设计重点**: 稳定与强度

---

## 一、重力坝基本概念

### 1.1 定义

**重力坝**：依靠自重维持稳定的坝型

**特点**：
- 结构简单
- 施工方便
- 安全可靠
- 工程量大

### 1.2 荷载组合

**基本组合**：
1. 自重
2. 静水压力
3. 扬压力
4. 泥沙压力

**特殊组合**：
- 地震荷载
- 冰压力
- 浪压力

---

## 二、荷载计算

### 2.1 自重

$$W = \gamma_c \cdot V$$

混凝土容重：$\gamma_c = 24$ kN/m³

### 2.2 静水压力

**上游水压力**（三角形分布）：
$$P_1 = \frac{1}{2}\gamma_w H_1^2$$

作用点：距坝底$\frac{H_1}{3}$

### 2.3 扬压力

**简化公式**：
$$U = \frac{1}{2}\gamma_w (H_1 + H_2) \cdot B \cdot \alpha$$

- $\alpha$：扬压力折减系数（0.25-0.33）
- $B$：坝底宽度

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class GravityDamDesign:
    """重力坝设计"""
    
    def __init__(self, gamma_c=24000, gamma_w=10000):
        """
        参数:
            gamma_c: 混凝土容重 (N/m³)
            gamma_w: 水容重 (N/m³)
        """
        self.gamma_c = gamma_c
        self.gamma_w = gamma_w
    
    def self_weight(self, profile_coords):
        """
        计算坝体自重
        
        参数:
            profile_coords: 坝体剖面坐标 [(x1,y1), (x2,y2), ...]
        
        返回:
            W: 自重 (N/m)
            x_w: 重心横坐标 (m)
        """
        # 使用鞋带公式计算面积
        coords = np.array(profile_coords)
        x = coords[:, 0]
        y = coords[:, 1]
        
        area = 0.5 * abs(np.dot(x, np.roll(y, 1)) - np.dot(y, np.roll(x, 1)))
        
        # 重心坐标
        x_c = np.sum((x + np.roll(x, 1)) * (x * np.roll(y, 1) - np.roll(x, 1) * y)) / (6 * area)
        
        W = self.gamma_c * area
        
        return W, x_c
    
    def water_pressure(self, H):
        """
        静水压力
        
        P = (1/2)·γ_w·H²
        
        参数:
            H: 水深 (m)
        
        返回:
            P: 总压力 (N/m)
            y_p: 作用点高度 (m，距底部)
        """
        P = 0.5 * self.gamma_w * H**2
        y_p = H / 3
        
        return P, y_p
    
    def uplift_pressure(self, H1, H2, B, alpha=0.3):
        """
        扬压力
        
        U = (1/2)·γ_w·(H1 + H2)·B·α
        
        参数:
            H1: 上游水深 (m)
            H2: 下游水深 (m)
            B: 坝底宽度 (m)
            alpha: 折减系数
        
        返回:
            U: 扬压力 (N/m)
            x_u: 作用点位置 (m，距上游坝踵)
        """
        U = 0.5 * self.gamma_w * (H1 + H2) * B * alpha
        
        # 作用点（梯形形心）
        if H1 != H2:
            x_u = B * (H1 + 2*H2) / (3 * (H1 + H2))
        else:
            x_u = B / 2
        
        return U, x_u
    
    def stability_analysis(self, W, P_h, U, B, H, x_w, mu=0.65):
        """
        稳定分析
        
        1. 抗滑稳定：K_s = (W - U)·μ / P_h
        2. 抗倾覆稳定：K_o = ΣM_稳定 / ΣM_倾覆
        
        参数:
            W: 自重 (N/m)
            P_h: 水平水压力 (N/m)
            U: 扬压力 (N/m)
            B: 坝底宽度 (m)
            H: 坝高 (m)
            x_w: 重心到上游坝踵距离 (m)
            mu: 摩擦系数
        
        返回:
            K_s: 抗滑稳定系数
            K_o: 抗倾覆稳定系数
        """
        # 抗滑稳定
        K_s = (W - U) * mu / P_h
        
        # 抗倾覆稳定（对坝踵取矩）
        # 稳定力矩
        M_stable = W * x_w
        
        # 倾覆力矩
        M_overturn = P_h * H / 3 + U * B / 2
        
        K_o = M_stable / M_overturn
        
        return K_s, K_o
    
    def stress_analysis(self, W, P_h, U, B, x_w):
        """
        坝基应力分析
        
        σ = (W - U)/B ± 6M/B²
        
        M = W·x_w - P_h·H/3 - U·B/2
        
        返回:
            sigma_heel: 坝踵应力 (Pa)
            sigma_toe: 坝趾应力 (Pa)
        """
        # 合力偏心距
        N = W - U
        
        # 对坝底中心取矩
        M = W * (x_w - B/2) - P_h * 0  # 简化
        
        # 坝基应力
        sigma_avg = N / B
        sigma_bend = 6 * M / B**2
        
        sigma_heel = sigma_avg - sigma_bend  # 上游坝踵
        sigma_toe = sigma_avg + sigma_bend   # 下游坝趾
        
        return sigma_heel, sigma_toe
    
    def plot_dam_profile(self, H, m1=0.7, m2=0.05, B_crest=5):
        """
        绘制重力坝剖面
        
        参数:
            H: 坝高 (m)
            m1: 上游坡比
            m2: 下游坡比
            B_crest: 坝顶宽度 (m)
        """
        # 坝体坐标（梯形）
        x_dam = [0, m1*H, m1*H + B_crest, m1*H + B_crest + m2*H, 0]
        y_dam = [0, H, H, 0, 0]
        
        # 上下游水位
        H1 = H * 0.9  # 上游水位
        H2 = H * 0.1  # 下游水位
        
        fig, ax = plt.subplots(figsize=(14, 8))
        
        # 坝体
        ax.fill(x_dam, y_dam, color='gray', alpha=0.7, label='坝体')
        ax.plot(x_dam, y_dam, 'k-', linewidth=2)
        
        # 上游水体
        x_water_up = [0, 0, m1*H, m1*H]
        y_water_up = [0, H1, H1, 0]
        ax.fill(x_water_up, y_water_up, color='blue', alpha=0.3,
               label='上游水位')
        
        # 下游水体
        x_water_down = [m1*H + B_crest, m1*H + B_crest, 
                        m1*H + B_crest + m2*H, m1*H + B_crest + m2*H]
        y_water_down = [0, H2, H2, 0]
        ax.fill(x_water_down, y_water_down, color='cyan', alpha=0.3,
               label='下游水位')
        
        # 标注
        ax.text(B_crest/2, H+2, f'坝顶宽度={B_crest}m', ha='center',
               fontsize=11, bbox=dict(boxstyle='round', facecolor='wheat'))
        ax.text(-5, H1/2, f'H₁={H1:.1f}m', fontsize=11)
        ax.text(max(x_dam)+5, H2/2, f'H₂={H2:.1f}m', fontsize=11)
        
        ax.set_xlabel('水平距离 (m)', fontsize=12)
        ax.set_ylabel('高程 (m)', fontsize=12)
        ax.set_title('重力坝剖面图', fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        ax.set_aspect('equal')
        
        plt.tight_layout()
        plt.savefig('gravity_dam_profile.png', dpi=300)
        plt.show()

# 示例：重力坝设计计算
print("="*60)
print("重力坝稳定与应力计算")
print("="*60)

gd = GravityDamDesign()

# 坝体几何（简化为梯形）
H = 50  # 坝高 (m)
B_crest = 5  # 坝顶宽 (m)
m1 = 0.7  # 上游坡比
m2 = 0.05  # 下游坡比（接近直立）

B = m1*H + B_crest + m2*H  # 坝底宽

# 坝体剖面坐标
profile = [
    (0, 0),
    (m1*H, H),
    (m1*H + B_crest, H),
    (B, 0),
    (0, 0)
]

print(f"坝体几何:")
print(f"  坝高 H = {H} m")
print(f"  坝顶宽度 = {B_crest} m")
print(f"  坝底宽度 B = {B:.1f} m")

# 荷载计算
W, x_w = gd.self_weight(profile)

H1 = H * 0.9  # 上游水深
H2 = H * 0.1  # 下游水深

P1, y_p1 = gd.water_pressure(H1)
P2, y_p2 = gd.water_pressure(H2)
P_h = P1 - P2  # 净水平力

U, x_u = gd.uplift_pressure(H1, H2, B)

print(f"\n荷载计算:")
print(f"  自重 W = {W/1000:.0f} kN/m")
print(f"  重心位置 x_w = {x_w:.2f} m")
print(f"  上游水压力 P₁ = {P1/1000:.0f} kN/m")
print(f"  下游水压力 P₂ = {P2/1000:.0f} kN/m")
print(f"  净水平力 P_h = {P_h/1000:.0f} kN/m")
print(f"  扬压力 U = {U/1000:.0f} kN/m")

# 稳定性计算
K_s, K_o = gd.stability_analysis(W, P_h, U, B, H, x_w)

print(f"\n稳定性分析:")
print(f"  抗滑稳定系数 K_s = {K_s:.3f}")
print(f"  规范要求: K_s ≥ 1.05 (正常), ≥ 1.00 (非常)")

if K_s >= 1.05:
    print(f"  ✓ 抗滑稳定满足要求")
else:
    print(f"  ✗ 抗滑稳定不满足，需增大坝体或排水")

print(f"\n  抗倾覆稳定系数 K_o = {K_o:.3f}")
print(f"  规范要求: K_o ≥ 1.5")

if K_o >= 1.5:
    print(f"  ✓ 抗倾覆稳定满足要求")
else:
    print(f"  ✗ 抗倾覆稳定不满足")

# 应力分析
sigma_heel, sigma_toe = gd.stress_analysis(W, P_h, U, B, x_w)

print(f"\n坝基应力:")
print(f"  坝踵应力 σ_heel = {sigma_heel/1000:.1f} kPa")
print(f"  坝趾应力 σ_toe = {sigma_toe/1000:.1f} kPa")

# 检查
if sigma_heel >= 0:
    print(f"  ✓ 坝踵无拉应力")
else:
    print(f"  ✗ 坝踵出现拉应力 {abs(sigma_heel)/1000:.1f} kPa")

# 可视化
gd.plot_dam_profile(H, m1, m2, B_crest)
```

---

## 三、稳定性校核

### 3.1 抗滑稳定

$$K_s = \frac{(W - U)f'}{\sum P_h} \geq 1.05$$

$f'$：抗剪断摩擦系数（0.65-1.0）

### 3.2 抗倾覆稳定

$$K_o = \frac{\sum M_{稳定}}{\sum M_{倾覆}} \geq 1.5$$

对坝踵取矩

---

## 四、应力校核

### 4.1 坝基应力

$$\sigma = \frac{N}{B} \pm \frac{6M}{B^2}$$

**要求**：
- 上游坝踵：不出现拉应力（σ≥0）
- 下游坝趾：σ≤[σ]

### 4.2 强度校核

$$\sigma \leq [\sigma] = \frac{f_{ck}}{K}$$

$f_{ck}$：混凝土抗压强度  
$K$：安全系数（2.5-3.5）

---

## 五、典型考题

### 【例题】重力坝稳定计算

**题目**（35分）

重力坝，坝高H=40m，坝底宽B=35m，上游水深H₁=36m，下游水深H₂=4m。混凝土容重γ_c=24kN/m³，摩擦系数f'=0.7。扬压力折减系数α=0.3。求：
1. 抗滑稳定系数
2. 抗倾覆稳定系数

**【解答】**（略，参见Python代码示例）

---

**本章重点**：
- 荷载组合
- 稳定性计算
- 应力分析
- 安全系数标准
