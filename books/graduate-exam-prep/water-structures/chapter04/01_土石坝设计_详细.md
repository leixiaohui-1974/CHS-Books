# 第4章：土石坝设计原理

**坝型**: 土质坝、堆石坝  
**设计重点**: 渗流与稳定

---

## 一、土石坝基本概念

### 1.1 分类

**按材料**：
- 均质土坝：单一土料
- 心墙坝：防渗心墙+坝壳
- 斜墙坝：防渗斜墙+坝壳
- 面板坝：混凝土面板+堆石

**按施工方法**：
- 碾压式：分层碾压
- 水力冲填式：高压水冲填

### 1.2 优缺点

**优点**：
- 就地取材，造价低
- 对地基适应性强
- 抗震性能好

**缺点**：
- 不能溢流
- 施工期长
- 易渗漏

---

## 二、渗流分析

### 2.1 达西定律

$$v = k \cdot i = k \frac{\Delta h}{L}$$

- $k$：渗透系数（cm/s）
- $i$：水力坡度

### 2.2 浸润线

**定义**：坝体内自由水面（饱和区与非饱和区分界）

**计算方法**：
- 解析法（简化）
- 图解法
- 数值法（有限元）

**抛物线法**（基本公式）：
$$y^2 = x^2 + (h_1^2 - a^2)$$

### 2.3 渗流量

**单宽渗流量**：
$$q = k \cdot i \cdot h$$

**总渗流量**：
$$Q = q \cdot L$$

### 2.4 渗透稳定

**渗透破坏类型**：
1. **管涌**：细颗粒流失
2. **流土**：土体整体移动
3. **接触冲刷**：层间冲刷

**安全判别**：
$$i_{出溢} < [i_{允许}]$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class EarthDamDesign:
    """土石坝设计"""
    
    def __init__(self, g=9.81, gamma_w=10000):
        self.g = g
        self.gamma_w = gamma_w
    
    def seepage_line_parabolic(self, H, L, a, x_range):
        """
        浸润线（抛物线法）
        
        y² = x² + (H² - a²)
        
        参数:
            H: 上游水位 (m)
            L: 坝底长度 (m)
            a: 修正参数 (m)
            x_range: x坐标范围 (m)
        
        返回:
            x, y: 浸润线坐标
        """
        x = np.array(x_range)
        
        # 抛物线方程
        y_squared = x**2 + (H**2 - a**2)
        
        # 只取正值
        y = np.sqrt(np.maximum(0, y_squared))
        
        return x, y
    
    def seepage_discharge(self, k, H1, H2, L):
        """
        渗流量（简化公式）
        
        q = k(H₁² - H₂²) / (2L)
        
        参数:
            k: 渗透系数 (m/s)
            H1: 上游水位 (m)
            H2: 下游水位 (m)
            L: 渗径长度 (m)
        
        返回:
            q: 单宽渗流量 (m²/s)
        """
        q = k * (H1**2 - H2**2) / (2 * L)
        
        return q
    
    def exit_gradient(self, q, k, h_exit):
        """
        出溢坡降
        
        i_出 = q / (k·h_出溢)
        
        参数:
            q: 单宽渗流量 (m²/s)
            k: 渗透系数 (m/s)
            h_exit: 出溢点水深 (m)
        
        返回:
            i_exit: 出溢坡降
        """
        i_exit = q / (k * h_exit)
        
        return i_exit
    
    def critical_gradient(self, gamma_s, n):
        """
        临界坡降
        
        i_cr = (γ_s - γ_w) / γ_w = (G_s - 1) / (1 + e)
        
        简化：i_cr ≈ 1.0 (砂土)
        
        参数:
            gamma_s: 土粒容重 (N/m³)
            n: 孔隙率
        
        返回:
            i_cr: 临界坡降
        """
        G_s = gamma_s / self.gamma_w  # 土粒相对密度
        e = n / (1 - n)  # 孔隙比
        
        i_cr = (G_s - 1) / (1 + e)
        
        return i_cr
    
    def slope_stability_slice(self, H, theta, c, phi, gamma):
        """
        边坡稳定（简化条分法）
        
        Fs = (c·L + W·cosθ·tanφ) / (W·sinθ)
        
        参数:
            H: 坝高 (m)
            theta: 滑裂面倾角 (度)
            c: 粘聚力 (kPa)
            phi: 内摩擦角 (度)
            gamma: 土容重 (kN/m³)
        
        返回:
            Fs: 安全系数
        """
        theta_rad = np.radians(theta)
        phi_rad = np.radians(phi)
        
        # 简化：单位宽度滑块
        W = 0.5 * gamma * H**2  # 近似重量
        L = H / np.sin(theta_rad)  # 滑裂面长度
        
        # 抗滑力
        T_r = c * L + W * np.cos(theta_rad) * np.tan(phi_rad)
        
        # 滑动力
        T_s = W * np.sin(theta_rad)
        
        # 安全系数
        Fs = T_r / T_s if T_s > 0 else np.inf
        
        return Fs
    
    def compaction_parameters(self, w_opt, gamma_d_max, w, gamma_d):
        """
        压实参数
        
        压实度 K = γ_d / γ_d,max
        
        参数:
            w_opt: 最优含水率 (%)
            gamma_d_max: 最大干密度 (kN/m³)
            w: 实际含水率 (%)
            gamma_d: 实际干密度 (kN/m³)
        
        返回:
            K: 压实度
        """
        K = gamma_d / gamma_d_max * 100  # %
        
        return K
    
    def plot_dam_cross_section(self, H, m1, m2, B_crest):
        """绘制土坝横断面与浸润线"""
        # 坝体轮廓
        x_upstream = -m1 * H
        x_crest_left = 0
        x_crest_right = B_crest
        x_downstream = B_crest + m2 * H
        
        x_dam = [x_upstream, x_crest_left, x_crest_right, x_downstream, 
                 x_downstream, x_upstream, x_upstream]
        y_dam = [0, H, H, 0, -0.5, -0.5, 0]
        
        # 上游水位
        H1 = 0.9 * H
        x_water_up = [x_upstream - 10, x_upstream, x_crest_left, x_crest_left]
        y_water_up = [H1, H1, H1, 0]
        
        # 下游水位
        H2 = 0.1 * H
        x_water_down = [x_crest_right, x_downstream, x_downstream, x_crest_right]
        y_water_down = [0, 0, H2, H2]
        
        # 浸润线（简化）
        L_seepage = B_crest + m1*H + m2*H
        a = 0.3 * m1 * H  # 修正参数
        
        x_seepage = np.linspace(0, L_seepage*0.8, 100)
        _, y_seepage = self.seepage_line_parabolic(H1, L_seepage, a, x_seepage)
        
        # 调整坐标系
        x_seepage_adjusted = x_seepage - m1*H
        
        fig, ax = plt.subplots(figsize=(16, 8))
        
        # 坝体
        ax.fill(x_dam, y_dam, color='brown', alpha=0.5, label='坝体')
        ax.plot(x_dam, y_dam, 'k-', linewidth=2)
        
        # 水体
        ax.fill(x_water_up, y_water_up, color='blue', alpha=0.3,
               label='上游水位')
        ax.fill(x_water_down, y_water_down, color='cyan', alpha=0.3,
               label='下游水位')
        
        # 浸润线
        ax.plot(x_seepage_adjusted, y_seepage, 'b--', linewidth=2.5,
               label='浸润线')
        
        # 标注
        ax.text(x_upstream/2, H/2, f'上游坡比\n1:{m1}', 
               ha='center', fontsize=11,
               bbox=dict(boxstyle='round', facecolor='wheat'))
        
        ax.text((x_crest_right+x_downstream)/2, H/2, f'下游坡比\n1:{m2}',
               ha='center', fontsize=11,
               bbox=dict(boxstyle='round', facecolor='wheat'))
        
        ax.text(B_crest/2, H+2, f'坝顶宽度={B_crest}m',
               ha='center', fontsize=11,
               bbox=dict(boxstyle='round', facecolor='lightgreen'))
        
        # 坝高标注
        ax.plot([x_crest_left-5, x_crest_left-5], [0, H], 'r-', linewidth=2)
        ax.text(x_crest_left-8, H/2, f'H={H}m', fontsize=12,
               rotation=90, va='center')
        
        ax.set_xlabel('水平距离 (m)', fontsize=12)
        ax.set_ylabel('高程 (m)', fontsize=12)
        ax.set_title('土石坝横断面与浸润线', fontsize=14)
        ax.legend(loc='upper right')
        ax.grid(True, alpha=0.3)
        ax.set_aspect('equal')
        ax.set_ylim([-2, H+5])
        
        plt.tight_layout()
        plt.savefig('earth_dam_cross_section.png', dpi=300)
        plt.show()
    
    def plot_compaction_curve(self):
        """绘制压实曲线"""
        # 标准击实试验数据（示例）
        w = np.array([8, 10, 12, 14, 16, 18, 20])  # 含水率 %
        gamma_d = np.array([17.5, 18.2, 18.8, 19.2, 19.0, 18.5, 18.0])  # 干密度 kN/m³
        
        # 找最优点
        idx_max = np.argmax(gamma_d)
        w_opt = w[idx_max]
        gamma_d_max = gamma_d[idx_max]
        
        fig, ax = plt.subplots(figsize=(10, 7))
        
        # 压实曲线
        ax.plot(w, gamma_d, 'bo-', linewidth=2, markersize=8,
               label='压实曲线')
        
        # 最优点
        ax.plot(w_opt, gamma_d_max, 'r*', markersize=20,
               label=f'最优点 (w={w_opt}%, γ_d,max={gamma_d_max}kN/m³)')
        
        # 辅助线
        ax.axvline(w_opt, color='r', linestyle='--', alpha=0.5)
        ax.axhline(gamma_d_max, color='r', linestyle='--', alpha=0.5)
        
        # 压实度线（95%、100%）
        ax.axhline(0.95*gamma_d_max, color='orange', linestyle=':',
                  linewidth=2, label='95%压实度')
        
        ax.set_xlabel('含水率 w (%)', fontsize=12)
        ax.set_ylabel('干密度 γ_d (kN/m³)', fontsize=12)
        ax.set_title('土料压实曲线', fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('compaction_curve.png', dpi=300)
        plt.show()

# 示例1：渗流分析
print("="*60)
print("示例1：土坝渗流分析")
print("="*60)

ed = EarthDamDesign()

# 坝体参数
H = 40  # 坝高 (m)
m1 = 2.5  # 上游坡比
m2 = 2.0  # 下游坡比
B_crest = 8  # 坝顶宽度 (m)
k = 1e-5  # 渗透系数 (m/s)

print(f"坝体参数:")
print(f"  坝高 H = {H} m")
print(f"  上游坡比 1:{m1}")
print(f"  下游坡比 1:{m2}")
print(f"  坝顶宽度 = {B_crest} m")
print(f"  渗透系数 k = {k} m/s = {k*100} cm/s")

# 水位
H1 = 36  # 上游水位 (m)
H2 = 4   # 下游水位 (m)

print(f"\n水位:")
print(f"  上游水位 H₁ = {H1} m")
print(f"  下游水位 H₂ = {H2} m")

# 渗径长度（简化）
L_seepage = B_crest + m1*H + m2*H

print(f"\n渗径长度:")
print(f"  L ≈ {L_seepage} m")

# 渗流量
q = ed.seepage_discharge(k, H1, H2, L_seepage)

print(f"\n渗流量:")
print(f"  单宽渗流量 q = {q*1000:.4f} L/(m·s)")
print(f"  若坝长500m，总渗流量 Q = {q*500:.3f} m³/s = {q*500*86400:.0f} m³/d")

# 出溢坡降检查
h_exit = 5  # 出溢点水深 (m)
i_exit = ed.exit_gradient(q, k, h_exit)

# 临界坡降
gamma_s = 27000  # 土粒容重 (N/m³)
n = 0.35  # 孔隙率
i_cr = ed.critical_gradient(gamma_s, n)

print(f"\n渗透稳定:")
print(f"  出溢坡降 i_出 = {i_exit:.3f}")
print(f"  临界坡降 i_cr = {i_cr:.3f}")
print(f"  安全系数 Fs = i_cr/i_出 = {i_cr/i_exit:.2f}")

if i_exit < i_cr:
    print(f"  ✓ 渗透稳定（Fs>1.5合格）")
else:
    print(f"  ✗ 渗透不稳定，需加固")

# 示例2：边坡稳定
print("\n" + "="*60)
print("示例2：边坡稳定分析")
print("="*60)

# 土料参数
c = 15  # 粘聚力 (kPa)
phi = 28  # 内摩擦角 (度)
gamma = 19  # 土容重 (kN/m³)

print(f"土料参数:")
print(f"  粘聚力 c = {c} kPa")
print(f"  内摩擦角 φ = {phi}°")
print(f"  土容重 γ = {gamma} kN/m³")

# 不同滑裂面倾角
print(f"\n不同滑裂面倾角的安全系数:")
print(f"{'倾角θ(°)':>10s} {'安全系数Fs':>15s} {'判定':>10s}")
print("-" * 40)

for theta in [20, 25, 30, 35, 40]:
    Fs = ed.slope_stability_slice(H, theta, c, phi, gamma)
    
    if Fs >= 1.5:
        status = '✓ 稳定'
    elif Fs >= 1.3:
        status = '○ 基本稳定'
    else:
        status = '✗ 不稳定'
    
    print(f"{theta:10d} {Fs:15.2f} {status:>10s}")

# 示例3：压实控制
print("\n" + "="*60)
print("示例3：压实质量控制")
print("="*60)

w_opt = 14  # 最优含水率 (%)
gamma_d_max = 19.2  # 最大干密度 (kN/m³)

print(f"标准击实试验:")
print(f"  最优含水率 w_opt = {w_opt}%")
print(f"  最大干密度 γ_d,max = {gamma_d_max} kN/m³")

# 现场压实检查
field_samples = [
    (13.5, 18.5),
    (14.0, 18.8),
    (14.5, 18.3),
    (15.0, 18.0)
]

print(f"\n现场压实检查:")
print(f"{'含水率w(%)':>12s} {'干密度γ_d':>15s} {'压实度K(%)':>15s} {'判定':>10s}")
print("-" * 60)

for w, gamma_d in field_samples:
    K = ed.compaction_parameters(w_opt, gamma_d_max, w, gamma_d)
    
    if K >= 96:
        status = '✓ 合格'
    elif K >= 93:
        status = '○ 基本合格'
    else:
        status = '✗ 不合格'
    
    print(f"{w:12.1f} {gamma_d:15.1f} {K:15.1f} {status:>10s}")

# 绘制坝体断面
print("\n绘制土坝横断面...")
ed.plot_dam_cross_section(H, m1, m2, B_crest)

# 绘制压实曲线
print("绘制压实曲线...")
ed.plot_compaction_curve()
```

---

## 三、边坡稳定

### 3.1 稳定分析方法

**瑞典圆弧法**：
$$K = \frac{\sum M_{稳}}{\sum M_{滑}} = \frac{\sum (c \cdot l + N \tan\varphi) \cdot R}{\sum W \cdot r}$$

### 3.2 稳定标准

| 工况 | 安全系数 |
|------|---------|
| 正常运用 | K≥1.5 |
| 非常运用 | K≥1.3 |
| 施工期 | K≥1.3 |

---

## 四、压实标准

### 4.1 压实度

$$K = \frac{\gamma_d}{\gamma_{d,max}} \times 100\%$$

**标准**：K≥96%（坝体），K≥93%（坝壳）

### 4.2 击实试验

**标准击实**：锤重2.5kg，落距30cm  
**重型击实**：锤重4.5kg，落距45cm

---

## 五、典型考题

### 【例题】土坝渗流计算

**题目**（25分）

均质土坝，H=50m，k=1×10⁻⁵m/s，上游水深45m，下游水深5m，渗径长度L=150m。求单宽渗流量。

**【解答】**

$$q = \frac{k(H_1^2 - H_2^2)}{2L} = \frac{1 \times 10^{-5} \times (45^2 - 5^2)}{2 \times 150}$$

$$q = \frac{1 \times 10^{-5} \times 2000}{300} = 6.67 \times 10^{-5} \text{ m}^2\text{/s}$$

---

**本章重点**：
- 渗流分析（达西定律、浸润线）
- 边坡稳定（条分法）
- 渗透稳定（临界坡降）
- 压实控制（压实度）

**下一章**：拱坝与支墩坝
