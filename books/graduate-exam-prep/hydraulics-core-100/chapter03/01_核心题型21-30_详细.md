# 第3章：管流核心题（21-30题）

**题型**: 沿程损失与局部损失  
**难度**: ⭐⭐⭐⭐

---

## 题21：沿程损失计算

**【题目】**（15分）

圆管，d=0.15m，L=500m，v=2m/s，λ=0.025。求沿程水头损失。

**【解答】**

**达西-魏斯巴赫公式**（8分）

$$h_f = \lambda \frac{L}{d} \frac{v^2}{2g}$$

代入：
$$h_f = 0.025 \times \frac{500}{0.15} \times \frac{2^2}{2 \times 9.81} = 8.50 \text{ m}$$

**评分点**（7分）：
- 公式正确（3分）
- 代入计算（3分）
- 结果单位（1分）

---

## 题22：管流雷诺数与流态

**【题目】**（12分）

水管，d=0.1m，Q=0.02m³/s，ν=1×10⁻⁶m²/s。判断流态。

**【解答】**

**(1) 流速**（3分）

$$v = \frac{Q}{A} = \frac{0.02}{\pi \times 0.1^2 / 4} = 2.55 \text{ m/s}$$

**(2) 雷诺数**（5分）

$$Re = \frac{vd}{\nu} = \frac{2.55 \times 0.1}{1 \times 10^{-6}} = 255000$$

**(3) 判断**（4分）

$$Re > 4000 \Rightarrow \text{湍流}$$

---

## 题23：沿程阻力系数

**【题目】**（18分）

管道，Re=50000，相对粗糙度k_s/d=0.001。求λ（用莫迪图或尼古拉兹公式）。

**【解答】**

**尼古拉兹公式**（湍流粗糙管）（10分）

$$\frac{1}{\sqrt{\lambda}} = 2\log\left(\frac{d}{k_s}\right) + 1.14 = 2\log(1000) + 1.14 = 7.14$$

$$\lambda = 0.0196$$

**或查莫迪图**（8分）

Re=50000，k_s/d=0.001 → λ≈0.020

**Python实现**：

```python
import numpy as np
import matplotlib.pyplot as plt

class PipeFlowResistance:
    """管流阻力计算"""
    
    def __init__(self, nu=1e-6):
        self.nu = nu  # 运动粘度
    
    def reynolds_number(self, v, d):
        """雷诺数 Re = vd/ν"""
        return v * d / self.nu
    
    def friction_factor_laminar(self, Re):
        """层流阻力系数 λ = 64/Re"""
        return 64 / Re
    
    def friction_factor_turbulent_smooth(self, Re):
        """
        湍流光滑管阻力系数（Blasius公式）
        
        λ = 0.3164 / Re^0.25  (Re < 10^5)
        """
        if Re < 1e5:
            return 0.3164 / (Re**0.25)
        else:
            # Prandtl-Karman公式（隐式）
            # 1/√λ = 2log(Re√λ) - 0.8
            # 迭代求解
            lam = 0.02  # 初值
            for _ in range(10):
                lam = 1 / (2*np.log10(Re*np.sqrt(lam)) - 0.8)**2
            return lam
    
    def friction_factor_turbulent_rough(self, ks_d):
        """
        湍流粗糙管阻力系数（Nikuradse公式）
        
        1/√λ = 2log(d/k_s) + 1.14
        
        参数:
            ks_d: 相对粗糙度 k_s/d
        """
        term = 2*np.log10(1/ks_d) + 1.14
        lam = 1 / term**2
        return lam
    
    def colebrook_white(self, Re, ks_d, max_iter=20):
        """
        Colebrook-White公式（过渡区）
        
        1/√λ = -2log(k_s/(3.7d) + 2.51/(Re√λ))
        
        迭代求解
        """
        lam = 0.02  # 初值
        
        for _ in range(max_iter):
            term = ks_d/3.7 + 2.51/(Re*np.sqrt(lam))
            lam_new = 1 / (-2*np.log10(term))**2
            
            if abs(lam_new - lam) < 1e-6:
                break
            
            lam = lam_new
        
        return lam
    
    def head_loss_along_path(self, lam, L, d, v):
        """
        沿程水头损失
        
        h_f = λ(L/d)(v²/2g)
        """
        g = 9.81
        h_f = lam * (L/d) * (v**2 / (2*g))
        return h_f
    
    def head_loss_local(self, zeta, v):
        """
        局部水头损失
        
        h_j = ζ(v²/2g)
        """
        g = 9.81
        h_j = zeta * v**2 / (2*g)
        return h_j
    
    def plot_moody_diagram(self):
        """绘制莫迪图（简化版）"""
        Re_range = np.logspace(3, 8, 100)
        
        fig, ax = plt.subplots(figsize=(12, 8))
        
        # 层流
        Re_lam = np.logspace(2, 3.3, 50)
        lam_lam = 64 / Re_lam
        ax.loglog(Re_lam, lam_lam, 'b-', linewidth=2, label='层流: λ=64/Re')
        
        # 湍流光滑管
        Re_smooth = np.logspace(3.5, 8, 100)
        lam_smooth = 0.3164 / (Re_smooth**0.25)
        lam_smooth[Re_smooth > 1e5] = np.nan  # Blasius公式适用范围
        ax.loglog(Re_smooth, lam_smooth, 'g--', linewidth=2, 
                 label='光滑管 (Blasius)')
        
        # 不同粗糙度曲线
        ks_d_values = [0.0001, 0.0005, 0.001, 0.002, 0.005, 0.01]
        
        for ks_d in ks_d_values:
            lam_vals = []
            for Re in Re_range:
                if Re > 4000:
                    lam = self.colebrook_white(Re, ks_d)
                    lam_vals.append(lam)
                else:
                    lam_vals.append(np.nan)
            
            ax.loglog(Re_range, lam_vals, linewidth=1.5,
                     label=f'k_s/d={ks_d}')
        
        # 过渡区标注
        ax.axvline(2000, color='r', linestyle='--', alpha=0.5,
                  label='Re=2000')
        ax.axvline(4000, color='r', linestyle='--', alpha=0.5,
                  label='Re=4000')
        
        ax.set_xlabel('雷诺数 Re', fontsize=12)
        ax.set_ylabel('沿程阻力系数 λ', fontsize=12)
        ax.set_title('莫迪图（Moody Diagram）', fontsize=14)
        ax.legend(loc='upper right', fontsize=9)
        ax.grid(True, which='both', alpha=0.3)
        ax.set_xlim([1e2, 1e8])
        ax.set_ylim([0.008, 0.1])
        
        plt.tight_layout()
        plt.savefig('moody_diagram.png', dpi=300)
        plt.show()

# 示例1：阻力系数计算
print("="*60)
print("示例1：阻力系数计算")
print("="*60)

pf = PipeFlowResistance()

# 参数
d = 0.1  # m
v = 2.0  # m/s
ks = 0.0001  # m（粗糙度）

Re = pf.reynolds_number(v, d)

print(f"管道参数:")
print(f"  直径 d = {d} m")
print(f"  流速 v = {v} m/s")
print(f"  粗糙度 k_s = {ks} m")
print(f"  雷诺数 Re = {Re:.0f}")

# 判断流态
if Re < 2000:
    flow_type = "层流"
    lam = pf.friction_factor_laminar(Re)
elif Re < 4000:
    flow_type = "过渡流"
    lam = (pf.friction_factor_laminar(2000) + 
           pf.friction_factor_turbulent_smooth(4000)) / 2
else:
    flow_type = "湍流"
    ks_d = ks / d
    lam = pf.colebrook_white(Re, ks_d)

print(f"\n流态: {flow_type}")
print(f"阻力系数 λ = {lam:.4f}")

# 沿程损失
L = 500  # m
h_f = pf.head_loss_along_path(lam, L, d, v)

print(f"\n沿程水头损失:")
print(f"  管长 L = {L} m")
print(f"  h_f = {h_f:.2f} m")

# 示例2：局部损失
print("\n" + "="*60)
print("示例2：局部损失")
print("="*60)

# 常见局部阻力系数
local_losses = {
    '管道进口（锐缘）': 0.5,
    '管道出口': 1.0,
    '90°标准弯头': 0.9,
    '45°弯头': 0.4,
    '突然扩大': 1.0,  # 简化
    '闸阀（全开）': 0.2,
    '球阀（全开）': 0.1
}

print(f"流速 v = {v} m/s")
print(f"\n常见局部损失:")

total_local = 0

for name, zeta in local_losses.items():
    h_j = pf.head_loss_local(zeta, v)
    total_local += h_j
    print(f"  {name:20s}: ζ={zeta:.2f}, h_j={h_j:.3f}m")

print(f"\n总局部损失: {total_local:.3f} m")

# 绘制莫迪图
print("\n绘制莫迪图...")
pf.plot_moody_diagram()
```

---

## 题24：局部损失

**【题目】**（10分）

管道突然扩大，d₁=0.1m，d₂=0.2m，v₁=3m/s。求局部损失。

**【解答】**

**Borda-Carnot公式**（5分）

$$h_j = \frac{(v_1 - v_2)^2}{2g}$$

**连续性**（2分）

$$v_2 = v_1 \frac{d_1^2}{d_2^2} = 3 \times \frac{0.1^2}{0.2^2} = 0.75 \text{ m/s}$$

**计算**（3分）

$$h_j = \frac{(3 - 0.75)^2}{2 \times 9.81} = 0.258 \text{ m}$$

---

## 题25-30：快速题型

### 题25：管道串联

三段串联管，L₁=200m，d₁=0.15m；L₂=150m，d₂=0.12m；L₃=100m，d₃=0.10m。λ=0.02，Q=0.03m³/s。求总损失。

**解**：各段分别计算h_f，求和。

---

### 题26：管道并联

两管并联，L₁=L₂=500m，d₁=0.2m，d₂=0.15m，λ=0.025。求流量分配。

**解**：$h_{f1} = h_{f2}$，$Q = Q_1 + Q_2$

---

### 题27：经济流速

输水管道，经济流速范围0.6-3.0 m/s。为什么？

**解**：
- 过小：管径大，造价高
- 过大：水头损失大，运行费高

---

### 题28：管网计算

简单环状管网，三节点，求各管流量（用节点法）。

---

### 题29：水锤

阀门关闭时间T_c=2s，管长L=1000m，水击波速a=1000m/s。判断水锤类型。

**解**：
$$\frac{2L}{a} = \frac{2000}{1000} = 2 \text{ s} = T_c$$

**临界情况**，接近直接水锤。

---

### 题30：泵与管路配合

离心泵特性：$H = 20 - 0.0001Q^2$

管路特性：$H_{req} = 10 + 0.0002Q^2$

求工作点流量。

**解**：
$$20 - 0.0001Q^2 = 10 + 0.0002Q^2$$

$$Q = 182.6 \text{ m}^3\text{/h}$$

---

**本章总结**：
- 达西公式必须掌握
- 雷诺数判别流态
- 莫迪图查λ
- 局部损失系数记忆

**下一章**：明渠流核心题
