# 第2章：动水力学核心题（11-20题）

**题型**: 伯努利方程与动量方程  
**难度**: ⭐⭐⭐⭐⭐

---

## 题11：伯努利方程应用

**【题目】**（15分）

水平管道，断面1：d₁=0.2m，p₁=150kPa；断面2：d₂=0.1m，p₂=100kPa。不计损失，求流量Q。

**【解答】**

**能量方程**（5分）

$$\frac{p_1}{\gamma} + \frac{v_1^2}{2g} = \frac{p_2}{\gamma} + \frac{v_2^2}{2g}$$

**连续性方程**（3分）

$$Q = A_1 v_1 = A_2 v_2$$

$$v_2 = v_1 \frac{A_1}{A_2} = v_1 \frac{d_1^2}{d_2^2} = v_1 \frac{0.2^2}{0.1^2} = 4v_1$$

**代入求解**（5分）

$$\frac{150000}{9810} + \frac{v_1^2}{2 \times 9.81} = \frac{100000}{9810} + \frac{(4v_1)^2}{2 \times 9.81}$$

$$15.29 + 0.051v_1^2 = 10.19 + 0.815v_1^2$$

$$5.10 = 0.764v_1^2$$

$$v_1 = 2.58 \text{ m/s}$$

**流量**（2分）

$$Q = A_1 v_1 = \frac{\pi \times 0.2^2}{4} \times 2.58 = 0.081 \text{ m}^3\text{/s} = 81 \text{ L/s}$$

**Python实现**：

```python
import numpy as np
import matplotlib.pyplot as plt

class BernoulliSolver:
    """伯努利方程求解器"""
    
    def __init__(self, gamma=9810, g=9.81):
        self.gamma = gamma
        self.g = g
    
    def pipe_flow_no_loss(self, d1, p1, d2, p2, z1=0, z2=0):
        """
        水平变径管流量计算（无损失）
        
        参数:
            d1, d2: 直径 (m)
            p1, p2: 压强 (Pa)
            z1, z2: 高程 (m)
        
        返回:
            Q: 流量 (m³/s)
            v1, v2: 流速 (m/s)
        """
        # 面积
        A1 = np.pi * d1**2 / 4
        A2 = np.pi * d2**2 / 4
        
        # 面积比
        ratio = (A1 / A2)**2
        
        # 伯努利+连续性
        # (p1/γ + v1²/2g + z1) = (p2/γ + v2²/2g + z2)
        # v2 = v1 * A1/A2
        # 代入得: v1² = 2g[(p1-p2)/γ + (z1-z2)] / (ratio - 1)
        
        delta_h = (p1 - p2) / self.gamma + (z1 - z2)
        
        v1_squared = 2 * self.g * delta_h / (ratio - 1)
        
        if v1_squared < 0:
            raise ValueError("负压差或配置不合理")
        
        v1 = np.sqrt(v1_squared)
        v2 = v1 * A1 / A2
        Q = A1 * v1
        
        return Q, v1, v2
    
    def pipe_flow_with_loss(self, d1, p1, d2, p2, h_loss, z1=0, z2=0):
        """
        考虑水头损失的管流
        
        h_loss: 水头损失 (m)
        """
        A1 = np.pi * d1**2 / 4
        A2 = np.pi * d2**2 / 4
        ratio = (A1 / A2)**2
        
        delta_h = (p1 - p2) / self.gamma + (z1 - z2) - h_loss
        
        v1_squared = 2 * self.g * delta_h / (ratio - 1)
        
        if v1_squared < 0:
            return None, None, None
        
        v1 = np.sqrt(v1_squared)
        v2 = v1 * A1 / A2
        Q = A1 * v1
        
        return Q, v1, v2
    
    def venturi_meter(self, d1, d2, delta_h_manometer, gamma_man=133400):
        """
        文丘里流量计
        
        参数:
            delta_h_manometer: U型管压差计读数 (m)
            gamma_man: 测压液容重 (N/m³)
        
        返回:
            流量 Q (m³/s)
        """
        # 压差
        delta_p = (gamma_man - self.gamma) * delta_h_manometer
        
        # 流量公式
        A1 = np.pi * d1**2 / 4
        A2 = np.pi * d2**2 / 4
        
        Q_theory = A2 * np.sqrt(2 * self.g * delta_p / self.gamma / 
                                (1 - (A2/A1)**2))
        
        # 考虑流量系数（一般0.95-0.99）
        C = 0.98
        Q = C * Q_theory
        
        return Q
    
    def plot_energy_line(self, stations, elevations, pressures, velocities):
        """绘制能量线与水力坡度线"""
        # 计算水头
        z = np.array(elevations)
        p_head = np.array(pressures) / self.gamma
        v_head = np.array(velocities)**2 / (2 * self.g)
        
        # 测压管水头
        H_p = z + p_head
        
        # 总水头
        H_total = H_p + v_head
        
        fig, ax = plt.subplots(figsize=(12, 6))
        
        # 管道轴线
        ax.plot(stations, z, 'k-', linewidth=3, label='管道轴线')
        ax.fill_between(stations, z, -5, alpha=0.2, color='gray')
        
        # 测压管水头线
        ax.plot(stations, H_p, 'b--', linewidth=2, 
               marker='o', markersize=6, label='测压管水头线')
        
        # 总能量线
        ax.plot(stations, H_total, 'r-', linewidth=2,
               marker='s', markersize=6, label='总能量线')
        
        ax.set_xlabel('距离 (m)', fontsize=12)
        ax.set_ylabel('高程/水头 (m)', fontsize=12)
        ax.set_title('能量线与水力坡度线', fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('energy_line.png', dpi=300)
        plt.show()

# 示例
print("="*60)
print("题11：变径管流量计算")
print("="*60)

solver = BernoulliSolver()

d1 = 0.2  # m
p1 = 150000  # Pa
d2 = 0.1  # m
p2 = 100000  # Pa

Q, v1, v2 = solver.pipe_flow_no_loss(d1, p1, d2, p2)

print(f"给定:")
print(f"  d₁ = {d1} m, p₁ = {p1/1000} kPa")
print(f"  d₂ = {d2} m, p₂ = {p2/1000} kPa")

print(f"\n结果:")
print(f"  流速 v₁ = {v1:.2f} m/s")
print(f"  流速 v₂ = {v2:.2f} m/s")
print(f"  流量 Q = {Q:.4f} m³/s = {Q*1000:.1f} L/s")

# 验证能量守恒
E1 = p1/solver.gamma + v1**2/(2*solver.g)
E2 = p2/solver.gamma + v2**2/(2*solver.g)
print(f"\n能量验证:")
print(f"  E₁ = {E1:.2f} m")
print(f"  E₂ = {E2:.2f} m")
print(f"  差值 = {abs(E1-E2):.4f} m (应≈0)")
```

---

## 题12：孔口出流

**【题目】**（12分）

水箱侧壁孔口，直径d=0.05m，中心距水面H=2m，求流量Q（收缩系数φ=0.62）。

**【解答】**

**孔口出流速度**（5分）

$$v = \varphi \sqrt{2gH} = 0.62 \times \sqrt{2 \times 9.81 \times 2} = 3.88 \text{ m/s}$$

**流量**（5分）

$$Q = A \cdot v = \frac{\pi \times 0.05^2}{4} \times 3.88 = 0.00763 \text{ m}^3\text{/s} = 7.63 \text{ L/s}$$

**评分点**（2分）
- 公式正确
- 收缩系数应用
- 单位换算

---

## 题13：动量方程应用

**【题目】**（18分）

水平90°弯管，d=0.3m，Q=0.2m³/s，进口压强p₁=200kPa，出口p₂=150kPa。求水流对弯管的作用力。

**【解答】**

**流速**（3分）

$$v = \frac{Q}{A} = \frac{0.2}{\pi \times 0.3^2 / 4} = 2.83 \text{ m/s}$$

**动量方程**（x方向）（5分）

$$F_x + p_1 A = \rho Q v$$

$$F_x = \rho Q v - p_1 A = 1000 \times 0.2 \times 2.83 - 200000 \times 0.0707$$

$$F_x = 566 - 14140 = -13574 \text{ N}$$

**动量方程**（y方向）（5分）

$$F_y - p_2 A = -\rho Q v$$

$$F_y = p_2 A - \rho Q v = 150000 \times 0.0707 - 566 = 10038 \text{ N}$$

**合力**（5分）

$$F = \sqrt{F_x^2 + F_y^2} = \sqrt{13574^2 + 10038^2} = 16881 \text{ N} = 16.9 \text{ kN}$$

方向：与x轴夹角
$$\theta = \arctan\frac{F_y}{|F_x|} = \arctan\frac{10038}{13574} = 36.5°$$

---

## 题14-20：快速题型

### 题14：水泵扬程

水泵，Q=0.05m³/s，吸水高度3m，压水高度20m，管道损失5m，求扬程H。

**解**：$H = 20 + 3 + 5 = 28$ m

---

### 题15：能量方程修正

实际流动，动能修正系数α，动量修正系数β。

层流：α=2.0，β=1.33  
湍流：α≈1.05，β≈1.03

---

### 题16：突然扩大损失

$$h_j = \frac{(v_1 - v_2)^2}{2g}$$

---

### 题17：串联管路

总损失：$h_f = h_{f1} + h_{f2} + h_{f3}$

流量相同：$Q_1 = Q_2 = Q_3$

---

### 题18：并联管路

水头损失相同：$h_{f1} = h_{f2}$

流量分配：$Q = Q_1 + Q_2$

$$\frac{Q_1}{Q_2} = \sqrt{\frac{\lambda_2 L_2 / d_2^5}{\lambda_1 L_1 / d_1^5}}$$

---

### 题19：短管出流

$$Q = \mu A \sqrt{2gH}$$

综合流量系数：$\mu = 0.5 \sim 0.6$

---

### 题20：雷诺数判别

$$Re = \frac{vd}{\nu}$$

- Re < 2000：层流
- 2000 < Re < 4000：过渡
- Re > 4000：湍流

---

## Python综合工具

```python
class MomentumEquation:
    """动量方程求解"""
    
    @staticmethod
    def pipe_bend_force(d, Q, p1, p2, angle_deg=90, rho=1000):
        """
        弯管受力
        
        参数:
            angle_deg: 转角（度）
        """
        import numpy as np
        
        A = np.pi * d**2 / 4
        v = Q / A
        
        angle = np.radians(angle_deg)
        
        # x方向动量方程
        F_x = rho * Q * v * (1 - np.cos(angle)) - p1 * A + p2 * A * np.cos(angle)
        
        # y方向动量方程
        F_y = -rho * Q * v * np.sin(angle) + p2 * A * np.sin(angle)
        
        # 合力
        F_total = np.sqrt(F_x**2 + F_y**2)
        
        return F_x, F_y, F_total

# 应用
F_x, F_y, F = MomentumEquation.pipe_bend_force(
    d=0.3, Q=0.2, p1=200000, p2=150000, angle_deg=90
)

print(f"弯管受力:")
print(f"  F_x = {F_x/1000:.1f} kN")
print(f"  F_y = {F_y/1000:.1f} kN")
print(f"  F = {F/1000:.1f} kN")
```

---

**本章总结**：
- 伯努利方程三项
- 连续性方程联立
- 动量方程矢量性
- 能量线与水力坡度线

**下一章**：管流核心题
