# 第4章：明渠流核心题（31-40题）

**题型**: 临界水深、比能、水跃  
**难度**: ⭐⭐⭐⭐⭐

---

## 题31：临界水深计算

**【题目】**（15分）

矩形明渠，b=4m，Q=20m³/s。求临界水深$h_c$、临界流速$v_c$、最小比能$E_{min}$

**【解答】**

**(1) 临界水深**（6分）

$$h_c = \sqrt[3]{\frac{Q^2}{gb^2}} = \sqrt[3]{\frac{20^2}{9.81 \times 4^2}} = \sqrt[3]{2.55} = 1.37 \text{ m}$$

**(2) 临界流速**（4分）

$$v_c = \frac{Q}{bh_c} = \frac{20}{4 \times 1.37} = 3.65 \text{ m/s}$$

或：$v_c = \sqrt{gh_c} = \sqrt{9.81 \times 1.37} = 3.67$ m/s

**(3) 最小比能**（5分）

$$E_{min} = E_c = \frac{3}{2}h_c = 1.5 \times 1.37 = 2.06 \text{ m}$$

---

## 题32：比能曲线与流态

**【题目】**（18分）

矩形断面，b=3m，q=5m²/s（单宽流量）。

(1) 求临界水深  
(2) 当h=2m时，判断流态  
(3) 当h=0.8m时，判断流态

**【解答】**

**(1) 临界水深**（6分）

单宽流量：$q = Q/b = 5$ m²/s

$$h_c = \sqrt[3]{\frac{q^2}{g}} = \sqrt[3]{\frac{25}{9.81}} = 1.37 \text{ m}$$

**(2) h=2m**（6分）

$$h = 2 > h_c = 1.37 \Rightarrow \text{缓流}$$

$$Fr = \frac{v}{\sqrt{gh}} = \frac{q/h}{\sqrt{gh}} = \frac{5/2}{\sqrt{9.81 \times 2}} = 0.56 < 1$$

**(3) h=0.8m**（6分）

$$h = 0.8 < h_c = 1.37 \Rightarrow \text{急流}$$

$$Fr = \frac{5/0.8}{\sqrt{9.81 \times 0.8}} = 2.23 > 1$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class OpenChannelCritical:
    """明渠临界水深与比能"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def critical_depth_rectangular(self, Q, b):
        """
        矩形断面临界水深
        
        h_c = ³√(Q²/gb²)
        
        参数:
            Q: 流量 (m³/s)
            b: 宽度 (m)
        """
        h_c = (Q**2 / (self.g * b**2))**(1/3)
        
        return h_c
    
    def critical_depth_unit_discharge(self, q):
        """
        单宽流量临界水深
        
        h_c = ³√(q²/g)
        
        参数:
            q: 单宽流量 (m²/s)
        """
        h_c = (q**2 / self.g)**(1/3)
        
        return h_c
    
    def specific_energy(self, q, h):
        """
        比能
        
        E = h + q²/(2gh²)
        
        参数:
            q: 单宽流量 (m²/s)
            h: 水深 (m)
        """
        v = q / h
        E = h + v**2 / (2 * self.g)
        
        return E
    
    def froude_number(self, q, h):
        """弗劳德数 Fr = v/√(gh)"""
        v = q / h
        Fr = v / np.sqrt(self.g * h)
        
        return Fr
    
    def conjugate_depth(self, h1, q):
        """
        共轭水深（水跃）
        
        h₂ = (h₁/2)(√(1+8Fr₁²) - 1)
        
        参数:
            h1: 跃前水深 (m)
            q: 单宽流量 (m²/s)
        """
        Fr1 = self.froude_number(q, h1)
        
        h2 = h1 / 2 * (np.sqrt(1 + 8*Fr1**2) - 1)
        
        return h2
    
    def alternate_depths(self, E, q):
        """
        共轭水深（相同比能）
        
        给定比能E和流量q，求两个可能的水深h1（急流）、h2（缓流）
        
        方程: h + q²/(2gh²) = E
        即: h³ - E·h² + q²/(2g) = 0
        
        参数:
            E: 比能 (m)
            q: 单宽流量 (m²/s)
        
        返回:
            h_super: 急流水深 (m)
            h_sub: 缓流水深 (m)
        """
        # 系数
        a = 1
        b = -E
        c = 0
        d = q**2 / (2 * self.g)
        
        # 三次方程求根（简化：数值迭代）
        # h³ - E·h² + q²/(2g) = 0
        
        # 临界水深
        h_c = self.critical_depth_unit_discharge(q)
        
        # 急流水深（h < h_c）
        h_super = None
        for h_trial in np.linspace(0.01, h_c, 100):
            E_trial = self.specific_energy(q, h_trial)
            if abs(E_trial - E) < 0.01:
                h_super = h_trial
                break
        
        # 缓流水深（h > h_c）
        h_sub = None
        for h_trial in np.linspace(h_c, E, 100):
            E_trial = self.specific_energy(q, h_trial)
            if abs(E_trial - E) < 0.01:
                h_sub = h_trial
                break
        
        return h_super, h_sub
    
    def plot_specific_energy_curve(self, q):
        """绘制比能曲线"""
        # 临界水深
        h_c = self.critical_depth_unit_discharge(q)
        E_c = 1.5 * h_c
        
        # 水深范围
        h_range = np.linspace(0.1, 5*h_c, 500)
        
        # 比能
        E_values = []
        for h in h_range:
            E = self.specific_energy(q, h)
            E_values.append(E)
        
        E_values = np.array(E_values)
        
        fig, ax = plt.subplots(figsize=(10, 8))
        
        # 比能曲线
        ax.plot(E_values, h_range, 'b-', linewidth=2.5, label='比能曲线')
        
        # 临界点
        ax.plot(E_c, h_c, 'ro', markersize=12, label=f'临界点 (E_c={E_c:.2f}m, h_c={h_c:.2f}m)')
        
        # 临界线
        ax.axhline(h_c, color='r', linestyle='--', linewidth=1.5,
                  alpha=0.5, label=f'临界水深 h_c={h_c:.2f}m')
        ax.axvline(E_c, color='r', linestyle='--', linewidth=1.5,
                  alpha=0.5)
        
        # 区域标注
        ax.text(E_c + 0.5, h_c/2, '急流区\nFr>1', fontsize=12,
               ha='left', va='center',
               bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.3))
        
        ax.text(E_c + 0.5, h_c*2, '缓流区\nFr<1', fontsize=12,
               ha='left', va='center',
               bbox=dict(boxstyle='round', facecolor='cyan', alpha=0.3))
        
        # 共轭水深示例
        E_example = E_c + 1.0
        h_super, h_sub = self.alternate_depths(E_example, q)
        
        if h_super and h_sub:
            ax.plot([E_example, E_example], [h_super, h_sub], 'g--',
                   linewidth=2, marker='o', markersize=8,
                   label='共轭水深（相同比能）')
            ax.text(E_example + 0.1, (h_super + h_sub)/2, 
                   f'E={E_example:.2f}m\nh₁={h_super:.2f}m\nh₂={h_sub:.2f}m',
                   fontsize=10, va='center')
        
        ax.set_xlabel('比能 E (m)', fontsize=12)
        ax.set_ylabel('水深 h (m)', fontsize=12)
        ax.set_title(f'比能曲线 (q={q}m²/s)', fontsize=14)
        ax.legend(loc='upper left')
        ax.grid(True, alpha=0.3)
        ax.set_xlim([0, E_c + 2])
        ax.set_ylim([0, 5*h_c])
        
        plt.tight_layout()
        plt.savefig('specific_energy_curve.png', dpi=300)
        plt.show()
    
    def plot_jump_conjugate_curve(self, q):
        """绘制水跃共轭水深曲线"""
        h1_range = np.linspace(0.1, 3, 100)
        h2_values = []
        
        for h1 in h1_range:
            h2 = self.conjugate_depth(h1, q)
            h2_values.append(h2)
        
        h2_values = np.array(h2_values)
        
        fig, ax = plt.subplots(figsize=(10, 8))
        
        # 共轭水深曲线
        ax.plot(h1_range, h2_values, 'b-', linewidth=2.5,
               label='共轭水深 h₂(h₁)')
        
        # 45°线
        ax.plot([0, 3], [0, 3], 'k--', alpha=0.5, label='h₂=h₁')
        
        # 临界水深
        h_c = self.critical_depth_unit_discharge(q)
        ax.axvline(h_c, color='r', linestyle='--', linewidth=1.5,
                  label=f'临界水深 h_c={h_c:.2f}m')
        ax.axhline(h_c, color='r', linestyle='--', linewidth=1.5)
        
        # 标注区域
        ax.fill_between(h1_range[h1_range < h_c], 0, 3,
                       alpha=0.1, color='yellow', label='h₁<h_c 急流')
        ax.fill_between(h1_range[h1_range > h_c], 0, 3,
                       alpha=0.1, color='cyan', label='h₁>h_c 缓流')
        
        ax.set_xlabel('跃前水深 h₁ (m)', fontsize=12)
        ax.set_ylabel('跃后水深 h₂ (m)', fontsize=12)
        ax.set_title(f'水跃共轭水深曲线 (q={q}m²/s)', fontsize=14)
        ax.legend(loc='upper left')
        ax.grid(True, alpha=0.3)
        ax.set_xlim([0, 3])
        ax.set_ylim([0, max(h2_values)])
        
        plt.tight_layout()
        plt.savefig('jump_conjugate_curve.png', dpi=300)
        plt.show()

# 示例1：临界水深计算
print("="*60)
print("示例1：临界水深与比能")
print("="*60)

occ = OpenChannelCritical()

b = 4
Q = 20
q = Q / b

print(f"参数:")
print(f"  宽度 b = {b} m")
print(f"  流量 Q = {Q} m³/s")
print(f"  单宽流量 q = {q} m²/s")

h_c = occ.critical_depth_rectangular(Q, b)
v_c = Q / (b * h_c)
E_c = 1.5 * h_c

print(f"\n临界状态:")
print(f"  临界水深 h_c = {h_c:.3f} m")
print(f"  临界流速 v_c = {v_c:.3f} m/s")
print(f"  最小比能 E_c = {E_c:.3f} m")

# 验证
print(f"\n验证:")
print(f"  v_c / √(gh_c) = {v_c / np.sqrt(9.81*h_c):.3f} ≈ 1")
print(f"  E_c / h_c = {E_c / h_c:.3f} ≈ 1.5")

# 示例2：流态判断
print("\n" + "="*60)
print("示例2：流态判断")
print("="*60)

depths = [0.8, 1.37, 2.0, 3.0]

print(f"单宽流量 q = {q} m²/s")
print(f"临界水深 h_c = {h_c:.3f} m")

print(f"\n{'水深h(m)':>10s} {'比能E(m)':>10s} {'Fr':>8s} {'流态':>8s}")
print("-" * 45)

for h in depths:
    E = occ.specific_energy(q, h)
    Fr = occ.froude_number(q, h)
    
    if Fr < 0.95:
        flow_type = '缓流'
    elif Fr > 1.05:
        flow_type = '急流'
    else:
        flow_type = '临界'
    
    print(f"{h:10.2f} {E:10.3f} {Fr:8.3f} {flow_type:>8s}")

# 示例3：共轭水深
print("\n" + "="*60)
print("示例3：共轭水深（相同比能）")
print("="*60)

E_given = 2.5  # m

h_super, h_sub = occ.alternate_depths(E_given, q)

if h_super and h_sub:
    print(f"给定比能 E = {E_given} m")
    print(f"\n共轭水深:")
    print(f"  急流水深 h₁ = {h_super:.3f} m")
    print(f"  缓流水深 h₂ = {h_sub:.3f} m")
    
    # 验证
    E1 = occ.specific_energy(q, h_super)
    E2 = occ.specific_energy(q, h_sub)
    
    print(f"\n验证:")
    print(f"  E(h₁) = {E1:.3f} m")
    print(f"  E(h₂) = {E2:.3f} m")
    print(f"  误差 = {abs(E1-E2):.4f} m")

# 示例4：水跃共轭水深
print("\n" + "="*60)
print("示例4：水跃共轭水深")
print("="*60)

h1_jump = 0.6  # m

h2_jump = occ.conjugate_depth(h1_jump, q)
Fr1 = occ.froude_number(q, h1_jump)

print(f"跃前参数:")
print(f"  跃前水深 h₁ = {h1_jump} m")
print(f"  弗劳德数 Fr₁ = {Fr1:.2f}")

print(f"\n跃后参数:")
print(f"  跃后水深 h₂ = {h2_jump:.3f} m")
print(f"  水深比 h₂/h₁ = {h2_jump/h1_jump:.2f}")

# 绘制比能曲线
print("\n绘制比能曲线...")
occ.plot_specific_energy_curve(q)

# 绘制水跃共轭水深曲线
print("绘制水跃共轭水深曲线...")
occ.plot_jump_conjugate_curve(q)
```

---

## 题33-40：快速题型

### 题33：梯形断面临界水深

给定梯形断面参数，求临界水深（需迭代求解）

---

### 题34：水跃长度

已知Fr₁=3.5，h₁=0.8m，求水跃长度

**解**：$L_j = 5(h_2 - h_1) = 5 \times (2.2 - 0.8) = 7$ m

---

### 题35：堰流

矩形堰，b=2m，堰上水头H=0.3m，求流量

**解**：$Q = mb\sqrt{2g}H^{3/2} = 0.4 \times 2 \times 4.43 \times 0.164 = 0.58$ m³/s

---

### 题36：孔口出流vs堰流

对比二者流量公式，说明适用条件

---

### 题37：渐变流能量方程

$$\frac{p_1}{\gamma} + z_1 + \alpha_1\frac{v_1^2}{2g} = \frac{p_2}{\gamma} + z_2 + \alpha_2\frac{v_2^2}{2g} + h_w$$

---

### 题38：明渠均匀流Manning公式

$$v = \frac{1}{n}R^{2/3}i^{1/2}$$

已知参数，求流量

---

### 题39：临界底坡

使水流恰好达到临界状态的底坡$i_c$

---

### 题40：水面线分析

判断12种水面线类型（M1, M2, M3, S1, S2, S3等）

---

**本章总结**：
- 临界水深公式（矩形、梯形）
- 比能曲线与共轭水深
- 水跃计算
- 堰流与孔口出流

**下一章**：有压管流综合题
