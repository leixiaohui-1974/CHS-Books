# 第3章：水资源承载力评价

**战略意义**: 区域可持续发展  
**评价难度**: ⭐⭐⭐⭐⭐

---

## 一、基本概念

### 1.1 定义

**水资源承载力（Water Resources Carrying Capacity, WRCC）**：
在一定时期、一定技术经济条件下，水资源对区域社会经济发展的最大支撑能力。

**三要素**：
1. **水资源量**：可利用水资源总量
2. **用水需求**：人口、经济规模
3. **生态需水**：维持生态平衡的最小需水

### 1.2 承载要素

**承载主体**：水资源  
**承载对象**：人口、经济、生态

**承载状态**：
- **超载**：需水 > 可供水
- **临界**：需水 ≈ 可供水
- **未超载**：需水 < 可供水

### 1.3 评价指标

| 指标 | 公式 | 阈值 |
|------|------|------|
| 水资源开发利用率 | $\eta = W_{用}/W_{总}$ | <40%（未超载）|
| 人均水资源量 | $W_{人均} = W_{总}/P$ | >1700 m³（充足）|
| 缺水率 | $r = (W_{需}-W_{供})/W_{需}$ | <10%（轻微）|
| 生态用水率 | $\alpha_{生态} = W_{生态}/W_{总}$ | >30% |

---

## 二、评价方法

### 2.1 供需平衡法

**水量平衡方程**：
$$W_{可供} = W_{地表} + W_{地下} - W_{重复} - W_{生态}$$

**需水预测**：
$$W_{需} = W_{生活} + W_{工业} + W_{农业} + W_{生态}$$

**承载力**：
$$P_{max} = \frac{W_{可供}}{q_{综合}}$$

$q_{综合}$：人均综合用水定额

### 2.2 主成分分析法

**步骤**：
1. 构建指标体系（n个指标）
2. 数据标准化
3. 计算相关系数矩阵
4. 提取主成分
5. 计算综合得分

**综合评价**：
$$F = \sum_{i=1}^{m} \lambda_i F_i / \sum_{i=1}^{m} \lambda_i$$

$\lambda_i$：第i个主成分的特征值  
$F_i$：第i个主成分得分

### 2.3 系统动力学（SD）模型

**核心方程**：
$$\frac{dS}{dt} = R(t) - W(t)$$

$S$：水资源储量  
$R$：补给量  
$W$：用水量

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import linprog

class WRCCEvaluation:
    """水资源承载力评价"""
    
    def __init__(self, total_water, eco_water):
        """
        参数:
            total_water: 水资源总量 (亿m³)
            eco_water: 生态需水 (亿m³)
        """
        self.total_water = total_water
        self.eco_water = eco_water
        self.available_water = total_water - eco_water
    
    def supply_demand_balance(self, pop, q_domestic, q_industrial, 
                              q_agricultural):
        """
        供需平衡法
        
        参数:
            pop: 人口 (万人)
            q_domestic: 生活用水定额 (L/人·天)
            q_industrial: 工业用水定额 (m³/万元GDP)
            q_agricultural: 农业用水定额 (m³/亩)
        
        返回:
            供需平衡结果
        """
        # 需水量计算
        W_domestic = pop * q_domestic * 365 / 1e8  # 亿m³
        
        # 工业、农业需水（简化，这里给定）
        W_industrial = 2.0  # 亿m³
        W_agricultural = 5.0  # 亿m³
        
        W_demand = W_domestic + W_industrial + W_agricultural
        
        # 可供水量
        W_supply = self.available_water
        
        # 缺水量
        W_deficit = max(0, W_demand - W_supply)
        
        # 缺水率
        deficit_rate = W_deficit / W_demand if W_demand > 0 else 0
        
        # 开发利用率
        utilization_rate = W_demand / self.total_water
        
        results = {
            'W_demand': W_demand,
            'W_supply': W_supply,
            'W_deficit': W_deficit,
            'deficit_rate': deficit_rate * 100,
            'utilization_rate': utilization_rate * 100,
            'per_capita': self.total_water / pop * 1e4  # m³/人
        }
        
        return results
    
    def carrying_capacity_population(self, q_comprehensive=500):
        """
        承载人口
        
        W_{可供} = P × q_{综合}
        
        参数:
            q_comprehensive: 综合用水定额 (m³/人·年)
        
        返回:
            最大承载人口 (万人)
        """
        P_max = self.available_water * 1e8 / q_comprehensive / 1e4
        
        return P_max
    
    def comprehensive_evaluation(self, indicators):
        """
        综合评价法（多指标）
        
        参数:
            indicators: dict，包含各项指标值
        
        返回:
            score: 综合得分 (0-100)
            status: 承载状态
        """
        # 指标权重（专家打分法确定）
        weights = {
            'utilization_rate': 0.25,  # 开发利用率
            'per_capita': 0.20,        # 人均水资源
            'deficit_rate': 0.25,      # 缺水率
            'eco_rate': 0.15,          # 生态用水率
            'water_quality': 0.15      # 水质达标率
        }
        
        # 归一化与评分（0-100分制）
        scores = {}
        
        # 开发利用率（<40%为优）
        util = indicators.get('utilization_rate', 50)
        scores['utilization_rate'] = max(0, 100 - util * 2)
        
        # 人均水资源（>1700为优）
        per_cap = indicators.get('per_capita', 1000)
        scores['per_capita'] = min(100, per_cap / 1700 * 100)
        
        # 缺水率（<10%为优）
        deficit = indicators.get('deficit_rate', 20)
        scores['deficit_rate'] = max(0, 100 - deficit * 10)
        
        # 生态用水率（>30%为优）
        eco = indicators.get('eco_rate', 20)
        scores['eco_rate'] = min(100, eco / 30 * 100)
        
        # 水质达标率（>90%为优）
        quality = indicators.get('water_quality', 80)
        scores['water_quality'] = quality
        
        # 综合得分
        score = sum(weights[k] * scores[k] for k in scores)
        
        # 评价等级
        if score >= 80:
            status = '未超载（优）'
        elif score >= 60:
            status = '临界（良）'
        elif score >= 40:
            status = '轻度超载（中）'
        else:
            status = '重度超载（差）'
        
        return score, status, scores
    
    def optimization_allocation(self, sectors, demands, priorities):
        """
        优化配置
        
        最大化满足率：max Σ p_i·x_i
        
        约束：Σ x_i ≤ W_{可供}, 0 ≤ x_i ≤ W_i
        
        参数:
            sectors: 用水部门列表
            demands: 各部门需水量 (亿m³)
            priorities: 优先级权重
        
        返回:
            allocation: 配置方案
        """
        n = len(sectors)
        
        # 目标函数（最大化，转为最小化负值）
        c = -np.array(priorities)
        
        # 约束条件
        A_ub = np.array([np.ones(n)])  # Σx_i ≤ W_{可供}
        b_ub = np.array([self.available_water])
        
        # 边界
        bounds = [(0, d) for d in demands]
        
        # 求解
        result = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds,
                        method='highs')
        
        if result.success:
            allocation = dict(zip(sectors, result.x))
            satisfaction = {s: allocation[s]/demands[i]*100 
                          for i, s in enumerate(sectors)}
        else:
            allocation = None
            satisfaction = None
        
        return allocation, satisfaction
    
    def plot_wrcc_indicators(self, years, data):
        """绘制承载力指标变化趋势"""
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # (a) 开发利用率
        axes[0, 0].plot(years, data['utilization_rate'], 'b-o',
                       linewidth=2, markersize=6)
        axes[0, 0].axhline(40, color='r', linestyle='--',
                          label='警戒线40%')
        axes[0, 0].set_xlabel('年份', fontsize=12)
        axes[0, 0].set_ylabel('开发利用率 (%)', fontsize=12)
        axes[0, 0].set_title('水资源开发利用率', fontsize=13)
        axes[0, 0].legend()
        axes[0, 0].grid(True, alpha=0.3)
        
        # (b) 人均水资源
        axes[0, 1].plot(years, data['per_capita'], 'g-s',
                       linewidth=2, markersize=6)
        axes[0, 1].axhline(1700, color='orange', linestyle='--',
                          label='充足线1700m³')
        axes[0, 1].axhline(1000, color='r', linestyle='--',
                          label='缺水线1000m³')
        axes[0, 1].set_xlabel('年份', fontsize=12)
        axes[0, 1].set_ylabel('人均水资源量 (m³/人·年)', fontsize=12)
        axes[0, 1].set_title('人均水资源量', fontsize=13)
        axes[0, 1].legend()
        axes[0, 1].grid(True, alpha=0.3)
        
        # (c) 缺水率
        axes[1, 0].plot(years, data['deficit_rate'], 'r-^',
                       linewidth=2, markersize=6)
        axes[1, 0].axhline(10, color='orange', linestyle='--',
                          label='轻微缺水10%')
        axes[1, 0].set_xlabel('年份', fontsize=12)
        axes[1, 0].set_ylabel('缺水率 (%)', fontsize=12)
        axes[1, 0].set_title('区域缺水率', fontsize=13)
        axes[1, 0].legend()
        axes[1, 0].grid(True, alpha=0.3)
        
        # (d) 生态用水率
        axes[1, 1].plot(years, data['eco_rate'], 'c-d',
                       linewidth=2, markersize=6)
        axes[1, 1].axhline(30, color='g', linestyle='--',
                          label='生态底线30%')
        axes[1, 1].set_xlabel('年份', fontsize=12)
        axes[1, 1].set_ylabel('生态用水率 (%)', fontsize=12)
        axes[1, 1].set_title('生态用水保障率', fontsize=13)
        axes[1, 1].legend()
        axes[1, 1].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('wrcc_indicators_trend.png', dpi=300)
        plt.show()

# 示例1：某市水资源承载力评价
print("="*60)
print("示例1：某市水资源承载力评价")
print("="*60)

# 基础数据
total_water = 10.0  # 亿m³
eco_water = 3.0     # 亿m³
pop = 150           # 万人

wrcc = WRCCEvaluation(total_water, eco_water)

print(f"基础数据:")
print(f"  水资源总量: {total_water} 亿m³")
print(f("  生态需水: {eco_water} 亿m³")
print(f"  可利用水量: {wrcc.available_water} 亿m³")
print(f"  现状人口: {pop} 万人")

# 供需平衡分析
results = wrcc.supply_demand_balance(
    pop=pop,
    q_domestic=150,  # L/人·天
    q_industrial=0,
    q_agricultural=0
)

print(f"\n供需平衡分析:")
print(f"  需水量: {results['W_demand']:.2f} 亿m³")
print(f"  可供水量: {results['W_supply']:.2f} 亿m³")
print(f"  缺水量: {results['W_deficit']:.2f} 亿m³")
print(f"  缺水率: {results['deficit_rate']:.1f}%")
print(f"  开发利用率: {results['utilization_rate']:.1f}%")
print(f"  人均水资源: {results['per_capita']:.0f} m³/人·年")

# 承载人口
P_max = wrcc.carrying_capacity_population(q_comprehensive=500)

print(f"\n承载力分析:")
print(f"  最大承载人口: {P_max:.1f} 万人")
print(f"  现状人口: {pop} 万人")
print(f"  剩余承载空间: {P_max - pop:.1f} 万人")

# 综合评价
indicators = {
    'utilization_rate': results['utilization_rate'],
    'per_capita': results['per_capita'],
    'deficit_rate': results['deficit_rate'],
    'eco_rate': eco_water / total_water * 100,
    'water_quality': 85
}

score, status, detailed_scores = wrcc.comprehensive_evaluation(indicators)

print(f"\n综合评价:")
print(f"  综合得分: {score:.1f}分")
print(f"  承载状态: {status}")
print(f"  分项得分:")
for key, val in detailed_scores.items():
    print(f"    {key}: {val:.1f}分")

# 示例2：水资源优化配置
print("\n" + "="*60)
print("示例2：水资源优化配置")
print("="*60)

sectors = ['生活', '工业', '农业', '生态']
demands = [1.5, 3.0, 4.5, 3.0]  # 亿m³
priorities = [1.0, 0.8, 0.6, 0.9]  # 优先级权重

print(f"各部门需水与优先级:")
for i, sector in enumerate(sectors):
    print(f"  {sector}: 需水{demands[i]}亿m³, 优先级{priorities[i]}")

allocation, satisfaction = wrcc.optimization_allocation(
    sectors, demands, priorities)

print(f"\n优化配置方案:")
print(f"  可供水量: {wrcc.available_water} 亿m³")

if allocation:
    total_alloc = sum(allocation.values())
    print(f"  配置总量: {total_alloc:.2f} 亿m³")
    
    for sector in sectors:
        print(f"  {sector}: 配置{allocation[sector]:.2f}亿m³, "
              f"满足率{satisfaction[sector]:.1f}%")

# 示例3：承载力指标趋势分析
print("\n" + "="*60)
print("示例3：承载力指标历史趋势")
print("="*60)

years = np.arange(2010, 2021)
data = {
    'utilization_rate': [25, 27, 30, 33, 36, 38, 41, 43, 45, 47, 50],
    'per_capita': [2200, 2100, 2000, 1900, 1800, 1750, 1700, 1650, 1600, 1550, 1500],
    'deficit_rate': [2, 3, 5, 7, 9, 11, 13, 15, 17, 19, 22],
    'eco_rate': [35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25]
}

wrcc.plot_wrcc_indicators(years, data)

print(f"趋势分析:")
print(f"  开发利用率: {data['utilization_rate'][0]}% → "
      f"{data['utilization_rate'][-1]}% (已超警戒线)")
print(f"  人均水资源: {data['per_capita'][0]} → "
      f"{data['per_capita'][-1]} m³ (接近缺水线)")
print(f"  缺水率: {data['deficit_rate'][0]}% → "
      f"{data['deficit_rate'][-1]}% (重度缺水)")
print(f"  生态用水率: {data['eco_rate'][0]}% → "
      f"{data['eco_rate'][-1]}% (接近底线)")
```

---

## 三、提升对策

### 3.1 开源措施

1. **工程调水**：跨流域引水
2. **雨洪利用**：雨水收集、滞蓄
3. **非常规水源**：海水淡化、再生水

### 3.2 节流措施

1. **农业节水**：喷灌、滴灌，节水30-50%
2. **工业节水**：循环冷却、中水回用
3. **生活节水**：节水器具普及

### 3.3 治污措施

**水质提升** → **可用水量增加**

---

## 四、典型考题

### 【例题】承载力计算

**题目**（25分）

某市水资源总量8亿m³，生态需水2亿m³，现状人口100万，人均综合用水定额400m³/年。求：
1) 最大承载人口
2) 承载状态

**【解答】**

(1) 可利用水量：6亿m³

(2) 最大承载人口：
$$P_{max} = \frac{6 \times 10^8}{400} = 150 \text{万人}$$

(3) 现状人口100万 < 150万，**未超载**

---

**本章重点**：
- 承载力概念与指标
- 供需平衡法
- 优化配置
- 提升对策
