# ç¬¬8ç«  æ´ªæ°´é¢„æŠ¥

**æœ¬ç« å®šä½**ï¼šæ´ªæ°´é¢„æŠ¥çš„æ ¸å¿ƒæŠ€æœ¯  
**è€ƒè¯•å æ¯”**ï¼šçº¦16-20%  
**éš¾åº¦åˆ†å¸ƒ**ï¼šåŸºç¡€7é¢˜ + ä¸­ç­‰11é¢˜ + æ‹”é«˜4é¢˜  
**æœ¬ç« é¢˜æ•°**ï¼š22é¢˜  
**æœ¬ç« æ€»åˆ†**ï¼š610åˆ†

---

## æœ¬ç« çŸ¥è¯†ä½“ç³»

```
æ´ªæ°´é¢„æŠ¥
â”œâ”€â”€ 1. æ´ªæ°´é¢„æŠ¥åŸºç¡€ï¼ˆé¢˜1-5ï¼‰
â”‚   â”œâ”€â”€ æ´ªæ°´é¢„æŠ¥æ¦‚å¿µ
â”‚   â”œâ”€â”€ é¢„æŠ¥åˆ†ç±»
â”‚   â”œâ”€â”€ æ´ªå³°æµé‡é¢„æŠ¥
â”‚   â”œâ”€â”€ æ´ªæ°´è¿‡ç¨‹é¢„æŠ¥
â”‚   â””â”€â”€ é¢„æŠ¥æ–¹æ¡ˆé€‰æ‹©
â”‚
â”œâ”€â”€ 2. æ²³é“æ´ªæ°´æ¼”ç®—ï¼ˆé¢˜6-11ï¼‰
â”‚   â”œâ”€â”€ Muskingumæ³• âœ… ä»£ç 1
â”‚   â”œâ”€â”€ é©¬æ–¯äº¬æ ¹-åº·å‰æ³•
â”‚   â”œâ”€â”€ æ°´åŠ›å­¦æ³•
â”‚   â”œâ”€â”€ ç‰¹å¾çº¿æ³•
â”‚   â”œâ”€â”€ å‚æ•°ç‡å®š
â”‚   â””â”€â”€ åŒºé—´å…¥æµ
â”‚
â”œâ”€â”€ 3. é¢„æŠ¥ç²¾åº¦è¯„ä»·ï¼ˆé¢˜12-16ï¼‰
â”‚   â”œâ”€â”€ ç²¾åº¦è¯„ä»·æŒ‡æ ‡ âœ… ä»£ç 2
â”‚   â”œâ”€â”€ æ´ªå³°è¯¯å·®
â”‚   â”œâ”€â”€ å³°ç°æ—¶é—´è¯¯å·®
â”‚   â”œâ”€â”€ æ´ªé‡è¯¯å·®
â”‚   â””â”€â”€ è¿‡ç¨‹çº¿æ‹Ÿåˆåº¦
â”‚
â””â”€â”€ 4. é¢„æŠ¥æ–¹æ³•ä¸å‰æ²¿ï¼ˆé¢˜17-22ï¼‰
    â”œâ”€â”€ ç¥ç»ç½‘ç»œé¢„æŠ¥
    â”œâ”€â”€ é›†åˆæ´ªæ°´é¢„æŠ¥
    â”œâ”€â”€ å®æ—¶é¢„æŠ¥è°ƒåº¦
    â”œâ”€â”€ é¢„æŠ¥é¢„è­¦ç³»ç»Ÿ
    â”œâ”€â”€ è€ƒç ”çœŸé¢˜
    â””â”€â”€ å‹è½´é¢˜
```

---

## é¢˜ç›®1ï¼šMuskingumæ²³é“æ´ªæ°´æ¼”ç®— â˜…â˜…â˜…â˜…â˜…

**ã€é¢˜ç›®æè¿°ã€‘**

æŸæ²³æ®µé•¿L=50kmï¼Œä¸Šæ¸¸æ–­é¢ï¼ˆå…¥æµï¼‰æŸæ¬¡æ´ªæ°´è¿‡ç¨‹å¦‚ä¸‹ï¼š

| æ—¶é—´t(h) | 0 | 6 | 12 | 18 | 24 | 30 | 36 | 42 | 48 |
|---------|---|---|----|----|----|----|----|----|-----|
| å…¥æµI(mÂ³/s) | 200 | 500 | 1000 | 1500 | 1200 | 800 | 500 | 300 | 200 |

å·²çŸ¥æ²³æ®µMuskingumå‚æ•°ï¼šK=12hï¼ˆè“„é‡æ»æ—¶ï¼‰ï¼Œx=0.25ï¼ˆæƒé‡ç³»æ•°ï¼‰

ä¸‹æ¸¸æ–­é¢åˆå§‹æµé‡Qâ‚€=200 mÂ³/s

**é—®é¢˜**ï¼š
1. é˜è¿°Muskingumæ³•çš„åŸºæœ¬åŸç†ï¼ˆ10åˆ†ï¼‰
2. æ¨å¯¼Muskingumæ¼”ç®—å…¬å¼ï¼ˆ8åˆ†ï¼‰
3. è®¡ç®—æ¼”ç®—å‚æ•°Câ‚€ã€Câ‚ã€Câ‚‚ï¼ˆ6åˆ†ï¼‰
4. æ¼”ç®—ä¸‹æ¸¸æ–­é¢æ´ªæ°´è¿‡ç¨‹ï¼ˆ6åˆ†ï¼‰

**ã€è€ƒç‚¹åˆ†æã€‘** â­ å¿…è€ƒæ ¸å¿ƒ
- MuskingumåŸç†â˜…â˜…â˜…â˜…â˜…
- æ¼”ç®—å…¬å¼æ¨å¯¼â˜…â˜…â˜…â˜…â˜…
- å‚æ•°è®¡ç®—â˜…â˜…â˜…â˜…â˜…
- æ´ªæ°´æ¼”ç®—â˜…â˜…â˜…â˜…â˜…

**ã€éš¾åº¦ã€‘** éš¾ï¼ˆå¿…è€ƒé‡ç‚¹ï¼‰  
**ã€åˆ†å€¼ã€‘** 30åˆ†  
**ã€å»ºè®®æ—¶é—´ã€‘** 25åˆ†é’Ÿ

---

**ã€è¯¦ç»†è§£ç­”ã€‘**

**ç¬¬1é—®ï¼šMuskingumæ³•åŸç†ï¼ˆ10åˆ†ï¼‰**

**åŸºæœ¬åŸç†**ï¼ˆ4åˆ†ï¼‰ï¼š

Muskingumæ³•æ˜¯ä¸€ç§æ°´æ–‡å­¦æ²³é“æ´ªæ°´æ¼”ç®—æ–¹æ³•ï¼ŒåŸºäºæ°´é‡å¹³è¡¡å’Œè“„æ³„å…³ç³»ã€‚

**æ ¸å¿ƒæ–¹ç¨‹**ï¼ˆ2åˆ†ï¼‰ï¼š

**æ°´é‡å¹³è¡¡æ–¹ç¨‹**ï¼š
$$
I - O = \frac{dS}{dt}
$$

å…¶ä¸­ï¼š
- Iï¼šå…¥æµï¼ˆmÂ³/sï¼‰
- Oï¼šå‡ºæµï¼ˆmÂ³/sï¼‰
- Sï¼šæ²³æ®µè“„é‡ï¼ˆmÂ³ï¼‰

**è“„æ³„å…³ç³»**ï¼ˆ2åˆ†ï¼‰ï¼š

Muskingumå‡è®¾æ²³æ®µè“„é‡Sä¸ºå…¥æµIå’Œå‡ºæµOçš„çº¿æ€§ç»„åˆï¼š
$$
S = K[xI + (1-x)O]
$$

å…¶ä¸­ï¼š
- Kï¼šè“„é‡æ»æ—¶ï¼ˆhï¼‰ï¼Œåæ˜ æ´ªæ°´æ³¢åœ¨æ²³æ®µçš„å¹³å‡ä¼ æ’­æ—¶é—´
- xï¼šæƒé‡ç³»æ•°ï¼ˆæ— é‡çº²ï¼‰ï¼Œ0â‰¤xâ‰¤0.5
  - x=0ï¼šæ°´åº“å‹ï¼ˆçº¯æ»è“„ï¼‰
  - x=0.5ï¼šçº¯æ¼”è¿›ï¼ˆæ— æ»è“„ï¼‰
  - é€šå¸¸x=0.2-0.3ï¼ˆå¤©ç„¶æ²³é“ï¼‰

**ç‰©ç†æ„ä¹‰**ï¼ˆ2åˆ†ï¼‰ï¼š
- **Kå€¼å¤§**ï¼šæ²³æ®µé•¿ã€ç³™ç‡å¤§ã€å¡åº¦ç¼“â†’æ´ªæ°´ä¼ æ’­æ…¢
- **Kå€¼å°**ï¼šæ²³æ®µçŸ­ã€ç³™ç‡å°ã€å¡åº¦é™¡â†’æ´ªæ°´ä¼ æ’­å¿«
- **xå€¼å¤§**ï¼šæ¥”å½¢è“„é‡å æ¯”å¤§ï¼ˆæ´ªå³°æ¶¨è½å¿«ï¼‰
- **xå€¼å°**ï¼šæ£±æŸ±è“„é‡å æ¯”å¤§ï¼ˆæ´ªå³°æ¶¨è½æ…¢ï¼‰

**è¯„åˆ†æ ‡å‡†**ï¼š
- æ°´é‡å¹³è¡¡ï¼ˆ2åˆ†ï¼‰
- è“„æ³„å…³ç³»ï¼ˆ2åˆ†ï¼‰
- å‚æ•°æ„ä¹‰ï¼ˆ4åˆ†ï¼‰
- ç‰©ç†è§£é‡Šï¼ˆ2åˆ†ï¼‰

---

**ç¬¬2é—®ï¼šæ¼”ç®—å…¬å¼æ¨å¯¼ï¼ˆ8åˆ†ï¼‰**

**æ¨å¯¼è¿‡ç¨‹**ï¼ˆ8åˆ†ï¼‰ï¼š

**Step 1ï¼šæ°´é‡å¹³è¡¡ç¦»æ•£åŒ–**ï¼ˆ2åˆ†ï¼‰

æ—¶æ®µ[t, t+Î”t]å†…çš„æ°´é‡å¹³è¡¡ï¼š
$$
\bar{I}\Delta t - \bar{O}\Delta t = S_{t+\Delta t} - S_t
$$

ç”¨æ¢¯å½¢å…¬å¼è¿‘ä¼¼ï¼š
$$
\frac{I_t + I_{t+\Delta t}}{2} \cdot \Delta t - \frac{O_t + O_{t+\Delta t}}{2} \cdot \Delta t = S_{t+\Delta t} - S_t
$$

**Step 2ï¼šä»£å…¥è“„æ³„å…³ç³»**ï¼ˆ2åˆ†ï¼‰

$$
S_t = K[xI_t + (1-x)O_t]
$$
$$
S_{t+\Delta t} = K[xI_{t+\Delta t} + (1-x)O_{t+\Delta t}]
$$

**Step 3ï¼šæ•´ç†æ–¹ç¨‹**ï¼ˆ2åˆ†ï¼‰

$$
\frac{I_t + I_{t+\Delta t}}{2}\Delta t - \frac{O_t + O_{t+\Delta t}}{2}\Delta t = K[xI_{t+\Delta t} + (1-x)O_{t+\Delta t}] - K[xI_t + (1-x)O_t]
$$

å±•å¼€å¹¶æ•´ç†ï¼š
$$
\frac{\Delta t}{2}(I_t + I_{t+\Delta t} - O_t - O_{t+\Delta t}) = K[x(I_{t+\Delta t} - I_t) + (1-x)(O_{t+\Delta t} - O_t)]
$$

ç§»é¡¹ï¼Œå°†å«$O_{t+\Delta t}$çš„é¡¹ç§»åˆ°å·¦è¾¹ï¼š
$$
\frac{\Delta t}{2}O_{t+\Delta t} + K(1-x)O_{t+\Delta t} = \frac{\Delta t}{2}(I_t + I_{t+\Delta t} - O_t) + K[xI_{t+\Delta t} - xI_t - (1-x)O_t]
$$

$$
[\frac{\Delta t}{2} + K(1-x)]O_{t+\Delta t} = \frac{\Delta t}{2}I_{t+\Delta t} + Kx I_{t+\Delta t} + \frac{\Delta t}{2}I_t - KxI_t + [\frac{\Delta t}{2} - K(1-x)]O_t
$$

**Step 4ï¼šæ ‡å‡†å½¢å¼**ï¼ˆ2åˆ†ï¼‰

é™¤ä»¥$[\frac{\Delta t}{2} + K(1-x)]$ï¼Œå¾—ï¼š
$$
O_{t+\Delta t} = C_0 I_{t+\Delta t} + C_1 I_t + C_2 O_t
$$

å…¶ä¸­æ¼”ç®—ç³»æ•°ï¼š
$$
C_0 = \frac{\frac{\Delta t}{2} + Kx}{\frac{\Delta t}{2} + K(1-x)} = \frac{\Delta t + 2Kx}{\Delta t + 2K(1-x)}
$$

$$
C_1 = \frac{\frac{\Delta t}{2} - Kx}{\frac{\Delta t}{2} + K(1-x)} = \frac{\Delta t - 2Kx}{\Delta t + 2K(1-x)}
$$

$$
C_2 = \frac{-\frac{\Delta t}{2} + K(1-x)}{\frac{\Delta t}{2} + K(1-x)} = \frac{-\Delta t + 2K(1-x)}{\Delta t + 2K(1-x)}
$$

**éªŒè¯**ï¼š$C_0 + C_1 + C_2 = 1$ï¼ˆæ°´é‡å®ˆæ’ï¼‰

**è¯„åˆ†æ ‡å‡†**ï¼š
- æ°´é‡å¹³è¡¡ç¦»æ•£åŒ–ï¼ˆ2åˆ†ï¼‰
- ä»£å…¥è“„æ³„å…³ç³»ï¼ˆ2åˆ†ï¼‰
- æ•´ç†æ–¹ç¨‹ï¼ˆ2åˆ†ï¼‰
- æ ‡å‡†å½¢å¼ï¼ˆ2åˆ†ï¼‰

---

**ç¬¬3é—®ï¼šæ¼”ç®—å‚æ•°è®¡ç®—ï¼ˆ6åˆ†ï¼‰**

**å·²çŸ¥å‚æ•°**ï¼ˆ1åˆ†ï¼‰ï¼š
- K = 12 h
- x = 0.25
- Î”t = 6 hï¼ˆæ—¶æ®µé•¿ï¼‰

**è®¡ç®—Câ‚€**ï¼ˆ2åˆ†ï¼‰ï¼š
$$
C_0 = \frac{\Delta t + 2Kx}{\Delta t + 2K(1-x)} = \frac{6 + 2 \times 12 \times 0.25}{6 + 2 \times 12 \times (1-0.25)}
$$

$$
= \frac{6 + 6}{6 + 18} = \frac{12}{24} = 0.5
$$

**è®¡ç®—Câ‚**ï¼ˆ2åˆ†ï¼‰ï¼š
$$
C_1 = \frac{\Delta t - 2Kx}{\Delta t + 2K(1-x)} = \frac{6 - 2 \times 12 \times 0.25}{6 + 2 \times 12 \times 0.75}
$$

$$
= \frac{6 - 6}{24} = \frac{0}{24} = 0
$$

**è®¡ç®—Câ‚‚**ï¼ˆ1åˆ†ï¼‰ï¼š
$$
C_2 = \frac{-\Delta t + 2K(1-x)}{\Delta t + 2K(1-x)} = \frac{-6 + 2 \times 12 \times 0.75}{24}
$$

$$
= \frac{-6 + 18}{24} = \frac{12}{24} = 0.5
$$

**éªŒè¯**ï¼š
$$
C_0 + C_1 + C_2 = 0.5 + 0 + 0.5 = 1 \quad \checkmark
$$

**ç»“æœ**ï¼š
- Câ‚€ = 0.5
- Câ‚ = 0
- Câ‚‚ = 0.5

**ç‰©ç†æ„ä¹‰**ï¼š
- Câ‚=0ï¼šè¯´æ˜Î”t/(2K)=xï¼Œæ—¶æ®µåˆ’åˆ†æ°å½“
- Câ‚€=Câ‚‚=0.5ï¼šå‡ºæµç”±å½“å‰å…¥æµå’Œå‰æœŸå‡ºæµå¹³å‡å†³å®š

**è¯„åˆ†æ ‡å‡†**ï¼š
- å‚æ•°è¯†åˆ«ï¼ˆ1åˆ†ï¼‰
- Câ‚€è®¡ç®—ï¼ˆ2åˆ†ï¼‰
- Câ‚è®¡ç®—ï¼ˆ2åˆ†ï¼‰
- Câ‚‚è®¡ç®—ï¼ˆ1åˆ†ï¼‰

---

**ç¬¬4é—®ï¼šæ´ªæ°´æ¼”ç®—ï¼ˆ6åˆ†ï¼‰**

**æ¼”ç®—å…¬å¼**ï¼š
$$
O_{t+\Delta t} = 0.5 I_{t+\Delta t} + 0 \cdot I_t + 0.5 O_t = 0.5(I_{t+\Delta t} + O_t)
$$

**é€æ—¶æ®µæ¼”ç®—**ï¼ˆ5åˆ†ï¼‰ï¼š

| æ—¶é—´t(h) | å…¥æµI(mÂ³/s) | å‡ºæµO(mÂ³/s) | è®¡ç®—è¿‡ç¨‹ |
|---------|-------------|-------------|---------|
| 0 | 200 | 200 | åˆå§‹ |
| 6 | 500 | 0.5Ã—(500+200)=350 | 350 |
| 12 | 1000 | 0.5Ã—(1000+350)=675 | 675 |
| 18 | 1500 | 0.5Ã—(1500+675)=1088 | 1088 |
| 24 | 1200 | 0.5Ã—(1200+1088)=1144 | 1144 |
| 30 | 800 | 0.5Ã—(800+1144)=972 | 972 |
| 36 | 500 | 0.5Ã—(500+972)=736 | 736 |
| 42 | 300 | 0.5Ã—(300+736)=518 | 518 |
| 48 | 200 | 0.5Ã—(200+518)=359 | 359 |

**ç»“æœåˆ†æ**ï¼ˆ1åˆ†ï¼‰ï¼š
- **æ´ªå³°å‰Šå‡**ï¼šå…¥æµæ´ªå³°1500 mÂ³/s â†’ å‡ºæµæ´ªå³°1144 mÂ³/sï¼ˆå‰Šå‡23.7%ï¼‰
- **æ´ªå³°æ»å**ï¼šå…¥æµæ´ªå³°18h â†’ å‡ºæµæ´ªå³°24hï¼ˆæ»å6hï¼‰
- **è¿‡ç¨‹å¹³ç¼“**ï¼šå‡ºæµè¿‡ç¨‹çº¿æ¯”å…¥æµå¹³ç¼“

**è¯„åˆ†æ ‡å‡†**ï¼š
- æ¼”ç®—å…¬å¼ï¼ˆ1åˆ†ï¼‰
- é€æ—¶æ®µè®¡ç®—ï¼ˆ4åˆ†ï¼‰
- ç»“æœåˆ†æï¼ˆ1åˆ†ï¼‰

---

**ã€Pythonä»£ç å®ç°ã€‘**

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams

rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# æ•°æ®
time = np.array([0, 6, 12, 18, 24, 30, 36, 42, 48])
inflow = np.array([200, 500, 1000, 1500, 1200, 800, 500, 300, 200])

# Muskingumå‚æ•°
K = 12  # h
x = 0.25
dt = 6  # h
Q0 = 200  # åˆå§‹æµé‡

print("="*70)
print("é¢˜ç›®1ï¼šMuskingumæ²³é“æ´ªæ°´æ¼”ç®—")
print("="*70)
print(f"\næ²³æ®µå‚æ•°ï¼š")
print(f"  æ²³æ®µé•¿åº¦ L = 50 km")
print(f"  è“„é‡æ»æ—¶ K = {K} h")
print(f"  æƒé‡ç³»æ•° x = {x}")
print(f"  æ—¶æ®µé•¿åº¦ Î”t = {dt} h")
print(f"  åˆå§‹æµé‡ Qâ‚€ = {Q0} mÂ³/s")

# è®¡ç®—æ¼”ç®—ç³»æ•°
C0 = (dt + 2*K*x) / (dt + 2*K*(1-x))
C1 = (dt - 2*K*x) / (dt + 2*K*(1-x))
C2 = (-dt + 2*K*(1-x)) / (dt + 2*K*(1-x))

print(f"\næ¼”ç®—ç³»æ•°ï¼š")
print(f"  Câ‚€ = {C0:.4f}")
print(f"  Câ‚ = {C1:.4f}")
print(f"  Câ‚‚ = {C2:.4f}")
print(f"  éªŒè¯ï¼šCâ‚€+Câ‚+Câ‚‚ = {C0+C1+C2:.4f} (åº”=1)")

# æ¼”ç®—
outflow = np.zeros_like(inflow, dtype=float)
outflow[0] = Q0

for i in range(1, len(time)):
    outflow[i] = C0 * inflow[i] + C1 * inflow[i-1] + C2 * outflow[i-1]

print(f"\næ¼”ç®—ç»“æœï¼š")
print(f"{'æ—¶é—´(h)':<10} {'å…¥æµI(mÂ³/s)':<15} {'å‡ºæµO(mÂ³/s)':<15}")
for t, I, O in zip(time, inflow, outflow):
    print(f"{t:<10} {I:<15} {O:<15.1f}")

# æ´ªå³°åˆ†æ
peak_in_idx = np.argmax(inflow)
peak_out_idx = np.argmax(outflow)
peak_in = inflow[peak_in_idx]
peak_out = outflow[peak_out_idx]
peak_time_in = time[peak_in_idx]
peak_time_out = time[peak_out_idx]

print(f"\næ´ªå³°åˆ†æï¼š")
print(f"  å…¥æµæ´ªå³°ï¼š{peak_in} mÂ³/sï¼Œå‡ºç°æ—¶é—´ï¼š{peak_time_in} h")
print(f"  å‡ºæµæ´ªå³°ï¼š{peak_out:.1f} mÂ³/sï¼Œå‡ºç°æ—¶é—´ï¼š{peak_time_out} h")
print(f"  æ´ªå³°å‰Šå‡ï¼š{(peak_in - peak_out):.1f} mÂ³/s ({(peak_in-peak_out)/peak_in*100:.1f}%)")
print(f"  æ´ªå³°æ»åï¼š{peak_time_out - peak_time_in} h")

# æ´ªé‡åˆ†æ
volume_in = np.trapz(inflow, time) * 3600  # mÂ³
volume_out = np.trapz(outflow, time) * 3600  # mÂ³

print(f"\næ´ªé‡åˆ†æï¼š")
print(f"  å…¥æµæ´ªé‡ï¼š{volume_in:.0f} mÂ³")
print(f"  å‡ºæµæ´ªé‡ï¼š{volume_out:.0f} mÂ³")
print(f"  æ´ªé‡å·®ï¼š{abs(volume_in - volume_out):.0f} mÂ³ ({abs(volume_in-volume_out)/volume_in*100:.2f}%)")
print("="*70)

# åˆ›å»ºå›¾å½¢
fig = plt.figure(figsize=(16, 12))
gs = fig.add_gridspec(3, 3, hspace=0.35, wspace=0.35)

# å­å›¾1ï¼šå…¥æµvså‡ºæµè¿‡ç¨‹çº¿
ax1 = fig.add_subplot(gs[0, :2])
ax1.plot(time, inflow, 'b-o', linewidth=2, markersize=8, label='å…¥æµI')
ax1.plot(time, outflow, 'r-s', linewidth=2, markersize=8, label='å‡ºæµO')
ax1.plot(peak_time_in, peak_in, 'b*', markersize=15, label=f'å…¥æµæ´ªå³°({peak_time_in}h, {peak_in}mÂ³/s)')
ax1.plot(peak_time_out, peak_out, 'r*', markersize=15, label=f'å‡ºæµæ´ªå³°({peak_time_out}h, {peak_out:.0f}mÂ³/s)')
ax1.set_xlabel('æ—¶é—´ (h)', fontsize=11)
ax1.set_ylabel('æµé‡ (mÂ³/s)', fontsize=11)
ax1.set_title('é¢˜ç›®1-1ï¼šMuskingumæ²³é“æ´ªæ°´æ¼”ç®—', fontsize=12, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)
ax1.set_xlim(-2, 50)

# å­å›¾2ï¼šæ¼”ç®—ç³»æ•°
ax2 = fig.add_subplot(gs[0, 2])
coeff_names = ['Câ‚€', 'Câ‚', 'Câ‚‚']
coeff_values = [C0, C1, C2]
colors = ['blue', 'green', 'red']
bars = ax2.bar(coeff_names, coeff_values, color=colors, alpha=0.7, edgecolor='black')
for bar, val in zip(bars, coeff_values):
    ax2.text(bar.get_x() + bar.get_width()/2, val + 0.02,
             f'{val:.3f}', ha='center', fontsize=10, fontweight='bold')
ax2.axhline(1, color='gray', linestyle='--', alpha=0.5)
ax2.set_ylabel('ç³»æ•°å€¼', fontsize=11)
ax2.set_title('é¢˜ç›®1-2ï¼šMuskingumæ¼”ç®—ç³»æ•°', fontsize=11, fontweight='bold')
ax2.grid(True, alpha=0.3, axis='y')
ax2.set_ylim(-0.1, 1.2)

# å­å›¾3ï¼šæ´ªå³°å‰Šå‡å’Œæ»å
ax3 = fig.add_subplot(gs[1, :2])
ax3.bar(['å…¥æµæ´ªå³°', 'å‡ºæµæ´ªå³°'], [peak_in, peak_out], 
        color=['blue', 'red'], alpha=0.7, edgecolor='black')
ax3.text(0, peak_in + 30, f'{peak_in}mÂ³/s', ha='center', fontsize=10, fontweight='bold')
ax3.text(1, peak_out + 30, f'{peak_out:.0f}mÂ³/s', ha='center', fontsize=10, fontweight='bold')
ax3.set_ylabel('æ´ªå³°æµé‡ (mÂ³/s)', fontsize=11)
ax3.set_title(f'é¢˜ç›®1-3ï¼šæ´ªå³°å‰Šå‡ï¼ˆ{(peak_in-peak_out)/peak_in*100:.1f}%ï¼‰', 
              fontsize=12, fontweight='bold')
ax3.grid(True, alpha=0.3, axis='y')

# å­å›¾4ï¼šMuskingumåŸç†ç¤ºæ„
ax4 = fig.add_subplot(gs[1, 2])
ax4.axis('off')
principle_text = f"""
MuskingumåŸç†ï¼š

1. æ°´é‡å¹³è¡¡
   I - O = dS/dt
   
2. è“„æ³„å…³ç³»
   S = K[xI + (1-x)O]
   
3. æ¼”ç®—å…¬å¼
   Oâ‚œâ‚Šâ‚ = Câ‚€Iâ‚œâ‚Šâ‚ + Câ‚Iâ‚œ + Câ‚‚Oâ‚œ
   
å‚æ•°ï¼š
  K = {K} h (è“„é‡æ»æ—¶)
  x = {x} (æƒé‡ç³»æ•°)
  
ç³»æ•°ï¼š
  Câ‚€ = {C0:.3f}
  Câ‚ = {C1:.3f}
  Câ‚‚ = {C2:.3f}
"""
ax4.text(0.05, 0.95, principle_text, transform=ax4.transAxes,
         fontsize=9, verticalalignment='top', family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.7))

# å­å›¾5ï¼šè“„é‡å˜åŒ–
ax5 = fig.add_subplot(gs[2, :2])
storage = K * (x * inflow + (1-x) * outflow)
ax5.fill_between(time, 0, storage, alpha=0.3, color='cyan', label='æ²³æ®µè“„é‡S')
ax5.plot(time, storage, 'c-o', linewidth=2, markersize=6)
ax5.set_xlabel('æ—¶é—´ (h)', fontsize=11)
ax5.set_ylabel('è“„é‡ (mÂ³Â·h)', fontsize=11)
ax5.set_title('é¢˜ç›®1-4ï¼šæ²³æ®µè“„é‡å˜åŒ–è¿‡ç¨‹', fontsize=12, fontweight='bold')
ax5.legend(fontsize=10)
ax5.grid(True, alpha=0.3)
ax5.set_xlim(-2, 50)

# å­å›¾6ï¼šå‚æ•°æ•æ„Ÿæ€§åˆ†æ
ax6 = fig.add_subplot(gs[2, 2])
x_range = np.linspace(0, 0.5, 50)
C0_range = []
C2_range = []
for x_val in x_range:
    C0_val = (dt + 2*K*x_val) / (dt + 2*K*(1-x_val))
    C2_val = (-dt + 2*K*(1-x_val)) / (dt + 2*K*(1-x_val))
    C0_range.append(C0_val)
    C2_range.append(C2_val)

ax6.plot(x_range, C0_range, 'b-', linewidth=2, label='Câ‚€')
ax6.plot(x_range, C2_range, 'r-', linewidth=2, label='Câ‚‚')
ax6.plot(x, C0, 'bo', markersize=10, label=f'å½“å‰x={x}')
ax6.plot(x, C2, 'ro', markersize=10)
ax6.set_xlabel('æƒé‡ç³»æ•° x', fontsize=11)
ax6.set_ylabel('æ¼”ç®—ç³»æ•°', fontsize=11)
ax6.set_title('é¢˜ç›®1-5ï¼šå‚æ•°xå¯¹æ¼”ç®—ç³»æ•°çš„å½±å“', fontsize=11, fontweight='bold')
ax6.legend(fontsize=10)
ax6.grid(True, alpha=0.3)
ax6.set_xlim(0, 0.5)

plt.savefig('é¢˜ç›®1_Muskingumæ¼”ç®—.png', dpi=150, bbox_inches='tight')
print("\nâœ… é¢˜ç›®1å›¾å½¢å·²ç”Ÿæˆï¼šé¢˜ç›®1_Muskingumæ¼”ç®—.png")
plt.show()
```

---

**ã€çŸ¥è¯†æ‹“å±•ã€‘**

**1. Muskingumå‚æ•°ç¡®å®šæ–¹æ³•**

| æ–¹æ³• | åŸç† | ä¼˜ç¼ºç‚¹ |
|------|------|--------|
| è¯•é”™æ³• | è°ƒæ•´Kã€xä½¿æ‹Ÿåˆæœ€ä¼˜ | ç®€å•ä½†ä¸»è§‚ |
| ç¯æ›²çº¿æ³• | S vs [xI+(1-x)O]ä½œå›¾ | ç›´è§‚ä½†éœ€å¤šæ¬¡æ´ªæ°´ |
| ä¼˜åŒ–æ³• | æœ€å°åŒ–è¯¯å·®ç›®æ ‡å‡½æ•° | å®¢è§‚ä½†è®¡ç®—å¤æ‚ |

**2. Muskingumå‚æ•°å…¸å‹å€¼**

| æ²³é“ç±»å‹ | K(h) | x |
|---------|------|---|
| å±±åŒºæ²³æµ | 6-12 | 0.2-0.3 |
| å¹³åŸæ²³æµ | 12-24 | 0.1-0.25 |
| æ°´åº“ | >24 | 0-0.1 |

**3. æ¼”ç®—ç¨³å®šæ€§æ¡ä»¶**

ä¸ºä¿è¯æ¼”ç®—ç¨³å®šï¼Œéœ€æ»¡è¶³ï¼š
$$
\Delta t \geq 2Kx
$$

å¦åˆ™Câ‚<0ï¼Œå‡ºç°æ•°å€¼æŒ¯è¡ã€‚

---

**ã€å¸¸è§é”™è¯¯ã€‘**

âŒ **Câ‚€+Câ‚+Câ‚‚â‰ 1**
âœ… å¿…é¡»éªŒè¯ï¼Œå¦åˆ™ä¸å®ˆæ’

âŒ **æ··æ·†Kå’ŒÎ”t**
âœ… Kæ˜¯æ²³æ®µç‰¹æ€§ï¼ŒÎ”tæ˜¯è®¡ç®—æ—¶æ®µ

âŒ **x>0.5**
âœ… xå¿…é¡»â‰¤0.5ï¼Œå¦åˆ™éç‰©ç†

âŒ **è´Ÿæµé‡**
âœ… æ£€æŸ¥å‚æ•°ï¼Œè°ƒæ•´Î”t

---

## é¢˜ç›®2ï¼šæ´ªæ°´é¢„æŠ¥ç²¾åº¦è¯„ä»· â˜…â˜…â˜…â˜…â˜†

**ã€é¢˜ç›®æè¿°ã€‘**

æŸæµåŸŸæ´ªæ°´é¢„æŠ¥ç»“æœå¦‚ä¸‹ï¼ˆå…±10ä¸ªæ—¶æ®µï¼‰ï¼š

| æ—¶æ®µ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
|------|---|---|---|---|---|---|---|---|---|----|
| å®æµ‹Qo(mÂ³/s) | 100 | 250 | 550 | 850 | 1000 | 900 | 650 | 400 | 200 | 100 |
| é¢„æŠ¥Qf(mÂ³/s) | 120 | 280 | 600 | 820 | 950 | 920 | 680 | 380 | 220 | 110 |

**é—®é¢˜**ï¼š
1. è¯´æ˜æ´ªæ°´é¢„æŠ¥ç²¾åº¦è¯„ä»·çš„æ„ä¹‰å’ŒæŒ‡æ ‡ä½“ç³»ï¼ˆ8åˆ†ï¼‰
2. è®¡ç®—ç¡®å®šæ€§ç³»æ•°ï¼ˆNSEï¼‰ï¼ˆ6åˆ†ï¼‰
3. è®¡ç®—æ´ªå³°æµé‡ç›¸å¯¹è¯¯å·®å’Œå³°ç°æ—¶é—´è¯¯å·®ï¼ˆ8åˆ†ï¼‰
4. è®¡ç®—æ´ªé‡ç›¸å¯¹è¯¯å·®å’Œè¿‡ç¨‹ç›¸å…³ç³»æ•°ï¼ˆ6åˆ†ï¼‰

**ã€è€ƒç‚¹åˆ†æã€‘** â­ é«˜é¢‘è€ƒç‚¹
- ç²¾åº¦è¯„ä»·æ„ä¹‰â˜…â˜…â˜…â˜…â˜…
- NSEç³»æ•°â˜…â˜…â˜…â˜…â˜…
- æ´ªå³°è¯¯å·®â˜…â˜…â˜…â˜…â˜…
- æ´ªé‡è¯¯å·®â˜…â˜…â˜…â˜…

**ã€éš¾åº¦ã€‘** ä¸­ç­‰åéš¾  
**ã€åˆ†å€¼ã€‘** 28åˆ†  
**ã€å»ºè®®æ—¶é—´ã€‘** 22åˆ†é’Ÿ

---

**ã€è¯¦ç»†è§£ç­”ã€‘**

**ç¬¬1é—®ï¼šç²¾åº¦è¯„ä»·æ„ä¹‰å’ŒæŒ‡æ ‡ï¼ˆ8åˆ†ï¼‰**

**è¯„ä»·æ„ä¹‰**ï¼ˆ3åˆ†ï¼‰ï¼š

1. **æ£€éªŒé¢„æŠ¥èƒ½åŠ›**ï¼ˆ1åˆ†ï¼‰ï¼š
   - å®¢è§‚è¯„ä»·é¢„æŠ¥æ–¹æ³•ä¼˜åŠ£
   - è¯†åˆ«é¢„æŠ¥æ¨¡å‹é—®é¢˜
   - æŒ‡å¯¼æ¨¡å‹æ”¹è¿›æ–¹å‘

2. **æŒ‡å¯¼ä¸šåŠ¡åº”ç”¨**ï¼ˆ1åˆ†ï¼‰ï¼š
   - ç¡®å®šé¢„æŠ¥å¯é æ€§
   - è¯„ä¼°é¢„æŠ¥ä»·å€¼
   - ä¸ºå†³ç­–æä¾›ä¾æ®

3. **å¯¹æ¯”ä¸åŒæ–¹æ¡ˆ**ï¼ˆ1åˆ†ï¼‰ï¼š
   - å¤šæ–¹æ¡ˆæ¯”é€‰
   - ä¼˜é€‰æœ€ä½³æ–¹æ¡ˆ
   - æŒç»­æ”¹è¿›

**æŒ‡æ ‡ä½“ç³»**ï¼ˆ5åˆ†ï¼‰ï¼š

**ç±»åˆ«1ï¼šæ´ªå³°è¯¯å·®æŒ‡æ ‡**ï¼ˆ1.5åˆ†ï¼‰
- **æ´ªå³°æµé‡ç›¸å¯¹è¯¯å·®**ï¼š
  $$RE_{Qp} = \frac{Q_{fp} - Q_{op}}{Q_{op}} \times 100\%$$
- **å³°ç°æ—¶é—´è¯¯å·®**ï¼š
  $$\Delta T_p = T_{fp} - T_{op}$$
- **åˆæ ¼æ ‡å‡†**ï¼š$|RE_{Qp}| \leq 20\%$ï¼Œ$|\Delta T_p| \leq 3h$

**ç±»åˆ«2ï¼šæ´ªé‡è¯¯å·®æŒ‡æ ‡**ï¼ˆ1.5åˆ†ï¼‰
- **æ´ªé‡ç›¸å¯¹è¯¯å·®**ï¼š
  $$RE_W = \frac{W_f - W_o}{W_o} \times 100\%$$
- **åˆæ ¼æ ‡å‡†**ï¼š$|RE_W| \leq 20\%$

**ç±»åˆ«3ï¼šè¿‡ç¨‹æ‹Ÿåˆåº¦æŒ‡æ ‡**ï¼ˆ2åˆ†ï¼‰
- **ç¡®å®šæ€§ç³»æ•°ï¼ˆNSEï¼‰**ï¼š
  $$NSE = 1 - \frac{\sum(Q_o - Q_f)^2}{\sum(Q_o - \bar{Q}_o)^2}$$
  - èŒƒå›´ï¼š(-âˆ, 1]
  - NSE>0.7ï¼šè‰¯å¥½
  - NSE>0.8ï¼šä¼˜ç§€

- **ç›¸å…³ç³»æ•°**ï¼š
  $$r = \frac{\sum(Q_o - \bar{Q}_o)(Q_f - \bar{Q}_f)}{\sqrt{\sum(Q_o-\bar{Q}_o)^2 \sum(Q_f-\bar{Q}_f)^2}}$$

**è¯„åˆ†æ ‡å‡†**ï¼š
- è¯„ä»·æ„ä¹‰ï¼ˆ3åˆ†ï¼‰
- æ´ªå³°è¯¯å·®ï¼ˆ1.5åˆ†ï¼‰
- æ´ªé‡è¯¯å·®ï¼ˆ1.5åˆ†ï¼‰
- æ‹Ÿåˆåº¦æŒ‡æ ‡ï¼ˆ2åˆ†ï¼‰

---

**ç¬¬2é—®ï¼šç¡®å®šæ€§ç³»æ•°NSEï¼ˆ6åˆ†ï¼‰**

**NSEå®šä¹‰**ï¼ˆ2åˆ†ï¼‰ï¼š

$$
NSE = 1 - \frac{\sum_{i=1}^{n}(Q_{oi} - Q_{fi})^2}{\sum_{i=1}^{n}(Q_{oi} - \bar{Q}_o)^2}
$$

**è®¡ç®—æ­¥éª¤**ï¼ˆ4åˆ†ï¼‰ï¼š

**Step 1ï¼šè®¡ç®—å¹³å‡å€¼**
$$
\bar{Q}_o = \frac{1}{10}\sum Q_{oi} = \frac{100+250+550+850+1000+900+650+400+200+100}{10} = \frac{5000}{10} = 500 \text{ m}^3/\text{s}
$$

**Step 2ï¼šè®¡ç®—åˆ†å­ï¼ˆé¢„æŠ¥è¯¯å·®å¹³æ–¹å’Œï¼‰**
$$
\sum(Q_o - Q_f)^2 = (100-120)^2 + (250-280)^2 + ... + (100-110)^2
$$

é€é¡¹è®¡ç®—ï¼š
- $(100-120)^2 = 400$
- $(250-280)^2 = 900$
- $(550-600)^2 = 2500$
- $(850-820)^2 = 900$
- $(1000-950)^2 = 2500$
- $(900-920)^2 = 400$
- $(650-680)^2 = 900$
- $(400-380)^2 = 400$
- $(200-220)^2 = 400$
- $(100-110)^2 = 100$

$$
\sum(Q_o - Q_f)^2 = 400+900+2500+900+2500+400+900+400+400+100 = 9400
$$

**Step 3ï¼šè®¡ç®—åˆ†æ¯ï¼ˆå®æµ‹ç¦»å·®å¹³æ–¹å’Œï¼‰**
$$
\sum(Q_o - \bar{Q}_o)^2 = (100-500)^2 + (250-500)^2 + ... + (100-500)^2
$$

é€é¡¹è®¡ç®—ï¼š
- $(100-500)^2 = 160000$
- $(250-500)^2 = 62500$
- $(550-500)^2 = 2500$
- $(850-500)^2 = 122500$
- $(1000-500)^2 = 250000$
- $(900-500)^2 = 160000$
- $(650-500)^2 = 22500$
- $(400-500)^2 = 10000$
- $(200-500)^2 = 90000$
- $(100-500)^2 = 160000$

$$
\sum(Q_o - \bar{Q}_o)^2 = 1040000
$$

**Step 4ï¼šè®¡ç®—NSE**
$$
NSE = 1 - \frac{9400}{1040000} = 1 - 0.00904 = 0.991
$$

**ç»“æœ**ï¼š**NSE = 0.991** ï¼ˆä¼˜ç§€ï¼‰

**è¯„ä»·**ï¼šNSE>0.9ï¼Œé¢„æŠ¥ç²¾åº¦æé«˜ï¼Œè¿‡ç¨‹æ‹Ÿåˆéå¸¸å¥½ã€‚

**è¯„åˆ†æ ‡å‡†**ï¼š
- NSEå®šä¹‰ï¼ˆ2åˆ†ï¼‰
- åˆ†å­è®¡ç®—ï¼ˆ1.5åˆ†ï¼‰
- åˆ†æ¯è®¡ç®—ï¼ˆ1.5åˆ†ï¼‰
- NSEè®¡ç®—ï¼ˆ1åˆ†ï¼‰

---

**ç¬¬3é—®ï¼šæ´ªå³°è¯¯å·®ï¼ˆ8åˆ†ï¼‰**

**æ´ªå³°æµé‡ç›¸å¯¹è¯¯å·®**ï¼ˆ4åˆ†ï¼‰ï¼š

**Step 1ï¼šè¯†åˆ«æ´ªå³°**
- å®æµ‹æ´ªå³°ï¼š$Q_{op} = 1000$ mÂ³/sï¼ˆæ—¶æ®µ5ï¼‰
- é¢„æŠ¥æ´ªå³°ï¼š$Q_{fp} = 950$ mÂ³/sï¼ˆæ—¶æ®µ5ï¼‰

**Step 2ï¼šè®¡ç®—ç›¸å¯¹è¯¯å·®**
$$
RE_{Qp} = \frac{Q_{fp} - Q_{op}}{Q_{op}} \times 100\% = \frac{950 - 1000}{1000} \times 100\% = -5\%
$$

**ç»“æœ**ï¼š$RE_{Qp} = -5\%$ï¼ˆè´Ÿå€¼è¡¨ç¤ºé¢„æŠ¥åä½ï¼‰

**è¯„ä»·**ï¼š$|RE_{Qp}| = 5\% < 20\%$ï¼Œ**åˆæ ¼**

---

**å³°ç°æ—¶é—´è¯¯å·®**ï¼ˆ4åˆ†ï¼‰ï¼š

**Step 1ï¼šè¯†åˆ«å³°ç°æ—¶é—´**
- å®æµ‹å³°ç°æ—¶é—´ï¼š$T_{op} = 5$ï¼ˆæ—¶æ®µ5ï¼‰
- é¢„æŠ¥å³°ç°æ—¶é—´ï¼š$T_{fp} = 5$ï¼ˆæ—¶æ®µ5ï¼‰

**Step 2ï¼šè®¡ç®—æ—¶é—´è¯¯å·®**
$$
\Delta T_p = T_{fp} - T_{op} = 5 - 5 = 0 \text{ æ—¶æ®µ}
$$

**ç»“æœ**ï¼š$\Delta T_p = 0$

**è¯„ä»·**ï¼šå³°ç°æ—¶é—´å®Œå…¨å‡†ç¡®ï¼Œ**ä¼˜ç§€**

**è¯„åˆ†æ ‡å‡†**ï¼š
- æ´ªå³°æµé‡è¯¯å·®ï¼ˆ4åˆ†ï¼‰
- å³°ç°æ—¶é—´è¯¯å·®ï¼ˆ4åˆ†ï¼‰

---

**ç¬¬4é—®ï¼šæ´ªé‡è¯¯å·®å’Œç›¸å…³ç³»æ•°ï¼ˆ6åˆ†ï¼‰**

**æ´ªé‡ç›¸å¯¹è¯¯å·®**ï¼ˆ3åˆ†ï¼‰ï¼š

**Step 1ï¼šè®¡ç®—æ´ªé‡**ï¼ˆç”¨æ¢¯å½¢æ³•ï¼Œå‡è®¾æ—¶æ®µé•¿åº¦Î”t=1ï¼‰

å®æµ‹æ´ªé‡ï¼š
$$
W_o = \sum Q_{oi} = 100+250+550+850+1000+900+650+400+200+100 = 5000 \text{ m}^3
$$

é¢„æŠ¥æ´ªé‡ï¼š
$$
W_f = \sum Q_{fi} = 120+280+600+820+950+920+680+380+220+110 = 5080 \text{ m}^3
$$

**Step 2ï¼šè®¡ç®—ç›¸å¯¹è¯¯å·®**
$$
RE_W = \frac{W_f - W_o}{W_o} \times 100\% = \frac{5080 - 5000}{5000} \times 100\% = 1.6\%
$$

**ç»“æœ**ï¼š$RE_W = 1.6\%$

**è¯„ä»·**ï¼š$|RE_W| = 1.6\% < 20\%$ï¼Œ**åˆæ ¼ä¸”ä¼˜ç§€**

---

**è¿‡ç¨‹ç›¸å…³ç³»æ•°**ï¼ˆ3åˆ†ï¼‰ï¼š

$$
r = \frac{\sum(Q_o - \bar{Q}_o)(Q_f - \bar{Q}_f)}{\sqrt{\sum(Q_o-\bar{Q}_o)^2 \sum(Q_f-\bar{Q}_f)^2}}
$$

å·²çŸ¥ï¼š$\bar{Q}_o = 500$ï¼Œ$\sum(Q_o-\bar{Q}_o)^2 = 1040000$

è®¡ç®—$\bar{Q}_f$ï¼š
$$
\bar{Q}_f = \frac{5080}{10} = 508 \text{ m}^3/\text{s}
$$

è®¡ç®—åˆ†å­ã€åˆ†æ¯ï¼ˆç®€åŒ–ï¼‰ï¼š
ç”±äºNSE=0.991æé«˜ï¼Œå¯æ¨æ–­râ‰ˆ0.995

**ç»“æœ**ï¼š$r \approx 0.995$

**è¯„ä»·**ï¼šr>0.99ï¼Œç›¸å…³æ€§æå¼º

**è¯„åˆ†æ ‡å‡†**ï¼š
- æ´ªé‡è¯¯å·®ï¼ˆ3åˆ†ï¼‰
- ç›¸å…³ç³»æ•°ï¼ˆ3åˆ†ï¼‰

---

**ã€Pythonä»£ç å®ç°ã€‘**

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams

rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# æ•°æ®
time = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
Qo = np.array([100, 250, 550, 850, 1000, 900, 650, 400, 200, 100])  # å®æµ‹
Qf = np.array([120, 280, 600, 820, 950, 920, 680, 380, 220, 110])  # é¢„æŠ¥

print("="*70)
print("é¢˜ç›®2ï¼šæ´ªæ°´é¢„æŠ¥ç²¾åº¦è¯„ä»·")
print("="*70)

# åŸºæœ¬ç»Ÿè®¡
Qo_mean = np.mean(Qo)
Qf_mean = np.mean(Qf)

print(f"\nåŸºæœ¬ç»Ÿè®¡ï¼š")
print(f"  å®æµ‹å¹³å‡æµé‡ QÌ„â‚’ = {Qo_mean:.1f} mÂ³/s")
print(f"  é¢„æŠ¥å¹³å‡æµé‡ QÌ„_f = {Qf_mean:.1f} mÂ³/s")

# NSEç³»æ•°
numerator = np.sum((Qo - Qf)**2)
denominator = np.sum((Qo - Qo_mean)**2)
NSE = 1 - numerator / denominator

print(f"\nç¡®å®šæ€§ç³»æ•°NSEï¼š")
print(f"  åˆ†å­ Î£(Qâ‚’-Q_f)Â² = {numerator:.0f}")
print(f"  åˆ†æ¯ Î£(Qâ‚’-QÌ„â‚’)Â² = {denominator:.0f}")
print(f"  NSE = 1 - {numerator:.0f}/{denominator:.0f}")
print(f"  NSE = {NSE:.4f}")
print(f"  è¯„ä»·ï¼š{'ä¼˜ç§€' if NSE > 0.8 else 'è‰¯å¥½' if NSE > 0.7 else 'ä¸€èˆ¬'}")

# æ´ªå³°è¯¯å·®
Qop = np.max(Qo)
Qfp = np.max(Qf)
Qop_idx = np.argmax(Qo)
Qfp_idx = np.argmax(Qf)
REQp = (Qfp - Qop) / Qop * 100
DTp = Qfp_idx - Qop_idx

print(f"\næ´ªå³°è¯¯å·®ï¼š")
print(f"  å®æµ‹æ´ªå³° Qâ‚’â‚š = {Qop} mÂ³/s (æ—¶æ®µ{Qop_idx+1})")
print(f"  é¢„æŠ¥æ´ªå³° Q_fp = {Qfp} mÂ³/s (æ—¶æ®µ{Qfp_idx+1})")
print(f"  æ´ªå³°ç›¸å¯¹è¯¯å·® RE_Qp = {REQp:.2f}%")
print(f"  å³°ç°æ—¶é—´è¯¯å·® Î”Tâ‚š = {DTp} æ—¶æ®µ")
print(f"  è¯„ä»·ï¼š{'åˆæ ¼' if abs(REQp) <= 20 else 'ä¸åˆæ ¼'}")

# æ´ªé‡è¯¯å·®
Wo = np.sum(Qo)
Wf = np.sum(Qf)
REW = (Wf - Wo) / Wo * 100

print(f"\næ´ªé‡è¯¯å·®ï¼š")
print(f"  å®æµ‹æ´ªé‡ Wâ‚’ = {Wo} mÂ³")
print(f"  é¢„æŠ¥æ´ªé‡ W_f = {Wf} mÂ³")
print(f"  æ´ªé‡ç›¸å¯¹è¯¯å·® RE_W = {REW:.2f}%")
print(f"  è¯„ä»·ï¼š{'åˆæ ¼' if abs(REW) <= 20 else 'ä¸åˆæ ¼'}")

# ç›¸å…³ç³»æ•°
r = np.corrcoef(Qo, Qf)[0, 1]

print(f"\nè¿‡ç¨‹ç›¸å…³ç³»æ•°ï¼š")
print(f"  r = {r:.4f}")
print(f"  è¯„ä»·ï¼šç›¸å…³æ€§{'æå¼º' if r > 0.9 else 'å¼º' if r > 0.7 else 'ä¸­ç­‰'}")

# RMSE
RMSE = np.sqrt(np.mean((Qo - Qf)**2))
print(f"\nå‡æ–¹æ ¹è¯¯å·®ï¼š")
print(f"  RMSE = {RMSE:.2f} mÂ³/s")

# MAE
MAE = np.mean(np.abs(Qo - Qf))
print(f"\nå¹³å‡ç»å¯¹è¯¯å·®ï¼š")
print(f"  MAE = {MAE:.2f} mÂ³/s")

print("="*70)

# åˆ›å»ºå›¾å½¢
fig = plt.figure(figsize=(16, 12))
gs = fig.add_gridspec(3, 3, hspace=0.35, wspace=0.35)

# å­å›¾1ï¼šå®æµ‹vsé¢„æŠ¥è¿‡ç¨‹çº¿
ax1 = fig.add_subplot(gs[0, :2])
ax1.plot(time, Qo, 'bo-', linewidth=2, markersize=8, label='å®æµ‹Qâ‚’')
ax1.plot(time, Qf, 'rs--', linewidth=2, markersize=8, label='é¢„æŠ¥Q_f')
ax1.plot(Qop_idx+1, Qop, 'b*', markersize=15, label=f'å®æµ‹æ´ªå³°({Qop}mÂ³/s)')
ax1.plot(Qfp_idx+1, Qfp, 'r*', markersize=15, label=f'é¢„æŠ¥æ´ªå³°({Qfp}mÂ³/s)')
ax1.set_xlabel('æ—¶æ®µ', fontsize=11)
ax1.set_ylabel('æµé‡ (mÂ³/s)', fontsize=11)
ax1.set_title(f'é¢˜ç›®2-1ï¼šæ´ªæ°´é¢„æŠ¥ç²¾åº¦è¯„ä»·ï¼ˆNSE={NSE:.3f}ï¼‰', fontsize=12, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)

# å­å›¾2ï¼šè¯¯å·®æ—¶é—´åºåˆ—
ax2 = fig.add_subplot(gs[0, 2])
errors = Qo - Qf
ax2.bar(time, errors, color=['red' if e > 0 else 'blue' for e in errors],
        alpha=0.7, edgecolor='black')
ax2.axhline(0, color='black', linewidth=1)
ax2.set_xlabel('æ—¶æ®µ', fontsize=11)
ax2.set_ylabel('è¯¯å·® Qâ‚’-Q_f (mÂ³/s)', fontsize=11)
ax2.set_title('é¢˜ç›®2-2ï¼šé¢„æŠ¥è¯¯å·®æ—¶é—´åºåˆ—', fontsize=11, fontweight='bold')
ax2.grid(True, alpha=0.3, axis='y')

# å­å›¾3ï¼šæ•£ç‚¹å›¾
ax3 = fig.add_subplot(gs[1, :2])
ax3.scatter(Qo, Qf, s=100, alpha=0.6, edgecolors='black', linewidth=2)
# 1:1çº¿
ax3.plot([0, 1100], [0, 1100], 'r--', linewidth=2, label='1:1çº¿')
# æ‹Ÿåˆçº¿
z = np.polyfit(Qo, Qf, 1)
p = np.poly1d(z)
ax3.plot(Qo, p(Qo), 'b-', linewidth=2, label=f'æ‹Ÿåˆçº¿(y={z[0]:.2f}x+{z[1]:.1f})')
ax3.set_xlabel('å®æµ‹æµé‡ Qâ‚’ (mÂ³/s)', fontsize=11)
ax3.set_ylabel('é¢„æŠ¥æµé‡ Q_f (mÂ³/s)', fontsize=11)
ax3.set_title(f'é¢˜ç›®2-3ï¼šå®æµ‹vsé¢„æŠ¥æ•£ç‚¹å›¾ï¼ˆr={r:.3f}ï¼‰', fontsize=12, fontweight='bold')
ax3.legend(fontsize=10)
ax3.grid(True, alpha=0.3)
ax3.set_xlim(0, 1100)
ax3.set_ylim(0, 1100)

# å­å›¾4ï¼šç²¾åº¦æŒ‡æ ‡æ±‡æ€»
ax4 = fig.add_subplot(gs[1, 2])
ax4.axis('off')
metrics_text = f"""
ç²¾åº¦è¯„ä»·æŒ‡æ ‡æ±‡æ€»ï¼š

1. ç¡®å®šæ€§ç³»æ•°
   NSE = {NSE:.4f}
   è¯„ä»·ï¼šä¼˜ç§€
   
2. æ´ªå³°è¯¯å·®
   RE_Qp = {REQp:.2f}%
   Î”Tâ‚š = {DTp} æ—¶æ®µ
   è¯„ä»·ï¼šåˆæ ¼
   
3. æ´ªé‡è¯¯å·®
   RE_W = {REW:.2f}%
   è¯„ä»·ï¼šåˆæ ¼
   
4. ç›¸å…³ç³»æ•°
   r = {r:.4f}
   è¯„ä»·ï¼šæå¼º
   
5. RMSE
   {RMSE:.2f} mÂ³/s
   
6. MAE
   {MAE:.2f} mÂ³/s
"""
ax4.text(0.05, 0.95, metrics_text, transform=ax4.transAxes,
         fontsize=9, verticalalignment='top', family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.7))

# å­å›¾5ï¼šæ´ªå³°å’Œæ´ªé‡å¯¹æ¯”
ax5 = fig.add_subplot(gs[2, :2])
categories = ['æ´ªå³°\n(mÂ³/s)', 'æ´ªé‡\n(mÂ³)']
observed = [Qop, Wo]
forecasted = [Qfp, Wf]
x = np.arange(len(categories))
width = 0.35

bars1 = ax5.bar(x - width/2, observed, width, label='å®æµ‹', color='blue', alpha=0.7)
bars2 = ax5.bar(x + width/2, forecasted, width, label='é¢„æŠ¥', color='red', alpha=0.7)

# æ ‡æ³¨æ•°å€¼
for bar, val in zip(bars1, observed):
    ax5.text(bar.get_x() + bar.get_width()/2, val + 30,
             f'{val:.0f}', ha='center', fontsize=9)
for bar, val in zip(bars2, forecasted):
    ax5.text(bar.get_x() + bar.get_width()/2, val + 30,
             f'{val:.0f}', ha='center', fontsize=9)

ax5.set_ylabel('æ•°å€¼', fontsize=11)
ax5.set_title('é¢˜ç›®2-4ï¼šæ´ªå³°å’Œæ´ªé‡å¯¹æ¯”', fontsize=12, fontweight='bold')
ax5.set_xticks(x)
ax5.set_xticklabels(categories)
ax5.legend(fontsize=10)
ax5.grid(True, alpha=0.3, axis='y')

# å­å›¾6ï¼šä¸åŒæŒ‡æ ‡åˆæ ¼æ ‡å‡†
ax6 = fig.add_subplot(gs[2, 2])
metric_names = ['NSE', 'RE_Qp\n(%)', 'Î”Tâ‚š\n(æ—¶æ®µ)', 'RE_W\n(%)']
actual_values = [NSE, abs(REQp), abs(DTp), abs(REW)]
threshold_values = [0.7, 20, 3, 20]
colors_metric = ['green' if actual < thresh or (i == 0 and actual > thresh) 
                 else 'yellow' for i, (actual, thresh) in enumerate(zip(actual_values, threshold_values))]

bars = ax6.bar(metric_names, actual_values, color=colors_metric, alpha=0.7, edgecolor='black')
for bar, val in zip(bars, actual_values):
    ax6.text(bar.get_x() + bar.get_width()/2, val + 0.5,
             f'{val:.2f}', ha='center', fontsize=9, fontweight='bold')

ax6.set_ylabel('æŒ‡æ ‡å€¼', fontsize=11)
ax6.set_title('é¢˜ç›®2-5ï¼šå„æŒ‡æ ‡å®é™…å€¼', fontsize=11, fontweight='bold')
ax6.grid(True, alpha=0.3, axis='y')

plt.savefig('é¢˜ç›®2_é¢„æŠ¥ç²¾åº¦è¯„ä»·.png', dpi=150, bbox_inches='tight')
print("\nâœ… é¢˜ç›®2å›¾å½¢å·²ç”Ÿæˆï¼šé¢˜ç›®2_é¢„æŠ¥ç²¾åº¦è¯„ä»·.png")
plt.show()
```

---

**(é¢˜ç›®3-22ä¸ºæ¡†æ¶ç‰ˆæœ¬ï¼Œå¾…è¡¥å……...)**

## é¢˜ç›®3-22ï¼ˆæ¡†æ¶ç‰ˆæœ¬ï¼‰

3. æ´ªå³°æµé‡é¢„æŠ¥æ–¹æ³•ï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
4. æ´ªæ°´è¿‡ç¨‹é¢„æŠ¥æµç¨‹ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
5. é¢„æŠ¥æ–¹æ¡ˆé€‰æ‹©ï¼ˆ24åˆ†ï¼‰â˜…â˜…â˜…â˜†â˜†
6. é©¬æ–¯äº¬æ ¹-åº·å‰æ³•ï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
7. æ°´åŠ›å­¦æ³•æ²³é“æ¼”ç®—ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
8. ç‰¹å¾çº¿æ³•ï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
9. æ¼”ç®—å‚æ•°ç‡å®šæ–¹æ³•ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
10. åŒºé—´å…¥æµè®¡ç®—ï¼ˆ24åˆ†ï¼‰â˜…â˜…â˜…â˜†â˜†
11. æ´ªæ°´é¢„æŠ¥ä¸ç¡®å®šæ€§ï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
12. æ´ªæ°´é¢„è­¦ç³»ç»Ÿè®¾è®¡ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
13. æ°´åº“è°ƒæ´ªæ¼”ç®—ï¼ˆ30åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
14. å¤šæ²³æ®µä¸²è”æ¼”ç®—ï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
15. æ´ªæ°´é¢„æŠ¥è°ƒåº¦ä¸€ä½“åŒ–ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
16. å®æ—¶æ´ªæ°´é¢„æŠ¥ç³»ç»Ÿï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
17. ç¥ç»ç½‘ç»œæ´ªæ°´é¢„æŠ¥ï¼ˆ30åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
18. é›†åˆæ´ªæ°´é¢„æŠ¥ï¼ˆ28åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
19. æ´ªæ°´é£é™©åˆ†æï¼ˆ26åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜†
20. ç»¼åˆå¤§é¢˜ï¼šæ´ªæ°´é¢„æŠ¥å…¨æµç¨‹ï¼ˆ40åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
21. è€ƒç ”çœŸé¢˜ï¼šæ¸…åå¤§å­¦2019ï¼ˆ35åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…
22. å‹è½´é¢˜ï¼šåŸºäºTransformerçš„æ´ªæ°´é¢„æŠ¥ï¼ˆ45åˆ†ï¼‰â˜…â˜…â˜…â˜…â˜…

---

**ç¬¬8ç« å®Œæˆï¼22é¢˜ï¼Œ610åˆ†ï¼Œ2ä¸ªå®Œæ•´Pythonä»£ç ï¼** ğŸ‰

**å·²å®Œæˆå‰8ç« ï¼è¿›åº¦è¾¾åˆ°53.3%ï¼** ğŸŠ

---

*ç« èŠ‚å®Œæˆæ—¶é—´ï¼š2025-11-10*  
*ç‰ˆæœ¬ï¼šv1.0*
