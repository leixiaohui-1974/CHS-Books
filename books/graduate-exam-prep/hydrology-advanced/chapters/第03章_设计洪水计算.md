# 第03章 设计洪水计算

**本章概述**：
设计洪水是水利工程规划设计的重要依据。本章重点讨论由流量资料和暴雨资料推求设计洪水的方法，包括频率分析法、推理公式法、地区综合法等，以及设计洪水过程线的推求和放大、可能最大洪水（PMF）的估算等内容。

**学习目标**：
1. 掌握由流量资料推求设计洪水的频率分析方法
2. 熟练应用由暴雨资料推求设计洪水的推理公式法
3. 理解设计洪峰流量经验公式的应用条件
4. 掌握设计洪水过程线的推求与放大方法
5. 了解可能最大洪水（PMF）的概念与计算
6. 能够进行设计洪水的综合分析与合理性检验

**考点分布**：
- 频率分析法：⭐⭐⭐⭐⭐（必考，核心方法）
- 推理公式法：⭐⭐⭐⭐⭐（必考，重要方法）
- 设计洪水过程线：⭐⭐⭐⭐（高频考点）
- 经验公式法：⭐⭐⭐（中频考点）
- 可能最大洪水：⭐⭐⭐（中频考点）

**本章结构**：
- 题1-5：基础题（频率分析、推理公式基础）
- 题6-10：进阶题（过程线推求、综合应用）
- 题11-15：综合题（设计方案比较、PMF计算）

**总分值**：400分

---

## 题1：设计洪峰流量频率分析（25分）⭐⭐⭐⭐⭐

**难度**：⭐⭐⭐
**考频**：⭐⭐⭐⭐⭐（必考基础题）
**分值**：25分
**考查重点**：P-III型频率曲线、设计洪峰流量计算

### 题目

某水库坝址处有1980-2020年共41年的洪峰流量观测资料，经一致性检验合格。现需推求该坝址不同频率的设计洪峰流量，作为水库防洪设计的依据。

**洪峰流量系列统计参数**：
- 系列长度：n = 41年
- 多年平均洪峰流量：Q̄ = 3850 m³/s
- 标准差：σQ = 1240 m³/s
- 变差系数：Cv = 0.322
- 实测最大洪峰：Qmax = 7820 m³/s（1998年）
- 实测最小洪峰：Qmin = 1650 m³/s（2006年）

**要求**：
1. （8分）确定偏态系数Cs，说明确定方法及理由
2. （10分）采用P-III型曲线，计算频率P = 0.1%、1%、2%、5%、10%的设计洪峰流量
3. （7分）进行合理性检验，评价计算结果的可靠性

---

### 详细解答

#### **第（1）问：确定偏态系数Cs（8分）**

**步骤1：Cs确定方法**

确定偏态系数Cs有三种方法：

**方法1：矩法公式**
```
Cs = [n × ΣK³] / [(n-1)(n-2) × Cv³]

其中：K = Q/Q̄ (模比系数)
```

**方法2：适线法**
```
Cs = a × Cv  (经验关系)

常用：Cs = 2Cv 或 Cs = 3.5Cv
```

**方法3：地区经验**
根据本地区历史资料统计的Cs/Cv关系

**【踩分点1】**：列举Cs确定方法（3分）

---

**步骤2：本题推荐方法**

由于题目未给出各年洪峰流量详细数据，**无法使用矩法**。

采用**适线法**确定Cs：

**洪峰流量系列的经验关系**：
- 湿润地区：Cs/Cv = 2 ~ 3
- 半湿润区：Cs/Cv = 3 ~ 4
- 半干旱区：Cs/Cv = 4 ~ 6

**水文规范推荐**（SL44-2006）：
对于年最大洪峰流量系列，通常取：
```
Cs = 3.5 × Cv
```

本题计算：
```
Cs = 3.5 × Cv = 3.5 × 0.322 = 1.127
```

**圆整**：Cs = **1.13**

**Cs/Cv = 1.13 / 0.322 = 3.51** ✓

**【踩分点2】**：选择适线法并计算Cs（3分）

---

**步骤3：合理性分析**

**Cs值合理性判断**：

1. **经验范围检验**：
   - Cs/Cv = 3.51，在3~4之间
   - 属于半湿润区特征 ✓

2. **偏态系数意义**：
   - Cs = 1.13 > 0：**正偏态分布**
   - 说明：大洪水离开均值较远，小洪水相对集中
   - 符合洪水系列的一般规律 ✓

3. **Cv值特征**：
   - Cv = 0.322：**中等变率**
   - 说明洪峰年际变化中等

**【踩分点3】**：分析Cs合理性（2分）

---

#### **第（2）问：设计洪峰流量计算（10分）**

**步骤1：P-III型频率曲线公式**

```
QP = Q̄ × (1 + Cv × ΦP)
```

其中：
- QP：频率为P的设计洪峰流量（m³/s）
- ΦP：模比系数离差，查《P-III型频率计算表》
- 查表参数：Cv、Cs/Cv、P

**【踩分点1】**：写出P-III型公式（2分）

---

**步骤2：查表确定ΦP值**

已知：Cv = 0.322，Cs/Cv = 3.51

查《P-III型曲线模比系数表》：

**方法**：对Cv = 0.30和Cv = 0.35进行内插

| 频率P | Cv=0.30 | Cv=0.35 | **Cv=0.322**(内插) |
|-------|---------|---------|-------------------|
| 0.1% | 5.68 | 6.15 | **5.89** |
| 1% | 4.12 | 4.45 | **4.27** |
| 2% | 3.62 | 3.91 | **3.75** |
| 5% | 3.02 | 3.25 | **3.12** |
| 10% | 2.56 | 2.75 | **2.64** |

**内插公式**（以P=0.1%为例）：
```
Φ0.1%(0.322) = Φ0.1%(0.30) + [Φ0.1%(0.35) - Φ0.1%(0.30)] × (0.322-0.30)/(0.35-0.30)
              = 5.68 + (6.15 - 5.68) × 0.44
              = 5.68 + 0.21
              = 5.89
```

**【踩分点2】**：正确查表并内插（3分）

---

**步骤3：计算各频率设计值**

**P = 0.1%（千年一遇）**：
```
Q0.1% = Q̄ × (1 + Cv × Φ0.1%)
      = 3850 × (1 + 0.322 × 5.89)
      = 3850 × (1 + 1.897)
      = 3850 × 2.897
      = 11,153 m³/s
```

**P = 1%（百年一遇）**：
```
Q1% = 3850 × (1 + 0.322 × 4.27)
    = 3850 × (1 + 1.375)
    = 3850 × 2.375
    = 9,144 m³/s
```

**P = 2%（五十年一遇）**：
```
Q2% = 3850 × (1 + 0.322 × 3.75)
    = 3850 × (1 + 1.208)
    = 3850 × 2.208
    = 8,501 m³/s
```

**P = 5%（二十年一遇）**：
```
Q5% = 3850 × (1 + 0.322 × 3.12)
    = 3850 × (1 + 1.005)
    = 3850 × 2.005
    = 7,719 m³/s
```

**P = 10%（十年一遇）**：
```
Q10% = 3850 × (1 + 0.322 × 2.64)
     = 3850 × (1 + 0.850)
     = 3850 × 1.850
     = 7,123 m³/s
```

**【踩分点3】**：正确计算各频率设计值（4分）

---

**步骤4：结果汇总**

| 频率P | 重现期T | 模比系数ΦP | 设计洪峰QP(m³/s) | 模比系数KP |
|-------|---------|-----------|----------------|-----------|
| 0.1% | 1000年 | 5.89 | **11,153** | 2.90 |
| 1% | 100年 | 4.27 | **9,144** | 2.38 |
| 2% | 50年 | 3.75 | **8,501** | 2.21 |
| 5% | 20年 | 3.12 | **7,719** | 2.00 |
| 10% | 10年 | 2.64 | **7,123** | 1.85 |

**【踩分点4】**：汇总整理结果（1分）

---

#### **第（3）问：合理性检验（7分）**

**步骤1：实测资料对比检验**

**检验1：极值合理性**

实测最大洪峰：Qmax = 7820 m³/s（1998年）

对比设计值：
- Q10% = 7123 m³/s < Qmax ✓
- Q5% = 7719 m³/s < Qmax ✓
- Q2% = 8501 m³/s > Qmax ✓

**分析**：
- 实测最大值介于P=5%和P=10%之间
- 41年系列中，最大值的经验频率≈2.4%（排序第1，n=41）
- 理论P=5%对应20年一遇，41年中出现合理 ✓

**【踩分点1】**：进行极值对比（2分）

---

**检验2：经验频率点对比**

将实测系列按大小排序，计算经验频率：
```
Pm = m / (n+1) × 100%

m：由大到小排序序号
```

理论上：
- m=1: P1 = 1/(41+1) = 2.4% → Q理论 ≈ 8200 m³/s
- 实测最大值7820 m³/s，略小于理论值
- 符合频率分布规律 ✓

**【踩分点2】**：经验频率检验（2分）

---

**步骤2：统计参数精度检验**

**抽样误差**：
```
δQ̄ = Cv / √n × 100%
    = 0.322 / √41 × 100%
    = 0.322 / 6.403 × 100%
    = 5.03%
```

**规范要求**（大型工程）：δQ̄ ≤ 10%
**评价**：5.03% < 10%，精度满足要求 ✓

**系列长度**：
- n = 41年 > 30年（大型工程要求）
- 系列长度充足 ✓

**【踩分点3】**：精度检验（2分）

---

**步骤3：综合评价**

**可靠性评价**：

**优点**：
1. ✓ 系列长度41年，超过规范要求
2. ✓ 统计参数精度满足大型工程要求
3. ✓ 计算结果与实测资料吻合良好
4. ✓ Cs/Cv = 3.51，符合地区经验

**不足**：
1. ⚠ Cs采用适线法，有一定主观性
2. ⚠ 41年系列对于推求千年一遇洪水偏短
3. ⚠ 未考虑特大历史洪水资料

**可靠性等级**：**良好**

**建议**：
1. 对于千年一遇设计标准（P=0.1%），建议：
   - 调查历史洪水，延长系列
   - 与地区综合法结果对比
   - 适当留有安全裕度

2. 对于百年一遇及以下标准（P≥1%），计算结果可靠，可直接采用

**【踩分点4】**：综合评价可靠性（1分）

---

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams
from scipy.stats import pearson3

# 中文显示设置
rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# 统计参数
n = 41
Q_mean = 3850  # m³/s
sigma_Q = 1240
Cv = 0.322
Cs = 3.5 * Cv  # 1.127
Qmax = 7820
Qmin = 1650

# 频率和模比系数
frequencies = [0.001, 0.01, 0.02, 0.05, 0.10, 0.20, 0.50]
Phi_values = [5.89, 4.27, 3.75, 3.12, 2.64, 2.04, 1.00]  # 查表值

# 计算设计洪峰流量
Q_design = Q_mean * (1 + Cv * np.array(Phi_values))

print("="*80)
print("设计洪峰流量频率分析")
print("="*80)
print(f"\n【统计参数】")
print(f"  系列长度: n = {n}年")
print(f"  多年平均洪峰: Q̄ = {Q_mean} m³/s")
print(f"  标准差: σ = {sigma_Q} m³/s")
print(f"  变差系数: Cv = {Cv}")
print(f"  偏态系数: Cs = {Cs:.3f} (适线法: Cs=3.5Cv)")
print(f"  Cs/Cv = {Cs/Cv:.2f}")

print(f"\n【设计洪峰流量】")
for i, (P, Phi, Q) in enumerate(zip(frequencies, Phi_values, Q_design)):
    T = 1 / P
    K = Q / Q_mean
    print(f"  P={P*100:5.1f}% (T={T:>4.0f}年): Φ={Phi:4.2f}, Q={Q:>7.0f} m³/s, K={K:.2f}")

# 抽样误差
delta_Q = Cv / np.sqrt(n) * 100
print(f"\n【精度检验】")
print(f"  均值抽样误差: δQ̄ = {delta_Q:.2f}% < 10% ✓")
print(f"  系列长度: {n}年 > 30年 ✓")

# 实测资料对比
print(f"\n【合理性检验】")
print(f"  实测最大洪峰: {Qmax} m³/s (1998年)")
print(f"  经验频率: Pm ≈ 1/(41+1) = 2.4%")
print(f"  理论Q2% = {Q_design[2]:.0f} m³/s")
print(f"  偏差: {(Q_design[2]-Qmax)/Qmax*100:+.1f}%")

# 可视化
fig = plt.figure(figsize=(18, 12))

# 图1：频率曲线（概率坐标纸）
ax1 = plt.subplot(2, 3, 1)

# 扩展频率范围用于绘制完整曲线
P_range = np.array([0.01, 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 30, 50, 70, 80, 90, 95, 99]) / 100
# 内插获得完整Phi值
Phi_range = np.interp(np.log(P_range), np.log(frequencies), Phi_values)
Q_range = Q_mean * (1 + Cv * Phi_range)

ax1.semilogx(P_range * 100, Q_range, 'b-', linewidth=2.5, label='P-III理论曲线')

# 标注设计点
design_P = [0.001, 0.01, 0.02, 0.05, 0.10]
design_Q = [Q_design[i] for i in range(5)]
ax1.scatter([p*100 for p in design_P], design_Q, s=150, color='red',
            zorder=5, marker='*', label='设计值')

# 标注数值
for p, q in zip(design_P, design_Q):
    if p <= 0.01:
        ax1.text(p*100, q+200, f'{q:.0f}', ha='center', fontsize=9, fontweight='bold')
    else:
        ax1.text(p*100, q-200, f'{q:.0f}', ha='center', va='top', fontsize=9, fontweight='bold')

# 实测最大值
ax1.scatter([2.4], [Qmax], s=200, color='green', marker='^',
            label=f'实测最大值({Qmax} m³/s)', zorder=4)
ax1.text(2.4, Qmax+300, 'Qmax\n1998年', ha='center', fontsize=9, color='green', fontweight='bold')

ax1.axhline(y=Q_mean, color='gray', linestyle='--', linewidth=1.5, alpha=0.7, label=f'均值={Q_mean}')
ax1.set_xlabel('频率 P (%)', fontsize=12)
ax1.set_ylabel('洪峰流量 (m³/s)', fontsize=12)
ax1.set_title('设计洪峰流量频率曲线', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10, loc='upper right')
ax1.grid(True, alpha=0.3, which='both')
ax1.set_xlim(0.05, 100)
ax1.invert_xaxis()

# 图2：模比系数KP曲线
ax2 = plt.subplot(2, 3, 2)
K_design = Q_design / Q_mean
K_range = Q_range / Q_mean

ax2.semilogx(P_range * 100, K_range, 'b-', linewidth=2.5, label='模比系数曲线')
ax2.scatter([p*100 for p in design_P], [K_design[i] for i in range(5)],
            s=150, color='red', zorder=5, marker='*')

for p, k in zip(design_P[:5], K_design[:5]):
    ax2.text(p*100, k+0.05, f'{k:.2f}', ha='center', fontsize=9)

ax2.axhline(y=1.0, color='red', linestyle='--', linewidth=1.5, alpha=0.7, label='KP=1')
ax2.set_xlabel('频率 P (%)', fontsize=12)
ax2.set_ylabel('模比系数 KP = QP/Q̄', fontsize=12)
ax2.set_title('模比系数曲线', fontsize=14, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, alpha=0.3, which='both')
ax2.set_xlim(0.05, 100)
ax2.invert_xaxis()

# 图3：重现期与洪峰关系
ax3 = plt.subplot(2, 3, 3)
T_values = 1 / np.array(frequencies)
ax3.plot(T_values, Q_design, 'go-', linewidth=2.5, markersize=10, label='设计洪峰')

for T, Q in zip([10, 20, 50, 100, 1000], [Q_design[4], Q_design[3], Q_design[2], Q_design[1], Q_design[0]]):
    ax3.text(T, Q+150, f'{Q:.0f}', ha='center', va='bottom', fontsize=9, fontweight='bold')

ax3.axhline(y=Qmax, color='green', linestyle='--', linewidth=2, label=f'实测最大={Qmax}')
ax3.set_xlabel('重现期 T (年)', fontsize=12)
ax3.set_ylabel('洪峰流量 (m³/s)', fontsize=12)
ax3.set_title('重现期与洪峰流量关系', fontsize=14, fontweight='bold')
ax3.set_xscale('log')
ax3.legend(fontsize=10)
ax3.grid(True, alpha=0.3, which='both')

# 图4：Cs/Cv关系
ax4 = plt.subplot(2, 3, 4)
Cs_Cv_values = np.linspace(2, 6, 50)
Cs_values = Cv * Cs_Cv_values

ax4.plot(Cs_Cv_values, Cs_values, 'b-', linewidth=2, label='Cs = Cv × (Cs/Cv)')
ax4.scatter([Cs/Cv], [Cs], s=200, color='red', marker='*', zorder=5, label=f'本题: Cs/Cv={Cs/Cv:.2f}')
ax4.axvline(x=3.5, color='orange', linestyle='--', linewidth=1.5, label='推荐值: Cs/Cv=3.5')
ax4.fill_between([3, 4], 0, 2, alpha=0.2, color='green', label='半湿润区(3~4)')

ax4.text(Cs/Cv, Cs+0.05, f'  Cs={Cs:.3f}', ha='left', va='bottom',
         fontsize=10, color='red', fontweight='bold')

ax4.set_xlabel('Cs/Cv', fontsize=12)
ax4.set_ylabel('偏态系数 Cs', fontsize=12)
ax4.set_title('偏态系数Cs确定', fontsize=14, fontweight='bold')
ax4.legend(fontsize=9)
ax4.grid(True, alpha=0.3)
ax4.set_xlim(2, 6)
ax4.set_ylim(0, 2)

# 图5：精度分析
ax5 = plt.subplot(2, 3, 5)
n_range = np.arange(10, 100, 1)
delta_range = Cv / np.sqrt(n_range) * 100

ax5.plot(n_range, delta_range, 'b-', linewidth=2.5, label='δQ̄(n)')
ax5.axhline(y=5, color='green', linestyle='--', linewidth=2, label='优秀线(5%)')
ax5.axhline(y=10, color='orange', linestyle='--', linewidth=2, label='合格线(10%)')
ax5.scatter([n], [delta_Q], s=200, color='red', marker='o', zorder=5, label=f'本题: n={n}')
ax5.text(n+2, delta_Q, f'  {delta_Q:.2f}%', ha='left', va='center',
         fontsize=10, color='red', fontweight='bold')

ax5.fill_between([30, 100], 0, 15, alpha=0.1, color='green', label='大型工程要求(n≥30)')
ax5.axvline(x=30, color='gray', linestyle=':', linewidth=1.5)
ax5.text(30, 12, '←大型工程', ha='right', fontsize=9, color='gray')

ax5.set_xlabel('系列长度 n (年)', fontsize=12)
ax5.set_ylabel('均值抽样误差 δQ̄ (%)', fontsize=12)
ax5.set_title('统计参数精度分析', fontsize=14, fontweight='bold')
ax5.legend(fontsize=9)
ax5.grid(True, alpha=0.3)
ax5.set_xlim(10, 100)
ax5.set_ylim(0, 15)

# 图6：结果汇总表
ax6 = plt.subplot(2, 3, 6)
ax6.axis('off')

summary_text = f"""
╔════════════════════════════════════════════════════════════╗
║           设计洪峰流量频率分析结果汇总                       ║
╠════════════════════════════════════════════════════════════╣
║ 一、统计参数                                                ║
║   • 系列长度: n = {n}年                                     ║
║   • 多年平均: Q̄ = {Q_mean} m³/s                           ║
║   • 变差系数: Cv = {Cv}                                    ║
║   • 偏态系数: Cs = {Cs:.3f} (适线法: 3.5Cv)               ║
║   • Cs/Cv = {Cs/Cv:.2f} (半湿润区特征)                    ║
║                                                            ║
║ 二、设计洪峰流量                                            ║
║   • P=0.1% (1000年): {Q_design[0]:>7.0f} m³/s            ║
║   • P=1%   ( 100年): {Q_design[1]:>7.0f} m³/s            ║
║   • P=2%   (  50年): {Q_design[2]:>7.0f} m³/s            ║
║   • P=5%   (  20年): {Q_design[3]:>7.0f} m³/s            ║
║   • P=10%  (  10年): {Q_design[4]:>7.0f} m³/s            ║
║                                                            ║
║ 三、精度检验                                                ║
║   • 抽样误差: δQ̄ = {delta_Q:.2f}% ✓ (<10%)               ║
║   • 系列长度: {n}年 ✓ (>30年)                              ║
║                                                            ║
║ 四、合理性检验                                              ║
║   • 实测最大: {Qmax} m³/s (1998年)                        ║
║   • 经验频率: ≈2.4% (排序第1/41)                           ║
║   • 理论Q2%: {Q_design[2]:.0f} m³/s                       ║
║   • 偏差: {(Q_design[2]-Qmax)/Qmax*100:+.1f}%             ║
║   • 评价: 吻合良好 ✓                                       ║
║                                                            ║
║ 五、可靠性评价                                              ║
║   • 等级: 良好                                             ║
║   • P≥1%设计值: 可直接采用                                 ║
║   • P=0.1%设计值: 建议调查历史洪水验证                     ║
║   • 建议: 与地区综合法对比,留安全裕度                       ║
╚════════════════════════════════════════════════════════════╝
"""

ax6.text(0.05, 0.95, summary_text, transform=ax6.transAxes,
         fontsize=10, verticalalignment='top', family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.8))

plt.tight_layout()
plt.savefig('设计洪峰流量频率分析.png', dpi=300, bbox_inches='tight')
plt.show()

print("="*80)
print("分析完成！")
print("="*80)
```

---

### 答案总结

#### **第（1）问答案**：

**偏态系数确定**：
- **方法**：适线法（Cs = 3.5 × Cv）
- **计算**：Cs = 3.5 × 0.322 = **1.13**
- **Cs/Cv** = 3.51（符合半湿润区特征）

#### **第（2）问答案**：

| 频率P | 重现期T | 设计洪峰QP (m³/s) |
|-------|---------|------------------|
| 0.1% | 1000年 | **11,153** |
| 1% | 100年 | **9,144** |
| 2% | 50年 | **8,501** |
| 5% | 20年 | **7,719** |
| 10% | 10年 | **7,123** |

#### **第（3）问答案**：

**合理性检验结论**：
1. ✓ 实测最大值7820 m³/s与理论值吻合良好（介于P=5%和P=10%之间）
2. ✓ 统计参数精度满足要求（δQ̄=5.03% < 10%）
3. ✓ 系列长度充足（41年 > 30年）

**可靠性等级**：**良好**

**建议**：P≥1%设计值可直接采用；P=0.1%建议调查历史洪水验证

---

### 本题考点总结

**核心考点**：
1. ⭐⭐⭐⭐⭐ P-III型频率曲线应用
2. ⭐⭐⭐⭐⭐ 偏态系数Cs确定（适线法）
3. ⭐⭐⭐⭐ 设计洪峰流量计算
4. ⭐⭐⭐⭐ 合理性检验方法

**易错点**：
1. ❌ **Cs确定方法选择错误** - 无详细数据时不能用矩法
2. ❌ **Φ值查表错误** - 需要双参数（Cv和Cs/Cv）内插
3. ❌ **合理性检验不全面** - 要从多角度检验
4. ❌ **频率和重现期混淆** - P=1%是百年一遇，不是1年

**答题技巧**：
1. Cs确定优先用适线法（Cs=3.5Cv）
2. 查表要细心，注意内插计算
3. 合理性检验至少3个方面
4. 结果要汇总成表格，清晰明了

---

## 题2：推理公式法推求设计洪水（28分）⭐⭐⭐⭐⭐

**难度**：⭐⭐⭐⭐
**考频**：⭐⭐⭐⭐⭐（必考重点）
**分值**：28分
**考查重点**：推理公式、设计暴雨、产汇流参数

### 题目

某小流域面积F = 256 km²，主河道长度L = 24 km，平均坡降J = 0.008。该流域缺乏流量观测资料，需采用推理公式法推求设计洪峰流量。

**设计暴雨参数**（P=1%，查地区暴雨图集）：
- 1小时点雨量：H₁ = 82 mm
- 24小时点雨量：H₂₄ = 186 mm
- 点面折减系数：ψF = 0.92
- 暴雨递减指数：n = 0.68

**流域参数**：
- 暴雨损失参数：μ = 0.65（径流系数）
- 汇流参数：m = 0.28（汇流参数）
- 地形系数：θ = 2.5

**要求**：
1. （10分）计算设计净雨强度和暴雨历时，确定最不利历时τ
2. （10分）采用推理公式计算设计洪峰流量Q₁%
3. （8分）分析主要参数对洪峰流量的敏感性

---

### 详细解答

#### **第（1）问：设计净雨强度与暴雨历时（10分）**

**步骤1：推理公式法原理**

**推理公式**（Rational Formula）：
```
Qm = 0.278 × φ × i × F

其中：
Qm：设计洪峰流量 (m³/s)
φ：径流系数 (无量纲)
i：设计净雨强度 (mm/h)
F：流域面积 (km²)
0.278：单位换算系数
```

**关键**：设计暴雨历时τ应等于流域汇流时间τc，此时洪峰流量最大。

**【踩分点1】**：阐述推理公式原理（2分）

---

**步骤2：计算汇流时间**

**汇流时间公式**（经验公式）：
```
τc = m × L / √J

其中：
τc：汇流时间 (h)
m：汇流参数（经验系数）
L：主河道长度 (km)
J：主河道平均坡降
```

代入数据：
```
τc = 0.28 × 24 / √0.008
   = 6.72 / 0.0894
   = 75.2 小时

取整：τc ≈ 75 h ≈ 3.1 天
```

这个结果明显不合理！对于256 km²的小流域，汇流时间不可能达到3天。

**修正**：公式应为：
```
τc = m × L^0.3 / J^0.2  (常用公式)
```

重新计算：
```
τc = 0.28 × 24^0.3 / 0.008^0.2
   = 0.28 × 2.88 / 0.345
   = 0.806 / 0.345
   = 2.34 小时
```

**汇流时间**：τc = **2.3 h**

**【踩分点2】**：正确计算汇流时间（3分）

---

**步骤3：计算设计暴雨强度**

**暴雨强度公式**（递减公式）：
```
it = H₁ / (t^n)

其中：
it：历时t的暴雨强度 (mm/h)
H₁：1小时点雨量 (mm)
t：暴雨历时 (h)
n：暴雨递减指数
```

**方法1：直接计算t=τc时的强度**

对于τ = 2.3 h：
```
i₂.₃ = H₁ × τ₁ⁿ / τⁿ
     = 82 × 1^0.68 / 2.3^0.68
     = 82 / 1.77
     = 46.3 mm/h
```

**方法2：暴雨公式一般形式**

```
Ht = H₁ × (t/1)^(1-n) = H₁ × t^(1-n)

对于t=2.3h:
H₂.₃ = 82 × 2.3^(1-0.68)
     = 82 × 2.3^0.32
     = 82 × 1.29
     = 105.8 mm

i₂.₃ = H₂.₃ / τ = 105.8 / 2.3 = 46.0 mm/h
```

**点面折减**：
```
i面 = i₂.₃ × ψF
    = 46.0 × 0.92
    = 42.3 mm/h
```

**设计暴雨强度**：i = **42.3 mm/h**

**【踩分点3】**：正确计算暴雨强度（3分）

---

**步骤4：确定最不利历时**

**概念**：最不利历时是使洪峰流量达到最大的暴雨历时。

**理论分析**：

推理公式：Qm ∝ i × F

暴雨强度：i ∝ 1/τⁿ (τ增大，i减小)

- 当τ < τc：部分流域来水未到达出口，Q < Qmax
- 当τ = τc：全流域同时出流，Q = Qmax（最不利）
- 当τ > τc：虽然全流域出流，但i减小，Q下降

**结论**：最不利历时 **τ = τc = 2.3 h**

**验证**（试算τ=1h和τ=3h）：

τ=1h：
```
i₁ = 82 × 0.92 = 75.4 mm/h
但τ < τc，流域未充分汇流
```

τ=3h：
```
i₃ = 82 × 3^(1-0.68) × 0.92 / 3 = 39.2 mm/h < 42.3
```

**最不利历时**：τ = **2.3 h**

**【踩分点4】**：分析并确定最不利历时（2分）

---

#### **第（2）问：设计洪峰流量计算（10分）**

**步骤1：推理公式法**

**公式**：
```
Qm = 0.278 × φ × i × F
```

**参数确定**：
- φ = μ = 0.65（径流系数）
- i = 42.3 mm/h（设计暴雨强度）
- F = 256 km²（流域面积）

**【踩分点1】**：明确公式和参数（2分）

---

**步骤2：计算设计洪峰**

```
Q₁% = 0.278 × 0.65 × 42.3 × 256
    = 0.278 × 7046.4
    = 1959 m³/s
```

**设计洪峰流量**：Q₁% = **1959 m³/s** ≈ **1960 m³/s**

**【踩分点2】**：正确计算洪峰流量（3分）

---

**步骤3：合理性检验**

**检验1：经验公式对比**

采用简化公式估算：
```
qm = Q / F = 1959 / 256 = 7.65 m³/(s·km²)
```

经验值（查手册）：
- 小流域（F<300km²），P=1%
- 丰水区：qm = 5~15 m³/(s·km²)

本题：qm = 7.65，在合理范围内 ✓

**【踩分点3】**：进行经验公式对比（2分）

---

**检验2：洪峰模数合理性**

洪峰模数与流域面积关系：
```
qm ∝ F^(-α)  (α ≈ 0.2~0.3)
```

对于F=256 km²的流域：
- qm = 7.65 m³/(s·km²)属于正常范围
- 如果F=100 km²，qm应更大（约10~12）
- 如果F=1000 km²，qm应更小（约4~6）

**【踩分点4】**：分析洪峰模数合理性（2分）

---

**检验3：与地区综合法对比**

若查《区域水文手册》：
- 该地区F=256 km²，P=1%
- 推荐值：Q₁% = 1800~2100 m³/s
- 本题计算：1960 m³/s，在推荐范围内 ✓

**【踩分点5】**：综合评价（1分）

---

#### **第（3）问：参数敏感性分析（8分）**

**步骤1：敏感性分析方法**

**定义**：参数变化对计算结果的影响程度。

**敏感系数**：
```
S = (ΔQ/Q) / (Δx/x) = ∂Q/Q / ∂x/x

其中：
x：某参数
ΔQ：Q的变化量
Δx：x的变化量
```

|S| > 1：高度敏感
0.5 < |S| < 1：中度敏感
|S| < 0.5：低度敏感

**【踩分点1】**：阐述敏感性分析方法（2分）

---

**步骤2：各参数敏感性**

推理公式：Qm = 0.278 × φ × i × F

分析各参数：

**(1) 径流系数φ的敏感性**

```
Qm ∝ φ  (线性关系)

S_φ = ∂Qm/∂φ × φ/Qm = 1
```

φ变化±10%：
```
φ=0.65×1.1 = 0.715: Q = 2155 m³/s (+10%)
φ=0.65×0.9 = 0.585: Q = 1763 m³/s (-10%)
```

**敏感系数**：S_φ = **1.0**（高度敏感）

**【踩分点2】**：分析φ的敏感性（2分）

---

**(2) 暴雨强度i的敏感性**

```
Qm ∝ i  (线性关系)

S_i = 1
```

i变化±10%：
```
i=42.3×1.1 = 46.5: Q = 2155 m³/s (+10%)
i=42.3×0.9 = 38.1: Q = 1763 m³/s (-10%)
```

**敏感系数**：S_i = **1.0**（高度敏感）

但i又受多个因素影响：
- 暴雨递减指数n
- 汇流时间τc
- 点面折减系数ψF

间接影响复杂。

**【踩分点3】**：分析i的敏感性（2分）

---

**(3) 汇流时间τc的敏感性**

```
i ∝ 1/τⁿ  →  Qm ∝ 1/τⁿ

S_τ = -n = -0.68
```

τc变化±10%：
```
τc=2.3×1.1=2.53h: i=40.5, Q=1876 m³/s (-4.2%)
τc=2.3×0.9=2.07h: i=44.4, Q=2057 m³/s (+5.0%)
```

实际变化：±10%τ → ∓6.8%i → ∓6.8%Q

**敏感系数**：S_τ = **-0.68**（中度敏感）

**【踩分点4】**：分析τc的敏感性（2分）

---

**步骤3：敏感性排序**

| 参数 | 敏感系数S | 敏感程度 | 备注 |
|------|-----------|---------|------|
| 径流系数φ | 1.0 | **高** | 直接线性影响 |
| 暴雨强度i | 1.0 | **高** | 直接线性影响 |
| 流域面积F | 1.0 | **高** | 直接线性影响（但通常固定）|
| 汇流时间τc | -0.68 | 中 | 通过i间接影响 |
| 暴雨递减指数n | - | 中 | 影响i的计算 |
| 点面折减ψF | 1.0 | 高 | 直接影响i |

**结论**：
1. **φ和i是最敏感参数**，必须精确确定
2. τc次之，但也很重要
3. n和ψF通常查图表，误差相对较小

**实际应用建议**：
- φ：通过实测暴雨-洪水资料率定
- i：采用多年暴雨统计，频率分析法
- τc：实测洪水过程反推，或多公式对比
- 对敏感参数进行不确定性分析

---

### Python敏感性分析代码

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams

rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# 基准参数
F = 256  # km²
L = 24  # km
J = 0.008
H1 = 82  # mm
n_rain = 0.68
psi_F = 0.92
mu = 0.65
m = 0.28

# 计算汇流时间
tau_c = m * L**0.3 / J**0.2

# 计算暴雨强度
i_design = H1 * tau_c**(1-n_rain) / tau_c * psi_F

# 基准洪峰流量
Q_base = 0.278 * mu * i_design * F

print("="*80)
print("推理公式法推求设计洪水")
print("="*80)
print(f"\n【流域参数】")
print(f"  流域面积: F = {F} km²")
print(f"  河道长度: L = {L} km")
print(f"  河道坡降: J = {J}")

print(f"\n【汇流计算】")
print(f"  汇流时间: τc = {tau_c:.2f} h")

print(f"\n【暴雨计算】")
print(f"  1小时点雨量: H₁ = {H1} mm")
print(f"  暴雨递减指数: n = {n_rain}")
print(f"  点面折减系数: ψF = {psi_F}")
print(f"  设计暴雨强度: i = {i_design:.1f} mm/h")

print(f"\n【洪峰流量】")
print(f"  径流系数: φ = {mu}")
print(f"  设计洪峰: Q₁% = {Q_base:.0f} m³/s")
print(f"  洪峰模数: qm = {Q_base/F:.2f} m³/(s·km²)")

# 敏感性分析
params = {
    '径流系数φ': (mu, lambda x: 0.278 * x * i_design * F),
    '暴雨强度i': (i_design, lambda x: 0.278 * mu * x * F),
    '流域面积F': (F, lambda x: 0.278 * mu * i_design * x),
    '汇流时间τ': (tau_c, lambda x: 0.278 * mu * (H1 * x**(1-n_rain) / x * psi_F) * F),
}

print(f"\n【敏感性分析】")
print(f"  基准洪峰: Q = {Q_base:.0f} m³/s")

sensitivity = {}
for param_name, (base_val, calc_func) in params.items():
    # 计算±10%变化
    Q_plus = calc_func(base_val * 1.1)
    Q_minus = calc_func(base_val * 0.9)
    
    delta_Q_plus = (Q_plus - Q_base) / Q_base * 100
    delta_Q_minus = (Q_minus - Q_base) / Q_base * 100
    
    S = (delta_Q_plus - delta_Q_minus) / 20  # 20% = 2×10%
    sensitivity[param_name] = S
    
    print(f"\n  {param_name}:")
    print(f"    基准值: {base_val:.2f}")
    print(f"    +10%变化: {base_val*1.1:.2f} → Q={Q_plus:.0f} ({delta_Q_plus:+.1f}%)")
    print(f"    -10%变化: {base_val*0.9:.2f} → Q={Q_minus:.0f} ({delta_Q_minus:+.1f}%)")
    print(f"    敏感系数: S = {S:.2f}")

# 可视化
fig = plt.figure(figsize=(18, 12))

# 图1：推理公式法流程图
ax1 = plt.subplot(2, 3, 1)
ax1.axis('off')
flow_text = """
┌─────────────────────────────────────────┐
│         推理公式法计算流程                  │
├─────────────────────────────────────────┤
│                                         │
│  1. 确定流域参数                          │
│     F, L, J                            │
│          ↓                              │
│  2. 计算汇流时间                          │
│     τc = m·L^0.3 / J^0.2               │
│          ↓                              │
│  3. 确定设计暴雨                          │
│     i = H₁·τ^(1-n) / τ · ψF           │
│          ↓                              │
│  4. 计算设计洪峰                          │
│     Qm = 0.278·φ·i·F                   │
│          ↓                              │
│  5. 合理性检验                            │
│     • 洪峰模数                            │
│     • 地区综合法对比                       │
└─────────────────────────────────────────┘
"""
ax1.text(0.5, 0.5, flow_text, transform=ax1.transAxes,
         fontsize=11, verticalalignment='center', ha='center',
         family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))
ax1.set_title('计算流程', fontsize=14, fontweight='bold')

# 图2：暴雨强度-历时曲线
ax2 = plt.subplot(2, 3, 2)
t_range = np.linspace(0.5, 24, 100)
i_range = H1 * t_range**(1-n_rain) / t_range * psi_F

ax2.plot(t_range, i_range, 'b-', linewidth=2.5, label='i-τ曲线')
ax2.scatter([tau_c], [i_design], s=200, color='red', marker='*',
            zorder=5, label=f'设计点(τ={tau_c:.1f}h, i={i_design:.1f}mm/h)')
ax2.axvline(x=tau_c, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax2.axhline(y=i_design, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax2.text(tau_c+0.5, i_design+2, f'  最不利历时\n  τc={tau_c:.1f}h',
         fontsize=10, color='red', fontweight='bold')

ax2.set_xlabel('暴雨历时 τ (h)', fontsize=12)
ax2.set_ylabel('暴雨强度 i (mm/h)', fontsize=12)
ax2.set_title('暴雨强度-历时关系', fontsize=14, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, alpha=0.3)
ax2.set_xlim(0, 12)

# 图3：洪峰流量-历时关系
ax3 = plt.subplot(2, 3, 3)
Q_range = 0.278 * mu * i_range * F
ax3.plot(t_range, Q_range, 'g-', linewidth=2.5, label='Q-τ曲线')
ax3.scatter([tau_c], [Q_base], s=200, color='red', marker='*',
            zorder=5, label=f'最大洪峰({Q_base:.0f} m³/s)')
ax3.axvline(x=tau_c, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax3.axhline(y=Q_base, color='red', linestyle='--', linewidth=1.5, alpha=0.7)

ax3.set_xlabel('暴雨历时 τ (h)', fontsize=12)
ax3.set_ylabel('洪峰流量 Q (m³/s)', fontsize=12)
ax3.set_title('洪峰流量-历时关系', fontsize=14, fontweight='bold')
ax3.legend(fontsize=10)
ax3.grid(True, alpha=0.3)
ax3.set_xlim(0, 12)

# 图4：敏感性分析柱状图
ax4 = plt.subplot(2, 3, 4)
param_names = list(sensitivity.keys())
S_values = list(sensitivity.values())
colors = ['red' if abs(s) >= 0.9 else 'orange' if abs(s) >= 0.5 else 'green' 
          for s in S_values]

bars = ax4.barh(param_names, S_values, color=colors, alpha=0.7, edgecolor='black')
for bar, val in zip(bars, S_values):
    ax4.text(val, bar.get_y() + bar.get_height()/2, f'  {val:.2f}',
             ha='left' if val > 0 else 'right', va='center', 
             fontsize=11, fontweight='bold')

ax4.axvline(x=0, color='black', linestyle='-', linewidth=1)
ax4.axvline(x=1, color='red', linestyle='--', linewidth=1.5, alpha=0.5, label='高敏感(|S|=1)')
ax4.axvline(x=-1, color='red', linestyle='--', linewidth=1.5, alpha=0.5)
ax4.axvline(x=0.5, color='orange', linestyle=':', linewidth=1.5, alpha=0.5, label='中敏感(|S|=0.5)')
ax4.axvline(x=-0.5, color='orange', linestyle=':', linewidth=1.5, alpha=0.5)

ax4.set_xlabel('敏感系数 S', fontsize=12)
ax4.set_title('参数敏感性分析', fontsize=14, fontweight='bold')
ax4.legend(fontsize=9)
ax4.grid(True, alpha=0.3, axis='x')

# 图5：径流系数影响
ax5 = plt.subplot(2, 3, 5)
phi_range = np.linspace(0.4, 0.9, 50)
Q_phi = 0.278 * phi_range * i_design * F

ax5.plot(phi_range, Q_phi, 'b-', linewidth=2.5)
ax5.scatter([mu], [Q_base], s=200, color='red', marker='o', zorder=5)
ax5.axvline(x=mu, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax5.axhline(y=Q_base, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax5.text(mu-0.02, Q_base+50, f'φ={mu}\nQ={Q_base:.0f}', 
         ha='right', fontsize=10, color='red', fontweight='bold')

# 标注±10%范围
phi_minus = mu * 0.9
phi_plus = mu * 1.1
Q_minus = 0.278 * phi_minus * i_design * F
Q_plus = 0.278 * phi_plus * i_design * F

ax5.fill_betweenx([Q_minus, Q_plus], phi_minus, phi_plus,
                   alpha=0.2, color='yellow', label='±10%范围')
ax5.scatter([phi_minus, phi_plus], [Q_minus, Q_plus], 
            s=100, color='orange', marker='s')

ax5.set_xlabel('径流系数 φ', fontsize=12)
ax5.set_ylabel('洪峰流量 Q (m³/s)', fontsize=12)
ax5.set_title('径流系数影响分析', fontsize=14, fontweight='bold')
ax5.legend(fontsize=10)
ax5.grid(True, alpha=0.3)

# 图6：结果汇总
ax6 = plt.subplot(2, 3, 6)
ax6.axis('off')

result_text = f"""
╔══════════════════════════════════════════════════╗
║          推理公式法计算结果汇总                    ║
╠══════════════════════════════════════════════════╣
║ 一、汇流时间计算                                  ║
║   • τc = m·L^0.3 / J^0.2                        ║
║   • τc = {tau_c:.2f} h                          ║
║                                                  ║
║ 二、设计暴雨                                      ║
║   • 历时: τ = {tau_c:.2f} h (最不利)             ║
║   • 强度: i = {i_design:.1f} mm/h               ║
║                                                  ║
║ 三、设计洪峰                                      ║
║   • Qm = 0.278·φ·i·F                           ║
║   • Q₁% = {Q_base:.0f} m³/s                    ║
║   • qm = {Q_base/F:.2f} m³/(s·km²)             ║
║                                                  ║
║ 四、敏感性分析                                    ║
║   • 径流系数φ: S = {sensitivity['径流系数φ']:.2f} (高敏感)  ║
║   • 暴雨强度i: S = {sensitivity['暴雨强度i']:.2f} (高敏感)  ║
║   • 流域面积F: S = {sensitivity['流域面积F']:.2f} (高敏感)  ║
║   • 汇流时间τ: S = {sensitivity['汇流时间τ']:.2f} (中敏感)  ║
║                                                  ║
║ 五、建议                                          ║
║   • φ需实测资料率定                              ║
║   • i采用频率分析法                              ║
║   • τc多公式验证                                 ║
║   • 进行不确定性分析                              ║
╚══════════════════════════════════════════════════╝
"""

ax6.text(0.05, 0.95, result_text, transform=ax6.transAxes,
         fontsize=10.5, verticalalignment='top', family='monospace',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.8))

plt.tight_layout()
plt.savefig('推理公式法设计洪水.png', dpi=300, bbox_inches='tight')
plt.show()

print("="*80)
print("分析完成！")
print("="*80)
```

---

### 答案总结

#### **第（1）问答案**：

- **汇流时间**：τc = 2.3 h
- **设计暴雨强度**：i = 42.3 mm/h（面雨量）
- **最不利历时**：τ = τc = 2.3 h

#### **第（2）问答案**：

- **设计洪峰流量**：Q₁% = **1960 m³/s**
- **洪峰模数**：qm = 7.65 m³/(s·km²)
- **合理性**：在经验值范围内（5~15 m³/(s·km²)）✓

#### **第（3）问答案**：

**参数敏感性排序**：
1. 径流系数φ：S = 1.0（高敏感）
2. 暴雨强度i：S = 1.0（高敏感）
3. 流域面积F：S = 1.0（高敏感）
4. 汇流时间τc：S = -0.68（中敏感）

**结论**：φ和i是最敏感参数，需精确确定

---

### 本题考点总结

**核心考点**：
1. ⭐⭐⭐⭐⭐ 推理公式法原理与应用
2. ⭐⭐⭐⭐⭐ 汇流时间计算
3. ⭐⭐⭐⭐⭐ 设计暴雨强度计算
4. ⭐⭐⭐⭐ 参数敏感性分析

**易错点**：
1. ❌ **汇流时间公式选错** - 不同公式适用条件不同
2. ❌ **暴雨强度计算错误** - 注意点面折减
3. ❌ **最不利历时理解错误** - τ=τc时洪峰最大
4. ❌ **单位换算错误** - 0.278系数的来源

**答题技巧**：
1. 汇流时间要合理性检验
2. 暴雨强度计算要分步骤
3. 敏感性分析要定量计算
4. 结果要进行多方面检验

---


## 题3：设计洪水过程线的推求（26分）⭐⭐⭐⭐

**难度**：⭐⭐⭐⭐
**考频**：⭐⭐⭐⭐（高频）
**分值**：26分
**考查重点**：同频率放大法、典型洪水过程线

### 题目

某水库坝址有1980-2015年共36年的洪水资料。经频率分析，P=1%设计洪峰流量Q₁%=8500 m³/s。实测最大洪水为2010年"7.18"洪水，洪峰流量Qm=6800 m³/s，洪水总量W=5.8亿m³，洪水历时T=120小时。

**2010年"7.18"洪水过程**（部分数据，Δt=6h）：

| 时刻(h) | 0 | 6 | 12 | 18 | 24 | 30 | 36 | 42 | 48 | 54 | 60 |
|---------|---|---|----|----|----|----|----|----|----|----|-----|
| 流量(m³/s) | 280 | 850 | 2400 | 4200 | 6800 | 5600 | 4200 | 3100 | 2300 | 1700 | 1250 |

| 时刻(h) | 66 | 72 | 78 | 84 | 90 | 96 | 102 | 108 | 114 | 120 |
|---------|----|----|----|----|----|----|-----|-----|-----|-----|
| 流量(m³/s) | 920 | 680 | 520 | 400 | 320 | 260 | 220 | 190 | 170 | 150 |

**要求**：
1. （8分）选择典型洪水，计算放大倍比，推求P=1%设计洪水过程线
2. （10分）计算设计洪水的洪量、洪峰模数、峰现时间等特征值
3. （8分）分析设计洪水过程线的合理性

---

### 详细解答

#### **第（1）问：推求设计洪水过程线（8分）**

**步骤1：同频率放大法原理**

**方法**：选择实测典型洪水，按洪峰、洪量同频率放大。

**公式**：
```
Qi设计 = (Q设计/Q典型) × Qi典型 = n × Qi典型
```

其中：
- n：放大倍比
- Qi典型：典型洪水第i时段流量
- Qi设计：设计洪水第i时段流量

**【踩分点1】**：阐述同频率放大法原理（2分）

---

**步骤2：选择典型洪水**

**典型洪水选择原则**：
1. 洪峰大、洪量大
2. 洪型完整
3. 资料可靠
4. 成因与设计洪水相似

本题：**选择2010年"7.18"洪水作为典型洪水**
- 实测最大洪水 ✓
- 洪峰Qm = 6800 m³/s
- 洪水过程完整 ✓
- 资料完整可靠 ✓

**【踩分点2】**：合理选择典型洪水（2分）

---

**步骤3：计算放大倍比**

**按洪峰放大**：
```
n_Q = Q₁%设计 / Qm典型
    = 8500 / 6800
    = 1.25
```

**放大倍比**：n = **1.25**

**【踩分点3】**：正确计算放大倍比（2分）

---

**步骤4：推求设计洪水过程**

```
Qi设计 = 1.25 × Qi典型
```

**设计洪水过程线**：

| 时刻(h) | 典型洪水(m³/s) | 设计洪水(m³/s) |
|---------|---------------|---------------|
| 0 | 280 | 350 |
| 6 | 850 | 1063 |
| 12 | 2400 | 3000 |
| 18 | 4200 | 5250 |
| 24 | **6800** | **8500** |
| 30 | 5600 | 7000 |
| 36 | 4200 | 5250 |
| 42 | 3100 | 3875 |
| 48 | 2300 | 2875 |
| 54 | 1700 | 2125 |
| 60 | 1250 | 1563 |
| 66 | 920 | 1150 |
| 72 | 680 | 850 |
| 78 | 520 | 650 |
| 84 | 400 | 500 |
| 90 | 320 | 400 |
| 96 | 260 | 325 |
| 102 | 220 | 275 |
| 108 | 190 | 238 |
| 114 | 170 | 213 |
| 120 | 150 | 188 |

**【踩分点4】**：正确推求设计洪水过程线（2分）

---

#### **第（2）问：计算特征值（10分）**

**步骤1：设计洪水总量**

**梯形公式**：
```
W设计 = Δt × [0.5×Q₀ + Q₁ + Q₂ + ... + Qₙ₋₁ + 0.5×Qₙ]
```

其中：Δt = 6h = 21600s

```
ΣQ中间 = 1063 + 3000 + 5250 + 8500 + 7000 + 5250 + 3875 + 2875 
        + 2125 + 1563 + 1150 + 850 + 650 + 500 + 400 + 325 + 275 
        + 238 + 213
      = 45,102 m³/s

W设计 = 21600 × [0.5×350 + 45,102 + 0.5×188]
      = 21600 × [175 + 45,102 + 94]
      = 21600 × 45,371
      = 980,014,000 m³
      = 9.80 × 10⁸ m³
```

**设计洪水总量**：W = **9.80 亿m³**

验证：W设计/W典型 = 9.80/5.8 = 1.69 ≠ 1.25

这是正常的，因为按洪峰放大，洪量放大倍比通常大于洪峰放大倍比。

**【踩分点1】**：正确计算设计洪量（3分）

---

**步骤2：洪峰模数**

需要流域面积F。假设本题已知F=1800 km²（题目应给出）。

```
qm = Q设计 / F × 1000
   = 8500 / 1800 × 1000
   = 4.72 m³/(s·km²)
```

**洪峰模数**：qm = **4.72 m³/(s·km²)**

**【踩分点2】**：计算洪峰模数（2分）

---

**步骤3：峰现时间**

从过程线可见：
- 涨水起点：t = 0h
- 洪峰时刻：t = 24h

**峰现时间**：t_p = **24小时**

**【踩分点3】**：确定峰现时间（1分）

---

**步骤4：涨水历时和退水历时**

**涨水历时**：
- 从起涨到洪峰：0h → 24h
- t涨 = **24小时**

**退水历时**：
- 从洪峰到洪尾：24h → 120h
- t退 = **96小时**

**涨退比**：
```
t涨 : t退 = 24 : 96 = 1 : 4
```

**【踩分点4】**：计算涨退历时（2分）

---

**步骤5：洪水历时和径流深**

**洪水历时**：T = **120小时** = 5天

**径流深**：
```
R = W / F × 1000
  = (9.80 × 10⁸) / (1800 × 10⁶) × 1000
  = 0.544 × 1000
  = 544 mm
```

**径流深**：R = **544 mm**

**【踩分点5】**：计算历时和径流深（2分）

---

#### **第（3）问：合理性分析（8分）**

**步骤1：洪峰合理性**

**检验1：与频率分析值对比**
- 设计洪峰：Q₁% = 8500 m³/s
- 这是由频率分析得到的，作为控制值 ✓

**检验2：洪峰模数**
- qm = 4.72 m³/(s·km²)
- 对于F=1800km²流域，P=1%
- 经验值：3~6 m³/(s·km²)
- 本题：4.72，合理 ✓

**【踩分点1】**：检验洪峰合理性（2分）

---

**步骤2：洪量合理性**

**放大倍比检验**：
```
n_Q = 1.25（洪峰放大）
n_W = 9.80/5.8 = 1.69（洪量放大）

n_W / n_Q = 1.69 / 1.25 = 1.35
```

**理论分析**：
- 通常 n_W > n_Q（洪量放大倍比大于洪峰）
- 比值一般在1.1~1.5之间
- 本题：1.35，合理 ✓

**原因**：
- 大洪水历时长，洪量相对更大
- 小洪水峰瘦，大洪水峰胖

**【踩分点2】**：检验洪量合理性（2分）

---

**步骤3：洪型合理性**

**涨退比分析**：
- 典型洪水：1:4
- 设计洪水：1:4（放大后保持）
- 符合一般暴雨洪水特征 ✓

**峰型分析**：
- 单峰型洪水
- 峰现时间24h，历时120h
- 峰现时间/总历时 = 24/120 = 20%
- 属于峰靠前型，合理 ✓

**【踩分点3】**：分析洪型合理性（2分）

---

**步骤4：综合评价**

**优点**：
1. ✓ 选用实测最大洪水，代表性好
2. ✓ 洪峰、洪量匹配合理
3. ✓ 洪型完整，特征值合理
4. ✓ 计算简便，易于应用

**不足**：
1. ⚠ 仅用一场洪水，代表性有限
2. ⚠ 未考虑不同洪型组合
3. ⚠ 36年系列对推求百年一遇略短

**建议**：
1. 多场典型洪水对比验证
2. 与地区综合成果对比
3. 考虑极端情况组合（如洪峰大+洪量大）

**结论**：设计洪水过程线**基本合理**，可作为工程初步设计依据。

**【踩分点4】**：综合评价（2分）

---

### 答案总结

#### **第（1）问答案**：

- **典型洪水**：2010年"7.18"洪水（Qm=6800 m³/s）
- **放大倍比**：n = 1.25
- **设计洪峰**：Q₁% = 8500 m³/s（t=24h）

#### **第（2）问答案**：

- **设计洪量**：W = 9.80亿m³
- **洪峰模数**：qm = 4.72 m³/(s·km²)
- **峰现时间**：t_p = 24h
- **涨水历时**：24h，退水历时：96h
- **洪水历时**：120h，径流深：544mm

#### **第（3）问答案**：

**合理性**：基本合理
- 洪峰、洪量匹配合理（n_W/n_Q=1.35）
- 洪型特征符合暴雨洪水规律
- 建议多场洪水验证

---

### 本题考点总结

**核心考点**：
1. ⭐⭐⭐⭐⭐ 同频率放大法
2. ⭐⭐⭐⭐ 典型洪水选择
3. ⭐⭐⭐⭐ 洪水特征值计算
4. ⭐⭐⭐ 合理性分析

**易错点**：
1. ❌ 梯形公式忘记首尾×0.5
2. ❌ 洪量放大倍比理解错误
3. ❌ 单位换算错误
4. ❌ 合理性分析不全面

**答题技巧**：
1. 放大倍比按洪峰计算
2. 特征值计算要细心
3. 合理性分析多角度
4. 结果要列表汇总

---

## 题4：设计洪水地区综合与经验公式（24分）⭐⭐⭐⭐

**难度**：⭐⭐⭐
**考频**：⭐⭐⭐⭐（高频）
**分值**：24分
**考查重点**：地区经验公式、参数率定

### 题目

某地区经多年研究，建立了设计洪峰流量地区综合公式：

```
Qp = K × Fⁿ × (1 + C×lgP)

其中：
Qp：设计洪峰流量（m³/s）
F：流域面积（km²）
P：设计频率（%）
K、n、C：地区参数
```

该地区已有5个水文站资料，P=1%洪峰流量统计如下：

| 站名 | 流域面积F(km²) | P=1%洪峰Q(m³/s) |
|------|--------------|----------------|
| A站 | 120 | 2850 |
| B站 | 350 | 6200 |
| C站 | 580 | 9100 |
| D站 | 920 | 12800 |
| E站 | 1500 | 18500 |

**要求**：
1. （10分）采用最小二乘法率定地区参数K、n
2. （8分）计算F=750 km²流域的P=1%、P=5%设计洪峰流量
3. （6分）评价公式适用性和精度

---

### 详细解答

#### **第（1）问：参数率定（10分）**

**步骤1：公式对数化**

对于P=1%：
```
Qp = K × Fⁿ × (1 + C×lg1)
   = K × Fⁿ × (1 + 0)
   = K × Fⁿ
```

两边取对数：
```
lgQ = lgK + n×lgF
```

令：
- y = lgQ
- x = lgF
- a = lgK
- b = n

得：**y = a + b×x**（线性关系）

**【踩分点1】**：公式对数化（2分）

---

**步骤2：计算统计量**

| 站 | F | Q | x=lgF | y=lgQ |
|----|---|---|-------|-------|
| A | 120 | 2850 | 2.079 | 3.455 |
| B | 350 | 6200 | 2.544 | 3.792 |
| C | 580 | 9100 | 2.763 | 3.959 |
| D | 920 | 12800 | 2.964 | 4.107 |
| E | 1500 | 18500 | 3.176 | 4.267 |

统计量：
```
n = 5
Σx = 2.079 + 2.544 + 2.763 + 2.964 + 3.176 = 13.526
Σy = 3.455 + 3.792 + 3.959 + 4.107 + 4.267 = 19.580
Σx² = 2.079² + ... + 3.176² = 37.048
Σxy = 2.079×3.455 + ... + 3.176×4.267 = 53.287
x̄ = 13.526/5 = 2.705
ȳ = 19.580/5 = 3.916
```

**【踩分点2】**：正确计算统计量（3分）

---

**步骤3：最小二乘法求参数**

**斜率b（即n）**：
```
b = [Σxy - n×x̄×ȳ] / [Σx² - n×x̄²]
  = [53.287 - 5×2.705×3.916] / [37.048 - 5×2.705²]
  = [53.287 - 52.928] / [37.048 - 36.585]
  = 0.359 / 0.463
  = 0.775
```

**截距a（即lgK）**：
```
a = ȳ - b×x̄
  = 3.916 - 0.775×2.705
  = 3.916 - 2.096
  = 1.820
```

**参数K**：
```
lgK = 1.820
K = 10^1.820 = 66.07
```

**【踩分点3】**：正确求解参数（3分）

---

**步骤4：参数C的确定**

C参数用于频率修正。经验取值：
- C = 0.3~0.5（湿润区）
- C = 0.5~0.8（半湿润区）

本题可取：**C = 0.5**（或根据地区经验）

**最终公式**：
```
Qp = 66.1 × F^0.775 × (1 + 0.5×lgP)
```

**【踩分点4】**：确定完整公式（2分）

---

#### **第（2）问：设计洪峰计算（8分）**

**步骤1：F=750 km²，P=1%**

```
Q₁% = 66.1 × 750^0.775 × (1 + 0.5×lg1)
    = 66.1 × 750^0.775 × 1
    = 66.1 × 161.3
    = 10,662 m³/s
```

**P=1%设计洪峰**：Q₁% = **10,660 m³/s**

**【踩分点1】**：正确计算P=1%洪峰（4分）

---

**步骤2：F=750 km²，P=5%**

```
Q₅% = 66.1 × 750^0.775 × (1 + 0.5×lg5)
    = 66.1 × 161.3 × (1 + 0.5×0.699)
    = 10,662 × (1 + 0.350)
    = 10,662 × 1.350
    = 14,394 m³/s
```

**P=5%设计洪峰**：Q₅% = **14,390 m³/s**

**【踩分点2】**：正确计算P=5%洪峰（4分）

---

#### **第（3）问：适用性评价（6分）**

**步骤1：精度评价**

**回代检验**（P=1%）：

| 站 | 实测Q | 计算Q | 误差 | 相对误差 |
|----|-------|-------|------|---------|
| A | 2850 | 2898 | +48 | +1.7% |
| B | 6200 | 6245 | +45 | +0.7% |
| C | 9100 | 9053 | -47 | -0.5% |
| D | 12800 | 12677 | -123 | -1.0% |
| E | 18500 | 18422 | -78 | -0.4% |

平均相对误差：
```
ε̄ = (|1.7| + |0.7| + |0.5| + |1.0| + |0.4|) / 5 = 0.86%
```

**精度评价**：优秀（ε < 5%）

**【踩分点1】**：进行精度评价（2分）

---

**步骤2：适用范围**

**流域面积范围**：
- 资料范围：120~1500 km²
- 适用范围：**100~2000 km²**（可适当外延）

**频率范围**：
- 率定频率：P=1%
- 适用范围：**0.5%~20%**（不宜外延太多）

**【踩分点2】**：确定适用范围（2分）

---

**步骤3：综合评价**

**优点**：
1. ✓ 公式简单，便于应用
2. ✓ 精度高（ε < 1%）
3. ✓ 物理意义明确
4. ✓ 参数稳定

**局限性**：
1. ⚠ 仅适用于本地区
2. ⚠ 未考虑暴雨特性差异
3. ⚠ 频率外延需谨慎
4. ⚠ 需定期更新参数

**使用建议**：
- 对于缺资料地区：优先采用
- 对于有资料地区：作为对比验证
- 对于超出范围：慎重使用，增加安全系数

**【踩分点3】**：综合评价（2分）

---

### 答案总结

#### **第（1）问答案**：

**地区参数**：
- K = 66.1
- n = 0.775
- C = 0.5

**公式**：Qp = 66.1 × F^0.775 × (1 + 0.5×lgP)

#### **第（2）问答案**：

- **P=1%洪峰**：Q₁% = 10,660 m³/s
- **P=5%洪峰**：Q₅% = 14,390 m³/s

#### **第（3）问答案**：

- **精度**：平均误差0.86%（优秀）
- **适用范围**：F=100~2000 km²，P=0.5%~20%
- **评价**：精度高，适用性好，需定期更新

---

### 本题考点总结

**核心考点**：
1. ⭐⭐⭐⭐⭐ 最小二乘法参数率定
2. ⭐⭐⭐⭐ 地区综合公式应用
3. ⭐⭐⭐ 公式精度评价

**易错点**：
1. ❌ 对数运算错误
2. ❌ 最小二乘法公式记错
3. ❌ 频率修正项计算错
4. ❌ 精度评价不全面

**答题技巧**：
1. 对数化简化计算
2. 统计量计算要细心
3. 回代检验精度
4. 明确适用范围

---

## 题5：设计洪水方法综合比较（22分）⭐⭐⭐

**难度**：⭐⭐⭐
**考频**：⭐⭐⭐（中频）
**分值**：22分
**考查重点**：多种方法对比、成果选择

### 题目

某设计站F=450 km²，缺乏实测流量资料。采用三种方法推求P=1%设计洪峰流量：

1. **推理公式法**：Q₁ = 7200 m³/s
2. **地区综合法**：Q₂ = 7850 m³/s
3. **暴雨资料法**（推理公式）：Q₃ = 6950 m³/s

**附近参证站资料**（F=380 km²）：
- P=1%洪峰：Q参 = 6800 m³/s

**要求**：
1. （8分）采用面积比拟法，推求设计站P=1%洪峰流量
2. （8分）综合四种方法成果，确定设计值
3. （6分）说明成果选择理由和建议安全裕度

---

### 详细解答

#### **第（1）问：面积比拟法（8分）**

**步骤1：面积比拟法原理**

**公式**：
```
Q设计 / Q参证 = (F设计 / F参证)^m

其中：
m：面积指数，一般0.5~0.8
```

**【踩分点1】**：阐述原理（2分）

---

**步骤2：确定面积指数m**

**经验值**：
- m = 0.5~0.6：大流域（F>1000 km²）
- m = 0.6~0.7：中等流域（100~1000 km²）
- m = 0.7~0.8：小流域（F<100 km²）

本题：F=450 km²，属于中等流域
取：**m = 0.65**

**【踩分点2】**：合理确定m值（2分）

---

**步骤3：计算设计洪峰**

```
Q₁%设计 / Q₁%参证 = (F设计 / F参证)^m

Q₁%设计 = Q₁%参证 × (F设计 / F参证)^m
        = 6800 × (450 / 380)^0.65
        = 6800 × 1.184^0.65
        = 6800 × 1.117
        = 7596 m³/s
```

**面积比拟法结果**：Q₄ = **7600 m³/s**

**【踩分点3】**：正确计算（3分）

---

**步骤4：合理性检验**

**检验**：
```
Q₄ / Q参 = 7600 / 6800 = 1.118

(F设计/F参)^m = (450/380)^0.65 = 1.117
```

两者一致 ✓

**【踩分点4】**：验证结果（1分）

---

#### **第（2）问：综合确定设计值（8分）**

**步骤1：成果汇总**

| 方法 | 结果Q(m³/s) | 偏离均值 | 权重建议 |
|------|------------|---------|---------|
| 推理公式法 | 7200 | -4.9% | 0.20 |
| 地区综合法 | 7850 | +3.7% | 0.30 |
| 暴雨资料法 | 6950 | -8.3% | 0.15 |
| 面积比拟法 | 7600 | +0.4% | 0.35 |
| **算术平均** | **7400** | - | - |

**【踩分点1】**：汇总成果（2分）

---

**步骤2：分析各方法可靠性**

**(1) 推理公式法**（Q=7200）：
- 优点：理论基础好
- 缺点：参数（φ、τc）不确定性大
- 可靠性：中等
- **权重：0.20**

**(2) 地区综合法**（Q=7850）：
- 优点：综合多站资料，代表性好
- 缺点：可能偏大（偏安全）
- 可靠性：较高
- **权重：0.30**

**(3) 暴雨资料法**（Q=6950）：
- 优点：基于暴雨资料
- 缺点：结果偏小，参数不确定
- 可靠性：较低
- **权重：0.15**

**(4) 面积比拟法**（Q=7600）：
- 优点：基于实测资料，流域相近
- 缺点：依赖参证站精度
- 可靠性：高
- **权重：0.35**

**【踩分点2】**：分析各方法可靠性（3分）

---

**步骤3：加权平均**

```
Q设计 = Σ(Wi × Qi)
      = 0.20×7200 + 0.30×7850 + 0.15×6950 + 0.35×7600
      = 1440 + 2355 + 1043 + 2660
      = 7498 m³/s
```

**综合成果**：Q₁% = **7500 m³/s**

**【踩分点3】**：综合确定设计值（3分）

---

#### **第（3）问：成果选择理由（6分）**

**步骤1：选择理由**

**采用加权平均法**的理由：

1. **综合利用信息**：
   - 充分利用了4种方法成果
   - 避免单一方法误差

2. **权重合理**：
   - 面积比拟法权重最大（基于实测）
   - 地区综合法次之（综合性强）
   - 不确定性大的方法权重小

3. **成果适中**：
   - 7500 m³/s接近算术平均值7400
   - 略偏安全（比最小值大8%）

**【踩分点1】**：说明选择理由（3分）

---

**步骤2：安全裕度建议**

**考虑因素**：
1. 工程等级（假设为大型）
2. 资料不足（无实测流量）
3. 方法不确定性

**建议**：
```
安全系数：K = 1.10~1.15

设计采用值：
Q₁%设计 = 7500 × 1.10 = 8250 m³/s
```

或分级：
- **校核洪水**（P=0.1%）：8800 m³/s（K=1.15）
- **设计洪水**（P=1%）：8250 m³/s（K=1.10）
- **施工洪水**（P=5%）：7500 m³/s（K=1.00）

**【踩分点2】**：给出安全裕度建议（3分）

---

### 答案总结

#### **第（1）问答案**：

**面积比拟法**：Q₄ = 7600 m³/s（m=0.65）

#### **第（2）问答案**：

**综合成果**（加权平均）：Q₁% = **7500 m³/s**

权重分配：
- 推理公式法：0.20
- 地区综合法：0.30
- 暴雨资料法：0.15
- 面积比拟法：0.35

#### **第（3）问答案**：

**理由**：综合利用信息，权重合理，成果适中

**建议**：考虑10%~15%安全裕度
- 设计值：8250 m³/s（K=1.10）

---

### 本题考点总结

**核心考点**：
1. ⭐⭐⭐⭐ 面积比拟法
2. ⭐⭐⭐⭐ 多方法综合
3. ⭐⭐⭐ 加权平均
4. ⭐⭐⭐ 安全裕度

**易错点**：
1. ❌ 面积指数m取值不当
2. ❌ 权重分配不合理
3. ❌ 忽略安全裕度
4. ❌ 分析不够全面

**答题技巧**：
1. 多方法结果要列表对比
2. 权重分配要有依据
3. 安全裕度要结合工程等级
4. 结论要明确具体

---

## 基础题部分完成标记

**第3章基础题（题1-5）已全部完成！**

**统计**：
- 题1：设计洪峰流量频率分析（25分）✅
- 题2：推理公式法推求设计洪水（28分）✅
- 题3：设计洪水过程线的推求（26分）✅
- 题4：设计洪水地区综合与经验公式（24分）✅
- 题5：设计洪水方法综合比较（22分）✅

**基础题总分**：125分

---


---

## 进阶题部分（题6-10）

以下题目难度和综合性更强，考查多方法融合与实际工程应用能力。

---

## 题6：设计洪水过程线的放大与修正（26分）⭐⭐⭐⭐

某水库设计流域F=1200 km²，有20年实测洪水资料。选定1998年8月洪水作为典型洪水，该场洪水实测洪峰流量Qm,典=3800 m³/s，洪量W典=1.52×10⁸ m³，历时T典=48 h。

通过频率分析得到设计值：
- P=1%设计洪峰流量：Q1%=5200 m³/s
- P=1%三日洪量：W1%(3d)=2.10×10⁸ m³

典型洪水过程（Δt=3h）：

| 时刻 | 0 | 3 | 6 | 9 | 12 | 15 | 18 | 21 | 24 |
|------|---|---|---|---|----|----|----|----|-----|
| Q(m³/s) | 200 | 850 | 1900 | 2800 | 3500 | 3800 | 3200 | 2400 | 1600 |

| 时刻 | 27 | 30 | 33 | 36 | 39 | 42 | 45 | 48 |
|------|----|----|----|----|----|----|----|----|
| Q(m³/s) | 1050 | 650 | 420 | 280 | 210 | 180 | 160 | 150 |

**要求**：
1. 采用同频率放大法，计算放大倍比n（25%踩分点）
2. 放大洪水过程，检验洪峰、洪量是否满足要求（30%踩分点）
3. 若不满足，采用同倍比放大法调整过程线（25%踩分点）
4. 检验修正后过程线的合理性（20%踩分点）

### 解答

#### **第1步：典型洪水特征值计算**【踩分点5分】

典型洪水洪量（梯形公式）：

```
W典 = Δt × [0.5×Q₀ + ΣQ + 0.5×Qₙ]
    = 3×3600 × [0.5×200 + (850+1900+2800+3500+3800+3200+2400+1600+1050+650+420+280+210+180+160) + 0.5×150] / 10⁶
    = 10800 × [100 + 23000 + 75] / 10⁶
    = 10800 × 23175 / 10⁶
    = 2.503×10⁸ m³
```

**说明**：题目给定W典=1.52×10⁸ m³，此为净雨洪量（扣除基流）

典型洪水三日洪量：
```
W典(3d) = 3×24×3600 × Q̄3d / 10⁶
```

取最大三日连续时段（t=6h至t=30h，共9个时段）：
```
Q̄(6-30h) = (1900+2800+3500+3800+3200+2400+1600+1050+650) / 9 = 2322 m³/s
W典(3d) ≈ 1.80×10⁸ m³（包含基流）
```

#### **第2步：同频率放大倍比计算**【踩分点5分】

根据洪峰放大：
```
n₁ = Q1% / Qm,典 = 5200 / 3800 = 1.368
```

根据洪量放大（净雨洪量）：
```
n₂ = W1% / W典 = 2.10×10⁸ / 1.52×10⁸ = 1.382
```

**差异分析**：
```
|n₂ - n₁| / n₁ = |1.382 - 1.368| / 1.368 = 1.02% < 5%
```

差异较小，可采用平均值：
```
n = (n₁ + n₂) / 2 = (1.368 + 1.382) / 2 = 1.375
```

**原则**：当n₁与n₂相差<5%时取平均；相差>5%时分别放大峰、量后调整。

#### **第3步：初次放大洪水过程**【踩分点6分】

放大公式：
```
Qi,1% = n × Qi,典 = 1.375 × Qi,典
```

放大后过程：

| 时刻(h) | 0 | 3 | 6 | 9 | 12 | 15 | 18 | 21 | 24 |
|---------|---|---|---|---|----|----|----|----|-----|
| Q(m³/s) | 275 | 1169 | 2613 | 3850 | 4813 | 5225 | 4400 | 3300 | 2200 |

| 时刻(h) | 27 | 30 | 33 | 36 | 39 | 42 | 45 | 48 |
|---------|----|----|----|----|----|----|----|----|
| Q(m³/s) | 1444 | 894 | 578 | 385 | 289 | 248 | 220 | 206 |

#### **第4步：检验放大成果**【踩分点4分】

**洪峰检验**：
```
Qm,1% = 5225 m³/s > Q1%设计 = 5200 m³/s  ✓ 满足
相对误差：(5225-5200)/5200 = 0.48%
```

**洪量检验**（净雨洪量）：
```
W1%,计算 = 1.375 × 1.52×10⁸ = 2.090×10⁸ m³
W1%,设计 = 2.10×10⁸ m³
相对误差：(2.090-2.10)/2.10 = -0.48% ≈ 0
```

✓ 洪峰、洪量均满足设计要求，无需进一步调整。

#### **第5步：同倍比放大法调整（若需要）**【踩分点5分】

**适用场景**：当n₁与n₂差异>5%时，需分别满足峰、量要求。

**调整原理**：
1. 先按洪峰放大：Q'i = (Q1%/Qm,典) × Qi,典
2. 计算放大后洪量W'
3. 若W' < W设计，采用同倍比加大法：
   ```
   Qi,1% = Q'i + (W设计 - W') / (n×Δt) × (Q'i / Qm,1%)
   ```
   即在各时刻按流量大小比例加大流量

4. 若W' > W设计，需削减洪量（较少见）

**本题情况**：n₁与n₂差异小，直接放大满足要求，无需同倍比调整。

#### **第6步：合理性检验**【踩分点1分】

**①峰量关系检验**：
```
洪峰模数：qm = Qm,1% / F = 5225 / 1200 = 4.35 m³/(s·km²)
洪量模数：wm = W1% / F = 2.10×10⁸ / (1200×10⁶) = 175 mm
```
查地区经验值：湿润地区P=1%洪峰模数3-6 m³/(s·km²)，洪量模数150-250 mm  ✓

**②过程线形态检验**：
- 涨洪历时：0-15h（15h）
- 落洪历时：15h-48h（33h）
- 涨落比：15:33 ≈ 1:2.2  ✓ 符合天然洪水特性

**③峰现时间检验**：
- 峰现时间：T峰=15h
- 汇流时间估算：τ = 0.278×L/√(J·F^0.1) 
  （假设流域长度L=60km，比降J=0.005）
  τ ≈ 8-12h
- T峰/τ ≈ 1.5  ✓ 合理（一般1.2-2.0）

### **答案总结**

**1. 放大倍比**：
- 按洪峰：n₁ = 1.368
- 按洪量：n₂ = 1.382
- 综合取值：n = 1.375

**2. 放大后洪峰**：Qm,1% = 5225 m³/s（满足Q1%=5200 m³/s）

**3. 放大后洪量**：W1% = 2.090×10⁸ m³（满足W1%=2.10×10⁸ m³）

**4. 结论**：采用同频率放大法，n=1.375放大典型洪水过程，成果满足设计要求，无需同倍比调整。

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import font_manager

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 典型洪水过程
t = np.array([0,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48])
Q_typical = np.array([200,850,1900,2800,3500,3800,3200,2400,1600,1050,650,420,280,210,180,160,150])

# 设计值
Q_design_peak = 5200
W_design = 2.10e8

# 典型洪水特征值
Q_typical_peak = 3800
W_typical = 1.52e8

# 放大倍比
n1 = Q_design_peak / Q_typical_peak
n2 = W_design / W_typical
n = (n1 + n2) / 2

# 放大后过程
Q_design = n * Q_typical

# 洪量计算（梯形公式）
dt = 3 * 3600  # 时段长度(s)
W_typical_calc = dt * (0.5*Q_typical[0] + np.sum(Q_typical[1:-1]) + 0.5*Q_typical[-1]) / 1e6
W_design_calc = dt * (0.5*Q_design[0] + np.sum(Q_design[1:-1]) + 0.5*Q_design[-1]) / 1e6

# 创建图形
fig = plt.figure(figsize=(18, 12))

# 子图1：典型洪水与设计洪水过程对比
ax1 = plt.subplot(2, 3, 1)
ax1.plot(t, Q_typical, 'b-o', linewidth=2, markersize=6, label='典型洪水(1998年8月)')
ax1.plot(t, Q_design, 'r-s', linewidth=2, markersize=6, label=f'设计洪水(P=1%, n={n:.3f})')
ax1.axhline(Q_design_peak, color='red', linestyle='--', alpha=0.5, label=f'设计洪峰={Q_design_peak} m³/s')
ax1.axhline(Q_typical_peak, color='blue', linestyle='--', alpha=0.5, label=f'典型洪峰={Q_typical_peak} m³/s')
ax1.fill_between(t, Q_typical, alpha=0.2, color='blue')
ax1.fill_between(t, Q_design, alpha=0.2, color='red')
ax1.set_xlabel('时间 (h)', fontsize=12)
ax1.set_ylabel('流量 (m³/s)', fontsize=12)
ax1.set_title('典型洪水与设计洪水过程对比', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)

# 子图2：放大倍比对比
ax2 = plt.subplot(2, 3, 2)
categories = ['按洪峰\nn₁', '按洪量\nn₂', '综合取值\nn']
values = [n1, n2, n]
colors = ['#3498db', '#e74c3c', '#2ecc71']
bars = ax2.bar(categories, values, color=colors, alpha=0.7, edgecolor='black', linewidth=1.5)
for bar, val in zip(bars, values):
    height = bar.get_height()
    ax2.text(bar.get_x() + bar.get_width()/2., height,
             f'{val:.3f}',
             ha='center', va='bottom', fontsize=12, fontweight='bold')
ax2.axhline(n, color='gray', linestyle='--', alpha=0.5)
ax2.set_ylabel('放大倍比', fontsize=12)
ax2.set_title('放大倍比计算与选择', fontsize=14, fontweight='bold')
ax2.set_ylim(1.3, 1.42)
ax2.grid(True, alpha=0.3, axis='y')

# 子图3：洪量对比
ax3 = plt.subplot(2, 3, 3)
W_values = [W_typical/1e8, W_design_calc/1e8, W_design/1e8]
W_labels = ['典型洪量', '放大后洪量', '设计洪量']
colors_w = ['#3498db', '#f39c12', '#e74c3c']
bars_w = ax3.bar(W_labels, W_values, color=colors_w, alpha=0.7, edgecolor='black', linewidth=1.5)
for bar, val in zip(bars_w, W_values):
    height = bar.get_height()
    ax3.text(bar.get_x() + bar.get_width()/2., height,
             f'{val:.2f}×10⁸ m³',
             ha='center', va='bottom', fontsize=11, fontweight='bold')
ax3.set_ylabel('洪量 (×10⁸ m³)', fontsize=12)
ax3.set_title('洪量对比检验', fontsize=14, fontweight='bold')
ax3.grid(True, alpha=0.3, axis='y')

# 子图4：流量放大系数沿历时变化
ax4 = plt.subplot(2, 3, 4)
amplification = Q_design / Q_typical
ax4.plot(t, amplification, 'g-o', linewidth=2, markersize=6)
ax4.axhline(n, color='red', linestyle='--', linewidth=2, label=f'平均放大倍比={n:.3f}')
ax4.fill_between(t, amplification, n, where=(amplification>=n), interpolate=True, 
                  alpha=0.3, color='green', label='高于平均')
ax4.fill_between(t, amplification, n, where=(amplification<n), interpolate=True, 
                  alpha=0.3, color='orange', label='低于平均')
ax4.set_xlabel('时间 (h)', fontsize=12)
ax4.set_ylabel('放大系数', fontsize=12)
ax4.set_title('同频率放大系数沿历时分布', fontsize=14, fontweight='bold')
ax4.legend(fontsize=10)
ax4.grid(True, alpha=0.3)

# 子图5：峰量关系检验
ax5 = plt.subplot(2, 3, 5)
F = 1200  # 流域面积
qm_typical = Q_typical_peak / F
qm_design = Q_design.max() / F
wm_typical = W_typical / (F * 1e6) * 1000  # mm
wm_design = W_design / (F * 1e6) * 1000

scatter_data = [
    ('典型洪水', qm_typical, wm_typical, 'blue', 'o'),
    ('设计洪水', qm_design, wm_design, 'red', 's')
]

for label, qm, wm, color, marker in scatter_data:
    ax5.scatter(wm, qm, s=200, c=color, marker=marker, alpha=0.7, 
                edgecolors='black', linewidths=2, label=label)
    ax5.annotate(f'{label}\nqm={qm:.2f}\nwm={wm:.1f}mm',
                xy=(wm, qm), xytext=(10, 10), textcoords='offset points',
                fontsize=10, bbox=dict(boxstyle='round,pad=0.5', facecolor=color, alpha=0.3))

# 地区经验范围
ax5.axhspan(3, 6, alpha=0.1, color='gray', label='地区qm经验范围')
ax5.axvspan(150, 250, alpha=0.1, color='yellow', label='地区wm经验范围')

ax5.set_xlabel('洪量模数 wm (mm)', fontsize=12)
ax5.set_ylabel('洪峰模数 qm [m³/(s·km²)]', fontsize=12)
ax5.set_title('峰量关系合理性检验', fontsize=14, fontweight='bold')
ax5.legend(fontsize=9)
ax5.grid(True, alpha=0.3)

# 子图6：过程线形态特征
ax6 = plt.subplot(2, 3, 6)
# 计算累积流量百分比
Q_cumsum = np.cumsum(Q_design)
Q_cumsum_pct = Q_cumsum / Q_cumsum[-1] * 100

ax6_twin = ax6.twinx()
ax6.plot(t, Q_design, 'r-s', linewidth=2, markersize=6, label='设计流量')
ax6_twin.plot(t, Q_cumsum_pct, 'b--o', linewidth=2, markersize=5, label='累积流量百分比')

# 标注峰现时间
peak_idx = np.argmax(Q_design)
ax6.axvline(t[peak_idx], color='gray', linestyle=':', alpha=0.7)
ax6.annotate(f'峰现时间\nT={t[peak_idx]}h',
            xy=(t[peak_idx], Q_design[peak_idx]), xytext=(20, -20),
            textcoords='offset points', fontsize=10,
            bbox=dict(boxstyle='round,pad=0.5', facecolor='yellow', alpha=0.7),
            arrowprops=dict(arrowstyle='->', connectionstyle='arc3,rad=0'))

# 标注涨落历时
ax6.text(7.5, 4500, f'涨洪历时\n{t[peak_idx]}h', ha='center', fontsize=10,
         bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.5))
ax6.text(31, 3000, f'落洪历时\n{t[-1]-t[peak_idx]}h', ha='center', fontsize=10,
         bbox=dict(boxstyle='round', facecolor='lightcoral', alpha=0.5))

ax6.set_xlabel('时间 (h)', fontsize=12)
ax6.set_ylabel('流量 (m³/s)', fontsize=12, color='red')
ax6_twin.set_ylabel('累积流量百分比 (%)', fontsize=12, color='blue')
ax6.set_title('设计洪水过程线形态特征', fontsize=14, fontweight='bold')
ax6.tick_params(axis='y', labelcolor='red')
ax6_twin.tick_params(axis='y', labelcolor='blue')
ax6.legend(loc='upper left', fontsize=10)
ax6_twin.legend(loc='upper right', fontsize=10)
ax6.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('第3章题6_设计洪水过程线放大与修正.png', dpi=300, bbox_inches='tight')
plt.show()

# 输出计算结果
print("=" * 60)
print("设计洪水过程线放大与修正计算结果")
print("=" * 60)
print(f"\n【1】典型洪水特征值：")
print(f"  洪峰流量：Qm,典 = {Q_typical_peak} m³/s")
print(f"  洪量：W典 = {W_typical/1e8:.2f}×10⁸ m³")
print(f"\n【2】设计值：")
print(f"  设计洪峰：Q1% = {Q_design_peak} m³/s")
print(f"  设计洪量：W1% = {W_design/1e8:.2f}×10⁸ m³")
print(f"\n【3】放大倍比：")
print(f"  按洪峰：n₁ = {n1:.3f}")
print(f"  按洪量：n₂ = {n2:.3f}")
print(f"  差异：{abs(n2-n1)/n1*100:.2f}% < 5% ✓")
print(f"  综合取值：n = {n:.3f}")
print(f"\n【4】放大后成果检验：")
print(f"  放大后洪峰：Qm,1% = {Q_design.max():.0f} m³/s")
print(f"  与设计值对比：{Q_design.max()} vs {Q_design_peak}，误差={(Q_design.max()-Q_design_peak)/Q_design_peak*100:.2f}%")
print(f"  放大后洪量：W1%,计算 = {W_design_calc/1e8:.3f}×10⁸ m³")
print(f"  与设计值对比：{W_design_calc/1e8:.3f} vs {W_design/1e8:.2f}，误差={(W_design_calc-W_design)/W_design*100:.2f}%")
print(f"\n【5】合理性检验：")
print(f"  洪峰模数：qm = {qm_design:.2f} m³/(s·km²)（地区范围3-6）")
print(f"  洪量模数：wm = {wm_design:.1f} mm（地区范围150-250）")
print(f"  涨落历时比：{t[peak_idx]}:{t[-1]-t[peak_idx]} ≈ 1:{(t[-1]-t[peak_idx])/t[peak_idx]:.1f}")
print(f"\n【6】结论：")
print(f"  采用同频率放大法，n={n:.3f}，放大后成果满足设计要求✓")
print("=" * 60)
```

### **核心知识点**

| 知识点 | 内容 | 考试要求 |
|--------|------|----------|
| 同频率放大法 | n=Q设计/Q典型（或n=W设计/W典型） | ⭐⭐⭐⭐⭐ |
| 峰量一致性 | n₁与n₂差异<5%可直接放大 | ⭐⭐⭐⭐ |
| 同倍比加大法 | 峰量不一致时的调整方法 | ⭐⭐⭐⭐ |
| 洪量计算 | 梯形公式：W=Δt×[0.5Q₀+ΣQ+0.5Qₙ] | ⭐⭐⭐⭐⭐ |
| 合理性检验 | 峰量关系、过程形态、峰现时间 | ⭐⭐⭐ |

### **常见错误**

1. **混淆净雨洪量与总洪量**：设计洪量一般指净雨洪量（扣除基流）
2. **放大倍比取值不当**：n₁与n₂差异大时不能简单平均
3. **忽略合理性检验**：只计算不检验，容易出现不合理成果
4. **洪量计算公式错误**：忘记首尾流量乘0.5

### **考试策略**

- **时间分配**：26分题建议35分钟
- **得分重点**：放大倍比计算（10分）、过程放大（6分）、检验（4分）
- **快速检验**：放大后Q和W的相对误差应<3%
- **图表展示**：绘制典型与设计过程对比图可加2-3分

---

## 题7：可能最大洪水(PMF)估算（28分）⭐⭐⭐⭐⭐

某大型水库（Ⅰ等工程）坝址以上流域面积F=5600 km²，流域平均宽度B=35 km。通过暴雨资料分析，得到可能最大暴雨(PMP)：

**可能最大1日、3日点暴雨**：
- PMP₁=450 mm
- PMP₃=720 mm

**流域平均面雨量折算系数**：
- 1日：α₁=0.85
- 3日：α₃=0.88

**流域产汇流参数**（查地区综合成果）：
- 损失参数：μ=0.72（径流系数）
- 汇流参数：m=0.62（汇流系数）
- 流域汇流时间：τ=18 h

已知设计洪水P=0.1%洪峰流量Q₀.₁%=12500 m³/s。

**要求**：
1. 计算可能最大洪水(PMF)洪峰流量（30%踩分点）
2. 推求PMF洪水过程线（25%踩分点）
3. 说明PMF与设计洪水的关系及应用场合（20%踩分点）
4. 分析PMF计算的不确定性来源（25%踩分点）

### 解答

#### **第1步：可能最大洪水概念理解**【踩分点4分】

**PMF定义**：可能最大洪水(Probable Maximum Flood)是指在流域最不利的气象、水文条件组合下，可能发生的最大洪水。

**与设计洪水关系**：
- 设计洪水：有频率概念，如P=0.1%、1%等
- PMF：无频率概念，理论上的极限洪水（重现期>10000年）
- 关系：PMF > Q₀.₀₁% > Q₀.₁% > Q₁%

**应用场合**：
1. 特别重要工程的校核洪水（Ⅰ等大坝）
2. 核电站防洪安全评价
3. 化工等高危设施的极端洪水评估

#### **第2步：可能最大暴雨面雨量计算**【踩分点5分】

**1日可能最大面雨量**：
```
PMP₁,面 = α₁ × PMP₁ = 0.85 × 450 = 382.5 mm
```

**3日可能最大面雨量**：
```
PMP₃,面 = α₃ × PMP₃ = 0.88 × 720 = 633.6 mm
```

**最大日雨量**（从3日中分配）：
采用典型时程分配，最大1日占3日的55-65%：
```
PMP₁,max = 0.60 × PMP₃,面 = 0.60 × 633.6 = 380.2 mm
```

与1日PMP对比，取大值：
```
PMP₁,采用 = max(382.5, 380.2) = 382.5 mm
```

#### **第3步：可能最大净雨量计算**【踩分点4分】

采用径流系数法：
```
径流系数：μ = 0.72
```

**1日净雨**：
```
R₁ = μ × PMP₁,面 = 0.72 × 382.5 = 275.4 mm
```

**3日净雨**：
```
R₃ = μ × PMP₃,面 = 0.72 × 633.6 = 456.2 mm
```

**净雨时程分配**（采用暴雨中心型）：

| 时段 | 第1日 | 第2日 | 第3日 |
|------|-------|-------|-------|
| 雨量占比 | 20% | 55% | 25% |
| 净雨(mm) | 91.2 | 251.0 | 114.0 |

中心日（第2日）再细化为6个时段（Δt=4h）：

| 时段 | 1 | 2 | 3 | 4 | 5 | 6 |
|------|---|---|---|---|---|---|
| 占第2日% | 8% | 15% | 35% | 25% | 12% | 5% |
| 净雨(mm) | 20.1 | 37.6 | 87.9 | 62.8 | 30.1 | 12.5 |

#### **第4步：PMF洪峰流量计算**【踩分点6分】

**方法1：推理公式法（简化）**

推理公式：
```
Qm = 0.278 × φ × Sp × F / τ
```

其中：
- φ = m = 0.62（汇流系数）
- Sp = 最大时段平均净雨强度
- τ = 18 h（汇流时间）
- F = 5600 km²

取与汇流时间τ=18h相近的时段，约4-6个时段。取最大净雨集中的3个时段（时段3-5）：
```
R(3-5) = 87.9 + 62.8 + 30.1 = 180.8 mm
历时：t = 3 × 4 = 12 h
平均净雨强度：Sp = 180.8 / 12 = 15.07 mm/h
```

代入公式：
```
Qm,PMF = 0.278 × 0.62 × 15.07 × 5600 / 18
       = 0.278 × 0.62 × 15.07 × 311.1
       = 8060 m³/s
```

**方法2：放大倍比法**

利用已知的Q₀.₁%=12500 m³/s，采用放大关系：
```
Qm,PMF / Q₀.₁% ≈ (PMP₁,面 / P₀.₁%,1日雨量)^(0.7-0.8)
```

查资料，该流域P=0.1%一日雨量约250 mm，则：
```
n = (382.5 / 250)^0.75 = (1.53)^0.75 = 1.38
Qm,PMF = 1.38 × 12500 = 17250 m³/s
```

**方法3：经验公式法**

对于该地区（假设湿润区），经验公式：
```
Qm,PMF = K × F^n × (R₁,max / 100)^p
```
其中K=180, n=0.75, p=1.2（地区参数）

```
Qm,PMF = 180 × 5600^0.75 × (275.4/100)^1.2
       = 180 × 354.8 × 3.53
       = 22540 m³/s
```

**综合确定**：
三种方法差异较大，推理公式法偏小（参数可能偏保守），经验公式法偏大。采用加权平均：
```
Qm,PMF = 0.20×8060 + 0.50×17250 + 0.30×22540
       = 1612 + 8625 + 6762
       = 17000 m³/s（取整）
```

**与设计洪水关系**：
```
Qm,PMF / Q₀.₁% = 17000 / 12500 = 1.36
```
经验值一般为1.3-1.5，合理✓

#### **第5步：PMF洪水过程线推求**【踩分点5分】

采用**放大法**：以P=0.1%设计洪水过程为基础

假设P=0.1%设计洪水过程已知（或采用地区综合的无量纲过程线）。

**无量纲过程线**（地区综合成果，以洪峰为基准，t/τ为时间尺度）：

| t/τ | -1.0 | -0.5 | 0 | 0.5 | 1.0 | 1.5 | 2.0 | 2.5 | 3.0 |
|-----|------|------|---|-----|-----|-----|-----|-----|-----|
| Q/Qm | 0.05 | 0.20 | 0.50 | 0.85 | 1.00 | 0.75 | 0.50 | 0.30 | 0.15 |

| t/τ | 3.5 | 4.0 |
|-----|-----|-----|
| Q/Qm | 0.08 | 0.04 |

τ=18h，则实际时间：

| 时刻(h) | -18 | -9 | 0 | 9 | 18 | 27 | 36 | 45 | 54 | 63 | 72 |
|---------|-----|----|----|---|----|----|----|----|----|----|-----|
| Q(m³/s) | 850 | 3400 | 8500 | 14450 | 17000 | 12750 | 8500 | 5100 | 2550 | 1360 | 680 |

**洪量计算**（Δt=9h）：
```
W_PMF = 9×3600 × [0.5×850 + (3400+8500+14450+17000+12750+8500+5100+2550+1360) + 0.5×680] / 10⁶
      = 32400 × [425 + 73610 + 340] / 10⁶
      = 32400 × 74375 / 10⁶
      = 2.410×10⁹ m³ = 24.1×10⁸ m³
```

#### **第6步：PMF与设计洪水关系**【踩分点4分】

| 项目 | 设计洪水(P=0.1%) | PMF | 比值 |
|------|------------------|-----|------|
| 洪峰流量(m³/s) | 12500 | 17000 | 1.36 |
| 3日洪量(×10⁸m³) | ~15 | 24.1 | 1.61 |
| 洪峰模数[m³/(s·km²)] | 2.23 | 3.04 | 1.36 |

**应用原则**：
1. **Ⅰ等工程**：PMF作为校核洪水，设计洪水P=0.1%-0.5%
2. **Ⅱ等工程**：P=0.1%作为校核洪水，设计洪水P=0.5%-1%
3. **Ⅲ等及以下**：不考虑PMF

**本工程（Ⅰ等大坝）**：
- 设计洪水：P=0.5%-1%
- 校核洪水：PMF或P=0.1%（取大）
- 采用：PMF = 17000 m³/s 作为校核标准

#### **第7步：不确定性分析**【踩分点6分】

**①PMP估算不确定性**（最大）：
- 点暴雨→面暴雨换算系数α：±10-15%
- PMP估算方法差异：水汽最大化法vs统计放大法，差异可达20-30%
- 时程分配（峰型选择）：影响洪峰5-10%

**②产流参数不确定性**：
- 径流系数μ：实测值0.68-0.76，取0.72，误差±5%
- 前期影响：PMF假定最不利（土壤饱和），但实际可能更复杂

**③汇流参数不确定性**：
- 汇流时间τ：随洪水大小变化，大洪水τ减小，影响5-10%
- 汇流系数m：地区综合成果，个别流域差异可达±10%

**④方法综合不确定性**：
- 推理公式法：参数概化，误差10-15%
- 放大法：假设线性关系，极端情况可能失效
- 经验公式：地区性强，外延使用误差大

**总不确定性估计**：
```
综合不确定性：σ_total ≈ √(σ₁² + σ₂² + σ₃² + σ₄²)
                      ≈ √(20² + 5² + 8² + 12²)
                      ≈ ±25%
```

**置信区间**：
```
Qm,PMF = 17000 m³/s，置信区间：[12750, 21250] m³/s
```

### **答案总结**

**1. PMF洪峰流量**：Qm,PMF = 17000 m³/s
   - 推理公式法：8060 m³/s
   - 放大倍比法：17250 m³/s
   - 经验公式法：22540 m³/s
   - 综合确定：17000 m³/s

**2. PMF洪量**：W_PMF = 24.1×10⁸ m³

**3. PMF/Q₀.₁%**：1.36（经验范围1.3-1.5）

**4. 不确定性**：综合不确定性约±25%，主要来源于PMP估算

**5. 应用建议**：
   - 本工程(Ⅰ等)采用PMF作为校核洪水
   - 建议取上限值：17000×1.1 = 18700 m³/s（留安全余地）

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import font_manager

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 基本数据
F = 5600  # 流域面积
PMP1 = 450  # 1日点暴雨
PMP3 = 720  # 3日点暴雨
alpha1, alpha3 = 0.85, 0.88
mu = 0.72  # 径流系数
Q_001 = 12500  # P=0.1%设计洪峰

# 计算
PMP1_area = alpha1 * PMP1
PMP3_area = alpha3 * PMP3
R1 = mu * PMP1_area
R3 = mu * PMP3_area

# PMF洪峰计算（三种方法）
Q_PMF_method1 = 8060
Q_PMF_method2 = 17250
Q_PMF_method3 = 22540
weights = np.array([0.20, 0.50, 0.30])
Q_PMF = np.sum(weights * np.array([Q_PMF_method1, Q_PMF_method2, Q_PMF_method3]))

# PMF过程线（基于无量纲过程）
t_norm = np.array([-1.0, -0.5, 0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0])
Q_norm = np.array([0.05, 0.20, 0.50, 0.85, 1.00, 0.75, 0.50, 0.30, 0.15, 0.08, 0.04])
tau = 18  # 汇流时间
t_PMF = t_norm * tau
Q_PMF_process = Q_norm * Q_PMF

# 设计洪水过程（假设）
Q_design_process = Q_norm * Q_001
t_design = t_norm * tau

# 创建图形
fig = plt.figure(figsize=(18, 14))

# 子图1：PMP计算流程
ax1 = plt.subplot(3, 3, 1)
pmp_stages = ['点暴雨\nPMP', '面暴雨\nPMP×α', '净雨\nR=μ×PMP']
pmp_1d = [PMP1, PMP1_area, R1]
pmp_3d = [PMP3, PMP3_area, R3]
x_pos = np.arange(len(pmp_stages))
width = 0.35

bars1 = ax1.bar(x_pos - width/2, pmp_1d, width, label='1日', alpha=0.7, color='#3498db')
bars2 = ax1.bar(x_pos + width/2, pmp_3d, width, label='3日', alpha=0.7, color='#e74c3c')

for bars in [bars1, bars2]:
    for bar in bars:
        height = bar.get_height()
        ax1.text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.1f}',
                ha='center', va='bottom', fontsize=10, fontweight='bold')

ax1.set_xticks(x_pos)
ax1.set_xticklabels(pmp_stages, fontsize=11)
ax1.set_ylabel('雨量 (mm)', fontsize=12)
ax1.set_title('PMP计算流程', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3, axis='y')

# 子图2：PMF三种方法对比
ax2 = plt.subplot(3, 3, 2)
methods = ['推理公式法', '放大倍比法', '经验公式法', '加权综合']
Q_values = [Q_PMF_method1, Q_PMF_method2, Q_PMF_method3, Q_PMF]
colors_method = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12']

bars_m = ax2.bar(methods, Q_values, color=colors_method, alpha=0.7, edgecolor='black', linewidth=1.5)
for bar, val, w in zip(bars_m, Q_values, [weights[0], weights[1], weights[2], 1.0]):
    height = bar.get_height()
    if w < 1:
        label = f'{val:.0f} m³/s\n权重{w:.0%}'
    else:
        label = f'{val:.0f} m³/s'
    ax2.text(bar.get_x() + bar.get_width()/2., height,
            label,
            ha='center', va='bottom', fontsize=9.5, fontweight='bold')

ax2.axhline(Q_PMF, color='gray', linestyle='--', alpha=0.5)
ax2.set_ylabel('洪峰流量 (m³/s)', fontsize=12)
ax2.set_title('PMF洪峰计算方法对比', fontsize=14, fontweight='bold')
ax2.tick_params(axis='x', rotation=15)
ax2.grid(True, alpha=0.3, axis='y')

# 子图3：PMF与设计洪水关系
ax3 = plt.subplot(3, 3, 3)
floods = ['Q₁%\n(设计)', 'Q₀.₁%\n(设计/校核)', 'PMF\n(校核)']
Q_floods = [0.8*Q_001, Q_001, Q_PMF]  # Q1%假设为Q0.1%的80%
colors_flood = ['#95a5a6', '#3498db', '#e74c3c']
markers = ['o', 's', '^']

for i, (flood, q, color, marker) in enumerate(zip(floods, Q_floods, colors_flood, markers)):
    ax3.scatter(i, q, s=300, c=color, marker=marker, alpha=0.7, 
                edgecolors='black', linewidths=2, zorder=3)
    ax3.text(i, q + 500, f'{q:.0f}\nm³/s', ha='center', fontsize=11, fontweight='bold',
            bbox=dict(boxstyle='round,pad=0.5', facecolor=color, alpha=0.3))
    
# 连线显示递增关系
ax3.plot(range(len(floods)), Q_floods, 'k--', alpha=0.3, linewidth=2, zorder=1)

ax3.set_xticks(range(len(floods)))
ax3.set_xticklabels(floods, fontsize=11)
ax3.set_ylabel('洪峰流量 (m³/s)', fontsize=12)
ax3.set_title('不同频率洪水关系', fontsize=14, fontweight='bold')
ax3.grid(True, alpha=0.3, axis='y')
ax3.set_ylim(8000, 18000)

# 子图4：PMF与设计洪水过程对比
ax4 = plt.subplot(3, 3, 4)
ax4.plot(t_design, Q_design_process, 'b-o', linewidth=2.5, markersize=7, 
        label=f'设计洪水(P=0.1%)\nQm={Q_001} m³/s')
ax4.plot(t_PMF, Q_PMF_process, 'r-s', linewidth=2.5, markersize=7, 
        label=f'PMF洪水\nQm={Q_PMF:.0f} m³/s')
ax4.fill_between(t_design, Q_design_process, alpha=0.2, color='blue')
ax4.fill_between(t_PMF, Q_PMF_process, alpha=0.2, color='red')

# 标注洪峰
ax4.annotate(f'PMF洪峰\n{Q_PMF:.0f} m³/s',
            xy=(18, Q_PMF), xytext=(30, Q_PMF+2000),
            fontsize=11, fontweight='bold',
            bbox=dict(boxstyle='round,pad=0.5', facecolor='red', alpha=0.5),
            arrowprops=dict(arrowstyle='->', lw=2))

ax4.set_xlabel('时间 (h)', fontsize=12)
ax4.set_ylabel('流量 (m³/s)', fontsize=12)
ax4.set_title('PMF与设计洪水过程对比', fontsize=14, fontweight='bold')
ax4.legend(fontsize=11, loc='upper right')
ax4.grid(True, alpha=0.3)

# 子图5：净雨时程分配
ax5 = plt.subplot(3, 3, 5)
days = ['第1日', '第2日\n(中心)', '第3日']
rain_dist = [91.2, 251.0, 114.0]
rain_pct = np.array(rain_dist) / sum(rain_dist) * 100
colors_rain = ['#95a5a6', '#e74c3c', '#95a5a6']

bars_rain = ax5.bar(days, rain_dist, color=colors_rain, alpha=0.7, 
                    edgecolor='black', linewidth=1.5)
for bar, val, pct in zip(bars_rain, rain_dist, rain_pct):
    height = bar.get_height()
    ax5.text(bar.get_x() + bar.get_width()/2., height,
            f'{val:.1f} mm\n({pct:.0f}%)',
            ha='center', va='bottom', fontsize=11, fontweight='bold')

ax5.set_ylabel('净雨量 (mm)', fontsize=12)
ax5.set_title(f'3日净雨时程分配（总量{sum(rain_dist):.1f}mm）', fontsize=14, fontweight='bold')
ax5.grid(True, alpha=0.3, axis='y')

# 子图6：不确定性分析
ax6 = plt.subplot(3, 3, 6)
uncertainties = ['PMP估算', '产流参数', '汇流参数', '方法综合']
uncert_values = [20, 5, 8, 12]
colors_uncert = ['#e74c3c', '#f39c12', '#3498db', '#9b59b6']

bars_u = ax6.barh(uncertainties, uncert_values, color=colors_uncert, 
                  alpha=0.7, edgecolor='black', linewidth=1.5)
for bar, val in zip(bars_u, uncert_values):
    width = bar.get_width()
    ax6.text(width, bar.get_y() + bar.get_height()/2.,
            f' ±{val}%',
            ha='left', va='center', fontsize=11, fontweight='bold')

total_uncert = np.sqrt(sum(np.array(uncert_values)**2))
ax6.axvline(total_uncert, color='red', linestyle='--', linewidth=2.5, 
           label=f'综合不确定性≈±{total_uncert:.0f}%')

ax6.set_xlabel('不确定性 (%)', fontsize=12)
ax6.set_title('PMF计算不确定性来源', fontsize=14, fontweight='bold')
ax6.legend(fontsize=11)
ax6.grid(True, alpha=0.3, axis='x')

# 子图7：PMF置信区间
ax7 = plt.subplot(3, 3, 7)
Q_lower = Q_PMF * (1 - total_uncert/100)
Q_upper = Q_PMF * (1 + total_uncert/100)

ax7.errorbar(1, Q_PMF, yerr=[[Q_PMF-Q_lower], [Q_upper-Q_PMF]], 
            fmt='ro', markersize=15, capsize=10, capthick=3, 
            linewidth=3, label='PMF及置信区间')

ax7.axhspan(Q_lower, Q_upper, alpha=0.2, color='red', label=f'95%置信区间')
ax7.axhline(Q_PMF, color='red', linestyle='-', linewidth=2, alpha=0.7)
ax7.axhline(Q_001, color='blue', linestyle='--', linewidth=2, label=f'设计洪水(P=0.1%)')

ax7.text(1.15, Q_PMF, f'PMF={Q_PMF:.0f} m³/s', fontsize=11, fontweight='bold')
ax7.text(1.15, Q_upper, f'上限={Q_upper:.0f}', fontsize=10, color='red')
ax7.text(1.15, Q_lower, f'下限={Q_lower:.0f}', fontsize=10, color='red')
ax7.text(1.15, Q_001, f'Q₀.₁%={Q_001}', fontsize=10, color='blue')

ax7.set_xlim(0.5, 1.5)
ax7.set_ylim(10000, 23000)
ax7.set_xticks([1])
ax7.set_xticklabels(['PMF洪峰'], fontsize=12)
ax7.set_ylabel('流量 (m³/s)', fontsize=12)
ax7.set_title('PMF成果及不确定性', fontsize=14, fontweight='bold')
ax7.legend(fontsize=10, loc='upper left')
ax7.grid(True, alpha=0.3, axis='y')

# 子图8：工程等级与洪水标准
ax8 = plt.subplot(3, 3, 8)
grades = ['Ⅴ', 'Ⅳ', 'Ⅲ', 'Ⅱ', 'Ⅰ']
design_flood = ['P=2-5%', 'P=1-2%', 'P=0.5-1%', 'P=0.2-0.5%', 'P=0.1-0.5%']
check_flood = ['P=0.5-1%', 'P=0.2-0.5%', 'P=0.1-0.2%', 'P=0.05-0.1%', 'PMF或P=0.05%']
y_pos = np.arange(len(grades))

ax8.barh(y_pos, [1]*len(grades), left=0, height=0.35, 
        label='设计洪水', alpha=0.7, color='#3498db')
ax8.barh(y_pos, [1]*len(grades), left=1, height=0.35, 
        label='校核洪水', alpha=0.7, color='#e74c3c')

for i, (grade, design, check) in enumerate(zip(grades, design_flood, check_flood)):
    ax8.text(0.5, i, design, ha='center', va='center', fontsize=9, fontweight='bold')
    ax8.text(1.5, i, check, ha='center', va='center', fontsize=9, fontweight='bold')
    if grade == 'Ⅰ':
        ax8.text(-0.15, i, grade, ha='right', va='center', fontsize=12, 
                fontweight='bold', color='red',
                bbox=dict(boxstyle='round,pad=0.3', facecolor='yellow', alpha=0.5))
    else:
        ax8.text(-0.15, i, grade, ha='right', va='center', fontsize=11)

ax8.set_yticks(y_pos)
ax8.set_yticklabels([''] * len(grades))
ax8.set_xlim(-0.3, 2.2)
ax8.set_xticks([0.5, 1.5])
ax8.set_xticklabels(['设计洪水', '校核洪水'], fontsize=12)
ax8.set_ylabel('工程等级', fontsize=12)
ax8.set_title('水工建筑物洪水标准（本工程Ⅰ等）', fontsize=14, fontweight='bold')
ax8.grid(False)

# 子图9：计算流程图
ax9 = plt.subplot(3, 3, 9)
ax9.axis('off')

flow_text = """
PMF计算流程：

1. PMP估算
   └─> 点暴雨 → 面暴雨

2. 产流计算
   └─> 损失参数 → 净雨过程

3. 汇流计算
   └─> 推理公式/单位线 → PMF过程

4. 成果检验
   ├─> 与设计洪水对比
   ├─> 峰量关系检验
   └─> 不确定性分析

5. 工程应用
   └─> Ⅰ等工程校核洪水
"""

ax9.text(0.1, 0.95, flow_text, transform=ax9.transAxes,
        fontsize=11, verticalalignment='top', family='monospace',
        bbox=dict(boxstyle='round,pad=1', facecolor='wheat', alpha=0.5))

# 添加关键参数表
params_text = f"""
关键参数：
─────────────────
流域面积：{F} km²
PMP₁：{PMP1} mm → {PMP1_area:.1f} mm
PMP₃：{PMP3} mm → {PMP3_area:.1f} mm
径流系数：{mu}
汇流时间：{tau} h
─────────────────
PMF洪峰：{Q_PMF:.0f} m³/s
PMF/Q₀.₁%：{Q_PMF/Q_001:.2f}
"""

ax9.text(0.1, 0.45, params_text, transform=ax9.transAxes,
        fontsize=10, verticalalignment='top', family='monospace',
        bbox=dict(boxstyle='round,pad=0.8', facecolor='lightblue', alpha=0.5))

plt.tight_layout()
plt.savefig('第3章题7_可能最大洪水PMF估算.png', dpi=300, bbox_inches='tight')
plt.show()

# 输出计算结果
print("=" * 70)
print("可能最大洪水(PMF)估算计算结果")
print("=" * 70)
print(f"\n【1】PMP计算：")
print(f"  1日点暴雨：PMP₁ = {PMP1} mm")
print(f"  3日点暴雨：PMP₃ = {PMP3} mm")
print(f"  1日面暴雨：PMP₁,面 = {PMP1_area:.1f} mm（α₁={alpha1}）")
print(f"  3日面暴雨：PMP₃,面 = {PMP3_area:.1f} mm（α₃={alpha3}）")
print(f"\n【2】净雨计算：")
print(f"  径流系数：μ = {mu}")
print(f"  1日净雨：R₁ = {R1:.1f} mm")
print(f"  3日净雨：R₃ = {R3:.1f} mm")
print(f"\n【3】PMF洪峰计算：")
print(f"  推理公式法：Qm = {Q_PMF_method1:.0f} m³/s（权重{weights[0]:.0%}）")
print(f"  放大倍比法：Qm = {Q_PMF_method2:.0f} m³/s（权重{weights[1]:.0%}）")
print(f"  经验公式法：Qm = {Q_PMF_method3:.0f} m³/s（权重{weights[2]:.0%}）")
print(f"  ───────────────────────────")
print(f"  综合确定：Qm,PMF = {Q_PMF:.0f} m³/s ✓")
print(f"\n【4】与设计洪水关系：")
print(f"  设计洪水(P=0.1%)：Q₀.₁% = {Q_001} m³/s")
print(f"  PMF：Qm,PMF = {Q_PMF:.0f} m³/s")
print(f"  放大倍数：{Q_PMF/Q_001:.2f}（经验范围1.3-1.5）✓")
print(f"\n【5】不确定性分析：")
print(f"  PMP估算：±{uncert_values[0]}%（最大来源）")
print(f"  产流参数：±{uncert_values[1]}%")
print(f"  汇流参数：±{uncert_values[2]}%")
print(f"  方法综合：±{uncert_values[3]}%")
print(f"  ───────────────────────────")
print(f"  综合不确定性：±{total_uncert:.0f}%")
print(f"  95%置信区间：[{Q_lower:.0f}, {Q_upper:.0f}] m³/s")
print(f"\n【6】工程应用建议：")
print(f"  工程等级：Ⅰ等大型水库")
print(f"  校核洪水：采用PMF = {Q_PMF:.0f} m³/s")
print(f"  建议取值：{Q_PMF*1.1:.0f} m³/s（考虑10%安全裕度）")
print("=" * 70)
```

### **核心知识点**

| 知识点 | 内容 | 考试要求 |
|--------|------|----------|
| PMF定义 | 最不利条件下的极限洪水，无频率概念 | ⭐⭐⭐⭐⭐ |
| PMP估算 | 点→面换算，1日/3日暴雨组合 | ⭐⭐⭐⭐ |
| 径流系数法 | R=μ×P，PMF取最不利土壤条件 | ⭐⭐⭐⭐ |
| PMF与设计洪水比值 | 一般1.3-1.5倍Q₀.₁% | ⭐⭐⭐⭐ |
| 不确定性分析 | PMP估算是最大误差来源(±20%) | ⭐⭐⭐ |

### **常见错误**

1. **混淆PMF与设计洪水**：PMF是理论极限，不是某个频率的洪水
2. **PMP时程分配不当**：中心日应占60%左右，不能平均分配
3. **忽略不确定性分析**：PMF不确定性大，需置信区间
4. **工程等级对应错误**：只有Ⅰ等工程才需考虑PMF

### **考试策略**

- **时间分配**：28分题建议40分钟
- **得分重点**：PMP计算（9分）、PMF洪峰（10分）、不确定性（6分）
- **概念辨析**：PMF、Q₀.₀₁%、Q₀.₁%的区别和应用（必考）
- **工程应用**：Ⅰ等工程校核标准（常出选择/判断题）

---

## 题8：历史洪水调查与考证（26分）⭐⭐⭐⭐

某水库设计流域F=3200 km²，有实测洪水资料35年(1985-2019年)。通过洪水调查，发现历史上有两次特大洪水：

**历史洪水信息**：
1. **1954年7月洪水**：调查到洪痕高程，推算洪峰流量约Q₁=16800 m³/s
2. **1931年8月洪水**：据历史文献记载"百年一遇大水"，估计Q₂≈15000 m³/s

**实测系列统计**（1985-2019年，n=35）：
- 最大洪峰：Qmax=8950 m³/s（1998年）
- 平均值：Q̄=3200 m³/s  
- Cv=0.52，Cs/Cv=3.5

**要求**：
1. 确定历史洪水调查期N和实测系列年数n（20%踩分点）
2. 采用P-III型曲线，处理历史洪水，计算设计洪峰Q1%（35%踩分点）
3. 比较加入历史洪水前后设计值的差异（25%踩分点）
4. 说明历史洪水调查的可靠性判别方法（20%踩分点）

### 解答

#### **第1步：历史洪水调查期确定**【踩分点5分】

**考证原则**：
1. **1954年洪水**：有洪痕实证，可靠性高，距今2019-1954=65年
2. **1931年洪水**：仅有文献记载，可靠性需验证

**调查期确定**：
- 从文献记载最早的1931年算起
- 调查期长度：N = 2019 - 1931 + 1 = 89年

**洪水系列构成**：
- 实测系列：n = 35年（1985-2019）
- 特大值（历史洪水）：a = 2次（1931、1954）
- 一般值年数：l = N - n - a = 89 - 35 - 2 = 52年

**验证**：N = n + a + l = 35 + 2 + 52 = 89年 ✓

#### **第2步：历史洪水重现期估算**【踩分点4分】

采用**数学期望公式法**：

对于历史调查系列，第i大洪水的经验频率（重现期）：
```
Pi = (m - 0.3) / (N + 0.4)
```
其中m为序号（按洪峰大小排列）

**洪水序列排列**（仅列特大值）：
1. 1954年：Q₁ = 16800 m³/s，m=1
2. 1931年：Q₂ = 15000 m³/s，m=2  
3. 1998年：Q₃ = 8950 m³/s（实测最大），m=3
4. 其余32个实测值：m=4, 5, ..., 35

**历史洪水经验频率**：
```
P₁₉₅₄ = (1 - 0.3) / (89 + 0.4) = 0.7 / 89.4 = 0.78% ≈ 1/128年
P₁₉₃₁ = (2 - 0.3) / 89.4 = 1.7 / 89.4 = 1.90% ≈ 1/53年
```

**验证**：
- 1954年洪水重现期约128年，符合"特大洪水"定义 ✓
- 1931年洪水重现期约53年，与文献"百年一遇"有差距，需谨慎

#### **第3步：P-III型参数计算（不含历史洪水）**【踩分点6分】

仅用实测系列(n=35)计算：

**统计参数**（已知）：
```
Q̄ = 3200 m³/s
Cv = 0.52
Cs = 3.5 × Cv = 3.5 × 0.52 = 1.82
```

**P=1%设计值（不含历史洪水）**：

查P-III型频率曲线表，当Cs/Cv=3.5时：
```
P=1%：Φ₁% = 2.85
```

设计洪峰：
```
Q₁%(不含历史) = Q̄ × (1 + Cv × Φ₁%)
              = 3200 × (1 + 0.52 × 2.85)
              = 3200 × (1 + 1.482)
              = 3200 × 2.482
              = 7942 m³/s
```

#### **第4步：加入历史洪水的参数调整**【踩分点8分】

**方法1：矩法调整（近似法）**

加入历史洪水后，需调整统计参数。采用**分段统计法**：

```
Q̄* = [Σ(实测系列) + Σ(历史洪水)] / N
    = [3200×35 + 16800 + 15000] / 89
    = [112000 + 31800] / 89
    = 143800 / 89
    = 1616 m³/s
```

**修正**：上式不合理！应考虑一般值年数l=52年的贡献。

**正确方法**：
```
Q̄(加权) = [Σ(实测35年) + Σ(历史2次) + Q̄估×l] / N
```

一般值（l=52年）估计平均值约等于实测系列小值平均（去除最大10%后）：
```
Q̄一般 ≈ 0.8 × Q̄实测 = 0.8 × 3200 = 2560 m³/s
```

则：
```
Q̄* = [3200×35 + 16800 + 15000 + 2560×52] / 89
   = [112000 + 31800 + 133120] / 89
   = 276920 / 89
   = 3112 m³/s
```

**Cv调整**（简化，实际需迭代）：
历史洪水的加入会增大Cv：
```
Cv* ≈ Cv × [1 + 0.1×(a/n)] = 0.52 × [1 + 0.1×(2/35)] = 0.52 × 1.006 = 0.523
```

取：Cv* = 0.55（适当放大，考虑历史特大值）

**Cs保持或略增**：Cs* = 2.0×Cv* = 1.10（或维持Cs/Cv=3.5关系）

**方法2：适线法（推荐）**

将历史洪水作为"超定点"，在频率纸上固定：
- 1954年：Q=16800，P=0.78%（m=1，N=89）
- 1931年：Q=15000，P=1.90%（m=2，N=89）

实测系列的经验频率需按调整公式：
```
Pm = (m - 0.3 - a) / (n + 0.4)
```
其中a=2为超过实测系列的历史洪水个数。

例如实测最大值(1998年，Q=8950)：
```
P₁₉₉₈ = (1 - 0.3 - 2) / (35 + 0.4) = -1.3 / 35.4（负值，说明公式需调整）
```

**正确的适线法经验频率**（对实测系列）：
```
Pm = a + (m - 0.3) × (N - a) / n / (N + 0.4)
```

对于m=1的实测最大（实际序列第3大）：
```
P = [2 + (1-0.3)×(89-2)/35] / 89.4
  = [2 + 0.7×2.486] / 89.4
  = 3.74 / 89.4 = 4.18%
```

通过适线法，调整Cv*和Cs*，使曲线通过历史点和实测点。

**适线结果**（假设迭代收敛）：
```
Q̄* = 3100 m³/s
Cv* = 0.58
Cs* = 2.0
```

#### **第5步：P=1%设计洪峰计算（含历史洪水）**【踩分点6分】

查P-III型表，Cs/Cv = 2.0/0.58 = 3.45 ≈ 3.5：
```
P=1%：Φ₁% = 2.85
```

设计洪峰：
```
Q₁%(含历史) = Q̄* × (1 + Cv* × Φ₁%)
            = 3100 × (1 + 0.58 × 2.85)
            = 3100 × (1 + 1.653)
            = 3100 × 2.653
            = 8224 m³/s
```

**检验**：8224 < 15000 < 16800，符合P=1%(1/100)应小于P=1.9%(1/53)和P=0.78%(1/128) ✓

#### **第6步：历史洪水影响分析**【踩分点5分】

| 项目 | 不含历史洪水 | 含历史洪水 | 变化 |
|------|--------------|------------|------|
| 系列长度 | n=35年 | N=89年 | +154% |
| 平均值Q̄ | 3200 m³/s | 3100 m³/s | -3.1% |
| Cv | 0.52 | 0.58 | +11.5% |
| Cs/Cv | 3.5 | 3.45 | -1.4% |
| Q₁% | 7942 m³/s | 8224 m³/s | +3.6% |

**结论**：
1. **系列延长**：N从35年增至89年，代表性显著提高
2. **Cv增大**：历史特大值使变差系数增大12%，反映极值特性
3. **Q₁%增大**：设计值增加3.6%（282 m³/s），工程意义重大
4. **合理性**：历史洪水的加入使设计更安全

#### **第7步：历史洪水可靠性判别**【踩分点5分】

**①实证材料可靠性**：
- **洪痕法**（1954年）：⭐⭐⭐⭐⭐ 最可靠
  - 高程测量误差：±5-10cm
  - 流量推算误差：±10-15%（比降法、曼宁公式）
  - 综合可靠度：A级（可直接使用）

- **文献记载**（1931年）：⭐⭐⭐ 可靠性一般
  - "百年一遇"属定性描述，误差±30-50%
  - 需多方文献印证
  - 综合可靠度：B级（可参考使用，权重降低）

**②一致性检验**：
对1954年洪水，检验暴雨→洪水关系：
```
设该次洪水3日雨量P₃=280 mm（据气象资料）
径流系数：μ = W/P/F（需推算洪量W）
与地区平均μ=0.68-0.72对比，判断合理性
```

**③地区比拟检验**：
邻近流域1954年同期洪水：
- A站（F=2800 km²）：Qm=15200 m³/s，qm=5.43 m³/(s·km²)
- 本站（F=3200 km²）：Qm=16800 m³/s，qm=5.25 m³/(s·km²)

洪峰模数接近，支持16800的合理性 ✓

**④频率合理性检验**：
1954年洪水经验频率P=0.78%（重现期128年），与"特大洪水"定义相符 ✓

**⑤等级评定**：

| 等级 | 判别标准 | 处理方法 |
|------|----------|----------|
| A级 | 有洪痕+实测+地区印证 | 直接作为超定点 |
| B级 | 有文献+部分验证 | 适线时权重0.5-0.7 |
| C级 | 仅有传说或定性记载 | 仅作参考，不入系列 |

**本题等级**：
- 1954年：A级，直接使用
- 1931年：B级，适线时降权或作为参考范围

### **答案总结**

**1. 调查期与系列构成**：
- 调查期：N = 89年（1931-2019）
- 实测系列：n = 35年
- 历史特大值：a = 2次
- 一般值年数：l = 52年

**2. 历史洪水经验频率**：
- 1954年：P = 0.78%，重现期128年
- 1931年：P = 1.90%，重现期53年

**3. 设计洪峰对比**：
- 不含历史洪水：Q₁% = 7942 m³/s
- 含历史洪水：Q₁% = 8224 m³/s
- 增幅：+3.6%（+282 m³/s）

**4. 可靠性等级**：
- 1954年：A级（洪痕法，直接使用）
- 1931年：B级（文献记载，降权使用）

**5. 建议**：采用含历史洪水成果Q₁%=8224 m³/s，工程更安全

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from matplotlib import font_manager

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 基本数据
F = 3200  # 流域面积
n = 35  # 实测年数
N = 89  # 调查期
a = 2   # 历史特大值数
l = N - n - a  # 一般值年数

# 历史洪水
Q_hist = np.array([16800, 15000])
years_hist = [1954, 1931]
m_hist = [1, 2]
P_hist = [(m - 0.3) / (N + 0.4) * 100 for m in m_hist]

# 实测系列（模拟，最大值8950）
np.random.seed(42)
Q_obs = np.sort(np.random.lognormal(mean=7.8, sigma=0.5, size=n))[::-1]
Q_obs[0] = 8950  # 最大值
Q_obs = Q_obs * 3200 / Q_obs.mean()  # 调整使均值为3200

# 不含历史洪水的统计
Qm_obs = Q_obs.mean()
Cv_obs = Q_obs.std(ddof=1) / Qm_obs
Cv_obs = 0.52  # 使用题目值
Cs_obs = 3.5 * Cv_obs

# 含历史洪水的统计（简化）
Q_general_mean = 0.8 * Qm_obs  # 一般值估计
Qm_with_hist = (Qm_obs*n + Q_hist.sum() + Q_general_mean*l) / N
Cv_with_hist = 0.58
Cs_with_hist = 2.0

# P=1%设计值
Phi_1pct = 2.85  # 查表（Cs/Cv≈3.5）
Q_1pct_no_hist = Qm_obs * (1 + Cv_obs * Phi_1pct)
Q_1pct_with_hist = Qm_with_hist * (1 + Cv_with_hist * Phi_1pct)

# 频率曲线计算
P_range = np.array([0.01, 0.1, 0.5, 1, 2, 5, 10, 20, 33.3, 50])
# P-III型Φ值（Cs/Cv=3.5）
Phi_no_hist = np.array([3.15, 2.85, 2.50, 2.25, 2.00, 1.65, 1.35, 1.00, 0.70, 0.40])
Q_curve_no_hist = Qm_obs * (1 + Cv_obs * Phi_no_hist)
# 含历史洪水（Cs/Cv≈3.5）
Q_curve_with_hist = Qm_with_hist * (1 + Cv_with_hist * Phi_no_hist)

# 实测系列经验频率
m_obs = np.arange(1, n+1)
P_obs = (m_obs - 0.3) / (n + 0.4) * 100

# 创建图形
fig = plt.figure(figsize=(18, 14))

# 子图1：频率曲线对比（半对数纸）
ax1 = plt.subplot(3, 3, 1)
ax1.semilogx(P_range, Q_curve_no_hist/1000, 'b-', linewidth=2.5, label='不含历史洪水')
ax1.semilogx(P_range, Q_curve_with_hist/1000, 'r-', linewidth=2.5, label='含历史洪水')
ax1.semilogx(P_obs, Q_obs/1000, 'bo', markersize=6, alpha=0.6, label='实测点')
ax1.semilogx(P_hist, Q_hist/1000, 'r^', markersize=12, label='历史洪水')

# 标注历史洪水
for year, q, p in zip(years_hist, Q_hist, P_hist):
    ax1.annotate(f'{year}年\nQ={q/1000:.1f}\nP={p:.2f}%',
                xy=(p, q/1000), xytext=(15, 5), textcoords='offset points',
                fontsize=9, bbox=dict(boxstyle='round,pad=0.4', facecolor='yellow', alpha=0.7),
                arrowprops=dict(arrowstyle='->', lw=1.5))

# 标注P=1%设计值
ax1.axhline(Q_1pct_no_hist/1000, color='blue', linestyle='--', alpha=0.5)
ax1.axhline(Q_1pct_with_hist/1000, color='red', linestyle='--', alpha=0.5)
ax1.text(50, Q_1pct_no_hist/1000, f'{Q_1pct_no_hist:.0f}', 
        fontsize=10, color='blue', fontweight='bold')
ax1.text(50, Q_1pct_with_hist/1000, f'{Q_1pct_with_hist:.0f}', 
        fontsize=10, color='red', fontweight='bold')

ax1.set_xlabel('频率 P (%)', fontsize=12)
ax1.set_ylabel('洪峰流量 (×10³ m³/s)', fontsize=12)
ax1.set_title('历史洪水对频率曲线的影响', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10, loc='lower left')
ax1.grid(True, alpha=0.3, which='both')
ax1.set_xlim(0.05, 100)

# 子图2：系列构成示意图
ax2 = plt.subplot(3, 3, 2)
series_components = ['实测系列\nn', '历史特大值\na', '一般值\nl']
series_years = [n, a, l]
colors_series = ['#3498db', '#e74c3c', '#95a5a6']
explode = (0.05, 0.15, 0)

wedges, texts, autotexts = ax2.pie(series_years, explode=explode, labels=series_components,
                                     colors=colors_series, autopct='%1.1f%%',
                                     startangle=90, textprops={'fontsize': 11})
for autotext in autotexts:
    autotext.set_color('white')
    autotext.set_fontweight('bold')

ax2.set_title(f'洪水系列构成（总调查期N={N}年）', fontsize=14, fontweight='bold')

# 添加数字标注
center_text = f'n={n}\na={a}\nl={l}\nN={N}'
ax2.text(0, 0, center_text, ha='center', va='center', fontsize=11,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='wheat', alpha=0.7))

# 子图3：统计参数对比
ax3 = plt.subplot(3, 3, 3)
params = ['均值Q̄\n(m³/s)', 'Cv', 'Cs', 'Q₁%\n(m³/s)']
values_no_hist = [Qm_obs, Cv_obs, Cs_obs, Q_1pct_no_hist]
values_with_hist = [Qm_with_hist, Cv_with_hist, Cs_with_hist, Q_1pct_with_hist]

x_pos = np.arange(len(params))
width = 0.35

bars1 = ax3.bar(x_pos - width/2, values_no_hist, width, 
               label='不含历史', alpha=0.7, color='#3498db')
bars2 = ax3.bar(x_pos + width/2, values_with_hist, width, 
               label='含历史', alpha=0.7, color='#e74c3c')

# 标注数值
for bars in [bars1, bars2]:
    for bar in bars:
        height = bar.get_height()
        ax3.text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.0f}' if height > 10 else f'{height:.2f}',
                ha='center', va='bottom', fontsize=9, fontweight='bold')

ax3.set_xticks(x_pos)
ax3.set_xticklabels(params, fontsize=10)
ax3.set_ylabel('参数值', fontsize=12)
ax3.set_title('统计参数对比', fontsize=14, fontweight='bold')
ax3.legend(fontsize=11)
ax3.grid(True, alpha=0.3, axis='y')

# 子图4：设计洪峰变化
ax4 = plt.subplot(3, 3, 4)
Q_diff = Q_1pct_with_hist - Q_1pct_no_hist
Q_diff_pct = Q_diff / Q_1pct_no_hist * 100

bars_q = ax4.bar(['不含历史洪水', '含历史洪水'], 
                 [Q_1pct_no_hist, Q_1pct_with_hist],
                 color=['#3498db', '#e74c3c'], alpha=0.7, edgecolor='black', linewidth=2)

for bar, val in zip(bars_q, [Q_1pct_no_hist, Q_1pct_with_hist]):
    height = bar.get_height()
    ax4.text(bar.get_x() + bar.get_width()/2., height,
            f'{val:.0f} m³/s',
            ha='center', va='bottom', fontsize=12, fontweight='bold')

# 标注差异
ax4.annotate('', xy=(1, Q_1pct_no_hist), xytext=(1, Q_1pct_with_hist),
            arrowprops=dict(arrowstyle='<->', lw=2.5, color='green'))
ax4.text(1.15, (Q_1pct_no_hist + Q_1pct_with_hist)/2,
        f'+{Q_diff:.0f} m³/s\n(+{Q_diff_pct:.1f}%)',
        fontsize=11, fontweight='bold', color='green',
        bbox=dict(boxstyle='round,pad=0.5', facecolor='lightyellow', alpha=0.8))

ax4.set_ylabel('P=1%设计洪峰 (m³/s)', fontsize=12)
ax4.set_title('设计洪峰流量对比', fontsize=14, fontweight='bold')
ax4.grid(True, alpha=0.3, axis='y')

# 子图5：历史洪水时间轴
ax5 = plt.subplot(3, 3, 5)
ax5.set_xlim(1920, 2025)
ax5.set_ylim(0, 3)

# 时间轴
ax5.axhline(1.5, color='black', linewidth=2)
ax5.plot([1931, 2019], [1.5, 1.5], 'k-', linewidth=4, label=f'调查期({N}年)')
ax5.plot([1985, 2019], [1.5, 1.5], 'b-', linewidth=6, label=f'实测期({n}年)')

# 历史洪水标记
ax5.plot(1954, 1.5, 'r^', markersize=20, label='历史洪水')
ax5.plot(1931, 1.5, 'r^', markersize=20)

# 标注
ax5.text(1931, 2.2, '1931年洪水\nQ≈15000 m³/s\n文献记载\n可靠性B级', 
        ha='center', fontsize=9,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='orange', alpha=0.7))
ax5.text(1954, 2.2, '1954年洪水\nQ=16800 m³/s\n洪痕实证\n可靠性A级', 
        ha='center', fontsize=9,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='red', alpha=0.5))
ax5.text(2002, 0.8, f'实测系列\n{n}年\nQmax={Q_obs[0]:.0f}', 
        ha='center', fontsize=9,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='lightblue', alpha=0.7))

# 关键年份标注
for year in [1931, 1954, 1985, 2019]:
    ax5.axvline(year, color='gray', linestyle=':', alpha=0.5)
    ax5.text(year, 0.2, str(year), ha='center', fontsize=10, rotation=0)

ax5.set_xlabel('年份', fontsize=12)
ax5.set_yticks([])
ax5.set_title('历史洪水调查时间轴', fontsize=14, fontweight='bold')
ax5.legend(fontsize=10, loc='upper left')
ax5.grid(False)

# 子图6：可靠性等级评定
ax6 = plt.subplot(3, 3, 6)
reliability_criteria = ['实证材料', '一致性', '地区比拟', '频率合理性', '综合等级']
score_1954 = [5, 4.5, 5, 5, 5]  # A级
score_1931 = [2.5, 3, 3.5, 3, 3]  # B级

y_pos = np.arange(len(reliability_criteria))
height = 0.35

bars_r1 = ax6.barh(y_pos - height/2, score_1954, height, 
                   label='1954年洪水', alpha=0.7, color='#e74c3c')
bars_r2 = ax6.barh(y_pos + height/2, score_1931, height, 
                   label='1931年洪水', alpha=0.7, color='#f39c12')

for bars in [bars_r1, bars_r2]:
    for bar in bars:
        width_bar = bar.get_width()
        stars = '⭐' * int(width_bar)
        ax6.text(width_bar, bar.get_y() + bar.get_height()/2.,
                f' {stars}',
                ha='left', va='center', fontsize=10)

ax6.set_yticks(y_pos)
ax6.set_yticklabels(reliability_criteria, fontsize=11)
ax6.set_xlabel('可靠性评分', fontsize=12)
ax6.set_xlim(0, 5.5)
ax6.set_xticks(range(6))
ax6.set_xticklabels(['0', '1', '2', '3', '4', '5\n(最高)'])
ax6.set_title('历史洪水可靠性评定', fontsize=14, fontweight='bold')
ax6.legend(fontsize=11, loc='lower right')
ax6.grid(True, alpha=0.3, axis='x')

# 子图7：洪峰模数地区对比
ax7 = plt.subplot(3, 3, 7)
stations = ['A站\n(邻近)', '本站\n1954年', '本站\n1998年\n(实测最大)']
F_stations = [2800, F, F]
Q_stations = [15200, 16800, 8950]
qm_stations = [Q/F for Q, F in zip(Q_stations, F_stations)]

colors_stations = ['#95a5a6', '#e74c3c', '#3498db']
bars_qm = ax7.bar(stations, qm_stations, color=colors_stations, 
                  alpha=0.7, edgecolor='black', linewidth=1.5)

for bar, q, f, qm in zip(bars_qm, Q_stations, F_stations, qm_stations):
    height = bar.get_height()
    ax7.text(bar.get_x() + bar.get_width()/2., height,
            f'qm={qm:.2f}\nQ={q}\nF={f}',
            ha='center', va='bottom', fontsize=9, fontweight='bold')

# 地区经验范围
ax7.axhspan(4.5, 6.0, alpha=0.15, color='green', label='地区经验范围')

ax7.set_ylabel('洪峰模数 qm [m³/(s·km²)]', fontsize=12)
ax7.set_title('洪峰模数地区比拟检验', fontsize=14, fontweight='bold')
ax7.legend(fontsize=10)
ax7.grid(True, alpha=0.3, axis='y')

# 子图8：频率-重现期对照
ax8 = plt.subplot(3, 3, 8)
P_values = [0.78, 1.90, 100*1/35, 1, 2, 5, 10]
T_values = [100/p for p in P_values]
labels_p = ['1954年\n洪水', '1931年\n洪水', '实测最大\n(平均)', 'P=1%\n设计', 'P=2%', 'P=5%', 'P=10%']
colors_p = ['red', 'orange', 'blue', 'green', 'gray', 'gray', 'gray']

bars_t = ax8.barh(range(len(P_values)), T_values, color=colors_p, 
                  alpha=0.6, edgecolor='black', linewidth=1.5)

for i, (bar, p, t, label) in enumerate(zip(bars_t, P_values, T_values, labels_p)):
    width = bar.get_width()
    ax8.text(width, bar.get_y() + bar.get_height()/2.,
            f' T={t:.0f}年',
            ha='left', va='center', fontsize=10, fontweight='bold')

ax8.set_yticks(range(len(P_values)))
ax8.set_yticklabels(labels_p, fontsize=10)
ax8.set_xlabel('重现期 T (年)', fontsize=12)
ax8.set_xscale('log')
ax8.set_title('频率与重现期对照', fontsize=14, fontweight='bold')
ax8.grid(True, alpha=0.3, axis='x', which='both')

# 子图9：计算结果汇总
ax9 = plt.subplot(3, 3, 9)
ax9.axis('off')

result_text = f"""
【计算结果汇总】

1. 系列构成
   ├ 调查期：N = {N}年 (1931-2019)
   ├ 实测系列：n = {n}年
   ├ 历史特大值：a = {a}次
   └ 一般值年数：l = {l}年

2. 历史洪水经验频率
   ├ 1954年：Q={Q_hist[0]} m³/s
   │         P={P_hist[0]:.2f}%, T≈128年
   └ 1931年：Q={Q_hist[1]} m³/s
             P={P_hist[1]:.2f}%, T≈53年

3. 统计参数对比
   ┌─────────┬────────┬────────┐
   │  参数   │ 不含历史│ 含历史  │
   ├─────────┼────────┼────────┤
   │ Q̄(m³/s) │  {Qm_obs:.0f}  │  {Qm_with_hist:.0f}  │
   │   Cv    │  {Cv_obs:.2f}  │  {Cv_with_hist:.2f}  │
   │   Cs    │  {Cs_obs:.2f}  │  {Cs_with_hist:.2f}  │
   └─────────┴────────┴────────┘

4. P=1%设计洪峰
   ├ 不含历史：Q₁% = {Q_1pct_no_hist:.0f} m³/s
   ├ 含历史：  Q₁% = {Q_1pct_with_hist:.0f} m³/s
   └ 增幅：    +{Q_diff:.0f} m³/s (+{Q_diff_pct:.1f}%)

5. 可靠性等级
   ├ 1954年：A级（洪痕实证）
   └ 1931年：B级（文献记载）

6. 建议采用
   └ Q₁% = {Q_1pct_with_hist:.0f} m³/s（含历史洪水）
"""

ax9.text(0.05, 0.95, result_text, transform=ax9.transAxes,
        fontsize=10, verticalalignment='top', family='monospace',
        bbox=dict(boxstyle='round,pad=1', facecolor='lightyellow', alpha=0.8))

plt.tight_layout()
plt.savefig('第3章题8_历史洪水调查与考证.png', dpi=300, bbox_inches='tight')
plt.show()

# 输出计算结果
print("=" * 70)
print("历史洪水调查与考证计算结果")
print("=" * 70)
print(f"\n【1】系列构成：")
print(f"  调查期：N = {N}年 (1931-2019)")
print(f"  实测系列：n = {n}年 (1985-2019)")
print(f"  历史特大值：a = {a}次")
print(f"  一般值年数：l = {l}年")
print(f"  验证：N = n + a + l = {n} + {a} + {l} = {N} ✓")
print(f"\n【2】历史洪水经验频率：")
for i, (year, q, m, p) in enumerate(zip(years_hist, Q_hist, m_hist, P_hist)):
    T = 100 / p
    print(f"  {year}年：Q = {q} m³/s")
    print(f"          P = {p:.2f}%，重现期T ≈ {T:.0f}年")
print(f"\n【3】统计参数（不含历史洪水）：")
print(f"  Q̄ = {Qm_obs:.0f} m³/s")
print(f"  Cv = {Cv_obs:.2f}")
print(f"  Cs = {Cs_obs:.2f}")
print(f"\n【4】统计参数（含历史洪水）：")
print(f"  Q̄* = {Qm_with_hist:.0f} m³/s")
print(f"  Cv* = {Cv_with_hist:.2f}")
print(f"  Cs* = {Cs_with_hist:.2f}")
print(f"\n【5】P=1%设计洪峰：")
print(f"  不含历史洪水：Q₁% = {Q_1pct_no_hist:.0f} m³/s")
print(f"  含历史洪水：  Q₁% = {Q_1pct_with_hist:.0f} m³/s")
print(f"  差异：+{Q_diff:.0f} m³/s (+{Q_diff_pct:.1f}%)")
print(f"\n【6】可靠性评定：")
print(f"  1954年洪水：A级（洪痕实证，可直接使用）")
print(f"  1931年洪水：B级（文献记载，可参考使用）")
print(f"\n【7】推荐成果：")
print(f"  采用含历史洪水成果：Q₁% = {Q_1pct_with_hist:.0f} m³/s")
print(f"  理由：①系列延长至{N}年，代表性提高")
print(f"        ②设计值提高{Q_diff_pct:.1f}%，工程更安全")
print(f"        ③历史洪水可靠性高，应充分利用")
print("=" * 70)
```

### **核心知识点**

| 知识点 | 内容 | 考试要求 |
|--------|------|----------|
| 调查期确定 | N=最早可靠记载年～调查年 | ⭐⭐⭐⭐⭐ |
| 系列构成 | N=n+a+l（实测+特大值+一般值） | ⭐⭐⭐⭐⭐ |
| 经验频率公式 | Pm=(m-0.3)/(N+0.4) | ⭐⭐⭐⭐ |
| 可靠性等级 | A级（实证）、B级（文献）、C级（传说） | ⭐⭐⭐⭐ |
| 参数调整 | 加入历史洪水后Cv增大10-20% | ⭐⭐⭐ |

### **常见错误**

1. **调查期确定错误**：从实测开始算起，忽略历史洪水前的"一般值年数"
2. **经验频率公式用错**：实测系列加入历史洪水后，频率公式需调整
3. **可靠性分级混乱**：文献记载的"百年一遇"不能等同于洪痕实证
4. **忽略一致性检验**：历史洪水流量需通过暴雨-径流关系验证

### **考试策略**

- **时间分配**：26分题建议35分钟
- **得分重点**：系列构成(5分)、参数调整(8分)、可靠性评定(5分)
- **概念题常考**：N、n、a、l的关系，经验频率公式
- **作图要求**：频率曲线上标注历史洪水点位（加2-3分）

---

## 题9：分期设计洪水计算（27分）⭐⭐⭐⭐

某水库流域F=2400 km²，主汛期(6-9月)与非汛期(10月-次年5月)洪水特性差异显著。统计40年资料(1980-2019年)：

**主汛期洪峰统计**（n=40）：
- 均值：Q̄汛=4800 m³/s
- Cv=0.60，Cs=2.0×Cv=1.20

**非汛期洪峰统计**（n=40）：
- 均值：Q̄非=1200 m³/s
- Cv=0.45，Cs=2.5×Cv=1.125

**年最大洪峰统计**（n=40）：
- 均值：Q̄年=5200 m³/s
- Cv=0.58，Cs=2.2×Cv=1.276

**水库特性**：
- 正常蓄水位：汛期156m，非汛期162m
- 设计洪水标准：P=1%

**要求**：
1. 说明分期设计洪水的概念及必要性（15%踩分点）
2. 计算主汛期和非汛期P=1%设计洪峰（30%踩分点）
3. 与年最大值法对比，分析差异（25%踩分点）
4. 确定各时期的设计洪水标准及运用调度（30%踩分点）

### 解答

#### **第1步：分期设计洪水概念**【踩分点4分】

**定义**：
将一年划分为若干时期（如汛期/非汛期、月），分别推求各时期的设计洪水。

**必要性**：
1. **洪水特性差异**：
   - 主汛期（6-9月）：暴雨型洪水，峰高量大
   - 非汛期（10-5月）：融雪或锋面雨，峰低历时长
   
2. **工程运用需求**：
   - 主汛期：低水位运行（156m），保留防洪库容
   - 非汛期：高水位运行（162m），增加发电兴利效益
   
3. **频率不可加性**：
   - 年最大值≠汛期最大+非汛期最大
   - 同一频率的年洪水可能出现在不同时期

**适用条件**：
- 洪水成因分期明显（如季风区）
- 水库有分期运用计划
- 各期洪水统计独立性好

#### **第2步：主汛期P=1%设计洪峰**【踩分点7分】

**统计参数**：
```
Q̄汛 = 4800 m³/s
Cv,汛 = 0.60
Cs,汛 = 1.20
Cs/Cv = 1.20 / 0.60 = 2.0
```

**查P-III型频率曲线表**（Cs/Cv=2.0，P=1%）：
```
Φ₁%,汛 = 2.35
```

**设计洪峰**：
```
Q₁%,汛 = Q̄汛 × (1 + Cv,汛 × Φ₁%,汛)
       = 4800 × (1 + 0.60 × 2.35)
       = 4800 × (1 + 1.41)
       = 4800 × 2.41
       = 11568 m³/s ≈ 11600 m³/s
```

#### **第3步：非汛期P=1%设计洪峰**【踩分点7分】

**统计参数**：
```
Q̄非 = 1200 m³/s
Cv,非 = 0.45
Cs,非 = 1.125
Cs/Cv = 1.125 / 0.45 = 2.5
```

**查P-III型频率曲线表**（Cs/Cv=2.5，P=1%）：
```
Φ₁%,非 = 2.58
```

**设计洪峰**：
```
Q₁%,非 = Q̄非 × (1 + Cv,非 × Φ₁%,非)
       = 1200 × (1 + 0.45 × 2.58)
       = 1200 × (1 + 1.161)
       = 1200 × 2.161
       = 2593 m³/s ≈ 2600 m³/s
```

#### **第4步：年最大值法P=1%设计洪峰**【踩分点4分】

**统计参数**：
```
Q̄年 = 5200 m³/s
Cv,年 = 0.58
Cs,年 = 1.276
Cs/Cv = 1.276 / 0.58 = 2.2
```

**查P-III型表**（Cs/Cv=2.2，P=1%）：
```
Φ₁%,年 = 2.42
```

**设计洪峰**：
```
Q₁%,年 = Q̄年 × (1 + Cv,年 × Φ₁%,年)
       = 5200 × (1 + 0.58 × 2.42)
       = 5200 × (1 + 1.404)
       = 5200 × 2.404
       = 12501 m³/s ≈ 12500 m³/s
```

#### **第5步：分期法与年最大值法对比**【踩分点6分】

| 项目 | 主汛期分期法 | 非汛期分期法 | 年最大值法 |
|------|-------------|-------------|-----------|
| 均值(m³/s) | 4800 | 1200 | 5200 |
| Cv | 0.60 | 0.45 | 0.58 |
| Cs/Cv | 2.0 | 2.5 | 2.2 |
| Φ₁% | 2.35 | 2.58 | 2.42 |
| Q₁%(m³/s) | 11600 | 2600 | 12500 |

**对比分析**：

**①主汛期设计值**：
```
Q₁%,汛 = 11600 m³/s < Q₁%,年 = 12500 m³/s
差异：12500 - 11600 = 900 m³/s（-7.2%）
```

**原因**：
- 年最大值系列中包含非汛期个别大值，拉高了均值和Cv
- 主汛期单独统计更符合该期洪水特性

**②非汛期设计值**：
```
Q₁%,非 = 2600 m³/s << Q₁%,年 = 12500 m³/s
比值：2600 / 12500 = 20.8%
```

**意义**：
- 非汛期洪水远小于年最大值法
- 若非汛期仍按12500 m³/s防洪，水位降低过多，经济损失大
- 分期设计允许非汛期抬高水位至162m运行

**③频率含义差异**：
- **年最大值法**：全年任意时刻遭遇≥12500 m³/s的频率为1%
- **分期法**：主汛期遭遇≥11600的频率为1%，非汛期遭遇≥2600的频率为1%

**④工程风险**：
假设主汛期占全年8个月(2/3)，非汛期占4个月(1/3)。

采用分期设计，全年风险：
```
P全年 ≈ P汛×时段比 + P非×时段比
      = 1% × (4/12) + 1% × (8/12)
      = 0.33% + 0.67% = 1%（近似）
```

但实际上，由于各期最大值独立性，风险计算更复杂：
```
P全年 = 1 - (1 - P汛)^(汛期年数占比) × (1 - P非)^(非汛期年数占比)
      ≈ 1 - 0.99 × 0.99 = 1.99% ≈ 2%
```

**分期设计风险略高于年最大值法（1% vs 2%），但换取经济效益**

#### **第6步：设计洪水标准确定与调度**【踩分点8分】

**①主汛期（6月1日-9月30日）**：

**设计标准**：
- 设计洪水：Q₁%,汛 = 11600 m³/s（分期法）
- 校核洪水：按年最大值法或PMF

**调度方式**：
- 起调水位：156m（汛限水位）
- 防洪库容：V防 = V(162m) - V(156m)（全部用于防洪）
- 泄洪原则：入库≤出库能力时，尽量降低水位；洪峰来临前预泄

**理由**：主汛期暴雨频繁，必须留足防洪库容

**②非汛期（10月1日-次年5月31日）**：

**设计标准**：
- 设计洪水：Q₁%,非 = 2600 m³/s（分期法）
- 校核洪水：Q₀.₁%,非 ≈ 4500 m³/s（估算）

**调度方式**：
- 起调水位：162m（正常蓄水位）
- 防洪库容：V防,非 = V(校核水位) - V(162m)（较小）
- 兴利调度：优先发电、供水，遇洪再降水位

**理由**：非汛期洪水小，可抬高水位增加发电水头和库容

**③过渡期（5月、10月）**：

**设计标准**：
- 采用5月、10月单独统计的设计值
- 或采用主汛期与非汛期的包络值（偏安全）

**调度方式**：
- 5月：逐步降低水位，162m→156m（汛前消落）
- 10月：逐步抬升水位，156m→162m（汛后蓄水）

**④风险控制**：

虽然分期设计风险略高（~2% vs 1%），但可通过：
- **预报调度**：利用气象预报，汛期提前预泄
- **动态汛限水位**：根据预报调整汛限水位（如"蓄滞"模式）
- **超标准洪水应对**：预留非常溢洪道

将综合风险控制在可接受范围。

**⑤效益对比**（简化估算）：

| 方案 | 汛期水位 | 非汛期水位 | 年均发电量 | 防洪风险 |
|------|---------|-----------|-----------|---------|
| 年最大值法 | 156m | 156m | 100% | 1% |
| 分期设计法 | 156m | 162m | 115-120% | ~2% |

**结论**：分期设计可增加发电15-20%，风险增加可接受（1%→2%）

### **答案总结**

**1. 分期设计洪水**：
- 主汛期(6-9月)：Q₁%,汛 = 11600 m³/s
- 非汛期(10-5月)：Q₁%,非 = 2600 m³/s

**2. 年最大值法**：Q₁%,年 = 12500 m³/s

**3. 对比分析**：
- 主汛期分期值比年值小7.2%（11600 vs 12500）
- 非汛期分期值仅为年值的21%（2600 vs 12500）

**4. 调度策略**：
- 主汛期：156m起调，留足防洪库容
- 非汛期：162m起调，增加兴利效益
- 年发电量提高15-20%

**5. 风险评估**：
- 年最大值法风险：1%
- 分期法风险：~2%（可通过预报调度控制）

**6. 建议**：采用分期设计，经济效益显著，风险可控

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from matplotlib import font_manager

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 基本数据
F = 2400  # 流域面积

# 主汛期统计
Qm_flood = 4800
Cv_flood = 0.60
Cs_flood = 1.20

# 非汛期统计
Qm_nonflood = 1200
Cv_nonflood = 0.45
Cs_nonflood = 1.125

# 年最大值统计
Qm_annual = 5200
Cv_annual = 0.58
Cs_annual = 1.276

# P=1%设计值
Phi_flood = 2.35  # Cs/Cv=2.0
Phi_nonflood = 2.58  # Cs/Cv=2.5
Phi_annual = 2.42  # Cs/Cv=2.2

Q_1pct_flood = Qm_flood * (1 + Cv_flood * Phi_flood)
Q_1pct_nonflood = Qm_nonflood * (1 + Cv_nonflood * Phi_nonflood)
Q_1pct_annual = Qm_annual * (1 + Cv_annual * Phi_annual)

# 频率曲线
P_range = np.array([0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 33.3, 50])
# P-III型Φ值（根据不同Cs/Cv）
Phi_flood_curve = np.array([3.05, 2.80, 2.50, 2.35, 2.10, 1.75, 1.45, 1.10, 0.78, 0.48])
Phi_nonflood_curve = np.array([3.35, 3.05, 2.70, 2.58, 2.30, 1.90, 1.55, 1.18, 0.83, 0.50])
Phi_annual_curve = np.array([3.15, 2.88, 2.58, 2.42, 2.18, 1.82, 1.48, 1.13, 0.80, 0.49])

Q_flood_curve = Qm_flood * (1 + Cv_flood * Phi_flood_curve)
Q_nonflood_curve = Qm_nonflood * (1 + Cv_nonflood * Phi_nonflood_curve)
Q_annual_curve = Qm_annual * (1 + Cv_annual * Phi_annual_curve)

# 创建图形
fig = plt.figure(figsize=(18, 14))

# 子图1：分期频率曲线对比
ax1 = plt.subplot(3, 3, 1)
ax1.semilogx(P_range, Q_flood_curve/1000, 'r-o', linewidth=2.5, markersize=6, 
            label='主汛期(6-9月)')
ax1.semilogx(P_range, Q_nonflood_curve/1000, 'b-s', linewidth=2.5, markersize=6, 
            label='非汛期(10-5月)')
ax1.semilogx(P_range, Q_annual_curve/1000, 'g-^', linewidth=2.5, markersize=6, 
            label='年最大值')

# 标注P=1%设计值
ax1.axvline(1, color='gray', linestyle=':', alpha=0.7)
ax1.plot(1, Q_1pct_flood/1000, 'ro', markersize=12)
ax1.plot(1, Q_1pct_nonflood/1000, 'bs', markersize=12)
ax1.plot(1, Q_1pct_annual/1000, 'g^', markersize=12)

ax1.text(1.5, Q_1pct_flood/1000, f'{Q_1pct_flood:.0f}', fontsize=10, color='red', fontweight='bold')
ax1.text(1.5, Q_1pct_nonflood/1000, f'{Q_1pct_nonflood:.0f}', fontsize=10, color='blue', fontweight='bold')
ax1.text(1.5, Q_1pct_annual/1000, f'{Q_1pct_annual:.0f}', fontsize=10, color='green', fontweight='bold')

ax1.set_xlabel('频率 P (%)', fontsize=12)
ax1.set_ylabel('洪峰流量 (×10³ m³/s)', fontsize=12)
ax1.set_title('分期频率曲线对比', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11, loc='lower left')
ax1.grid(True, alpha=0.3, which='both')
ax1.set_xlim(0.1, 100)

# 子图2：统计参数对比
ax2 = plt.subplot(3, 3, 2)
params_names = ['均值\nQ̄', 'Cv', 'Cs/Cv', 'Φ₁%']
flood_params = [Qm_flood, Cv_flood, Cs_flood/Cv_flood, Phi_flood]
nonflood_params = [Qm_nonflood, Cv_nonflood, Cs_nonflood/Cv_nonflood, Phi_nonflood]
annual_params = [Qm_annual, Cv_annual, Cs_annual/Cv_annual, Phi_annual]

x_pos = np.arange(len(params_names))
width = 0.25

bars1 = ax2.bar(x_pos - width, flood_params, width, label='主汛期', alpha=0.7, color='red')
bars2 = ax2.bar(x_pos, nonflood_params, width, label='非汛期', alpha=0.7, color='blue')
bars3 = ax2.bar(x_pos + width, annual_params, width, label='年最大值', alpha=0.7, color='green')

for bars in [bars1, bars2, bars3]:
    for bar in bars:
        height = bar.get_height()
        if height > 10:
            label = f'{height:.0f}'
        else:
            label = f'{height:.2f}'
        ax2.text(bar.get_x() + bar.get_width()/2., height,
                label, ha='center', va='bottom', fontsize=8.5, fontweight='bold')

ax2.set_xticks(x_pos)
ax2.set_xticklabels(params_names, fontsize=11)
ax2.set_ylabel('参数值', fontsize=12)
ax2.set_title('统计参数对比', fontsize=14, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, alpha=0.3, axis='y')

# 子图3：P=1%设计洪峰对比
ax3 = plt.subplot(3, 3, 3)
design_methods = ['主汛期\n分期法', '非汛期\n分期法', '年最大值法']
Q_1pct_values = [Q_1pct_flood, Q_1pct_nonflood, Q_1pct_annual]
colors_design = ['#e74c3c', '#3498db', '#2ecc71']

bars_design = ax3.bar(design_methods, Q_1pct_values, color=colors_design, 
                      alpha=0.7, edgecolor='black', linewidth=2)

for bar, val in zip(bars_design, Q_1pct_values):
    height = bar.get_height()
    ax3.text(bar.get_x() + bar.get_width()/2., height,
            f'{val:.0f} m³/s',
            ha='center', va='bottom', fontsize=11, fontweight='bold')

ax3.set_ylabel('P=1%设计洪峰 (m³/s)', fontsize=12)
ax3.set_title('P=1%设计洪峰对比', fontsize=14, fontweight='bold')
ax3.grid(True, alpha=0.3, axis='y')

# 子图4：年内洪水过程分布（模拟）
ax4 = plt.subplot(3, 3, 4)
months = np.arange(1, 13)
month_labels = ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']

# 模拟各月平均洪峰（主汛期6-9月高，其他月低）
Q_monthly_avg = np.array([800, 900, 1000, 1200, 1500, 3500, 5200, 5500, 4200, 1800, 1100, 900])
Q_monthly_max = np.array([1500, 1800, 2000, 2500, 3200, 8500, 11600, 10800, 9200, 3500, 2200, 1700])

ax4.bar(months, Q_monthly_avg/1000, alpha=0.6, color='lightblue', label='月均洪峰')
ax4.plot(months, Q_monthly_max/1000, 'ro-', linewidth=2.5, markersize=8, label='月最大洪峰')

# 标注分期
ax4.axvspan(6, 9, alpha=0.15, color='red', label='主汛期')
ax4.axvspan(10, 12, alpha=0.15, color='blue')
ax4.axvspan(1, 5, alpha=0.15, color='blue', label='非汛期')

# 标注设计值
ax4.axhline(Q_1pct_flood/1000, xmin=5/12, xmax=9/12, color='red', 
           linestyle='--', linewidth=2, label=f'主汛期设计值{Q_1pct_flood:.0f}')
ax4.axhline(Q_1pct_nonflood/1000, xmin=0, xmax=5/12, color='blue', 
           linestyle='--', linewidth=2)
ax4.axhline(Q_1pct_nonflood/1000, xmin=9/12, xmax=1, color='blue', 
           linestyle='--', linewidth=2, label=f'非汛期设计值{Q_1pct_nonflood:.0f}')

ax4.set_xticks(months)
ax4.set_xticklabels(month_labels, rotation=45)
ax4.set_ylabel('洪峰流量 (×10³ m³/s)', fontsize=12)
ax4.set_title('年内洪水分布特征', fontsize=14, fontweight='bold')
ax4.legend(fontsize=9, loc='upper left')
ax4.grid(True, alpha=0.3, axis='y')

# 子图5：水库分期运用水位
ax5 = plt.subplot(3, 3, 5)
months_water = np.arange(1, 13)
# 水位变化：非汛期162m，主汛期156m，过渡期线性变化
water_levels = np.array([162, 162, 162, 162, 160, 156, 156, 156, 156, 158, 162, 162])

ax5.plot(months_water, water_levels, 'b-o', linewidth=3, markersize=10, label='运行水位')
ax5.fill_between(months_water, water_levels, 150, alpha=0.3, color='lightblue')

# 标注关键水位
ax5.axhline(162, color='green', linestyle='--', linewidth=2, label='正常蓄水位162m')
ax5.axhline(156, color='red', linestyle='--', linewidth=2, label='汛限水位156m')

# 标注分期
ax5.axvspan(6, 9, alpha=0.15, color='red')
ax5.text(7.5, 153, '主汛期\n低水位运行\n156m', ha='center', fontsize=10,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='red', alpha=0.3))
ax5.text(2, 153, '非汛期\n高水位运行\n162m', ha='center', fontsize=10,
        bbox=dict(boxstyle='round,pad=0.5', facecolor='blue', alpha=0.3))
ax5.text(5, 157, '汛前消落', ha='center', fontsize=9, rotation=45)
ax5.text(10, 159, '汛后蓄水', ha='center', fontsize=9, rotation=45)

ax5.set_xticks(months_water)
ax5.set_xticklabels(month_labels, rotation=45)
ax5.set_ylabel('水位 (m)', fontsize=12)
ax5.set_ylim(150, 165)
ax5.set_title('水库分期运用水位', fontsize=14, fontweight='bold')
ax5.legend(fontsize=10, loc='lower left')
ax5.grid(True, alpha=0.3)

# 子图6：效益对比（年最大值法 vs 分期法）
ax6 = plt.subplot(3, 3, 6)
schemes = ['年最大值法\n(全年156m)', '分期法\n(汛期156m\n非汛期162m)']
power_generation = [100, 118]  # 相对发电量
flood_risk = [1.0, 2.0]  # 防洪风险%

ax6_twin = ax6.twinx()

bars_power = ax6.bar(schemes, power_generation, alpha=0.7, color='#2ecc71', 
                     edgecolor='black', linewidth=2, label='发电量')
line_risk = ax6_twin.plot(schemes, flood_risk, 'ro-', linewidth=3, markersize=12, 
                          label='防洪风险')

for bar, val in zip(bars_power, power_generation):
    height = bar.get_height()
    ax6.text(bar.get_x() + bar.get_width()/2., height,
            f'{val}%',
            ha='center', va='bottom', fontsize=12, fontweight='bold')

for i, (scheme, risk) in enumerate(zip(schemes, flood_risk)):
    ax6_twin.text(i, risk + 0.15, f'{risk}%', ha='center', 
                 fontsize=11, color='red', fontweight='bold')

ax6.set_ylabel('相对年发电量 (%)', fontsize=12, color='green')
ax6_twin.set_ylabel('防洪风险 (%)', fontsize=12, color='red')
ax6.set_ylim(90, 125)
ax6_twin.set_ylim(0, 3)
ax6.set_title('年最大值法 vs 分期法效益对比', fontsize=14, fontweight='bold')
ax6.tick_params(axis='y', labelcolor='green')
ax6_twin.tick_params(axis='y', labelcolor='red')
ax6.legend(loc='upper left', fontsize=11)
ax6_twin.legend(loc='upper right', fontsize=11)
ax6.grid(True, alpha=0.3, axis='y')

# 子图7：分期设计合理性分析
ax7 = plt.subplot(3, 3, 7)
criteria = ['洪水特性\n差异', '工程需求\n差异', '统计独立性', '经济效益', '风险可控性']
scores = [5, 5, 4.5, 5, 4]
colors_criteria = ['#e74c3c', '#3498db', '#f39c12', '#2ecc71', '#9b59b6']

bars_score = ax7.barh(criteria, scores, color=colors_criteria, alpha=0.7, 
                      edgecolor='black', linewidth=1.5)

for bar, score in zip(bars_score, scores):
    width = bar.get_width()
    stars = '⭐' * int(score)
    ax7.text(width, bar.get_y() + bar.get_height()/2.,
            f' {score:.1f} {stars}',
            ha='left', va='center', fontsize=10, fontweight='bold')

ax7.set_xlabel('评分', fontsize=12)
ax7.set_xlim(0, 5.5)
ax7.set_xticks(range(6))
ax7.set_title('分期设计必要性评估', fontsize=14, fontweight='bold')
ax7.grid(True, alpha=0.3, axis='x')

# 子图8：风险分析（概率树）
ax8 = plt.subplot(3, 3, 8)
ax8.axis('off')
ax8.set_xlim(0, 10)
ax8.set_ylim(0, 10)

# 概率树图
ax8.text(5, 9, '全年防洪风险', ha='center', fontsize=12, fontweight='bold',
        bbox=dict(boxstyle='round,pad=0.6', facecolor='yellow', alpha=0.7))

# 主汛期分支
ax8.arrow(4.5, 8.7, -2, -2, head_width=0.3, head_length=0.2, fc='red', ec='red', lw=2)
ax8.text(2, 6.2, '主汛期\n(4个月, 1/3年)', ha='center', fontsize=10,
        bbox=dict(boxstyle='round,pad=0.4', facecolor='red', alpha=0.5))
ax8.text(2, 5, f'P=1%\nQ>{Q_1pct_flood:.0f}', ha='center', fontsize=9)

# 非汛期分支
ax8.arrow(5.5, 8.7, 2, -2, head_width=0.3, head_length=0.2, fc='blue', ec='blue', lw=2)
ax8.text(8, 6.2, '非汛期\n(8个月, 2/3年)', ha='center', fontsize=10,
        bbox=dict(boxstyle='round,pad=0.4', facecolor='blue', alpha=0.5))
ax8.text(8, 5, f'P=1%\nQ>{Q_1pct_nonflood:.0f}', ha='center', fontsize=9)

# 风险计算
risk_text = """
分期法全年风险（简化）：
P≈1-(1-P汛)×(1-P非)
  =1-0.99×0.99
  =1.99% ≈ 2%

年最大值法风险：
P = 1%

结论：分期法风险略高1%
      但可通过预报调度控制
"""
ax8.text(5, 2, risk_text, ha='center', fontsize=9, family='monospace',
        bbox=dict(boxstyle='round,pad=0.8', facecolor='wheat', alpha=0.7))

ax8.set_title('分期设计风险分析', fontsize=14, fontweight='bold')

# 子图9：调度决策流程
ax9 = plt.subplot(3, 3, 9)
ax9.axis('off')

decision_flow = """
【分期设计洪水调度决策】

1. 主汛期 (6-9月)
   ├ 设计标准：Q₁%={:.0f} m³/s
   ├ 起调水位：156m (汛限水位)
   ├ 防洪库容：全部用于防洪
   └ 调度原则：确保防洪安全

2. 非汛期 (10-5月)
   ├ 设计标准：Q₁%={:.0f} m³/s
   ├ 起调水位：162m (正常蓄水位)
   ├ 兴利优先：发电、供水
   └ 调度原则：兼顾经济效益

3. 过渡期 (5月、10月)
   ├ 5月：162m→156m (汛前消落)
   ├ 10月：156m→162m (汛后蓄水)
   └ 调度原则：平稳过渡

4. 效益分析
   ├ 年发电量提高：+18%
   ├ 防洪风险增加：1%→2%
   └ 综合评价：效益显著，风险可控

5. 风险控制措施
   ├ 气象预报：提前3-7天预泄
   ├ 动态调整：汛限水位可调
   └ 应急预案：超标准洪水应对
""".format(Q_1pct_flood, Q_1pct_nonflood)

ax9.text(0.05, 0.95, decision_flow, transform=ax9.transAxes,
        fontsize=10, verticalalignment='top', family='monospace',
        bbox=dict(boxstyle='round,pad=1', facecolor='lightblue', alpha=0.6))

plt.tight_layout()
plt.savefig('第3章题9_分期设计洪水计算.png', dpi=300, bbox_inches='tight')
plt.show()

# 输出计算结果
print("=" * 70)
print("分期设计洪水计算结果")
print("=" * 70)
print(f"\n【1】主汛期(6-9月)设计洪水：")
print(f"  统计参数：Q̄={Qm_flood} m³/s, Cv={Cv_flood}, Cs/Cv={Cs_flood/Cv_flood}")
print(f"  Φ₁% = {Phi_flood}")
print(f"  Q₁%,汛 = {Q_1pct_flood:.0f} m³/s")
print(f"\n【2】非汛期(10-5月)设计洪水：")
print(f"  统计参数：Q̄={Qm_nonflood} m³/s, Cv={Cv_nonflood}, Cs/Cv={Cs_nonflood/Cv_nonflood:.1f}")
print(f"  Φ₁% = {Phi_nonflood}")
print(f"  Q₁%,非 = {Q_1pct_nonflood:.0f} m³/s")
print(f"\n【3】年最大值法设计洪水：")
print(f"  统计参数：Q̄={Qm_annual} m³/s, Cv={Cv_annual}, Cs/Cv={Cs_annual/Cv_annual:.1f}")
print(f"  Φ₁% = {Phi_annual}")
print(f"  Q₁%,年 = {Q_1pct_annual:.0f} m³/s")
print(f"\n【4】对比分析：")
print(f"  主汛期分期值 vs 年值：{Q_1pct_flood:.0f} vs {Q_1pct_annual:.0f}")
print(f"                       差异：{Q_1pct_annual-Q_1pct_flood:.0f} m³/s ({(Q_1pct_annual-Q_1pct_flood)/Q_1pct_annual*100:.1f}%)")
print(f"  非汛期分期值 vs 年值：{Q_1pct_nonflood:.0f} vs {Q_1pct_annual:.0f}")
print(f"                       比值：{Q_1pct_nonflood/Q_1pct_annual*100:.1f}%")
print(f"\n【5】调度方案：")
print(f"  主汛期：起调水位156m，设计洪水{Q_1pct_flood:.0f} m³/s")
print(f"  非汛期：起调水位162m，设计洪水{Q_1pct_nonflood:.0f} m³/s")
print(f"  效益：年发电量提高约18%")
print(f"\n【6】风险评估：")
print(f"  年最大值法风险：1%")
print(f"  分期法风险：约2%")
print(f"  风险控制：通过预报调度可控制在可接受范围")
print(f"\n【7】建议：")
print(f"  采用分期设计方案，经济效益显著，风险可控")
print("=" * 70)
```

### **核心知识点**

| 知识点 | 内容 | 考试要求 |
|--------|------|----------|
| 分期设计概念 | 按时期分别推求设计洪水 | ⭐⭐⭐⭐⭐ |
| 必要性 | 洪水特性差异+工程运用需求 | ⭐⭐⭐⭐ |
| 系列独立性 | 各期最大值系列应独立 | ⭐⭐⭐⭐ |
| 风险计算 | P全年≈1-(1-P汛)(1-P非) | ⭐⭐⭐ |
| 调度策略 | 汛期低水位、非汛期高水位 | ⭐⭐⭐⭐ |

### **常见错误**

1. **混淆年最大值与分期值**：两者频率含义不同，不能直接比较
2. **忽略风险增加**：分期设计风险略高，必须论证可控性
3. **分期划分不当**：应根据洪水成因，不能简单按季节
4. **系列独立性检验缺失**：汛期/非汛期系列需独立性检验

### **考试策略**

- **时间分配**：27分题建议35-40分钟
- **得分重点**：概念理解(4分)、分期计算(14分)、对比分析(6分)
- **概念辨析**：分期设计vs年最大值法的适用条件（常考）
- **风险分析**：必须说明风险控制措施，否则扣分

---

## 题10：设计暴雨推求设计洪水（30分）⭐⭐⭐⭐⭐

某小流域F=85 km²，流域长度L=18 km，平均比降J=0.008，缺乏实测洪水资料，但有邻近气象站50年降雨资料。通过暴雨频率分析得到：

**设计暴雨成果**（P=1%）：
- 1小时点暴雨：H₁,₁% = 65 mm
- 6小时点暴雨：H₆,₁% = 125 mm
- 24小时点暴雨：H₂₄,₁% = 180 mm

**暴雨参数**：
- 点面折算系数：Kp = 0.90（F<100 km²）
- 设计雨型：雨峰系数r=0.40（中心型）

**产汇流参数**（查地区图集）：
- 前期影响雨量Pa = 40 mm
- 稳渗率fc = 2.5 mm/h
- 汇流参数：m=0.80

**要求**：
1. 推求P=1%设计暴雨过程（30%踩分点）
2. 计算设计净雨过程（25%踩分点）
3. 采用推理公式法推求设计洪峰流量（25%踩分点）
4. 对比暴雨资料法与实测资料法的优缺点（20%踩分点）

### 解答

#### **第1步：确定设计历时与暴雨**【踩分点6分】

**汇流时间估算**：

采用经验公式（山区、土壤）：
```
τ = 0.278 × L / (J^0.25 × F^0.1)
  = 0.278 × 18 / (0.008^0.25 × 85^0.1)
  = 0.278 × 18 / (0.30 × 1.66)
  = 5.0 / 0.498
  = 10.0 h
```

**设计历时确定**：
取T = τ = 10 h（或稍长，取12h）

**内插计算10小时暴雨**：

采用暴雨递减指数公式：
```
Ht = H₁ × t^n
```

先求指数n（利用H₆和H₂₄）：
```
H₂₄ / H₆ = (24 / 6)^n = 4^n
180 / 125 = 4^n
1.44 = 4^n
n = log(1.44) / log(4) = 0.157 / 0.602 = 0.26
```

验证（用H₁）：
```
H₆ = H₁ × 6^0.26 = 65 × 1.60 = 104 mm（与125略有差异，采用H₆、H₂₄拟合）
```

重新计算n（用H₆、H₂₄）：
```
n ≈ 0.26
```

**10小时暴雨**：
```
H₁₀,₁% = H₆,₁% × (10/6)^0.26
       = 125 × 1.667^0.26
       = 125 × 1.138
       = 142 mm
```

**面雨量**：
```
Hm,₁₀ = Kp × H₁₀,₁% = 0.90 × 142 = 128 mm
```

#### **第2步：设计暴雨时程分配**【踩分点8分】

采用**同频率暴雨法**，雨峰系数r=0.40。

将10小时分为10个时段（Δt=1h），雨峰在第r×n时段。

**雨峰位置**：
```
峰位 = r × n = 0.40 × 10 = 4（第4时段）
```

**典型雨型**（中心型，峰前较峰后陡）：

| 时段 | 1 | 2 | 3 | 4(峰) | 5 | 6 | 7 | 8 | 9 | 10 |
|------|---|---|-----|-------|---|---|---|---|---|----|
| 占比(%) | 5 | 10 | 18 | 25 | 15 | 10 | 7 | 5 | 3 | 2 |

**各时段雨量**：
```
总雨量：Hm,₁₀ = 128 mm
```

| 时段i | 占比αi | hi = αi×128 (mm) |
|-------|--------|------------------|
| 1 | 5% | 6.4 |
| 2 | 10% | 12.8 |
| 3 | 18% | 23.0 |
| 4 | 25% | 32.0 |
| 5 | 15% | 19.2 |
| 6 | 10% | 12.8 |
| 7 | 7% | 9.0 |
| 8 | 5% | 6.4 |
| 9 | 3% | 3.8 |
| 10 | 2% | 2.6 |

合计：128.0 mm ✓

#### **第3步：设计净雨过程计算**【踩分点7分】

采用**φ指数法**（稳渗率法）：

**前期土壤含水量**：
```
前期影响雨量Pa = 40 mm（中等湿润）
```

**损失参数**：
- 初损Im = 5 mm（小流域）
- 稳渗率fc = 2.5 mm/h

**逐时段计算净雨**：

第1时段：
```
累计雨量P₁ = 6.4 mm < Im = 5 mm（但实际Im会分摊到前几个时段）
```

简化计算，采用**φ指数法**：

总损失：
```
W损 = Im + fc × T = 5 + 2.5 × 10 = 30 mm
```

净雨深：
```
R = Hm - W损 = 128 - 30 = 98 mm
```

**时段净雨分配**（超渗产流）：

当hi > fc×Δt时，时段净雨为：
```
ri = hi - fc×Δt = hi - 2.5 mm（Δt=1h）
```

| 时段i | hi(mm) | fc×Δt=2.5 | ri=max(hi-2.5,0) |
|-------|--------|-----------|------------------|
| 1 | 6.4 | 2.5 | 3.9 |
| 2 | 12.8 | 2.5 | 10.3 |
| 3 | 23.0 | 2.5 | 20.5 |
| 4 | 32.0 | 2.5 | 29.5 |
| 5 | 19.2 | 2.5 | 16.7 |
| 6 | 12.8 | 2.5 | 10.3 |
| 7 | 9.0 | 2.5 | 6.5 |
| 8 | 6.4 | 2.5 | 3.9 |
| 9 | 3.8 | 2.5 | 1.3 |
| 10 | 2.6 | 2.5 | 0.1 |

合计：R = 102.9 mm（与R=98略有差异，因初损未单独扣除）

**修正**：扣除初损Im=5mm后，按比例分配：
```
ri' = ri × (R / Σri) = ri × (98 / 103) = ri × 0.951
```

修正后净雨：

| 时段i | ri' (mm) |
|-------|----------|
| 1 | 3.7 |
| 2 | 9.8 |
| 3 | 19.5 |
| 4 | 28.1 |
| 5 | 15.9 |
| 6 | 9.8 |
| 7 | 6.2 |
| 8 | 3.7 |
| 9 | 1.2 |
| 10 | 0.1 |

总净雨：R ≈ 98 mm ✓

#### **第4步：推理公式法推求设计洪峰**【踩分点7分】

推理公式：
```
Qm = 0.278 × φ × Sp × F / τ
```

**参数确定**：

**①汇流系数φ**：
```
φ = m = 0.80（地区参数）
```

**②最大时段平均净雨强度Sp**：

取汇流时间τ=10h内的最大净雨，即全部10时段：
```
Sp = R / T = 98 / 10 = 9.8 mm/h
```

或采用更精确的方法，取与τ相近的时段组合。由于τ=10h，取全部10时段：
```
最大净雨量：R_max = 98 mm（全部）
对应历时：T = 10 h
Sp = 98 / 10 = 9.8 mm/h
```

**③流域面积F**：
```
F = 85 km²
```

**④汇流时间τ**：
```
τ = 10 h
```

**设计洪峰流量**：
```
Qm,₁% = 0.278 × φ × Sp × F / τ
      = 0.278 × 0.80 × 9.8 × 85 / 10
      = 0.278 × 0.80 × 9.8 × 8.5
      = 0.278 × 66.64
      = 18.5 m³/s
```

**检验**：

洪峰模数：
```
qm = Qm / F = 18.5 / 85 = 0.218 m³/(s·km²)
```

查地区经验值：小流域P=1%洪峰模数0.15-0.30 m³/(s·km²) ✓

#### **第5步：敏感性分析**【踩分点2分】

**汇流参数m的影响**：

若m=0.70（偏小）：
```
Qm = 18.5 × (0.70 / 0.80) = 16.2 m³/s（-12.4%）
```

若m=0.90（偏大）：
```
Qm = 18.5 × (0.90 / 0.80) = 20.8 m³/s（+12.4%）
```

**结论**：m变化±0.1导致Qm变化±12%，参数确定很关键

**稳渗率fc的影响**：

若fc=2.0 mm/h：
```
R = 128 - (5 + 2.0×10) = 103 mm
Sp = 10.3 mm/h
Qm = 18.5 × (10.3 / 9.8) = 19.4 m³/s（+4.9%）
```

若fc=3.0 mm/h：
```
R = 128 - (5 + 3.0×10) = 93 mm
Sp = 9.3 mm/h
Qm = 18.5 × (9.3 / 9.8) = 17.6 m³/s（-4.9%）
```

**结论**：fc变化±0.5影响Qm约±5%

#### **第6步：暴雨资料法vs实测资料法对比**【踩分点6分】

| 对比项 | 暴雨资料法 | 实测洪水资料法 |
|--------|-----------|---------------|
| **适用条件** | 缺乏洪水资料，有暴雨资料 | 有较长洪水系列（>20年） |
| **数据来源** | 气象站雨量（易获取） | 水文站流量（稀缺） |
| **计算过程** | 暴雨→净雨→洪水（复杂） | 洪水统计→频率分析（直接） |
| **主要误差** | ①暴雨点面折算<br>②产流参数不确定<br>③汇流参数经验性强 | ①系列长度有限<br>②代表性问题 |
| **精度** | 一般，误差15-25% | 较高，误差10-15% |
| **适用流域** | 小流域(<200 km²)首选 | 中大流域(>200 km²) |
| **成本** | 低（利用已有气象资料） | 高（需建水文站） |
| **可靠性** | 依赖参数合理性 | 依赖实测系列长度 |

**暴雨资料法优点**：
1. 气象站网密集，资料易得
2. 暴雨系列长（通常>50年），频率可靠
3. 可推求未建站流域洪水
4. 成本低，周期短

**暴雨资料法缺点**：
1. 点面折算、产流、汇流参数不确定性大
2. 小流域适用性好，大流域误差增大
3. 需地区参数，外延使用风险高
4. 不能反映流域特殊下垫面条件

**实测资料法优点**：
1. 直接反映流域产汇流特性
2. 参数少，物理概念清晰
3. 中大流域精度高
4. 可靠性高（若系列充分）

**实测资料法缺点**：
1. 需长系列（≥30年），短系列误差大
2. 建站成本高，周期长
3. 未建站流域无法使用
4. 下垫面变化（城市化）需资料还原

**工程应用建议**：
- **小流域**（F<100 km²）：首选暴雨资料法
- **中流域**（100-1000 km²）：两法结合，互相验证
- **大流域**（>1000 km²）：首选实测资料法，暴雨法辅助
- **重要工程**：两法并用，综合确定

### **答案总结**

**1. 设计暴雨**：
- 10小时点暴雨：H₁₀,₁% = 142 mm
- 10小时面暴雨：Hm,₁₀ = 128 mm
- 雨峰位置：第4时段（r=0.40）

**2. 设计净雨**：
- 总净雨深：R = 98 mm
- 峰时段净雨：r₄ = 28.1 mm
- 损失：W = 30 mm（初损5mm+稳渗25mm）

**3. 设计洪峰**：
- Q₁% = 18.5 m³/s
- qm = 0.218 m³/(s·km²)
- 推理公式：Qm = 0.278×φ×Sp×F/τ

**4. 方法对比**：
- 暴雨资料法：适用小流域，误差15-25%
- 实测资料法：适用中大流域，误差10-15%
- 本流域（F=85 km²）适合暴雨资料法

**5. 敏感性**：
- 汇流参数m变化±0.1 → Qm变化±12%
- 稳渗率fc变化±0.5 → Qm变化±5%

### Python可视化代码

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import font_manager

plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 基本参数
F = 85  # km²
L = 18  # km
J = 0.008
tau = 10  # h

# 设计暴雨
H1_1pct = 65  # mm
H6_1pct = 125
H24_1pct = 180
H10_1pct = 142
Hm_10 = 128  # 面雨量

# 雨型分配
rain_distribution = np.array([5, 10, 18, 25, 15, 10, 7, 5, 3, 2]) / 100
h_design = Hm_10 * rain_distribution

# 产流参数
Pa = 40
fc = 2.5  # mm/h
Im = 5  # mm
m = 0.80

# 净雨计算
r_design = np.maximum(h_design - fc, 0)
R_total = 98
r_design = r_design * (R_total / r_design.sum())  # 归一化

# 洪峰计算
Sp = R_total / tau
Qm_1pct = 0.278 * m * Sp * F / tau

# 创建图形
fig = plt.figure(figsize=(18, 14))

# 子图1：暴雨递减关系
ax1 = plt.subplot(3, 3, 1)
durations = np.array([1, 6, 10, 24])
H_point = np.array([H1_1pct, H6_1pct, H10_1pct, H24_1pct])
# 拟合曲线
t_fit = np.logspace(0, np.log10(24), 50)
n = 0.26
H_fit = H6_1pct * (t_fit / 6)**n

ax1.loglog(durations, H_point, 'ro', markersize=10, label='设计点')
ax1.loglog(t_fit, H_fit, 'b-', linewidth=2, label=f'拟合曲线(n={n})')
ax1.loglog(10, H10_1pct, 'r^', markersize=15, label='采用值(10h)')

for d, h in zip(durations, H_point):
    ax1.text(d, h*1.1, f'{h:.0f}mm', ha='center', fontsize=10, fontweight='bold')

ax1.set_xlabel('历时 t (h)', fontsize=12)
ax1.set_ylabel('点暴雨 H (mm)', fontsize=12)
ax1.set_title('P=1%暴雨递减关系', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3, which='both')

# 子图2：设计暴雨时程分配
ax2 = plt.subplot(3, 3, 2)
hours = np.arange(1, 11)
bars_rain = ax2.bar(hours, h_design, alpha=0.7, color='skyblue', 
                    edgecolor='black', linewidth=1.5, label='时段雨量')

# 标注雨峰
peak_idx = np.argmax(h_design)
bars_rain[peak_idx].set_color('red')
bars_rain[peak_idx].set_alpha(0.8)

for i, h in enumerate(h_design):
    ax2.text(hours[i], h, f'{h:.1f}', ha='center', va='bottom', 
            fontsize=9, fontweight='bold')

ax2.axhline(h_design.mean(), color='green', linestyle='--', linewidth=2, 
           label=f'平均={h_design.mean():.1f}mm')
ax2.text(9, h_design.mean()*1.1, f'雨峰系数r=0.40\n峰在第{peak_idx+1}时段', 
        fontsize=10, bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.7))

ax2.set_xlabel('时段 (h)', fontsize=12)
ax2.set_ylabel('雨量 (mm)', fontsize=12)
ax2.set_title(f'设计暴雨时程分配（总量{Hm_10}mm）', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3, axis='y')
ax2.set_xticks(hours)

# 子图3：净雨计算过程
ax3 = plt.subplot(3, 3, 3)
ax3.bar(hours, h_design, alpha=0.5, color='blue', label='总雨量')
ax3.bar(hours, r_design, alpha=0.7, color='red', label='净雨')

# 标注损失
loss = h_design - r_design
ax3.bar(hours, loss, bottom=r_design, alpha=0.3, color='gray', label='损失')

ax3.axhline(fc, color='orange', linestyle='--', linewidth=2, 
           label=f'稳渗率fc={fc}mm/h')

ax3.set_xlabel('时段 (h)', fontsize=12)
ax3.set_ylabel('雨量 (mm)', fontsize=12)
ax3.set_title('降雨-净雨关系', fontsize=14, fontweight='bold')
ax3.legend(fontsize=10, loc='upper right')
ax3.grid(True, alpha=0.3, axis='y')
ax3.set_xticks(hours)

# 子图4：推理公式参数
ax4 = plt.subplot(3, 3, 4)
ax4.axis('off')

formula_text = f"""
【推理公式法计算】

公式：Qm = 0.278 × φ × Sp × F / τ

参数取值：
─────────────────────
φ (汇流系数)      = {m}
Sp (净雨强度)     = {Sp:.2f} mm/h
F (流域面积)      = {F} km²
τ (汇流时间)      = {tau} h
─────────────────────

计算过程：
Qm = 0.278 × {m} × {Sp:.2f} × {F} / {tau}
   = 0.278 × {m * Sp * F / tau:.2f}
   = {Qm_1pct:.1f} m³/s

洪峰模数：
qm = Qm / F = {Qm_1pct:.1f} / {F}
   = {Qm_1pct/F:.3f} m³/(s·km²)

地区经验范围：0.15-0.30 ✓
"""

ax4.text(0.1, 0.9, formula_text, transform=ax4.transAxes,
        fontsize=10, verticalalignment='top', family='monospace',
        bbox=dict(boxstyle='round,pad=1', facecolor='lightblue', alpha=0.7))

# 子图5：参数敏感性分析
ax5 = plt.subplot(3, 3, 5)

# m的影响
m_values = np.array([0.70, 0.75, 0.80, 0.85, 0.90])
Qm_m = 0.278 * m_values * Sp * F / tau

# fc的影响  
fc_values = np.array([2.0, 2.25, 2.5, 2.75, 3.0])
R_fc = Hm_10 - (Im + fc_values * tau)
Sp_fc = R_fc / tau
Qm_fc = 0.278 * m * Sp_fc * F / tau

ax5.plot(m_values, Qm_m, 'ro-', linewidth=2.5, markersize=8, label='汇流系数m')
ax5_twin = ax5.twinx()
ax5_twin.plot(fc_values, Qm_fc, 'bs-', linewidth=2.5, markersize=8, label='稳渗率fc')

ax5.axvline(m, color='red', linestyle='--', alpha=0.5)
ax5_twin.axvline(fc, color='blue', linestyle='--', alpha=0.5)
ax5.axhline(Qm_1pct, color='gray', linestyle=':', alpha=0.5)

ax5.set_xlabel('参数值变化', fontsize=12)
ax5.set_ylabel('洪峰流量 Qm (m³/s) [m]', fontsize=11, color='red')
ax5_twin.set_ylabel('洪峰流量 Qm (m³/s) [fc]', fontsize=11, color='blue')
ax5.set_title('参数敏感性分析', fontsize=14, fontweight='bold')
ax5.tick_params(axis='y', labelcolor='red')
ax5_twin.tick_params(axis='y', labelcolor='blue')
ax5.legend(loc='upper left', fontsize=10)
ax5_twin.legend(loc='upper right', fontsize=10)
ax5.grid(True, alpha=0.3)

# 子图6：暴雨法vs实测法对比
ax6 = plt.subplot(3, 3, 6)
methods = ['暴雨资料法', '实测资料法']
advantages = [7, 6]  # 优点数量
disadvantages = [4, 4]
applicability = [8, 6]  # 适用性(小流域视角)

x_pos = np.arange(len(methods))
width = 0.25

bars1 = ax6.bar(x_pos - width, advantages, width, label='优点', alpha=0.7, color='#2ecc71')
bars2 = ax6.bar(x_pos, disadvantages, width, label='缺点', alpha=0.7, color='#e74c3c')
bars3 = ax6.bar(x_pos + width, applicability, width, label='适用性', alpha=0.7, color='#3498db')

for bars in [bars1, bars2, bars3]:
    for bar in bars:
        height = bar.get_height()
        ax6.text(bar.get_x() + bar.get_width()/2., height,
                f'{int(height)}',
                ha='center', va='bottom', fontsize=10, fontweight='bold')

ax6.set_xticks(x_pos)
ax6.set_xticklabels(methods, fontsize=11)
ax6.set_ylabel('评分', fontsize=12)
ax6.set_ylim(0, 10)
ax6.set_title('暴雨法vs实测法综合对比', fontsize=14, fontweight='bold')
ax6.legend(fontsize=11)
ax6.grid(True, alpha=0.3, axis='y')

# 子图7：流域大小适用性
ax7 = plt.subplot(3, 3, 7)
F_range = np.logspace(0, 4, 50)  # 1-10000 km²

# 适用性评分（0-1）
score_rainfall = 1 / (1 + (F_range / 100)**1.5)  # 小流域好
score_observed = 1 / (1 + (100 / F_range)**1.2)  # 大流域好

ax7.semilogx(F_range, score_rainfall * 100, 'r-', linewidth=3, label='暴雨资料法')
ax7.semilogx(F_range, score_observed * 100, 'b-', linewidth=3, label='实测资料法')
ax7.fill_between(F_range, score_rainfall * 100, alpha=0.2, color='red')
ax7.fill_between(F_range, score_observed * 100, alpha=0.2, color='blue')

# 标注本流域
ax7.axvline(F, color='green', linestyle='--', linewidth=2.5, label=f'本流域F={F} km²')
ax7.plot(F, score_rainfall[np.argmin(np.abs(F_range - F))] * 100, 'r^', markersize=15)

# 标注分区
ax7.axvspan(1, 100, alpha=0.1, color='red')
ax7.axvspan(100, 1000, alpha=0.1, color='yellow')
ax7.axvspan(1000, 10000, alpha=0.1, color='blue')
ax7.text(20, 90, '暴雨法首选', fontsize=10, fontweight='bold', color='red')
ax7.text(300, 50, '两法结合', fontsize=10, fontweight='bold', color='orange')
ax7.text(3000, 90, '实测法首选', fontsize=10, fontweight='bold', color='blue')

ax7.set_xlabel('流域面积 F (km²)', fontsize=12)
ax7.set_ylabel('适用性评分', fontsize=12)
ax7.set_xlim(1, 10000)
ax7.set_ylim(0, 100)
ax7.set_title('不同流域面积方法适用性', fontsize=14, fontweight='bold')
ax7.legend(fontsize=10)
ax7.grid(True, alpha=0.3, which='both')

# 子图8：计算流程图
ax8 = plt.subplot(3, 3, 8)
ax8.axis('off')
ax8.set_xlim(0, 10)
ax8.set_ylim(0, 10)

# 流程框图
flow_boxes = [
    (5, 9, '设计暴雨\nH₁₀=142mm'),
    (5, 7.5, '点面折算\nKp=0.90'),
    (5, 6, '面暴雨\nHm=128mm'),
    (5, 4.5, '雨型分配\nr=0.40'),
    (2, 3, '产流计算\nfc=2.5mm/h'),
    (8, 3, '暴雨过程\n10时段'),
    (5, 1.5, '净雨过程\nR=98mm'),
    (5, 0.3, '推理公式\nQm=18.5m³/s'),
]

for i in range(len(flow_boxes) - 1):
    x1, y1, text1 = flow_boxes[i]
    x2, y2, text2 = flow_boxes[i+1]
    
    # 特殊处理分支
    if i == 3:
        ax8.arrow(x1-0.5, y1-0.3, -2.2, -1.2, head_width=0.2, head_length=0.15, 
                 fc='blue', ec='blue', lw=2)
        ax8.arrow(x1+0.5, y1-0.3, 2.2, -1.2, head_width=0.2, head_length=0.15, 
                 fc='blue', ec='blue', lw=2)
    elif i == 4 or i == 5:
        ax8.arrow(flow_boxes[i][0], flow_boxes[i][1]-0.3, 
                 flow_boxes[i+2][0]-flow_boxes[i][0], 
                 flow_boxes[i+2][1]+0.3-flow_boxes[i][1]+0.3,
                 head_width=0.2, head_length=0.15, fc='blue', ec='blue', lw=2)
        continue
    else:
        ax8.arrow(x1, y1-0.3, 0, y2-y1+0.6, head_width=0.25, head_length=0.15, 
                 fc='blue', ec='blue', lw=2)

for x, y, text in flow_boxes:
    ax8.text(x, y, text, ha='center', va='center', fontsize=10, fontweight='bold',
            bbox=dict(boxstyle='round,pad=0.6', facecolor='lightblue', 
                     edgecolor='black', linewidth=2))

ax8.set_title('暴雨资料法计算流程', fontsize=14, fontweight='bold')

# 子图9：误差来源分析
ax9 = plt.subplot(3, 3, 9)
error_sources = ['点面折算', '雨型分配', '稳渗率fc', '汇流系数m', '汇流时间τ']
error_magnitude = [8, 5, 10, 15, 8]  # 误差百分比
colors_error = ['#e74c3c', '#f39c12', '#3498db', '#9b59b6', '#2ecc71']

bars_error = ax9.barh(error_sources, error_magnitude, color=colors_error, 
                      alpha=0.7, edgecolor='black', linewidth=1.5)

for bar, err in zip(bars_error, error_magnitude):
    width = bar.get_width()
    ax9.text(width, bar.get_y() + bar.get_height()/2.,
            f' ±{err}%',
            ha='left', va='center', fontsize=11, fontweight='bold')

total_error = np.sqrt(sum(np.array(error_magnitude)**2))
ax9.axvline(total_error, color='red', linestyle='--', linewidth=2.5, 
           label=f'综合误差≈±{total_error:.0f}%')

ax9.set_xlabel('误差幅度 (%)', fontsize=12)
ax9.set_title('暴雨资料法误差来源分析', fontsize=14, fontweight='bold')
ax9.legend(fontsize=11)
ax9.grid(True, alpha=0.3, axis='x')

plt.tight_layout()
plt.savefig('第3章题10_设计暴雨推求设计洪水.png', dpi=300, bbox_inches='tight')
plt.show()

# 输出计算结果
print("=" * 70)
print("设计暴雨推求设计洪水计算结果")
print("=" * 70)
print(f"\n【1】设计暴雨推求：")
print(f"  汇流时间：τ = {tau} h")
print(f"  10小时点暴雨：H₁₀,₁% = {H10_1pct} mm")
print(f"  10小时面暴雨：Hm,₁₀ = {Hm_10} mm (Kp={0.90})")
print(f"  雨峰位置：第{peak_idx+1}时段 (r=0.40)")
print(f"\n【2】设计净雨计算：")
print(f"  总雨量：Hm = {Hm_10} mm")
print(f"  总损失：W = {Im} + {fc}×{tau} = {Im + fc*tau} mm")
print(f"  净雨深：R = {R_total} mm")
print(f"  峰时段净雨：r₄ = {r_design[peak_idx]:.1f} mm")
print(f"\n【3】设计洪峰流量：")
print(f"  汇流系数：φ = m = {m}")
print(f"  净雨强度：Sp = R/T = {Sp:.2f} mm/h")
print(f"  推理公式：Qm = 0.278 × φ × Sp × F / τ")
print(f"            = 0.278 × {m} × {Sp:.2f} × {F} / {tau}")
print(f"            = {Qm_1pct:.1f} m³/s")
print(f"  洪峰模数：qm = {Qm_1pct/F:.3f} m³/(s·km²)")
print(f"\n【4】参数敏感性：")
print(f"  m变化±0.1 → Qm变化±{12.4:.1f}%")
print(f"  fc变化±0.5 → Qm变化±{4.9:.1f}%")
print(f"\n【5】方法对比：")
print(f"  暴雨资料法：适用小流域，误差15-25%")
print(f"  实测资料法：适用中大流域，误差10-15%")
print(f"  本流域(F={F} km²)：暴雨资料法适用性好")
print(f"\n【6】综合误差估计：")
error_total = np.sqrt(sum(np.array(error_magnitude)**2))
print(f"  综合不确定性：±{error_total:.0f}%")
print(f"  建议取值范围：[{Qm_1pct*(1-error_total/100):.1f}, {Qm_1pct*(1+error_total/100):.1f}] m³/s")
print("=" * 70)
```

### **核心知识点**

| 知识点 | 内容 | 考试要求 |
|--------|------|----------|
| 汇流时间估算 | τ=0.278×L/(J^0.25×F^0.1) | ⭐⭐⭐⭐⭐ |
| 暴雨递减公式 | Ht=H₁×t^n | ⭐⭐⭐⭐ |
| 雨型分配 | 雨峰系数r、中心型/前峰型/后峰型 | ⭐⭐⭐⭐⭐ |
| φ指数法 | ri=hi-fc（超渗产流） | ⭐⭐⭐⭐⭐ |
| 推理公式 | Qm=0.278×φ×Sp×F/τ | ⭐⭐⭐⭐⭐ |

### **常见错误**

1. **汇流时间公式用错**：山区、平原、城市公式不同
2. **点面折算系数**：随流域面积变化，不能固定取0.9
3. **雨峰位置错误**：r=0.4表示峰在40%位置，不是第40%时段
4. **净雨计算**：混淆φ指数法与蓄满产流法

### **考试策略**

- **时间分配**：30分题建议40-45分钟
- **得分重点**：雨型分配(8分)、净雨计算(7分)、推理公式(7分)
- **计算检验**：洪峰模数qm应在合理范围，否则检查参数
- **方法对比**：必考，需从适用性、精度、成本等多角度分析

---

## 进阶题部分完成标记

**第3章进阶题（题6-10）已全部完成！**

**统计**：
- 题6：设计洪水过程线的放大与修正（26分）✅
- 题7：可能最大洪水(PMF)估算（28分）✅
- 题8：历史洪水调查与考证（26分）✅
- 题9：分期设计洪水计算（27分）✅
- 题10：设计暴雨推求设计洪水（30分）✅

**进阶题总分**：137分

**第3章累计进度**：
- 基础题（题1-5）：125分 ✅
- 进阶题（题6-10）：137分 ✅
- 综合题（题11-15）：待开发

---
