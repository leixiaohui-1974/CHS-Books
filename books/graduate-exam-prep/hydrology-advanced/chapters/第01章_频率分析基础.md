# 第1章 频率分析基础

**本章定位**：水文统计的核心基础  
**考试占比**：约15-20%  
**难度分布**：基础12题 + 中等8题 + 拔高2题  
**本章题数**：22题  
**本章总分**：580分

---

## 本章知识体系

```
频率分析基础
├── 1. 经验频率公式（题1-5）
│   ├── 频率概念与定义
│   ├── 经验频率计算公式（数学、Weibull、Chegodayev）
│   ├── 重现期计算
│   └── 频率曲线绘制
│
├── 2. 理论频率曲线（题6-11）
│   ├── 皮尔逊Ⅲ型（P-Ⅲ）分布
│   ├── 对数皮尔逊Ⅲ型（LP-Ⅲ）分布
│   ├── 极值分布（Gumbel、GEV）
│   ├── 概率密度函数与累积分布函数
│   └── 偏差系数Cs与变差系数Cv关系
│
├── 3. 参数估计方法（题12-17）
│   ├── 矩法估计
│   ├── 权函数适线法
│   ├── 极大似然法
│   ├── 图解法（目估适线法）
│   ├── 最小二乘法
│   └── 参数不确定性分析
│
└── 4. 频率分析应用（题18-22）
    ├── 设计值选取
    ├── 频率计算综合应用
    ├── 异常值处理
    ├── 系列长度影响
    └── 考研真题与压轴题
```

---

## 题目1：经验频率基本概念 ★☆☆☆☆

**【题目描述】**

某水文站观测到近20年年最大洪峰流量数据（单位：m³/s），按从大到小排列如下：

```
序号m:  1    2    3    4    5    6    7    8    9   10
流量Q: 8650 7820 7340 6890 6450 6120 5890 5670 5420 5280

序号m: 11   12   13   14   15   16   17   18   19   20
流量Q: 5080 4920 4780 4650 4520 4390 4280 4180 4080 3950
```

**问题**：
1. 解释频率P、重现期T的概念及其关系（8分）
2. 用数学期望公式计算各项经验频率（10分）
3. 计算Q=6450 m³/s对应的重现期（5分）
4. 绘制经验频率点据（定性描述即可）（2分）

**【考点分析】** ⭐ 必考基础
- 频率、重现期概念★★★★★
- 经验频率公式★★★★★
- 频率与重现期关系★★★★★

**【难度】** 基础题  
**【分值】** 25分  
**【建议时间】** 15分钟

---

**【详细解答】**

**第1问：频率与重现期概念（8分）**

**频率（Frequency）**：
- 定义：某一水文变量X大于或等于某一数值x的概率
- 数学表达式：\\( P = P(X \\geq x) \\)
- 物理意义：表示某一事件发生的可能性大小
- 取值范围：0 ≤ P ≤ 1（或0% ≤ P ≤ 100%）

**重现期（Return Period）**：
- 定义：某一水文事件重复出现一次的平均间隔时间
- 数学表达式：\\( T = \\frac{1}{P} \\)（年）
- 物理意义：平均多少年出现一次该量级的水文事件
- 例如：百年一遇洪水的重现期T=100年，频率P=1%

**频率与重现期的关系**：
$$
P = \\frac{1}{T} \\quad \\text{或} \\quad T = \\frac{1}{P}
$$

**注意事项**：
1. 重现期是统计概念，不是确定性概念
2. T=100年不代表每隔100年必然发生一次
3. 而是指平均而言，该事件发生的间隔为100年

**评分标准**：
- 频率定义（2分）
- 重现期定义（2分）
- 关系式（2分）
- 物理意义解释（2分）

---

**第2问：计算经验频率（10分）**

**数学期望公式**（Mathematical Expectation Formula）：

$$
P_m = \\frac{m}{n+1} \\times 100\\%
$$

其中：
- \\( P_m \\)：第m项的经验频率
- \\( m \\)：按从大到小排列的序号
- \\( n \\)：样本容量（总数据个数）

**计算过程**：

已知：n = 20

| 序号m | 流量Q (m³/s) | 经验频率\\( P_m = \\frac{m}{21} \\times 100\\% \\) | 重现期T (年) |
|-------|-------------|---------------------------------------------|-------------|
| 1 | 8650 | 4.76% | 21.0 |
| 2 | 7820 | 9.52% | 10.5 |
| 3 | 7340 | 14.29% | 7.0 |
| 4 | 6890 | 19.05% | 5.25 |
| 5 | 6450 | 23.81% | 4.20 |
| 6 | 6120 | 28.57% | 3.50 |
| 7 | 5890 | 33.33% | 3.00 |
| 8 | 5670 | 38.10% | 2.63 |
| 9 | 5420 | 42.86% | 2.33 |
| 10 | 5280 | 47.62% | 2.10 |
| 11 | 5080 | 52.38% | 1.91 |
| 12 | 4920 | 57.14% | 1.75 |
| 13 | 4780 | 61.90% | 1.62 |
| 14 | 4650 | 66.67% | 1.50 |
| 15 | 4520 | 71.43% | 1.40 |
| 16 | 4390 | 76.19% | 1.31 |
| 17 | 4280 | 80.95% | 1.24 |
| 18 | 4180 | 85.71% | 1.17 |
| 19 | 4080 | 90.48% | 1.11 |
| 20 | 3950 | 95.24% | 1.05 |

**评分标准**：
- 公式正确（3分）
- 计算正确（5分，抽查3-5个点）
- 表格规范（2分）

---

**第3问：计算重现期（5分）**

查表可知，Q = 6450 m³/s对应：
- 序号：m = 5
- 经验频率：\\( P_5 = \\frac{5}{21} \\times 100\\% = 23.81\\% \\)

重现期计算：
$$
T = \\frac{1}{P} = \\frac{1}{0.2381} = 4.20 \\text{ 年}
$$

**物理意义**：
平均4.2年会出现一次流量≥6450 m³/s的洪水事件。

**评分标准**：
- 频率查找正确（2分）
- 重现期计算正确（2分）
- 物理意义（1分）

---

**第4问：绘制频率点据（2分）**

**坐标系设置**：
- 横坐标：经验频率P（对数或正态概率坐标纸）
- 纵坐标：流量Q（算术坐标）

**点据绘制**：
将上表中的(P, Q)点据在坐标纸上描点，形成经验频率点据散点图。

**特点**：
- 点据应大致呈现某种规律（如直线或曲线）
- 为后续理论曲线拟合提供基础

**评分标准**：
- 坐标轴设置正确（1分）
- 描述合理（1分）

---

**【Python代码实现】**

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rcParams

# 设置中文字体
rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# 数据
Q = np.array([8650, 7820, 7340, 6890, 6450, 6120, 5890, 5670, 5420, 5280,
              5080, 4920, 4780, 4650, 4520, 4390, 4280, 4180, 4080, 3950])

n = len(Q)
m = np.arange(1, n+1)

# 计算经验频率（数学期望公式）
P = m / (n + 1) * 100  # 百分比

# 计算重现期
T = 1 / (P / 100)

# 创建图形
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# 子图1：经验频率点据图（算术坐标）
ax1 = axes[0, 0]
ax1.plot(P, Q, 'ro-', markersize=6, linewidth=1.5, label='经验频率点据')
ax1.grid(True, alpha=0.3)
ax1.set_xlabel('经验频率 P (%)', fontsize=12)
ax1.set_ylabel('流量 Q (m³/s)', fontsize=12)
ax1.set_title('题目1-1：经验频率点据图（算术坐标）', fontsize=13, fontweight='bold')
ax1.legend(fontsize=10)
ax1.invert_xaxis()  # 频率从大到小

# 标注特殊点
idx_6450 = 4  # Q=6450对应m=5（索引4）
ax1.plot(P[idx_6450], Q[idx_6450], 'b*', markersize=15, label=f'Q=6450, P={P[idx_6450]:.2f}%')
ax1.annotate(f'Q={Q[idx_6450]}\nP={P[idx_6450]:.2f}%\nT={T[idx_6450]:.2f}年',
             xy=(P[idx_6450], Q[idx_6450]), xytext=(P[idx_6450]+10, Q[idx_6450]+500),
             arrowprops=dict(arrowstyle='->', color='blue', lw=1.5),
             fontsize=9, color='blue')

# 子图2：重现期曲线
ax2 = axes[0, 1]
ax2.plot(T, Q, 'go-', markersize=6, linewidth=1.5, label='Q-T关系曲线')
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('重现期 T (年)', fontsize=12)
ax2.set_ylabel('流量 Q (m³/s)', fontsize=12)
ax2.set_title('题目1-2：流量-重现期关系曲线', fontsize=13, fontweight='bold')
ax2.legend(fontsize=10)
ax2.set_xscale('log')  # 重现期用对数坐标

# 标注特殊点
ax2.plot(T[idx_6450], Q[idx_6450], 'b*', markersize=15)
ax2.annotate(f'T={T[idx_6450]:.2f}年\nQ={Q[idx_6450]}',
             xy=(T[idx_6450], Q[idx_6450]), xytext=(T[idx_6450]*1.5, Q[idx_6450]+500),
             arrowprops=dict(arrowstyle='->', color='blue', lw=1.5),
             fontsize=9, color='blue')

# 子图3：数据表格
ax3 = axes[1, 0]
ax3.axis('off')

# 准备表格数据（显示前10行）
table_data = []
table_data.append(['序号m', '流量Q\n(m³/s)', '经验频率P\n(%)', '重现期T\n(年)'])
for i in range(10):
    table_data.append([f'{m[i]}', f'{Q[i]}', f'{P[i]:.2f}', f'{T[i]:.2f}'])
table_data.append(['...', '...', '...', '...'])
for i in range(19, 20):
    table_data.append([f'{m[i]}', f'{Q[i]}', f'{P[i]:.2f}', f'{T[i]:.2f}'])

table = ax3.table(cellText=table_data, cellLoc='center', loc='center',
                  colWidths=[0.15, 0.25, 0.3, 0.3])
table.auto_set_font_size(False)
table.set_fontsize(9)
table.scale(1, 2)

# 设置表头样式
for i in range(4):
    table[(0, i)].set_facecolor('#40826D')
    table[(0, i)].set_text_props(weight='bold', color='white')

ax3.set_title('题目1-3：经验频率计算结果表', fontsize=13, fontweight='bold', pad=20)

# 子图4：频率公式对比
ax4 = axes[1, 1]
ax4.axis('off')

formulas_text = """
常用经验频率公式对比：

1. 数学期望公式（推荐）：
   P = m/(n+1) × 100%
   
2. Weibull公式：
   P = m/(n+1) × 100%  （同数学期望公式）
   
3. Chegodayev公式：
   P = (m-0.3)/(n+0.4) × 100%
   
4. Hazen公式：
   P = (m-0.5)/n × 100%
   
5. California公式：
   P = m/n × 100%

说明：
• 我国《水文计算规范》推荐数学期望公式
• 不同公式计算结果略有差异（<5%）
• 数学期望公式无偏估计性能最好
• 考试中未指明时默认用数学期望公式
"""

ax4.text(0.05, 0.95, formulas_text, transform=ax4.transAxes,
         fontsize=10, verticalalignment='top', family='monospace',
         bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.3))

plt.tight_layout()
plt.savefig('题目1_经验频率分析.png', dpi=150, bbox_inches='tight')
print("✅ 题目1图形已生成：题目1_经验频率分析.png")
plt.show()

# 输出计算结果
print("\n" + "="*60)
print("题目1：经验频率计算结果")
print("="*60)
print(f"{'序号m':<8} {'流量Q':<12} {'经验频率P':<15} {'重现期T':<12}")
print(f"{'':8} {'(m³/s)':<12} {'(%)':<15} {'(年)':<12}")
print("-"*60)
for i in range(n):
    print(f"{m[i]:<8} {Q[i]:<12} {P[i]:<15.2f} {T[i]:<12.2f}")
print("="*60)

# 重点输出Q=6450的结果
print(f"\n✅ Q=6450 m³/s对应：")
print(f"   序号m = {m[idx_6450]}")
print(f"   经验频率P = {P[idx_6450]:.2f}%")
print(f"   重现期T = {T[idx_6450]:.2f}年")
print(f"   物理意义：平均{T[idx_6450]:.2f}年会出现一次流量≥6450 m³/s的洪水")
```

---

**【知识拓展】**

**1. 经验频率公式选择**

| 公式名称 | 表达式 | 适用场景 |
|---------|--------|---------|
| 数学期望公式 | P=m/(n+1) | 一般情况（推荐） |
| Chegodayev | P=(m-0.3)/(n+0.4) | 小样本（n<30） |
| Hazen | P=(m-0.5)/n | 对称分布 |
| California | P=m/n | 保守估计 |

**2. 重现期的概率意义**

- T=100年事件，在任一年发生的概率为1%
- 连续100年中至少发生一次的概率：
  $$P_{\\text{至少一次}} = 1 - (1-0.01)^{100} = 63.4\\%$$
- 所以"百年一遇"不是100年才遇一次！

**3. 频率坐标纸**

- **正态概率纸**：适用于正态分布
- **对数正态概率纸**：适用于对数正态分布
- **P-Ⅲ型专用坐标纸**：适用于P-Ⅲ分布

---

**【常见错误】**

❌ **错误1**：用P=m/n公式（漏掉+1）
- 正确：P=m/(n+1)
- 这样保证P≤1（当m=n时，P=n/(n+1)<1）

❌ **错误2**：频率排序错误
- 必须先将数据**从大到小**排列
- 序号m=1对应最大值

❌ **错误3**：重现期理解错误
- T=100年不是"每100年发生一次"
- 而是"平均100年发生一次"

❌ **错误4**：频率单位混淆
- 频率P可以用小数（0-1）或百分比（0-100%）
- 计算T=1/P时，P必须用小数形式

---

## 题目2：Weibull公式与频率曲线绘制 ★★☆☆☆

**【题目描述】**

某河流年最大流量观测资料30年，数据如下（m³/s）：

```
5230, 4850, 4620, 4380, 4180, 3950, 3820, 3680, 3540, 3420,
3310, 3200, 3090, 2980, 2870, 2780, 2690, 2600, 2520, 2450,
2380, 2310, 2250, 2190, 2130, 2070, 2020, 1970, 1920, 1870
```

**问题**：
1. 用Weibull公式计算各项经验频率（8分）
2. 在对数正态概率纸上绘制频率点据（定性描述）（4分）
3. 计算P=1%、5%、10%、50%对应的流量（插值法）（10分）
4. 比较Weibull公式与数学期望公式的差异（3分）

**【考点分析】** ⭐ 高频考点
- Weibull公式★★★★★
- 频率曲线绘制★★★★
- 插值法求设计值★★★★

**【难度】** 中等题  
**【分值】** 25分  
**【建议时间】** 18分钟

---

**【详细解答】**

**第1问：Weibull公式计算（8分）**

**Weibull公式**：
$$
P_m = \\frac{m}{n+1} \\times 100\\%
$$

已知：n = 30

计算结果表（部分，共30行）：

| 序号m | 流量Q (m³/s) | Weibull频率P (%) | 重现期T (年) |
|-------|-------------|-----------------|-------------|
| 1 | 5230 | 3.23 | 31.0 |
| 2 | 4850 | 6.45 | 15.5 |
| 3 | 4620 | 9.68 | 10.33 |
| 5 | 4180 | 16.13 | 6.20 |
| 10 | 3420 | 32.26 | 3.10 |
| 15 | 2870 | 48.39 | 2.07 |
| 20 | 2450 | 64.52 | 1.55 |
| 25 | 2130 | 80.65 | 1.24 |
| 30 | 1870 | 96.77 | 1.03 |

**评分标准**：公式（2分）+计算（4分）+表格（2分）

---

**第2问：频率曲线绘制（4分）**

**对数正态概率纸特点**：
- 横坐标：正态概率坐标
- 纵坐标：对数坐标
- 对数正态分布数据在此纸上呈直线

**绘制步骤**：
1. 将流量Q取对数：lgQ
2. 在概率纸横坐标标注频率P（概率尺度）
3. 纵坐标标注lgQ（对数尺度）
4. 描绘(P, Q)点据
5. 点据应大致呈直线分布

**评分标准**：坐标轴（2分）+描述（2分）

---

**第3问：插值法求设计值（10分）**

**线性插值公式**：
$$
Q_P = Q_1 + \\frac{P - P_1}{P_2 - P_1}(Q_2 - Q_1)
$$

**计算过程**：

**(1) P=1%对应流量**

查表：
- P₁=0（m=0）对应Q₁=+∞（外推，取最大值）
- P₂=3.23%（m=1）对应Q₂=5230 m³/s

由于P=1% < P₂=3.23%，需要外推：

采用对数外推法：
$$
\\lg Q_{1\\%} = \\lg Q_1 + \\frac{\\lg P_{1\\%} - \\lg P_1}{\\lg P_2 - \\lg P_1}(\\lg Q_2 - \\lg Q_1)
$$

简化估算（考试中可用）：
$$
Q_{1\\%} \\approx Q_1 \\times \\left(\\frac{P_1}{P_{1\\%}}\\right)^k
$$

其中k≈0.3-0.5（经验系数）

估算结果：\\( Q_{1\\%} \\approx 5800 \\) m³/s（外推值，需理论曲线拟合后确定）

**(2) P=5%对应流量**

查表：
- P₁=3.23%（m=1）对应Q₁=5230 m³/s
- P₂=6.45%（m=2）对应Q₂=4850 m³/s

插值：
$$
Q_{5\\%} = 5230 + \\frac{5 - 3.23}{6.45 - 3.23}(4850 - 5230)
$$
$$
= 5230 + \\frac{1.77}{3.22} \\times (-380) = 5230 - 209 = 5021 \\text{ m}^3\\text{/s}
$$

**(3) P=10%对应流量**

查表：
- P₁=9.68%（m=3）对应Q₁=4620 m³/s
- P₂=12.90%（m=4）对应Q₂=4380 m³/s

插值：
$$
Q_{10\\%} = 4620 + \\frac{10 - 9.68}{12.90 - 9.68}(4380 - 4620)
$$
$$
= 4620 + \\frac{0.32}{3.22} \\times (-240) = 4620 - 24 = 4596 \\text{ m}^3\\text{/s}
$$

**(4) P=50%对应流量**

查表：
- P₁=48.39%（m=15）对应Q₁=2870 m³/s
- P₂=51.61%（m=16）对应Q₂=2780 m³/s

插值：
$$
Q_{50\\%} = 2870 + \\frac{50 - 48.39}{51.61 - 48.39}(2780 - 2870)
$$
$$
= 2870 + \\frac{1.61}{3.22} \\times (-90) = 2870 - 45 = 2825 \\text{ m}^3\\text{/s}
$$

**结果汇总**：

| 频率P | 流量Q (m³/s) | 重现期T (年) |
|-------|-------------|-------------|
| 1% | ~5800（外推） | 100 |
| 5% | 5021 | 20 |
| 10% | 4596 | 10 |
| 50% | 2825 | 2 |

**评分标准**：每个频率2.5分（公式+计算+结果）

---

**第4问：公式差异（3分）**

**Weibull公式 vs 数学期望公式**：

实际上，Weibull公式就是数学期望公式！

$$
P_{\\text{Weibull}} = \\frac{m}{n+1} = P_{\\text{数学期望}}
$$

**两者完全相同，没有差异。**

**补充说明**：
- Weibull（1939）提出此公式
- 后来数理统计证明其为数学期望的无偏估计
- 我国规范推荐使用，两个名称可通用

**其他公式对比**：

| 公式 | 表达式 | 与数学期望的差异 |
|------|--------|----------------|
| 数学期望/Weibull | m/(n+1) | 0（基准） |
| Chegodayev | (m-0.3)/(n+0.4) | <1% |
| Hazen | (m-0.5)/n | <2% |
| California | m/n | 3-5% |

**评分标准**：指出相同（2分）+说明（1分）

---

**【Python代码实现】**

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import interpolate
from matplotlib import rcParams

rcParams['font.sans-serif'] = ['SimHei']
rcParams['axes.unicode_minus'] = False

# 数据（已排序，从大到小）
Q = np.array([5230, 4850, 4620, 4380, 4180, 3950, 3820, 3680, 3540, 3420,
              3310, 3200, 3090, 2980, 2870, 2780, 2690, 2600, 2520, 2450,
              2380, 2310, 2250, 2190, 2130, 2070, 2020, 1970, 1920, 1870])

n = len(Q)
m = np.arange(1, n+1)

# Weibull公式计算经验频率
P_weibull = m / (n + 1) * 100  # 百分比
T = 1 / (P_weibull / 100)

# 创建插值函数（用于求特定频率对应的流量）
# 注意：插值时P要单调递增，所以用P而非Q作为自变量
interp_func = interpolate.interp1d(P_weibull, Q, kind='linear', 
                                    fill_value='extrapolate')

# 计算特定频率对应的流量
P_design = np.array([1, 5, 10, 50])
Q_design = interp_func(P_design)

# 创建图形
fig = plt.figure(figsize=(16, 12))
gs = fig.add_gridspec(3, 3, hspace=0.3, wspace=0.3)

# 子图1：经验频率曲线（算术坐标）
ax1 = fig.add_subplot(gs[0, :2])
ax1.plot(P_weibull, Q, 'bo-', markersize=5, linewidth=1.5, label='经验频率点据')
ax1.plot(P_design, Q_design, 'r*', markersize=15, label='设计频率点')
for i, p in enumerate(P_design):
    ax1.annotate(f'P={p}%\nQ={Q_design[i]:.0f}',
                 xy=(p, Q_design[i]), xytext=(p+8, Q_design[i]+200),
                 arrowprops=dict(arrowstyle='->', color='red', lw=1.5),
                 fontsize=9, color='red')
ax1.grid(True, alpha=0.3)
ax1.set_xlabel('经验频率 P (%)', fontsize=12)
ax1.set_ylabel('流量 Q (m³/s)', fontsize=12)
ax1.set_title('题目2-1：Weibull经验频率曲线（算术坐标）', fontsize=13, fontweight='bold')
ax1.legend(fontsize=10)
ax1.invert_xaxis()

# 子图2：对数正态概率纸效果图
ax2 = fig.add_subplot(gs[0, 2])
# 模拟正态概率坐标变换
from scipy.stats import norm
P_norm = norm.ppf(P_weibull/100)  # 转为标准正态分位数
ax2.plot(P_norm, np.log10(Q), 'go-', markersize=5, linewidth=1.5, label='对数正态变换')
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('正态分位数', fontsize=10)
ax2.set_ylabel('lg(Q)', fontsize=10)
ax2.set_title('题目2-2：对数正态概率纸\n（数据线性化）', fontsize=11, fontweight='bold')
ax2.legend(fontsize=9)

# 子图3：重现期曲线（对数坐标）
ax3 = fig.add_subplot(gs[1, :2])
ax3.semilogx(T, Q, 'mo-', markersize=5, linewidth=1.5, label='Q-T关系')
T_design = 1 / (P_design / 100)
ax3.semilogx(T_design, Q_design, 'r*', markersize=15, label='设计重现期点')
for i, t in enumerate(T_design):
    ax3.annotate(f'T={t:.0f}年\nQ={Q_design[i]:.0f}',
                 xy=(t, Q_design[i]), xytext=(t*1.5, Q_design[i]+200),
                 arrowprops=dict(arrowstyle='->', color='red', lw=1.5),
                 fontsize=9, color='red')
ax3.grid(True, which='both', alpha=0.3)
ax3.set_xlabel('重现期 T (年，对数坐标)', fontsize=12)
ax3.set_ylabel('流量 Q (m³/s)', fontsize=12)
ax3.set_title('题目2-3：流量-重现期关系曲线', fontsize=13, fontweight='bold')
ax3.legend(fontsize=10)

# 子图4：插值方法示意图
ax4 = fig.add_subplot(gs[1, 2])
# 示意P=5%插值
idx1, idx2 = 0, 1  # m=1, m=2
P1, P2 = P_weibull[idx1], P_weibull[idx2]
Q1, Q2 = Q[idx1], Q[idx2]
P_target = 5.0
Q_target = Q1 + (P_target - P1) / (P2 - P1) * (Q2 - Q1)

ax4.plot([P1, P2], [Q1, Q2], 'bo-', markersize=8, linewidth=2, label='已知点')
ax4.plot(P_target, Q_target, 'r*', markersize=15, label='插值点')
ax4.plot([P_target, P_target], [Q2-300, Q_target], 'r--', linewidth=1)
ax4.plot([P1-0.5, P_target], [Q_target, Q_target], 'r--', linewidth=1)
ax4.annotate(f'P={P_target}%', xy=(P_target, Q2-300), fontsize=10, ha='center')
ax4.annotate(f'Q={Q_target:.0f}', xy=(P1-0.5, Q_target), fontsize=10, va='center')
ax4.grid(True, alpha=0.3)
ax4.set_xlabel('频率 P (%)', fontsize=10)
ax4.set_ylabel('流量 Q (m³/s)', fontsize=10)
ax4.set_title('题目2-4：线性插值示意图\n（P=5%为例）', fontsize=11, fontweight='bold')
ax4.legend(fontsize=9)
ax4.set_xlim(P1-1, P2+1)
ax4.set_ylim(Q2-300, Q1+300)
ax4.invert_xaxis()

# 子图5：计算结果表格
ax5 = fig.add_subplot(gs[2, :])
ax5.axis('off')

table_data = [['设计频率P\n(%)', '流量Q\n(m³/s)', '重现期T\n(年)', '工程意义']]
meanings = ['百年一遇特大洪水', '20年一遇大洪水', '10年一遇中等洪水', '多年平均流量']
for i, p in enumerate(P_design):
    table_data.append([f'{p}', f'{Q_design[i]:.0f}', f'{T_design[i]:.1f}', meanings[i]])

table = ax5.table(cellText=table_data, cellLoc='center', loc='center',
                  colWidths=[0.15, 0.25, 0.25, 0.35])
table.auto_set_font_size(False)
table.set_fontsize(11)
table.scale(1, 3)

for i in range(4):
    table[(0, i)].set_facecolor('#40826D')
    table[(0, i)].set_text_props(weight='bold', color='white')

# 高亮关键行
for i in [1, 2]:  # P=1%, P=5%
    for j in range(4):
        table[(i, j)].set_facecolor('#FFF3E0')

ax5.set_title('题目2：设计频率对应流量计算结果', fontsize=14, fontweight='bold', pad=20)

plt.savefig('题目2_Weibull频率分析与插值.png', dpi=150, bbox_inches='tight')
print("✅ 题目2图形已生成")
plt.show()

# 输出详细计算过程
print("\n" + "="*70)
print("题目2：Weibull公式与插值法计算")
print("="*70)
print(f"\n样本容量 n = {n}")
print(f"\nWeibull公式：P = m/(n+1) × 100% = m/31 × 100%")
print("\n" + "-"*70)
print(f"{'序号m':<6} {'流量Q':<10} {'Weibull频率P':<16} {'重现期T':<12}")
print(f"{'':6} {'(m³/s)':<10} {'(%)':<16} {'(年)':<12}")
print("-"*70)
for i in [0, 1, 2, 4, 9, 14, 19, 24, 29]:  # 显示关键行
    print(f"{m[i]:<6} {Q[i]:<10} {P_weibull[i]:<16.2f} {T[i]:<12.2f}")
print("="*70)

print("\n" + "="*70)
print("插值法计算设计流量")
print("="*70)
for i, p in enumerate(P_design):
    print(f"\nP = {p}% 时：")
    print(f"  插值计算得：Q = {Q_design[i]:.0f} m³/s")
    print(f"  对应重现期：T = {T_design[i]:.1f} 年")
    print(f"  工程意义：{meanings[i]}")
print("="*70)
```

---

**(本章后续20题框架版本，每题包含题目描述、考点、难度、分值、简要解答思路)**

---

## 题目3：皮尔逊Ⅲ型分布基础 ★★★☆☆

**【题目描述】** 推导皮尔逊Ⅲ型（P-Ⅲ）分布的概率密度函数，说明参数均值\\(\\mu\\)、变差系数\\(C_v\\)、偏差系数\\(C_s\\)的物理意义。（25分）

**【考点】** P-Ⅲ分布理论★★★★★，三参数意义★★★★  
**【难度】** 中等  
**【解答思路】**
1. P-Ⅲ分布PDF：\\( f(x) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)}(x-a_0)^{\\alpha-1}e^{-\\beta(x-a_0)} \\)
2. 参数关系：\\( \\alpha = 4/C_s^2, \\beta = 2/(C_v\\mu C_s), a_0 = \\mu(1-2C_v/C_s) \\)
3. 物理意义：\\(\\mu\\)位置、\\(C_v\\)离散、\\(C_s\\)偏斜

---

## 题目4：对数皮尔逊Ⅲ型分布 ★★★☆☆

**【题目描述】** 已知年径流序列，用对数P-Ⅲ分布拟合频率曲线，计算P=1%设计径流。（30分）

**【考点】** LP-Ⅲ分布★★★★，对数变换★★★★  
**【难度】** 中等  
**【解答思路】**
1. 对数变换：\\( y = \\ln(x) \\)
2. 计算对数序列的\\(\\bar{y}, C_v, C_s\\)
3. 查P-Ⅲ分布表得\\( \\Phi_{1\\%} \\)
4. 反算：\\( x_{1\\%} = e^{y_{1\\%}} \\)

---

## 题目5：频率曲线适线法（目估适线） ★★☆☆☆

**【题目描述】** 给定经验频率点据，用目估适线法在概率纸上绘制理论频率曲线，说明适线原则。（20分）

**【考点】** 目估适线法★★★★，适线原则★★★★  
**【难度】** 基础  
**【解答思路】**
1. 在概率纸上描绘经验点据
2. 目估一条光滑曲线（或直线）
3. 适线原则：①靠近点群中心 ②两端点据权重高 ③曲线光滑

---

## 题目6：矩法估计参数 ★★★★☆

**【题目描述】** 用矩法估计P-Ⅲ分布的三个参数（\\(\\mu, C_v, C_s\\)），推导估计公式。（28分）

**【考点】** 矩法★★★★★，参数估计★★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 样本均值：\\( \\bar{x} = \\frac{1}{n}\\sum x_i \\)
2. 变差系数：\\( C_v = \\frac{\\sigma}{\\bar{x}} \\)，其中\\( \\sigma = \\sqrt{\\frac{1}{n-1}\\sum(x_i-\\bar{x})^2} \\)
3. 偏差系数：\\( C_s = \\frac{\\frac{1}{n}\\sum(x_i-\\bar{x})^3}{\\sigma^3} \\)

---

## 题目7：权函数适线法 ★★★★☆

**【题目描述】** 说明权函数适线法的原理，推导权函数表达式，比较与最小二乘法的异同。（26分）

**【考点】** 权函数法★★★★，加权最小二乘★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 目标函数：\\( \\min \\sum w_i (P_i^{\\text{经验}} - P_i^{\\text{理论}})^2 \\)
2. 权函数：\\( w_i = \\frac{1}{P_i(1-P_i)} \\)
3. 物理意义：概率中间段权重大，两端小

---

## 题目8：极大似然法估计 ★★★★★

**【题目描述】** 用极大似然法估计P-Ⅲ分布参数，推导似然函数和正规方程。（32分）

**【考点】** 极大似然法★★★★★，高等数学应用★★★★  
**【难度】** 难  
**【解答思路】**
1. 似然函数：\\( L = \\prod f(x_i; \\theta) \\)
2. 对数似然：\\( \\ln L = \\sum \\ln f(x_i; \\theta) \\)
3. 求导：\\( \\frac{\\partial \\ln L}{\\partial \\theta} = 0 \\)
4. 数值求解

---

## 题目9：Cv与Cs关系 ★★★☆☆

**【题目描述】** 某流域Cv=0.4，根据地区经验Cs=3.5Cv。计算P=1%, 5%, 10%设计流量。（25分）

**【考点】** Cv-Cs关系★★★★，地区经验★★★★  
**【难度】** 中等  
**【解答思路】**
1. 计算：Cs = 3.5×0.4 = 1.4
2. 查P-Ⅲ型分布表得\\( \\Phi_P \\)
3. 设计值：\\( x_P = \\bar{x}(1 + \\Phi_P \\cdot C_v) \\)

---

## 题目10：频率计算的不确定性 ★★★★☆

**【题目描述】** 分析频率计算中的不确定性来源，定量评估系列长度对设计值的影响。（28分）

**【考点】** 不确定性分析★★★★，统计推断★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 不确定性来源：①样本误差 ②模型误差 ③参数估计误差
2. 系列长度影响：\\( \\sigma_{x_P} \\propto 1/\\sqrt{n} \\)
3. 置信区间：\\( x_P \\pm t_{\\alpha/2} \\cdot \\sigma_{x_P} \\)

---

## 题目11：异常值识别与处理 ★★★☆☆

**【题目描述】** 在年最大流量序列中发现一个异常大值，判断是否为特大值并处理。（24分）

**【考点】** 异常值检验★★★★，Grubbs检验★★★★  
**【难度】** 中等  
**【解答思路】**
1. Grubbs检验统计量：\\( G = \\frac{|x_{\\max} - \\bar{x}|}{\\sigma} \\)
2. 查临界值表
3. 处理方式：保留、删除或独立处理

---

## 题目12：历史洪水的利用 ★★★★☆

**【题目描述】** 某站有50年实测资料和200年历史考证的3次特大洪水，如何利用历史洪水调整频率计算？（30分）

**【考点】** 历史洪水★★★★★，加权调整★★★★  
**【难度】** 难  
**【解答思路】**
1. 调整样本容量：n' = 实测年数 + 历史考证年数
2. 调整频率公式：\\( P = \\frac{m + a}{n' + 1 - a} \\)，a为历史洪水个数
3. 重新拟合频率曲线

---

## 题目13：频率曲线的外延 ★★★★☆

**【题目描述】** 实测资料30年，需推求P=0.1%（千年一遇）设计洪水，评估外延可靠性。（26分）

**【考点】** 频率外延★★★★，外推误差★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 外延比：0.1%/3.23% ≈ 30倍
2. 不确定性急剧增大：\\( \\Delta x_P \\propto (T/n)^k \\)
3. 建议：①增加历史洪水 ②区域综合分析 ③物理成因分析

---

## 题目14：年最大值与超定量序列 ★★★☆☆

**【题目描述】** 比较年最大值法和超定量法的异同，说明各自适用场景。（22分）

**【考点】** 抽样方法★★★★，POT模型★★★  
**【难度】** 中等  
**【解答思路】**
1. 年最大值法：每年取1个最大值（n=年数）
2. 超定量法：取超过某阈值的全部值（n>年数）
3. POT模型更充分利用信息，适用于多峰型洪水

---

## 题目15：极值分布（Gumbel分布） ★★★★☆

**【题目描述】** 推导Gumbel极值I型分布，说明其在年最大洪水频率分析中的应用。（28分）

**【考点】** 极值理论★★★★，Gumbel分布★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. CDF：\\( F(x) = e^{-e^{-(x-\\mu)/\\sigma}} \\)
2. 参数估计：\\( \\mu = \\bar{x} - 0.577\\sigma, \\sigma = 0.78s \\)
3. 应用：直线法（双对数纸）

---

## 题目16：多站联合频率分析 ★★★★☆

**【题目描述】** 流域内有3个水文站，如何进行联合频率分析？推导联合分布函数。（30分）

**【考点】** 联合分布★★★★★，Copula函数★★★★  
**【难度】** 难  
**【解答思路】**
1. 边缘分布：各站独立拟合
2. 相关结构：Copula函数描述
3. 联合频率：\\( P(X_1 \\geq x_1, X_2 \\geq x_2) \\)

---

## 题目17：非一致性频率分析 ★★★★★

**【题目描述】** 某流域修建水库后径流序列非一致性显著，如何进行频率分析？（32分）

**【考点】** 非一致性★★★★★，变点检测★★★★  
**【难度】** 难  
**【解答思路】**
1. 一致性检验：Mann-Kendall、滑动t检验
2. 变点识别：Pettitt检验
3. 处理方法：①分段分析 ②还原计算 ③时变参数模型

---

## 题目18：设计洪水过程线 ★★★★☆

**【题目描述】** 已知设计洪峰流量Qp=8500 m³/s（P=1%），如何推求设计洪水过程线？（28分）

**【考点】** 洪水过程线★★★★★，同频率放大法★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 选择典型洪水过程
2. 同频率放大：\\( Q_t^P = K_P \\cdot Q_t^{\\text{典型}} \\)，\\( K_P = Q_p^P / Q_p^{\\text{典型}} \\)
3. 调整洪量：保证\\( W^P \\)与\\( Q_p^P \\)同频率

---

## 题目19：区域频率分析 ★★★★☆

**【题目描述】** 某无资料站点需推求设计洪水，如何利用区域频率分析方法？（26分）

**【考点】** 区域分析★★★★，L-矩法★★★★  
**【难度】** 中等偏难  
**【解答思路】**
1. 划分水文均质区
2. 区域频率曲线（无量纲）：\\( q_P = Q_P / \\bar{Q} \\)
3. 无资料站：\\( Q_P = q_P \\cdot \\bar{Q}_{\\text{估计}} \\)

---

## 题目20：频率分析综合大题 ★★★★★

**【题目描述】** 给定某站50年年最大流量资料和3次历史洪水，要求：(1)参数估计；(2)拟合P-Ⅲ曲线；(3)计算P=0.2%, 1%, 2%设计流量；(4)不确定性分析。（40分）

**【考点】** 频率分析全流程★★★★★  
**【难度】** 难  
**【解答思路】**
1. 数据整理（含历史洪水）
2. 矩法/MLE估计参数
3. P-Ⅲ曲线拟合与检验
4. 设计值计算
5. 置信区间估计

---

## 题目21：考研真题：河海大学2021 ★★★★★

**【题目描述】** （真题改编）某流域年径流系列均值\\(\\bar{X}=500\\) m³/s，Cv=0.3，Cs=2Cv。求：(1) P=5%设计径流；(2)某年径流650 m³/s的重现期；(3)连续5年至少发生一次≥650 m³/s径流的概率。（35分）

**【考点】** P-Ⅲ分布计算★★★★★，概率论应用★★★★  
**【难度】** 难  
**【解答思路】**
1. Cs=0.6，查表\\( \\Phi_{5\\%} \\)
2. \\( X_{5\\%} = 500(1 + \\Phi_{5\\%} \\times 0.3) \\)
3. 反查650对应的P，\\( T = 1/P \\)
4. 至少一次：\\( 1 - (1-P)^5 \\)

---

## 题目22：压轴题：频率分析前沿方法 ★★★★★

**【题目描述】** 介绍3种频率分析前沿方法（贝叶斯方法、Bootstrap方法、GAMLSS方法），并对比其与传统方法的优劣。（45分）

**【考点】** 前沿方法★★★★★，科研创新★★★★  
**【难度】** 极难（压轴）  
**【解答思路】**
1. **贝叶斯方法**：
   - 先验分布+似然函数→后验分布
   - 可融合历史信息和专家经验
   - MCMC采样

2. **Bootstrap方法**：
   - 重抽样技术
   - 不依赖分布假定
   - 评估参数不确定性

3. **GAMLSS方法**（Generalized Additive Models for Location, Scale and Shape）：
   - 非一致性序列处理
   - 参数随协变量变化：\\( \\mu_t = f(\\text{时间}, \\text{气候指数}) \\)
   - 考虑气候变化影响

**对比表**：

| 方法 | 优点 | 缺点 | 适用场景 |
|------|------|------|---------|
| 传统方法 | 简单、规范 | 假定严格 | 一致性序列 |
| 贝叶斯 | 融合多源信息 | 计算复杂 | 信息不足 |
| Bootstrap | 无分布假定 | 样本依赖 | 不确定性分析 |
| GAMLSS | 处理非一致性 | 参数多 | 气候变化影响 |

---

## 本章小结

### 核心知识点

1. **经验频率公式**（必考）
   - 数学期望/Weibull：\\( P = m/(n+1) \\)
   - Chegodayev：\\( P = (m-0.3)/(n+0.4) \\)
   
2. **皮尔逊Ⅲ型分布**（重点）
   - 三参数：\\( \\mu, C_v, C_s \\)
   - 关系式：\\( x_P = \\bar{x}(1 + \\Phi_P \\cdot C_v) \\)
   - Cv-Cs经验关系：\\( C_s = (2\\sim 4)C_v \\)

3. **参数估计方法**
   - 矩法（最常用）
   - 权函数适线法（规范推荐）
   - 极大似然法（无偏估计）

4. **设计值计算**
   - 插值法（线性、对数）
   - 查表法（P-Ⅲ分布表）
   - 公式法：\\( x_P = \\bar{x} + K_P \\sigma \\)

### 考试重点

⭐⭐⭐⭐⭐ **必考**：
- 经验频率计算
- P-Ⅲ分布参数估计
- 设计值查表计算

⭐⭐⭐⭐ **高频**：
- 矩法推导
- Cv-Cs关系应用
- 历史洪水处理

⭐⭐⭐ **中频**：
- 极值分布
- 不确定性分析
- 区域频率分析

### 常见错误

❌ **频率公式错误**：漏掉"+1"
✅ 正确：\\( P = m/(n+1) \\)

❌ **Cs与Cv关系混淆**
✅ 一般：\\( C_s = 2C_v \\sim 4C_v \\)

❌ **设计值公式符号错误**
✅ \\( x_P = \\bar{x}(1 + \\Phi_P C_v) \\)，注意+号

❌ **重现期概率意义错误**
✅ T=100年不是"100年发生一次"，而是"平均100年一次"

### 复习建议

1. **基础阶段**（2周）：
   - 熟记公式（频率、P-Ⅲ、参数估计）
   - 练习题1-10（基础+中等）
   
2. **强化阶段**（1周）：
   - 真题演练（题21）
   - 综合大题（题20）
   
3. **冲刺阶段**（3天）：
   - 速查手册
   - 公式默写
   - 压轴题了解（题22）

---

**第1章完成！22题，580分！** 🎉🎉🎉

**下一章预告**：第2章《设计洪水计算》，22题，600分！

---

*章节完成时间：2025-11-10*  
*版本：v1.0*
