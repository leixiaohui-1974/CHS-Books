# 第02章 径流资料分析与处理

**本章概述**：
径流资料是水文分析与计算的基础。本章重点讨论径流资料的收集、整理、检验、插补延长和还原修正等基本方法，以及径流资料的统计分析和代表性评价。这些方法是进行水文计算、水资源评价和水利工程设计的前提。

**学习目标**：
1. 掌握径流资料的一致性检验方法
2. 熟练应用径流资料的插补延长技术
3. 理解径流资料的还原与修正原理
4. 掌握年径流系列的统计分析方法
5. 能够评价径流资料的代表性
6. 熟悉洪水过程线的分割与还原

**考点分布**：
- 一致性检验：⭐⭐⭐⭐⭐（必考）
- 插补延长：⭐⭐⭐⭐⭐（必考）
- 还原修正：⭐⭐⭐⭐（高频）
- 代表性分析：⭐⭐⭐（中频）
- 过程线分析：⭐⭐⭐⭐（高频）

**本章结构**：
- 题1-5：基础题（一致性检验、插补延长）
- 题6-10：进阶题（还原修正、代表性分析）
- 题11-15：综合题（综合应用、真题演练）

**总分值**：350分

---

## 题1：径流资料一致性检验（22分）⭐⭐⭐⭐⭐

**难度**：⭐⭐⭐
**考频**：⭐⭐⭐⭐⭐（必考基础题）
**分值**：22分
**考查重点**：双累积曲线法、水文比拟法

### 题目

某水文站有1980-2010年共31年的年径流量资料，期间1995年上游修建水库，水库开始蓄水运行。为检验该站年径流系列的一致性，选择附近参证站（流域条件相似，无人类活动影响）的同期资料进行分析。部分数据如下表：

| 年份 | 测站年径流量(亿m³) | 参证站年径流量(亿m³) |
|------|-------------------|---------------------|
| 1980 | 12.5 | 18.2 |
| 1985 | 15.8 | 22.6 |
| 1990 | 14.2 | 20.8 |
| 1994 | 13.6 | 19.5 |
| 1995 | 11.8 | 19.8 |
| 2000 | 10.5 | 20.2 |
| 2005 | 9.8 | 19.5 |
| 2010 | 10.2 | 20.5 |

已知：
- 测站流域面积：F₁ = 800 km²
- 参证站流域面积：F₂ = 1200 km²
- 1980-1994年累积径流：测站215.6亿m³，参证站312.8亿m³
- 1995-2010年累积径流：测站168.4亿m³，参证站318.2亿m³

(1) 采用双累积曲线法检验该站径流系列的一致性。(8分)

(2) 若发现不一致，计算1995年前后的径流关系变化。(6分)

(3) 采用径流模数比拟法验证分析结果。(8分)

---

### 详解

#### (1) 双累积曲线法检验（8分）

**踩分点**：
- 双累积曲线原理（2分）
- 绘制累积曲线（3分）
- 一致性判断（3分）

**解答**：

**1. 双累积曲线法原理**
```
基本思想：
如果两个流域的降水和下垫面条件相似，
则两站的年径流量应保持线性关系。

检验方法：
绘制测站累积径流与参证站累积径流的关系曲线，
若曲线为直线，说明系列一致；
若出现转折，说明系列不一致。

关系式：
ΣW₁ = k·ΣW₂ + b

其中：
- ΣW₁：测站累积径流
- ΣW₂：参证站累积径流
- k：斜率（反映流域产流能力比）
- b：截距
```

**2. 累积径流计算**
```
时段划分：
- 前期（1980-1994）：水库修建前
- 后期（1995-2010）：水库运行后

前期累积：
测站：ΣW₁₁ = 215.6 亿m³
参证站：ΣW₂₁ = 312.8 亿m³

后期累积：
测站起点：215.6 亿m³
参证站起点：312.8 亿m³

后期终点：
测站：ΣW₁₂ = 215.6 + 168.4 = 384.0 亿m³
参证站：ΣW₂₂ = 312.8 + 318.2 = 631.0 亿m³
```

**3. 双累积曲线绘制与分析**
```
关键点坐标：
起点：(0, 0)
分界点（1994年底）：(312.8, 215.6)
终点（2010年底）：(631.0, 384.0)

前期斜率：
k₁ = ΣW₁₁ / ΣW₂₁ = 215.6 / 312.8 = 0.689

后期斜率：
k₂ = (ΣW₁₂ - ΣW₁₁) / (ΣW₂₂ - ΣW₂₁)
   = (384.0 - 215.6) / (631.0 - 312.8)
   = 168.4 / 318.2
   = 0.529

斜率变化：
Δk = k₂ - k₁ = 0.529 - 0.689 = -0.160
变化率 = Δk / k₁ × 100% = -23.2%
```

**4. 一致性判断**
```
判断标准：
✓ 斜率变化 > 5%：系列不一致
✓ 斜率变化 < 5%：系列基本一致

本题结果：
❌ 斜率变化率23.2% >> 5%
❌ 双累积曲线出现明显转折
❌ 结论：径流系列不一致

原因分析：
1995年水库建成后，上游拦蓄作用显著，
测站径流明显减少，与参证站关系发生变化。
```

---

#### (2) 径流关系变化计算（6分）

**踩分点**：
- 前后期关系式（3分）
- 径流减少量（3分）

**解答**：

**1. 前期关系式（1980-1994）**
```
W₁ = k₁·W₂

其中：
k₁ = 0.689

物理意义：
水库修建前，测站径流约为参证站的68.9%
```

**2. 后期关系式（1995-2010）**
```
W₁ = k₂·W₂

其中：
k₂ = 0.529

物理意义：
水库运行后，测站径流降至参证站的52.9%
```

**3. 径流减少分析**
```
① 相对减少率
   Δk/k₁ = (0.529 - 0.689) / 0.689 × 100%
         = -23.2%

② 年均减少量（以参证站平均径流20亿m³计）
   ΔW = (k₁ - k₂) × W̄₂
      = (0.689 - 0.529) × 20
      = 0.160 × 20
      = 3.2 亿m³/年

③ 总减少量（1995-2010，16年）
   ΣΔW = 3.2 × 16 = 51.2 亿m³

④ 占原径流比例
   ΔW/W̄₁ = 3.2 / (20×0.689) = 3.2 / 13.78 = 23.2%
```

**4. 变化原因**
```
主要原因：
① 水库蓄水：减少下泄流量
② 库区蒸发：增加水量损失
③ 灌溉用水：引水灌溉减少径流

次要原因：
① 气候变化可能性较小（参证站未变）
② 取水用水增加
```

---

#### (3) 径流模数比拟法验证（8分）

**踩分点**：
- 径流模数计算（3分）
- 模数比值分析（3分）
- 结论验证（2分）

**解答**：

**1. 径流模数计算**

**(a) 前期（1980-1994，15年）**
```
测站：
年均径流量：W̄₁₁ = 215.6 / 15 = 14.37 亿m³
流域面积：F₁ = 800 km²
径流模数：M₁₁ = W̄₁₁ × 10⁸ / (F₁ × 10⁶)
             = 14.37 × 10⁸ / (800 × 10⁶)
             = 17.96 m³/(s·km²) × 31.536
             = 17.96 L/(s·km²)

或直接：
M₁₁ = 14.37 × 100 / 800 = 1.796 万m³/(km²·年)

参证站：
年均径流量：W̄₂₁ = 312.8 / 15 = 20.85 亿m³
流域面积：F₂ = 1200 km²
径流模数：M₂₁ = 20.85 × 100 / 1200 = 1.738 万m³/(km²·年)

模数比：
r₁ = M₁₁ / M₂₁ = 1.796 / 1.738 = 1.033
```

**(b) 后期（1995-2010，16年）**
```
测站：
年均径流量：W̄₁₂ = 168.4 / 16 = 10.53 亿m³
径流模数：M₁₂ = 10.53 × 100 / 800 = 1.316 万m³/(km²·年)

参证站：
年均径流量：W̄₂₂ = 318.2 / 16 = 19.89 亿m³
径流模数：M₂₂ = 19.89 × 100 / 1200 = 1.658 万m³/(km²·年)

模数比：
r₂ = M₁₂ / M₂₂ = 1.316 / 1.658 = 0.794
```

**2. 模数比变化分析**
```
① 前期模数比：r₁ = 1.033
   说明：测站流域产流能力略高于参证站
   原因：可能测站流域面积较小，产流能力相对较强

② 后期模数比：r₂ = 0.794
   说明：测站流域产流能力降至参证站的79.4%

③ 模数比变化：
   Δr = r₂ - r₁ = 0.794 - 1.033 = -0.239
   变化率 = Δr / r₁ × 100% = -23.1%

④ 与双累积曲线结果对比：
   双累积曲线：斜率变化率 = -23.2%
   径流模数法：模数比变化率 = -23.1%
   相对误差：|(-23.2) - (-23.1)| / 23.2 = 0.4%

   ✓ 两种方法结果高度一致！
```

**3. 综合验证结论**
```
✓ 双累积曲线法：斜率减小23.2%
✓ 径流模数法：模数比降低23.1%
✓ 两种方法相互印证

最终结论：
1. 该站径流系列不一致
2. 1995年水库建成是转折点
3. 后期径流减少约23%
4. 需对后期资料进行还原修正

还原方法：
W₁'(还原) = W₁(实测) × (k₁/k₂)
          = W₁(实测) × (0.689/0.529)
          = W₁(实测) × 1.302

或：
W₁'(还原) = W₁(实测) × (r₁/r₂)
          = W₁(实测) × (1.033/0.794)
          = W₁(实测) × 1.301
```

---

### Python实现与可视化

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# ========== 数据准备 ==========
# 测站数据
years = np.array([1980, 1985, 1990, 1994, 1995, 2000, 2005, 2010])
station_runoff = np.array([12.5, 15.8, 14.2, 13.6, 11.8, 10.5, 9.8, 10.2])
reference_runoff = np.array([18.2, 22.6, 20.8, 19.5, 19.8, 20.2, 19.5, 20.5])

# 流域面积
F1 = 800  # km²
F2 = 1200  # km²

# 累积径流
cumsum_station_before = 215.6  # 1980-1994
cumsum_reference_before = 312.8
cumsum_station_after = 168.4   # 1995-2010
cumsum_reference_after = 318.2

# 计算累积序列
cumsum_reference = np.array([0, cumsum_reference_before,
                             cumsum_reference_before + cumsum_reference_after])
cumsum_station = np.array([0, cumsum_station_before,
                          cumsum_station_before + cumsum_station_after])

# 斜率计算
k1 = cumsum_station_before / cumsum_reference_before
k2 = cumsum_station_after / cumsum_reference_after

print("=" * 70)
print("题1：径流资料一致性检验 - 计算结果")
print("=" * 70)

print("\n【1】双累积曲线分析：")
print(f"  前期斜率 k₁ = {k1:.3f}")
print(f"  后期斜率 k₂ = {k2:.3f}")
print(f"  斜率变化 Δk = {k2-k1:.3f}")
print(f"  变化率 = {(k2-k1)/k1*100:.1f}%")
print(f"  结论：{'不一致' if abs((k2-k1)/k1) > 0.05 else '基本一致'}")

print("\n【2】径流模数分析：")
n1, n2 = 15, 16
M11 = cumsum_station_before / n1 * 100 / F1
M21 = cumsum_reference_before / n1 * 100 / F2
M12 = cumsum_station_after / n2 * 100 / F1
M22 = cumsum_reference_after / n2 * 100 / F2

r1 = M11 / M21
r2 = M12 / M22

print(f"  前期测站模数 M₁₁ = {M11:.3f} 万m³/(km²·年)")
print(f"  前期参证站模数 M₂₁ = {M21:.3f} 万m³/(km²·年)")
print(f"  前期模数比 r₁ = {r1:.3f}")
print(f"  后期测站模数 M₁₂ = {M12:.3f} 万m³/(km²·年)")
print(f"  后期参证站模数 M₂₂ = {M22:.3f} 万m³/(km²·年)")
print(f"  后期模数比 r₂ = {r2:.3f}")
print(f"  模数比变化率 = {(r2-r1)/r1*100:.1f}%")

print("\n【3】还原系数：")
restoration_coef = k1 / k2
print(f"  K = k₁/k₂ = {restoration_coef:.3f}")
print(f"  后期还原公式：W'₁ = W₁ × {restoration_coef:.3f}")

# ========== 可视化 ==========
fig = plt.figure(figsize=(16, 10))

# ========== 子图1: 双累积曲线 ==========
ax1 = fig.add_subplot(2, 3, 1)

# 绘制双累积曲线
x_ref = [0, cumsum_reference_before, cumsum_reference_before + cumsum_reference_after]
y_sta = [0, cumsum_station_before, cumsum_station_before + cumsum_station_after]

ax1.plot(x_ref, y_sta, 'bo-', linewidth=2, markersize=10,
         markeredgecolor='black', markeredgewidth=2, label='实测累积曲线')

# 绘制前后期拟合直线
x_fit1 = np.array([0, cumsum_reference_before])
y_fit1 = k1 * x_fit1
ax1.plot(x_fit1, y_fit1, 'r--', linewidth=2.5, label=f'前期拟合(k₁={k1:.3f})')

x_fit2 = np.array([cumsum_reference_before, cumsum_reference_before + cumsum_reference_after])
y_fit2 = cumsum_station_before + k2 * (x_fit2 - cumsum_reference_before)
ax1.plot(x_fit2, y_fit2, 'g--', linewidth=2.5, label=f'后期拟合(k₂={k2:.3f})')

# 标注转折点
ax1.plot(cumsum_reference_before, cumsum_station_before, 'r*',
         markersize=25, markeredgecolor='black', markeredgewidth=2)
ax1.annotate('1995年转折点\n水库开始运行',
             xy=(cumsum_reference_before, cumsum_station_before),
             xytext=(cumsum_reference_before - 50, cumsum_station_before + 30),
             fontsize=11, fontweight='bold',
             bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.7),
             arrowprops=dict(arrowstyle='->', lw=2, color='red'))

ax1.set_xlabel('参证站累积径流 (亿m³)', fontsize=12, fontweight='bold')
ax1.set_ylabel('测站累积径流 (亿m³)', fontsize=12, fontweight='bold')
ax1.set_title(f'(1) 双累积曲线法\n斜率变化{(k2-k1)/k1*100:.1f}% → 不一致',
              fontsize=13, fontweight='bold', pad=10)
ax1.legend(loc='upper left', fontsize=10)
ax1.grid(True, alpha=0.3, linestyle='--')

# ========== 子图2: 年径流量对比 ==========
ax2 = fig.add_subplot(2, 3, 2)

# 分前后期绘制
years_before = years[years < 1995]
years_after = years[years >= 1995]
runoff_before = station_runoff[years < 1995]
runoff_after = station_runoff[years >= 1995]

ax2.bar(years_before, runoff_before, width=0.8, color='#2ecc71', alpha=0.7,
        edgecolor='black', linewidth=1.5, label='水库前(1980-1994)')
ax2.bar(years_after, runoff_after, width=0.8, color='#e74c3c', alpha=0.7,
        edgecolor='black', linewidth=1.5, label='水库后(1995-2010)')

# 平均线
avg_before = cumsum_station_before / 15
avg_after = cumsum_station_after / 16
ax2.axhline(y=avg_before, xmin=0, xmax=0.47, color='green',
            linestyle='--', linewidth=2, label=f'前期均值={avg_before:.1f}')
ax2.axhline(y=avg_after, xmin=0.53, xmax=1, color='red',
            linestyle='--', linewidth=2, label=f'后期均值={avg_after:.1f}')

# 添加减少标注
ax2.annotate(f'减少{(avg_before-avg_after)/avg_before*100:.1f}%',
             xy=(2000, (avg_before+avg_after)/2),
             fontsize=12, fontweight='bold', color='red',
             bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.6))

ax2.set_xlabel('年份', fontsize=12, fontweight='bold')
ax2.set_ylabel('年径流量 (亿m³)', fontsize=12, fontweight='bold')
ax2.set_title('(2) 年径流量时间变化\n1995年后明显减少',
              fontsize=13, fontweight='bold', pad=10)
ax2.legend(loc='upper right', fontsize=10)
ax2.grid(axis='y', alpha=0.3, linestyle='--')
ax2.set_xlim(1977, 2013)

# ========== 子图3: 径流模数对比 ==========
ax3 = fig.add_subplot(2, 3, 3)

periods = ['前期\n1980-1994', '后期\n1995-2010']
modulus_station = [M11, M12]
modulus_ref = [M21, M22]

x = np.arange(len(periods))
width = 0.35

bars1 = ax3.bar(x - width/2, modulus_station, width, label='测站',
                color='#3498db', alpha=0.7, edgecolor='black', linewidth=2)
bars2 = ax3.bar(x + width/2, modulus_ref, width, label='参证站',
                color='#e74c3c', alpha=0.7, edgecolor='black', linewidth=2)

# 添加数值标签
for bars in [bars1, bars2]:
    for bar in bars:
        height = bar.get_height()
        ax3.text(bar.get_x() + bar.get_width()/2., height + 0.02,
                f'{height:.3f}',
                ha='center', va='bottom', fontsize=10, fontweight='bold')

# 添加模数比标注
ax3.text(0, 1.9, f'r₁={r1:.3f}', ha='center', fontsize=11, fontweight='bold',
         bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.7))
ax3.text(1, 1.9, f'r₂={r2:.3f}', ha='center', fontsize=11, fontweight='bold',
         bbox=dict(boxstyle='round', facecolor='lightcoral', alpha=0.7))

ax3.set_ylabel('径流模数 (万m³/(km²·年))', fontsize=12, fontweight='bold')
ax3.set_xticks(x)
ax3.set_xticklabels(periods, fontsize=11, fontweight='bold')
ax3.set_title(f'(3) 径流模数对比\n模数比变化{(r2-r1)/r1*100:.1f}%',
              fontsize=13, fontweight='bold', pad=10)
ax3.legend(loc='upper right', fontsize=10)
ax3.grid(axis='y', alpha=0.3, linestyle='--')
ax3.set_ylim(0, 2.0)

# ========== 子图4: 测站与参证站关系 ==========
ax4 = fig.add_subplot(2, 3, 4)

# 前期数据点
ref_before = reference_runoff[years < 1995]
sta_before = station_runoff[years < 1995]
ax4.scatter(ref_before, sta_before, s=150, c='green', marker='o',
            edgecolors='black', linewidths=2, alpha=0.7, label='前期(1980-1994)', zorder=5)

# 后期数据点
ref_after = reference_runoff[years >= 1995]
sta_after = station_runoff[years >= 1995]
ax4.scatter(ref_after, sta_after, s=150, c='red', marker='s',
            edgecolors='black', linewidths=2, alpha=0.7, label='后期(1995-2010)', zorder=5)

# 拟合线
x_range = np.linspace(18, 23, 100)
y_fit1_line = k1 * x_range
y_fit2_line = k2 * x_range

ax4.plot(x_range, y_fit1_line, 'g--', linewidth=2.5,
         label=f'前期: W₁={k1:.3f}W₂')
ax4.plot(x_range, y_fit2_line, 'r--', linewidth=2.5,
         label=f'后期: W₁={k2:.3f}W₂')

ax4.set_xlabel('参证站年径流量 (亿m³)', fontsize=12, fontweight='bold')
ax4.set_ylabel('测站年径流量 (亿m³)', fontsize=12, fontweight='bold')
ax4.set_title('(4) 两站径流关系\n关系发生显著变化',
              fontsize=13, fontweight='bold', pad=10)
ax4.legend(loc='upper left', fontsize=10)
ax4.grid(True, alpha=0.3, linestyle='--')
ax4.set_xlim(17, 24)
ax4.set_ylim(9, 17)

# ========== 子图5: 还原效果对比 ==========
ax5 = fig.add_subplot(2, 3, 5)

# 实测vs还原
years_after_full = np.arange(1995, 2011)
runoff_measured = np.ones(len(years_after_full)) * avg_after  # 简化为平均值
runoff_restored = runoff_measured * restoration_coef

x_pos = np.arange(len(years_after_full))
width = 0.4

bars1 = ax5.bar(x_pos - width/2, runoff_measured, width,
                label='实测径流', color='#e74c3c', alpha=0.7,
                edgecolor='black', linewidth=1.5)
bars2 = ax5.bar(x_pos + width/2, runoff_restored, width,
                label='还原径流', color='#2ecc71', alpha=0.7,
                edgecolor='black', linewidth=1.5)

# 前期平均线
ax5.axhline(y=avg_before, color='blue', linestyle='--', linewidth=2.5,
            label=f'前期水平({avg_before:.1f})')

ax5.set_xlabel('年份', fontsize=12, fontweight='bold')
ax5.set_ylabel('年径流量 (亿m³)', fontsize=12, fontweight='bold')
ax5.set_title(f'(5) 还原效果对比\n还原系数K={restoration_coef:.3f}',
              fontsize=13, fontweight='bold', pad=10)
ax5.set_xticks(x_pos[::2])
ax5.set_xticklabels(years_after_full[::2], rotation=45, fontsize=10)
ax5.legend(loc='upper right', fontsize=10)
ax5.grid(axis='y', alpha=0.3, linestyle='--')

# ========== 子图6: 检验结果总结 ==========
ax6 = fig.add_subplot(2, 3, 6)
ax6.axis('off')

# 创建总结表格
summary_data = [
    ['检验方法', '指标', '前期', '后期', '变化率'],
    ['双累积曲线', '斜率k', f'{k1:.3f}', f'{k2:.3f}', f'{(k2-k1)/k1*100:.1f}%'],
    ['径流模数法', '模数比r', f'{r1:.3f}', f'{r2:.3f}', f'{(r2-r1)/r1*100:.1f}%'],
    ['', '', '', '', ''],
    ['一致性结论', '不一致', '', '', ''],
    ['转折年份', '1995年', '', '', ''],
    ['主要原因', '上游水库蓄水', '', '', ''],
    ['还原系数', f'K={restoration_coef:.3f}', '', '', ''],
]

table = ax6.table(cellText=summary_data, cellLoc='center',
                  loc='center', bbox=[0, 0.1, 1, 0.85])

table.auto_set_font_size(False)
table.set_fontsize(11)
table.scale(1, 2.2)

# 设置表头样式
for i in range(5):
    cell = table[(0, i)]
    cell.set_facecolor('#3498db')
    cell.set_text_props(weight='bold', color='white')

# 设置数据行样式
for i in range(1, 8):
    for j in range(5):
        cell = table[(i, j)]
        if i <= 2:
            cell.set_facecolor('#ecf0f1' if i % 2 == 0 else 'white')
        else:
            cell.set_facecolor('#ffffcc')
            cell.set_text_props(weight='bold')

ax6.set_title('(6) 一致性检验结果总结\n两种方法结论一致：系列不一致',
              fontsize=13, fontweight='bold', pad=20)

plt.tight_layout()
plt.savefig('题1_径流资料一致性检验.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n" + "=" * 70)
```

---

### 本题总结

**考点归纳**：
- 双累积曲线法原理与应用 ✅
- 斜率变化判断标准 ✅
- 径流模数计算方法 ✅
- 模数比分析技术 ✅
- 两种方法相互验证 ✅
- 还原系数确定 ✅

**易错点**：
- ❌ 累积径流计算错误（起点设置）
- ❌ 斜率计算分子分母颠倒
- ❌ 径流模数单位换算错误
- ❌ 模数比与斜率概念混淆
- ❌ 忘记判断一致性标准(5%)

**答题技巧**：
- 双累积曲线必须从原点(0,0)开始
- 转折点是判断一致性的关键
- 斜率k反映流域产流能力比值
- 两种方法结果应相互印证
- 变化率>5%即可判定不一致
- 还原系数=前期斜率/后期斜率

---
