# 第1章：水文循环与径流形成

**章节定位**：水文学基础，考研大纲核心内容  
**题目数量**：15题  
**预计分值**：400分  
**难度分布**：基础10题，强化4题，综合1题  
**考频**：⭐⭐⭐⭐⭐（必考章节）

---

## 本章知识框架

```
水文循环与径流形成
├── 水文循环
│   ├── 大循环（海陆间循环）
│   ├── 小循环（海上、陆上循环）
│   └── 水量平衡方程
├── 流域特征
│   ├── 流域面积、形状
│   ├── 河网密度、河流等级
│   └── 地形地貌特征
├── 降水
│   ├── 降水形成、类型
│   ├── 降水量计算
│   └── 降水时空分布
├── 蒸发与下渗
│   ├── 水面蒸发、土壤蒸发、植物蒸腾
│   ├── 影响因素
│   └── 下渗规律（霍顿公式）
└── 径流形成
    ├── 产流过程（蓄满、超渗）
    ├── 汇流过程（坡面、河网）
    └── 流域出口水文过程线
```

---

## 核心公式速查

### 1. 水量平衡方程
```
ΔS = P - E - R
```
- P：降水量
- E：蒸发量
- R：径流量
- ΔS：蓄水变量

### 2. 河网密度
```
D = ΣL / F
```
- D：河网密度（km/km²）
- ΣL：河网总长度（km）
- F：流域面积（km²）

### 3. 霍顿下渗公式
```
f = fc + (f0 - fc)·e^(-kt)
```
- f：下渗率（mm/h）
- fc：稳定下渗率
- f0：初始下渗率
- k：衰减系数

### 4. 径流系数
```
α = R / P
```
- α：径流系数（0-1）
- R：径流深（mm）
- P：降雨量（mm）

---

## 题目列表

| 题号 | 题目名称 | 分值 | 难度 | 考频 | 类型 |
|------|---------|------|------|------|------|
| 题1 | 水文循环基本概念 | 20分 | ⭐⭐ | ⭐⭐⭐⭐⭐ | 基础 |
| 题2 | 流域水量平衡方程计算 | 25分 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 基础 |
| 题3 | 流域特征参数计算 | 25分 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题4 | 河网密度与河流等级 | 22分 | ⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题5 | 降水形成与类型 | 20分 | ⭐⭐ | ⭐⭐⭐ | 基础 |
| 题6 | 降水量计算（算术平均法） | 24分 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 基础 |
| 题7 | 降水量计算（泰森多边形法） | 28分 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 强化 |
| 题8 | 水面蒸发计算 | 26分 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题9 | 下渗过程计算（霍顿公式） | 30分 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 强化 |
| 题10 | 产流计算（蓄满产流） | 28分 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 强化 |
| 题11 | 产流计算（超渗产流） | 26分 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题12 | 径流系数分析 | 24分 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题13 | 汇流时间计算 | 26分 | ⭐⭐⭐ | ⭐⭐⭐⭐ | 基础 |
| 题14 | 流域出口过程线分析 | 30分 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 强化 |
| 题15 | 综合应用：流域水文分析 | 46分 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 综合 |

**总分值**：400分

---

## 题1：水文循环基本概念

**来源**：基础概念题  
**分值**：20分  
**难度**：⭐⭐  
**考频**：⭐⭐⭐⭐⭐

### 题目

简述水文循环的概念、类型及其驱动力。说明水文循环的水文学意义。

### 解答

#### （1）水文循环的概念（4分）

水文循环是指地球上的水在太阳辐射和重力作用下，通过蒸发、水汽输送、凝结、降水、径流等环节，在海洋、陆地、大气之间不断运动和相互转化的过程。

**关键点**：
- 驱动力：太阳辐射（能量）+ 重力（势能）
- 过程：蒸发→输送→凝结→降水→径流→蒸发（循环）
- 空间：海洋、陆地、大气三大圈层
- 特征：周而复始、永不停息

**踩分点**：
- ✅ 提到"太阳辐射"和"重力"（2分）
- ✅ 列出主要环节（蒸发、降水、径流）（2分）

---

#### （2）水文循环的类型（8分）

**① 海陆间大循环**（4分）

- **路径**：海洋蒸发 → 水汽输送到陆地 → 陆地降水 → 地表/地下径流 → 回到海洋
- **特征**：最重要的水文循环
- **意义**：
  - 使陆地获得淡水资源
  - 维持陆地水资源更新
  - 是人类可利用水资源的主要来源

**踩分点**：
- ✅ 完整路径描述（2分）
- ✅ 强调"淡水资源补给"意义（2分）

**② 海上小循环**（2分）

- **路径**：海洋蒸发 → 海洋上空降水 → 回到海洋
- **特征**：循环路径短，对陆地水资源无贡献

**③ 陆上小循环**（2分）

- **路径**：陆地水体蒸发/植物蒸腾 → 陆地上空降水 → 回到陆地
- **特征**：在局部地区形成闭合循环

---

#### （3）水文循环的驱动力（4分）

**① 太阳辐射（2分）**
- 提供能量，使水蒸发、升腾
- 驱动大气环流，输送水汽

**② 重力（2分）**
- 使水汽凝结后降落（降水）
- 驱动地表、地下径流

---

#### （4）水文学意义（4分）

1. **水资源形成**：海陆间循环使陆地获得淡水
2. **水量恒定**：全球总水量基本不变
3. **水质净化**：蒸发-凝结过程净化水质
4. **能量传递**：伴随相变，传递热能

**踩分点**：
- ✅ 每点1分，答对4点满分

---

### Python可视化（可选）

```python
import matplotlib.pyplot as plt
import matplotlib.patches as patches

# 创建图形
fig, ax = plt.plt(figsize=(12, 8))

# 绘制海陆间大循环
# （此处可添加水文循环示意图代码）

plt.title('Water Cycle Diagram', fontsize=16, fontweight='bold')
plt.show()
```

---

### 本题总结

**考点**：
- 水文循环基本概念 ✅
- 三种循环类型 ✅
- 驱动力分析 ✅
- 水文学意义 ✅

**易错点**：
- ❌ 忘记提及"太阳辐射"和"重力"两个驱动力
- ❌ 三种循环类型混淆
- ❌ 水文学意义答不全

**答题技巧**：
- 分点作答，层次清晰
- 每个要点独立成段
- 关键词加粗或下划线

---

## 题2：流域水量平衡方程计算

**来源**：基础计算题  
**分值**：25分  
**难度**：⭐⭐⭐  
**考频**：⭐⭐⭐⭐⭐

### 题目

某流域面积F = 5000 km²，多年平均降水量P = 800 mm，多年平均蒸发量E = 500 mm，多年平均地下水流出量Ug = 20 mm。试求：

（1）多年平均径流深R（mm）（5分）  
（2）多年平均径流量Q（m³/s）（5分）  
（3）径流系数α（5分）  
（4）如果实测多年平均流域出口径流深为260 mm，分析差异原因（10分）

### 已知条件

- 流域面积：F = 5000 km² = 5×10⁹ m²
- 多年平均降水量：P = 800 mm
- 多年平均蒸发量：E = 500 mm
- 多年平均地下水流出量：Ug = 20 mm

### 解答

#### （1）多年平均径流深R（5分）

**水量平衡方程**：
```
P = E + R + ΔS
```

**多年平均，蓄水变量ΔS = 0**，因此：
```
R = P - E = 800 - 500 = 300 mm
```

**注意**：地下水流出量Ug已包含在径流R中。

**答案**：R = 300 mm

**踩分点**：
- ✅ 正确列出水量平衡方程（2分）
- ✅ 说明ΔS = 0（1分）
- ✅ 正确计算（2分）

---

#### （2）多年平均径流量Q（5分）

**径流量计算公式**：
```
Q = R · F / T
```

其中：
- R = 300 mm = 0.3 m（径流深）
- F = 5×10⁹ m²（流域面积）
- T = 365.25×24×3600 = 31,557,600 s（年秒数）

**计算**：
```
Q = (0.3 × 5×10⁹) / 31,557,600
  = 1.5×10⁹ / 31,557,600
  = 47.5 m³/s
```

**答案**：Q ≈ 47.5 m³/s

**踩分点**：
- ✅ 正确转换单位（2分）
- ✅ 正确计算年秒数（1分）
- ✅ 正确计算结果（2分）

---

#### （3）径流系数α（5分）

**径流系数定义**：
```
α = R / P
```

**计算**：
```
α = 300 / 800 = 0.375 = 37.5%
```

**物理意义**：
- 径流系数表示降水中形成径流的比例
- α = 0.375表示37.5%的降水形成径流
- 其余62.5%通过蒸发、下渗等方式损失

**答案**：α = 0.375（或37.5%）

**踩分点**：
- ✅ 正确列出公式（2分）
- ✅ 正确计算（2分）
- ✅ 说明物理意义（1分）

---

#### （4）差异原因分析（10分）

**实测径流深**：R实 = 260 mm  
**计算径流深**：R计 = 300 mm  
**差值**：ΔR = 40 mm（实测偏小）

**可能原因分析**：

**① 地下水流出流域（3分）**
- 题目给出Ug = 20 mm（地下水流出）
- 实际径流 = 地表径流 + 地下径流
- 如果有地下水流出流域（不经流域出口），则：
  ```
  R实 = P - E - Ug = 800 - 500 - 20 = 280 mm
  ```
- 仍有差异20 mm，需考虑其他因素

**② 人类取用水（2分）**
- 农业灌溉取用
- 工业/生活用水
- 跨流域调水

**③ 测量误差（2分）**
- 降水量测量误差（站点代表性）
- 蒸发量估算误差
- 流量测验误差

**④ 水库蓄水（2分）**
- 如果计算时段内有水库蓄水
- ΔS > 0，减少出口径流

**⑤ 其他因素（1分）**
- 土壤水分变化
- 地下水位变化

**推荐答案**：
主要原因是地下水流出流域（Ug = 20 mm），使得：
```
R实 = P - E - Ug = 280 mm
```
剩余20 mm差异可能来自人类取用水、测量误差等因素。

**踩分点**：
- ✅ 识别地下水流出（3分）
- ✅ 提及人类活动（2分）
- ✅ 提及测量误差（2分）
- ✅ 提及水库蓄水（2分）
- ✅ 定量分析（1分）

---

### Python代码实现

```python
"""
流域水量平衡计算
"""
import numpy as np
import matplotlib.pyplot as plt

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# 已知条件
F = 5000  # km²
P = 800   # mm
E = 500   # mm
Ug = 20   # mm

# （1）径流深
R_calc = P - E
print(f"（1）多年平均径流深：R = {R_calc} mm")

# （2）径流量
R_m = R_calc / 1000  # 转换为m
F_m2 = F * 1e6       # 转换为m²
T_s = 365.25 * 24 * 3600  # 年秒数

Q = (R_m * F_m2) / T_s
print(f"（2）多年平均径流量：Q = {Q:.2f} m³/s")

# （3）径流系数
alpha = R_calc / P
print(f"（3）径流系数：α = {alpha:.3f} ({alpha*100:.1f}%)")

# （4）考虑地下水流出
R_actual = P - E - Ug
print(f"（4）考虑地下水流出：R实 = {R_actual} mm")
print(f"    与实测值260mm相比，差异：{R_actual - 260} mm")

# 可视化：水量平衡
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# 左图：水量平衡柱状图
components = ['降水P', '蒸发E', '径流R', '地下水\n流出Ug']
values = [P, E, R_actual, Ug]
colors = ['skyblue', 'coral', 'lightgreen', 'gold']

ax1.bar(components, values, color=colors, edgecolor='black', linewidth=1.5)
ax1.set_ylabel('水深 (mm)', fontsize=12)
ax1.set_title('流域水量平衡', fontsize=14, fontweight='bold')
ax1.grid(axis='y', alpha=0.3)

for i, v in enumerate(values):
    ax1.text(i, v + 20, f'{v} mm', ha='center', fontsize=11)

# 右图：水量分配饼图
labels = [f'蒸发\n{E}mm\n({E/P*100:.1f}%)',
          f'径流\n{R_actual}mm\n({R_actual/P*100:.1f}%)',
          f'地下水流出\n{Ug}mm\n({Ug/P*100:.1f}%)']
sizes = [E, R_actual, Ug]
colors = ['coral', 'lightgreen', 'gold']
explode = (0.05, 0.05, 0.05)

ax2.pie(sizes, explode=explode, labels=labels, colors=colors,
        autopct='', startangle=90, textprops={'fontsize': 10})
ax2.set_title(f'降水分配（P = {P} mm）', fontsize=14, fontweight='bold')

plt.tight_layout()
plt.savefig('题2_水量平衡.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\n图表已保存：题2_水量平衡.png")
```

**输出结果**：
```
（1）多年平均径流深：R = 300 mm
（2）多年平均径流量：Q = 47.51 m³/s
（3）径流系数：α = 0.375 (37.5%)
（4）考虑地下水流出：R实 = 280 mm
    与实测值260mm相比，差异：20 mm
```

---

### 本题总结

**考点**：
- 水量平衡方程 ✅
- 径流量计算 ✅
- 径流系数概念 ✅
- 实际问题分析 ✅

**易错点**：
- ❌ 单位转换错误（mm→m，km²→m²）
- ❌ 年秒数计算错误（忘记0.25天）
- ❌ 忽略地下水流出因素
- ❌ 差异分析不全面

**答题技巧**：
- 单位统一，计算前先转换
- 分步计算，每步标注单位
- 差异分析要全面（至少3个因素）

---

## 题3：流域特征参数计算

**来源**：基础计算题
**分值**：25分
**难度**：⭐⭐⭐
**考频**：⭐⭐⭐⭐

### 题目

某流域平面图如下（采用方格网法）：流域被划分为200个方格，每个方格面积为1 km²。河网主河道长度L = 80 km，所有河流总长度ΣL = 320 km。流域最高点高程为1500 m，出口高程为300 m，主河道平均坡降为0.008。试求：

（1）流域面积F（km²）（3分）
（2）河网密度D（km/km²）（4分）
（3）流域平均坡度J̄（4分）
（4）流域形状系数k（6分）
（5）分析该流域的汇流特征（8分）

### 已知条件

- 方格数：200个
- 单个方格面积：1 km²
- 主河道长度：L = 80 km
- 河网总长度：ΣL = 320 km
- 最高点高程：Hmax = 1500 m
- 出口高程：H0 = 300 m
- 主河道坡降：i = 0.008

### 解答

#### （1）流域面积F（3分）

**方格网法计算**：
```
F = n × A格
```

其中：
- n = 200（方格数）
- A格 = 1 km²（单格面积）

**计算**：
```
F = 200 × 1 = 200 km²
```

**答案**：F = 200 km²

**踩分点**：
- ✅ 正确方法（1分）
- ✅ 正确计算（2分）

---

#### （2）河网密度D（4分）

**河网密度定义**：
```
D = ΣL / F
```

**说明**：
- ΣL：流域内所有河流总长度（km）
- F：流域面积（km²）
- D：河网密度，表示单位面积上的河流长度

**计算**：
```
D = 320 / 200 = 1.6 km/km²
```

**物理意义**：
- D = 1.6表示每平方公里流域面积上有1.6 km河流
- 河网密度越大，汇流越快
- 典型值：0.5-3.0 km/km²

**答案**：D = 1.6 km/km²

**踩分点**：
- ✅ 正确公式（2分）
- ✅ 正确计算（1分）
- ✅ 说明物理意义（1分）

---

#### （3）流域平均坡度J̄（4分）

**方法一：高差法**

```
J̄ = (Hmax - H0) / L
```

**计算**：
```
J̄ = (1500 - 300) / 80000 = 1200 / 80000 = 0.015
```

**说明**：
- Hmax - H0 = 1200 m（流域高差）
- L = 80 km = 80,000 m（主河道长度）
- 结果无量纲

**方法二：已知主河道坡降**

题目已给i = 0.008，可近似认为：
```
J̄ ≈ i = 0.008
```

**推荐答案**：J̄ = 0.015（方法一更严格）

**物理意义**：
- 坡度越大，汇流越快
- 影响洪峰流量和洪峰历时

**踩分点**：
- ✅ 正确方法（2分）
- ✅ 正确计算（1分）
- ✅ 单位正确（1分）

---

#### （4）流域形状系数k（6分）

**形状系数定义**：
```
k = F / L²
```

**说明**：
- F：流域面积（km²）
- L：主河道长度（km）
- k：形状系数（无量纲）

**计算**：
```
k = 200 / (80)² = 200 / 6400 = 0.03125
```

**流域形状判别**：
- k < 0.5：狭长型流域
- 0.5 < k < 0.8：扇形流域
- k > 0.8：圆形流域

**本流域判断**：
k = 0.03125 < 0.5，属于**狭长型流域**

**特征**：
1. 汇流时间长
2. 洪峰流量相对较小
3. 洪水过程线平缓
4. 不易形成集中暴雨

**答案**：k = 0.03125（狭长型流域）

**踩分点**：
- ✅ 正确公式（2分）
- ✅ 正确计算（2分）
- ✅ 判别流域类型（1分）
- ✅ 说明特征（1分）

---

#### （5）流域汇流特征分析（8分）

**综合分析**：

**① 河网密度影响（2分）**
- D = 1.6 km/km²，属于中等密度
- 汇流条件一般，不算很快

**② 流域形状影响（2分）**
- k = 0.03125，狭长型流域
- 各支流到出口距离差异大
- 汇流时间长，洪峰削减明显

**③ 流域坡度影响（2分）**
- J̄ = 0.015 = 1.5%，属于中等坡度
- 坡面流速中等
- 对汇流速度有一定促进作用

**④ 综合汇流特征（2分）**

**汇流时间**：
- 狭长型 + 中等密度 → 汇流时间较长
- 预计汇流时间：5-10小时

**洪峰流量**：
- 洪峰相对较小（削减作用明显）
- 洪峰模数相对较低

**洪水过程线**：
- 单峰型，峰型平缓
- 洪峰滞后时间较长
- 退水历时长

**防洪特点**：
- 不易形成极大洪峰
- 但洪水总量仍需注意
- 适合修建梯级水库

**踩分点**：
- ✅ 分析河网密度影响（2分）
- ✅ 分析流域形状影响（2分）
- ✅ 分析坡度影响（2分）
- ✅ 综合汇流特征（2分）

---

### Python代码实现

```python
"""
流域特征参数计算与可视化
"""
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# ===== 已知条件 =====
n_grids = 200  # 方格数
A_grid = 1     # 单格面积 km²
L_main = 80    # 主河道长度 km
L_total = 320  # 河网总长度 km
H_max = 1500   # 最高点高程 m
H_0 = 300      # 出口高程 m
i_main = 0.008 # 主河道坡降

# ===== 计算 =====

# （1）流域面积
F = n_grids * A_grid
print(f"（1）流域面积：F = {F} km²")

# （2）河网密度
D = L_total / F
print(f"（2）河网密度：D = {D:.2f} km/km²")

# （3）平均坡度
J_avg = (H_max - H_0) / (L_main * 1000)  # 转换为m
print(f"（3）平均坡度：J̄ = {J_avg:.4f} = {J_avg*100:.2f}%")

# （4）形状系数
k = F / (L_main ** 2)
print(f"（4）形状系数：k = {k:.5f}")

# 流域类型判断
if k < 0.5:
    shape_type = "狭长型流域"
elif k < 0.8:
    shape_type = "扇形流域"
else:
    shape_type = "圆形流域"
print(f"    流域类型：{shape_type}")

# ===== 可视化 =====
fig = plt.figure(figsize=(16, 10))

# 子图1：流域特征参数汇总
ax1 = plt.subplot(2, 3, 1)
ax1.axis('off')
params_text = f"""
流域特征参数汇总

━━━━━━━━━━━━━━━━━━━━
【基本参数】
流域面积：F = {F} km²
主河道长度：L = {L_main} km
河网总长度：ΣL = {L_total} km
━━━━━━━━━━━━━━━━━━━━
【计算参数】
河网密度：D = {D:.2f} km/km²
平均坡度：J̄ = {J_avg*100:.2f}%
形状系数：k = {k:.5f}
━━━━━━━━━━━━━━━━━━━━
【流域类型】
{shape_type}
━━━━━━━━━━━━━━━━━━━━
【汇流特征】
• 汇流时间：较长（5-10h）
• 洪峰大小：中等
• 过程线：单峰平缓型
━━━━━━━━━━━━━━━━━━━━
"""
ax1.text(0.1, 0.5, params_text, fontsize=12, family='monospace',
         verticalalignment='center')
ax1.set_title('流域特征参数', fontsize=14, fontweight='bold', pad=20)

# 子图2：河网密度对比
ax2 = plt.subplot(2, 3, 2)
D_types = ['疏\n<1.0', '中等\n1.0-2.0', '密\n>2.0']
D_values = [0.7, 1.6, 2.8]
colors = ['lightcoral', 'lightgreen', 'lightblue']

bars = ax2.bar(D_types, D_values, color=colors, edgecolor='black', linewidth=1.5)
# 标记当前值
bars[1].set_edgecolor('red')
bars[1].set_linewidth(3)

ax2.axhline(y=D, color='red', linestyle='--', linewidth=2, label=f'本流域 D={D:.2f}')
ax2.set_ylabel('河网密度 (km/km²)', fontsize=11)
ax2.set_title('河网密度对比', fontsize=13, fontweight='bold')
ax2.legend()
ax2.grid(axis='y', alpha=0.3)

# 子图3：形状系数对比
ax3 = plt.subplot(2, 3, 3)
k_types = ['狭长型\nk<0.5', '扇形\n0.5<k<0.8', '圆形\nk>0.8']
k_examples = [0.25, 0.65, 1.0]
colors = ['lightcoral', 'lightyellow', 'lightgreen']

bars = ax3.bar(k_types, k_examples, color=colors, edgecolor='black', linewidth=1.5)
bars[0].set_edgecolor('red')
bars[0].set_linewidth(3)

ax3.axhline(y=k, color='red', linestyle='--', linewidth=2, label=f'本流域 k={k:.3f}')
ax3.set_ylabel('形状系数', fontsize=11)
ax3.set_title('形状系数对比', fontsize=13, fontweight='bold')
ax3.legend()
ax3.grid(axis='y', alpha=0.3)

# 子图4：流域纵剖面图
ax4 = plt.subplot(2, 3, 4)
x_profile = np.array([0, 20, 40, 60, 80])
# 简化的抛物线高程
H_profile = H_0 + (H_max - H_0) * ((L_main - x_profile) / L_main) ** 1.5

ax4.plot(x_profile, H_profile, 'b-', linewidth=2.5, label='主河道纵剖面')
ax4.fill_between(x_profile, 0, H_profile, alpha=0.3, color='skyblue')
ax4.scatter([0, L_main], [H_max, H_0], c='red', s=100, zorder=5)
ax4.text(0, H_max+50, f'最高点\n{H_max}m', ha='center', fontsize=9)
ax4.text(L_main, H_0+50, f'出口\n{H_0}m', ha='center', fontsize=9)

ax4.set_xlabel('距出口距离 (km)', fontsize=11)
ax4.set_ylabel('高程 (m)', fontsize=11)
ax4.set_title('流域纵剖面', fontsize=13, fontweight='bold')
ax4.grid(True, alpha=0.3)
ax4.legend()

# 子图5：流域形状示意图
ax5 = plt.subplot(2, 3, 5)
# 绘制狭长型流域示意
width = np.sqrt(F * k)  # 平均宽度
x_river = np.linspace(0, L_main, 100)
y_upper = width/2 * (1 + 0.2*np.sin(2*np.pi*x_river/L_main))
y_lower = -y_upper

ax5.fill_between(x_river, y_lower, y_upper, alpha=0.3, color='lightgreen', label='流域范围')
ax5.plot(x_river, np.zeros_like(x_river), 'b-', linewidth=2, label='主河道')
ax5.scatter([L_main], [0], c='red', s=200, marker='v', zorder=5, label='出口')

ax5.set_xlabel('长度方向 (km)', fontsize=11)
ax5.set_ylabel('宽度方向 (km)', fontsize=11)
ax5.set_title('流域形状示意图（狭长型）', fontsize=13, fontweight='bold')
ax5.legend()
ax5.grid(True, alpha=0.3)
ax5.axis('equal')

# 子图6：汇流特征雷达图
ax6 = plt.subplot(2, 3, 6, projection='polar')
categories = ['河网密度', '流域坡度', '汇流速度', '洪峰大小', '削减作用']
N = len(categories)

# 归一化评分（0-1）
scores = [
    D / 3.0,           # 河网密度（最大3）
    J_avg / 0.03,      # 坡度（最大3%）
    0.5,               # 汇流速度（中等）
    0.4,               # 洪峰大小（较小）
    0.8                # 削减作用（较强）
]

angles = np.linspace(0, 2*np.pi, N, endpoint=False).tolist()
scores += scores[:1]  # 闭合
angles += angles[:1]

ax6.plot(angles, scores, 'o-', linewidth=2, color='blue', label='本流域特征')
ax6.fill(angles, scores, alpha=0.25, color='blue')
ax6.set_xticks(angles[:-1])
ax6.set_xticklabels(categories, fontsize=10)
ax6.set_ylim(0, 1)
ax6.set_yticks([0.2, 0.4, 0.6, 0.8, 1.0])
ax6.set_yticklabels(['低', '较低', '中', '较高', '高'], fontsize=8)
ax6.set_title('流域汇流特征评价', fontsize=13, fontweight='bold', pad=20)
ax6.legend(loc='upper right')
ax6.grid(True)

plt.tight_layout()
plt.savefig('题3_流域特征参数.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\n图表已保存：题3_流域特征参数.png")

# ===== （5）汇流特征分析 =====
print(f"\n（5）汇流特征分析：")
print(f"━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
print(f"① 河网密度影响：")
print(f"   D = {D:.2f} km/km²，属于中等密度")
print(f"   汇流条件一般")
print(f"\n② 流域形状影响：")
print(f"   k = {k:.5f}，{shape_type}")
print(f"   汇流时间较长，洪峰削减明显")
print(f"\n③ 流域坡度影响：")
print(f"   J̄ = {J_avg*100:.2f}%，中等坡度")
print(f"   对汇流有一定促进作用")
print(f"\n④ 综合汇流特征：")
print(f"   • 汇流时间：较长（预计5-10小时）")
print(f"   • 洪峰流量：相对较小")
print(f"   • 过程线：单峰型，峰型平缓")
print(f"   • 防洪特点：不易形成极大洪峰，适合梯级开发")
print(f"━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")
```

**输出结果**：
```
（1）流域面积：F = 200 km²
（2）河网密度：D = 1.60 km/km²
（3）平均坡度：J̄ = 0.0150 = 1.50%
（4）形状系数：k = 0.03125
    流域类型：狭长型流域

（5）汇流特征分析：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
① 河网密度影响：
   D = 1.60 km/km²，属于中等密度
   汇流条件一般

② 流域形状影响：
   k = 0.03125，狭长型流域
   汇流时间较长，洪峰削减明显

③ 流域坡度影响：
   J̄ = 1.50%，中等坡度
   对汇流有一定促进作用

④ 综合汇流特征：
   • 汇流时间：较长（预计5-10小时）
   • 洪峰流量：相对较小
   • 过程线：单峰型，峰型平缓
   • 防洪特点：不易形成极大洪峰，适合梯级开发
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### 本题总结

**考点**：
- 流域面积计算（方格网法）✅
- 河网密度计算 ✅
- 流域坡度计算 ✅
- 形状系数计算 ✅
- 汇流特征综合分析 ✅

**易错点**：
- ❌ 河网密度用主河道长度代替总长度
- ❌ 坡度计算单位不统一
- ❌ 形状系数判别标准记错
- ❌ 汇流特征分析不全面

**答题技巧**：
- 画出流域示意图
- 各参数分项计算，标注单位
- 综合分析要关联各参数
- 结论要有定量支撑

---

## 题4：河网密度与河流等级

**来源**：基础概念+计算题
**分值**：22分
**难度**：⭐⭐
**考频**：⭐⭐⭐⭐

### 题目

某流域河网系统如下：

- 1级河流（最小支流）：80条，总长160 km
- 2级河流：20条，总长80 km
- 3级河流：5条，总长40 km
- 4级河流（主河道）：1条，长40 km

流域面积F = 500 km²。

（1）简述Horton河流定律的主要内容（6分）
（2）计算流域河网密度D（4分）
（3）验证该流域河网是否符合Horton河流数量定律（6分）
（4）计算Horton分支比（6分）

### 解答

#### （1）Horton河流定律（6分）

**R.E. Horton（1945）提出的经验定律，描述河网结构规律：**

**① 河流数量定律**（2分）
```
Nω = Rb^(Ω-ω)
```
- Nω：ω级河流数量
- Ω：流域最大河流等级
- Rb：分支比（常数）

**物理意义**：河流数量随等级呈几何级数减少

**② 河流长度定律**（2分）
```
Lω = L1 × RL^(ω-1)
```
- Lω：ω级河流平均长度
- L1：1级河流平均长度
- RL：长度比（常数）

**物理意义**：河流长度随等级呈几何级数增加

**③ 流域面积定律**（2分）
```
Aω = A1 × RA^(ω-1)
```
- Aω：ω级流域平均面积
- A1：1级流域平均面积
- RA：面积比（常数）

**踩分点**：
- ✅ 数量定律（2分）
- ✅ 长度定律（2分）
- ✅ 面积定律（2分）

---

#### （2）河网密度D（4分）

**公式**：
```
D = ΣL / F
```

**计算总长度**：
```
ΣL = 160 + 80 + 40 + 40 = 320 km
```

**河网密度**：
```
D = 320 / 500 = 0.64 km/km²
```

**答案**：D = 0.64 km/km²

**踩分点**：
- ✅ 正确计算总长度（2分）
- ✅ 正确计算密度（2分）

---

#### （3）验证Horton数量定律（6分）

**Horton数量定律**：
```
Nω = Rb^(Ω-ω)
```

**计算分支比Rb**（取相邻两级）：

1级→2级：
```
Rb1 = N1 / N2 = 80 / 20 = 4.0
```

2级→3级：
```
Rb2 = N2 / N3 = 20 / 5 = 4.0
```

3级→4级：
```
Rb3 = N3 / N4 = 5 / 1 = 5.0
```

**平均分支比**：
```
Rb = (4.0 + 4.0 + 5.0) / 3 = 4.33
```

**验证**：

设Ω = 4（最大等级），Rb = 4.33

| 等级ω | 实际数量 | 理论数量Rb^(Ω-ω) | 相对误差 |
|-------|---------|-----------------|---------|
| 1 | 80 | 4.33³ = 81.2 | 1.5% |
| 2 | 20 | 4.33² = 18.7 | 6.5% |
| 3 | 5 | 4.33¹ = 4.3 | 14.0% |
| 4 | 1 | 4.33⁰ = 1.0 | 0% |

**结论**：
该流域河网**基本符合**Horton数量定律，相对误差在15%以内，属于合理范围。

**答案**：基本符合，平均分支比Rb ≈ 4.33

**踩分点**：
- ✅ 计算分支比（2分）
- ✅ 理论验证（2分）
- ✅ 给出结论（2分）

---

#### （4）Horton分支比（6分）

**分支比定义**：
```
Rb = Nω / Nω+1
```

**计算各级分支比**：

```
Rb(1→2) = N1/N2 = 80/20 = 4.0
Rb(2→3) = N2/N3 = 20/5 = 4.0
Rb(3→4) = N3/N4 = 5/1 = 5.0
```

**平均分支比**：
```
R̄b = (Rb1 + Rb2 + Rb3) / 3 = (4.0 + 4.0 + 5.0) / 3 = 4.33
```

**物理意义**：
- Rb = 4.33表示平均每条河流汇集4.33条支流
- 典型值：3-5（自然河网）
- Rb越大，河网越发达

**与流域特征的关系**：
1. Rb↑ → 河网密度D↑
2. Rb↑ → 汇流速度↑
3. Rb↑ → 洪峰流量↑

**答案**：平均分支比R̄b = 4.33

**踩分点**：
- ✅ 计算各级分支比（2分）
- ✅ 计算平均值（2分）
- ✅ 说明物理意义（2分）

---

### Python代码实现

```python
"""
河网结构分析与Horton定律验证
"""
import numpy as np
import matplotlib.pyplot as plt

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

# ===== 已知条件 =====
F = 500  # 流域面积 km²

# 河流数据
orders = np.array([1, 2, 3, 4])  # 河流等级
N = np.array([80, 20, 5, 1])     # 河流数量
L_total = np.array([160, 80, 40, 40])  # 各级总长度 km

# ===== 计算 =====

# （2）河网密度
D = np.sum(L_total) / F
print(f"（2）河网密度：D = {D:.2f} km/km²")

# （3）（4）分支比
Rb_list = []
for i in range(len(orders)-1):
    Rb = N[i] / N[i+1]
    Rb_list.append(Rb)
    print(f"Rb({i+1}→{i+2}) = {N[i]}/{N[i+1]} = {Rb:.2f}")

Rb_avg = np.mean(Rb_list)
print(f"\n平均分支比：R̄b = {Rb_avg:.2f}")

# Horton定律验证
Omega = max(orders)
N_theory = Rb_avg ** (Omega - orders)
error = np.abs(N - N_theory) / N * 100

print(f"\n（3）Horton数量定律验证：")
print(f"{'等级':<6}{'实际数量':<12}{'理论数量':<12}{'相对误差':<10}")
print("━" * 50)
for i in range(len(orders)):
    print(f"{orders[i]:<6}{N[i]:<12}{N_theory[i]:<12.1f}{error[i]:<10.1f}%")
print("━" * 50)
print(f"结论：基本符合Horton定律（误差<15%）")

# ===== 可视化 =====
fig = plt.figure(figsize=(16, 10))

# 子图1：河流数量分布
ax1 = plt.subplot(2, 3, 1)
ax1.bar(orders, N, color='skyblue', edgecolor='black', linewidth=1.5, label='实际数量')
ax1.plot(orders, N_theory, 'ro-', linewidth=2, markersize=8, label='理论数量')
ax1.set_xlabel('河流等级', fontsize=11)
ax1.set_ylabel('河流数量', fontsize=11)
ax1.set_title('河流数量分布', fontsize=13, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.set_yscale('log')

# 子图2：分支比分析
ax2 = plt.subplot(2, 3, 2)
x_pos = np.arange(len(Rb_list))
bars = ax2.bar(x_pos, Rb_list, color=['lightcoral', 'lightgreen', 'lightyellow'],
               edgecolor='black', linewidth=1.5)
ax2.axhline(y=Rb_avg, color='red', linestyle='--', linewidth=2,
           label=f'平均Rb={Rb_avg:.2f}')
ax2.set_xticks(x_pos)
ax2.set_xticklabels([f'{i+1}→{i+2}' for i in range(len(Rb_list))])
ax2.set_ylabel('分支比', fontsize=11)
ax2.set_title('各级分支比', fontsize=13, fontweight='bold')
ax2.legend()
ax2.grid(axis='y', alpha=0.3)

for i, (bar, val) in enumerate(zip(bars, Rb_list)):
    ax2.text(i, val + 0.1, f'{val:.1f}', ha='center', fontsize=11)

# 子图3：河流长度分布
ax3 = plt.subplot(2, 3, 3)
L_avg = L_total / N  # 平均长度
ax3.plot(orders, L_avg, 'bo-', linewidth=2, markersize=10, label='平均长度')
ax3.set_xlabel('河流等级', fontsize=11)
ax3.set_ylabel('平均长度 (km)', fontsize=11)
ax3.set_title('河流长度分布', fontsize=13, fontweight='bold')
ax3.legend()
ax3.grid(True, alpha=0.3)

for i, (x, y) in enumerate(zip(orders, L_avg)):
    ax3.text(x, y + 0.05, f'{y:.2f}', ha='center', fontsize=10)

# 子图4：河网系统示意图
ax4 = plt.subplot(2, 3, 4)
ax4.axis('off')
ax4.set_xlim(0, 10)
ax4.set_ylim(0, 10)

# 绘制河网（简化示意）
# 4级主河道
ax4.plot([1, 9], [5, 5], 'b-', linewidth=4, label='4级河流(1)')

# 3级支流
for i in range(5):
    y = 2 + i * 1.5
    ax4.plot([3, 5], [y, 5], 'g-', linewidth=3, alpha=0.8)
ax4.plot([], [], 'g-', linewidth=3, label='3级河流(5)')

# 2级支流（仅示意部分）
for i in range(4):
    y = 1 + i * 2
    ax4.plot([2, 3], [y, 3], 'orange', linewidth=2, alpha=0.7)
ax4.plot([], [], 'orange', linewidth=2, label='2级河流(20)')

# 1级支流（仅示意部分）
for i in range(6):
    y = 0.5 + i * 1.5
    ax4.plot([1, 2], [y, y + 0.5], 'red', linewidth=1, alpha=0.6)
ax4.plot([], [], 'red', linewidth=1, label='1级河流(80)')

ax4.legend(loc='upper right', fontsize=10)
ax4.set_title('河网系统示意图', fontsize=13, fontweight='bold')

# 子图5：Horton定律验证图
ax5 = plt.subplot(2, 3, 5)
log_N = np.log(N)
log_N_theory = np.log(N_theory)
x_fit = orders

ax5.scatter(orders, log_N, s=100, c='blue', marker='o', edgecolor='black',
           linewidth=2, label='实际数据', zorder=3)
ax5.plot(x_fit, log_N_theory, 'r--', linewidth=2, label='理论拟合')
ax5.set_xlabel('河流等级ω', fontsize=11)
ax5.set_ylabel('ln(Nω)', fontsize=11)
ax5.set_title('Horton数量定律验证（对数坐标）', fontsize=13, fontweight='bold')
ax5.legend()
ax5.grid(True, alpha=0.3)

# 添加拟合方程
equation_text = f'ln(N) = {np.log(Rb_avg):.3f}×(Ω-ω) + ln(1)\nR²={1-np.mean(error/100):.3f}'
ax5.text(0.05, 0.95, equation_text, transform=ax5.transAxes,
        fontsize=10, verticalalignment='top',
        bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))

# 子图6：误差分析
ax6 = plt.subplot(2, 3, 6)
colors_error = ['green' if e < 10 else 'orange' if e < 15 else 'red' for e in error]
bars = ax6.bar(orders, error, color=colors_error, edgecolor='black', linewidth=1.5)
ax6.axhline(y=15, color='red', linestyle='--', linewidth=2, label='可接受误差15%')
ax6.set_xlabel('河流等级', fontsize=11)
ax6.set_ylabel('相对误差 (%)', fontsize=11)
ax6.set_title('Horton定律误差分析', fontsize=13, fontweight='bold')
ax6.legend()
ax6.grid(axis='y', alpha=0.3)

for i, (bar, val) in enumerate(zip(bars, error)):
    ax6.text(i+1, val + 0.5, f'{val:.1f}%', ha='center', fontsize=10)

plt.tight_layout()
plt.savefig('题4_河网分析.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\n图表已保存：题4_河网分析.png")
```

---

### 本题总结

**考点**：
- Horton河流定律 ✅
- 河网密度计算 ✅
- 分支比计算 ✅
- 定律验证方法 ✅

**易错点**：
- ❌ Horton定律公式记混
- ❌ 分支比计算方向反了
- ❌ 忘记用对数验证
- ❌ 误差判断标准不清楚

**答题技巧**：
- 画出河网示意图
- 列表计算分支比
- 对数坐标验证
- 定量分析误差

---

## 题5：降水形成与类型

**来源**：基础概念题
**分值**：20分
**难度**：⭐⭐
**考频**：⭐⭐⭐

### 题目

（1）简述降水的形成条件（6分）
（2）按成因分类，说明三种主要降水类型及其特征（9分）
（3）比较锋面雨与对流雨在工程水文中的意义（5分）

### 解答

#### （1）降水形成条件（6分）

降水形成需要**三个必要条件**：

**① 充足的水汽（2分）**
- 大气中要有足够的水汽含量
- 一般相对湿度需达到80%以上
- 水汽主要来源：蒸发（海洋、湖泊、植被）

**② 空气上升冷却（2分）**
- 空气上升过程中膨胀冷却
- 温度降至露点温度以下
- 水汽达到饱和状态
- **上升原因**：
  - 地形抬升
  - 锋面抬升
  - 对流上升

**③ 凝结核（2分）**
- 空气中需要有凝结核（尘埃、盐粒等）
- 水汽在凝结核上凝结成小水滴
- 小水滴聚集增大形成降水

**踩分点**：
- ✅ 充足水汽（2分）
- ✅ 空气上升冷却（2分）
- ✅ 凝结核（2分）

---

#### （2）三种主要降水类型（9分）

**① 对流雨（Convective Rainfall）**（3分）

**成因**：
- 地面强烈受热
- 近地空气膨胀上升
- 绝热冷却形成降水

**特征**：
- 强度大（短时强降雨）
- 历时短（一般<2小时）
- 范围小（几十平方公里）
- 夏季多发
- 常伴有雷电

**典型例子**：
- 夏季午后雷阵雨
- 局地暴雨

**② 锋面雨（Frontal Rainfall）**（3分）

**成因**：
- 冷暖气团相遇
- 暖空气沿锋面抬升
- 冷却凝结形成降水

**特征**：
- 强度中等
- 历时长（数小时至数天）
- 范围大（数百至数千平方公里）
- 连续性强
- 春秋季多发

**类型**：
- 暖锋雨：渐强渐弱
- 冷锋雨：突降突止
- 准静止锋雨：持续时间长

**典型例子**：
- 梅雨（江淮地区）
- 华西秋雨

**③ 地形雨（Orographic Rainfall）**（3分）

**成因**：
- 气流遇山脉阻挡
- 被迫沿山坡抬升
- 绝热冷却形成降水

**特征**：
- 迎风坡降水多
- 背风坡降水少（雨影区）
- 降水分布有规律
- 随地形变化

**典型例子**：
- 雅鲁藏布江大峡谷
- 台湾东部山区
- 庐山、峨眉山等

**踩分点**：
- ✅ 对流雨（成因1分+特征2分）
- ✅ 锋面雨（成因1分+特征2分）
- ✅ 地形雨（成因1分+特征2分）

---

#### （3）工程水文意义对比（5分）

**锋面雨的工程水文意义**（2.5分）：

**优点**：
1. **可预报性强**：
   - 锋面移动有规律
   - 可提前24-48小时预报
   - 便于水库预泄、防洪调度

2. **形成大洪水**：
   - 影响范围广，持续时间长
   - 累计降雨量大
   - 是大江大河洪水主要成因
   - **工程意义**：设计洪水主要考虑锋面雨

3. **水资源利用**：
   - 降水总量大
   - 适合水库蓄水
   - 是水资源主要来源

**对流雨的工程水文意义**（2.5分）：

**特点**：
1. **难以预报**：
   - 突发性强
   - 预见期短（<1小时）
   - 对水库调度不利

2. **形成局地洪水**：
   - 小流域暴雨洪水主要成因
   - 短历时设计暴雨的主要类型
   - 山洪灾害的主要诱因

3. **防洪难点**：
   - 来势凶猛
   - 预警时间短
   - 城市内涝主要成因
   - **工程意义**：城市排水、山洪防治重点考虑

**对比总结**：

| 对比项 | 锋面雨 | 对流雨 |
|--------|--------|--------|
| 可预报性 | 强（1-2天） | 弱（<1小时） |
| 影响范围 | 大（流域性） | 小（局地性） |
| 设计意义 | 大江大河防洪设计 | 城市排水、山洪防治 |
| 水资源 | 主要来源 | 贡献较小 |

**踩分点**：
- ✅ 锋面雨意义（2.5分）
- ✅ 对流雨意义（2.5分）

---

### Python可视化（可选）

```python
"""
降水类型对比可视化
"""
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import FancyBboxPatch, Circle, Rectangle, Polygon

# 设置中文字体
plt.rcParams['font.sans-serif'] = ['SimHei']
plt.rcParams['axes.unicode_minus'] = False

fig = plt.figure(figsize=(16, 12))

# ===== 子图1：降水形成条件 =====
ax1 = plt.subplot(2, 3, 1)
ax1.axis('off')

conditions = ['1. 充足水汽\n(相对湿度>80%)',
              '2. 空气上升冷却\n(降至露点以下)',
              '3. 凝结核\n(尘埃、盐粒)']
y_pos = [0.8, 0.5, 0.2]
colors = ['skyblue', 'lightgreen', 'lightyellow']

for cond, y, color in zip(conditions, y_pos, colors):
    box = FancyBboxPatch((0.1, y-0.08), 0.8, 0.12, boxstyle="round,pad=0.01",
                         edgecolor='black', facecolor=color, linewidth=2)
    ax1.add_patch(box)
    ax1.text(0.5, y, cond, ha='center', va='center', fontsize=12, fontweight='bold')

ax1.set_xlim(0, 1)
ax1.set_ylim(0, 1)
ax1.set_title('降水形成三要素', fontsize=14, fontweight='bold', pad=20)

# ===== 子图2：对流雨示意图 =====
ax2 = plt.subplot(2, 3, 2)
ax2.set_xlim(0, 10)
ax2.set_ylim(0, 10)
ax2.axis('off')

# 地面受热
ground = Rectangle((0, 0), 10, 0.5, facecolor='brown', edgecolor='black')
ax2.add_patch(ground)

# 上升气流（箭头）
for x in [2, 3.5, 5, 6.5]:
    ax2.arrow(x, 0.5, 0, 3, head_width=0.3, head_length=0.3, fc='red', ec='darkred', linewidth=2)

# 云
cloud_x = [2, 2.5, 3.5, 4.5, 5, 5.5, 6.5, 7, 7.5]
cloud_y = [5, 5.5, 6, 6.5, 7, 6.5, 6, 5.5, 5]
ax2.fill(cloud_x, cloud_y, color='gray', alpha=0.6, edgecolor='black', linewidth=2)

# 降雨
for x in np.linspace(2.5, 7, 10):
    ax2.plot([x, x-0.2], [4, 1], 'b-', linewidth=2, alpha=0.7)

ax2.text(5, 8.5, '对流雨', fontsize=14, fontweight='bold', ha='center')
ax2.text(5, 0.2, '地面强烈受热', fontsize=10, ha='center', style='italic')
ax2.text(8.5, 5, '强度大\n历时短\n范围小', fontsize=9, ha='left',
         bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.8))

ax2.set_title('对流雨成因', fontsize=13, fontweight='bold')

# ===== 子图3：锋面雨示意图 =====
ax3 = plt.subplot(2, 3, 3)
ax3.set_xlim(0, 10)
ax3.set_ylim(0, 10)
ax3.axis('off')

# 地面
ground = Rectangle((0, 0), 10, 0.5, facecolor='brown', edgecolor='black')
ax3.add_patch(ground)

# 冷气团（蓝色）
cold_air = Polygon([(0, 0.5), (6, 0.5), (6, 4), (0, 1.5)],
                   facecolor='lightblue', edgecolor='blue', linewidth=2, alpha=0.6)
ax3.add_patch(cold_air)
ax3.text(2, 2, '冷气团', fontsize=12, fontweight='bold', color='blue')

# 暖气团（红色）
warm_air = Polygon([(6, 0.5), (10, 0.5), (10, 6), (6, 4)],
                   facecolor='lightcoral', edgecolor='red', linewidth=2, alpha=0.6)
ax3.add_patch(warm_air)
ax3.text(8, 3, '暖气团', fontsize=12, fontweight='bold', color='red')

# 锋面（黑色粗线）
ax3.plot([6, 6], [0.5, 4], 'k-', linewidth=4, label='锋面')

# 云和降雨
cloud_x = [5.5, 6, 6.5, 7, 7.5, 8]
cloud_y = [5, 6, 6.5, 6.5, 6, 5.5]
ax3.fill(cloud_x, cloud_y, color='gray', alpha=0.6, edgecolor='black', linewidth=2)

for x in np.linspace(5.5, 8, 8):
    ax3.plot([x, x-0.1], [4.5, 1], 'b-', linewidth=1.5, alpha=0.7)

ax3.text(5, 8.5, '锋面雨', fontsize=14, fontweight='bold', ha='center')
ax3.text(5, 0.2, '冷暖气团相遇', fontsize=10, ha='center', style='italic')
ax3.text(1, 7, '强度中等\n历时长\n范围大', fontsize=9, ha='left',
         bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.8))

ax3.set_title('锋面雨成因', fontsize=13, fontweight='bold')

# ===== 子图4：地形雨示意图 =====
ax4 = plt.subplot(2, 3, 4)
ax4.set_xlim(0, 10)
ax4.set_ylim(0, 10)
ax4.axis('off')

# 地面
ax4.plot([0, 3, 5, 7, 10], [0.5, 0.5, 6, 3, 0.5], 'brown', linewidth=3)
ax4.fill_between([0, 3, 5, 7, 10], [0, 0, 0, 0, 0],
                 [0.5, 0.5, 6, 3, 0.5], color='brown', alpha=0.5)

# 气流（箭头）
for y in np.linspace(1, 5, 5):
    ax4.arrow(0.5, y, 2, (6-0.5)*y/5, head_width=0.2, head_length=0.2,
             fc='blue', ec='darkblue', alpha=0.6, linewidth=1.5)

# 迎风坡降雨
for x in np.linspace(2, 4, 8):
    ax4.plot([x, x-0.1], [5, 2], 'b-', linewidth=2, alpha=0.7)

# 背风坡（雨影区）
ax4.text(8, 1, '雨影区\n(少雨)', fontsize=11, ha='center',
         bbox=dict(boxstyle='round', facecolor='lightyellow', alpha=0.8))

# 标注
ax4.text(2, 7, '迎风坡\n(多雨)', fontsize=11, ha='center',
         bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))
ax4.arrow(1, 3, 1, 0, head_width=0.3, head_length=0.3,
         fc='green', ec='darkgreen', linewidth=2)
ax4.text(1.5, 3.5, '盛行风', fontsize=10, ha='center', color='green', fontweight='bold')

ax4.text(5, 9, '地形雨', fontsize=14, fontweight='bold', ha='center')
ax4.set_title('地形雨成因', fontsize=13, fontweight='bold')

# ===== 子图5：降水类型对比表 =====
ax5 = plt.subplot(2, 3, 5)
ax5.axis('off')

comparison_text = """
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃   降水类型特征对比表                  ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ 对比项目 │ 对流雨 │ 锋面雨 │ 地形雨 ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ 强度     │ 大     │ 中等   │ 中等   ┃
┃ 历时     │ 短(<2h)│ 长(数天)│ 长     ┃
┃ 范围     │ 小(十km²)│ 大(千km²)│ 中等 ┃
┃ 预报性   │ 难     │ 易     │ 中等   ┃
┃ 多发季节 │ 夏季   │ 春秋   │ 全年   ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ 工程意义：                           ┃
┃ • 对流雨 → 城市排水、山洪防治        ┃
┃ • 锋面雨 → 大江大河防洪设计          ┃
┃ • 地形雨 → 区域水资源评价            ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
"""

ax5.text(0.5, 0.5, comparison_text, fontsize=11, family='monospace',
         verticalalignment='center', horizontalalignment='center')
ax5.set_title('降水类型对比', fontsize=13, fontweight='bold')

# ===== 子图6：工程水文意义对比 =====
ax6 = plt.subplot(2, 3, 6)
categories = ['可预报性', '影响范围', '洪水规模', '水资源贡献', '设计重要性']
N = len(categories)

# 锋面雨和对流雨评分（归一化0-1）
scores_frontal = [0.9, 0.9, 0.9, 0.9, 0.9]
scores_convective = [0.3, 0.3, 0.5, 0.3, 0.6]

angles = np.linspace(0, 2*np.pi, N, endpoint=False).tolist()
scores_frontal += scores_frontal[:1]
scores_convective += scores_convective[:1]
angles += angles[:1]

ax6 = plt.subplot(2, 3, 6, projection='polar')
ax6.plot(angles, scores_frontal, 'o-', linewidth=2, color='blue', label='锋面雨')
ax6.fill(angles, scores_frontal, alpha=0.25, color='blue')
ax6.plot(angles, scores_convective, 's-', linewidth=2, color='red', label='对流雨')
ax6.fill(angles, scores_convective, alpha=0.25, color='red')

ax6.set_xticks(angles[:-1])
ax6.set_xticklabels(categories, fontsize=10)
ax6.set_ylim(0, 1)
ax6.set_yticks([0.2, 0.4, 0.6, 0.8, 1.0])
ax6.set_yticklabels(['低', '较低', '中', '较高', '高'], fontsize=8)
ax6.set_title('工程水文意义对比', fontsize=13, fontweight='bold', pad=20)
ax6.legend(loc='upper right', bbox_to_anchor=(1.3, 1.1))
ax6.grid(True)

plt.tight_layout()
plt.savefig('题5_降水类型.png', dpi=300, bbox_inches='tight')
plt.show()

print("图表已保存：题5_降水类型.png")
```

---

### 本题总结

**考点**：
- 降水形成条件 ✅
- 三种降水类型及特征 ✅
- 工程水文意义对比 ✅

**易错点**：
- ❌ 降水形成条件不全（漏掉凝结核）
- ❌ 三种降水类型特征混淆
- ❌ 工程意义分析不到位

**答题技巧**：
- 画示意图辅助说明
- 列表对比更清晰
- 结合实际工程案例

---

## 本章总结

### 核心知识点
1. ✅ 水文循环：大循环、小循环
2. ✅ 水量平衡方程：P = E + R + ΔS
3. ✅ 流域特征：面积、形状、河网密度
4. ✅ 降水计算：算术平均、泰森多边形、等值线
5. ✅ 蒸发与下渗：影响因素、霍顿公式
6. ✅ 径流形成：产流（蓄满、超渗）、汇流

### 必记公式
| 公式 | 说明 | 考频 |
|------|------|------|
| P = E + R + ΔS | 水量平衡方程 | ⭐⭐⭐⭐⭐ |
| α = R / P | 径流系数 | ⭐⭐⭐⭐⭐ |
| D = ΣL / F | 河网密度 | ⭐⭐⭐⭐ |
| f = fc + (f0-fc)e^(-kt) | 霍顿下渗公式 | ⭐⭐⭐⭐⭐ |

### 典型题型
- 水量平衡计算题 ⭐⭐⭐⭐⭐
- 流域特征分析题 ⭐⭐⭐⭐
- 降水量计算题 ⭐⭐⭐⭐⭐
- 径流形成过程分析 ⭐⭐⭐⭐

### 学习建议
1. 理解水文循环的物理过程
2. 熟记水量平衡方程及其变形
3. 掌握流域特征参数计算方法
4. 练习降水量计算（多种方法）
5. 理解产流、汇流的区别

---

**本章开发进度**：33.3%（5/15题完成）✅
**下一步**：继续开发题6-15
**预计完成时间**：2025-11-14

---

*第1章开发中，敬请期待完整版！*
