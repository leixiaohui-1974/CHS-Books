# 第5章：地下水资源评价

**学习时间**: 3小时  
**考试频率**: ⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐

---

## 一、地下水资源基本概念

### 1.1 资源分类

**静储量（Static Storage）**：含水层中现存的地下水总量

$$W_s = A \cdot m \cdot \mu$$

**参数说明**：
- $W_s$：静储量（m³）
- $A$：含水层面积（m²）
- $m$：含水层平均厚度（m）
- $\mu$：给水度（无量纲）

**动储量（Dynamic Storage）**：在一定时期内可补给的地下水量

$$W_d = Q \cdot T$$

**参数说明**：
- $W_d$：动储量（m³）
- $Q$：补给量（m³/d）
- $T$：时间周期（d）

**开采储量**：允许开采的地下水量，需满足可持续利用

---

### 1.2 补给与排泄

**补给来源**：
1. 降水入渗补给
2. 地表水体补给
3. 灌溉回归补给
4. 凝结水补给
5. 越流补给（跨含水层）

**排泄方式**：
1. 泉水溢出
2. 蒸发蒸腾
3. 河川基流
4. 地下径流
5. 人工开采

---

## 二、地下水补给量计算

### 2.1 降水入渗补给

**方法1：降水入渗系数法**

$$W_{rain} = \alpha \cdot P \cdot A$$

**参数说明**：
- $W_{rain}$：降水补给量（m³）
- $\alpha$：降水入渗系数（0.1~0.3，视土壤类型）
- $P$：降水量（m）
- $A$：补给面积（m²）

**方法2：水位动态法**

$$W_{rain} = \mu \cdot \Delta h \cdot A$$

**参数说明**：
- $\mu$：给水度
- $\Delta h$：降雨后水位上升幅度（m）

---

### 2.2 地表水体补给

**河流渗漏补给**（Darcy定律）：

$$Q = K \cdot i \cdot B \cdot L$$

**参数说明**：
- $Q$：渗漏补给量（m³/d）
- $K$：河床渗透系数（m/d）
- $i$：水力坡度
- $B$：渗漏带宽度（m）
- $L$：河段长度（m）

---

### 2.3 灌溉回归补给

$$W_{irr} = \beta \cdot W_{total}$$

**参数说明**：
- $W_{irr}$：灌溉回归补给量（m³）
- $\beta$：回归系数（0.2~0.4）
- $W_{total}$：总灌溉用水量（m³）

---

## 三、地下水排泄量计算

### 3.1 蒸发排泄

**经验公式**：

$$E = E_0 \cdot \exp\left(-\alpha \frac{h}{h_{max}}\right)$$

**参数说明**：
- $E$：潜水蒸发强度（mm/d）
- $E_0$：水面蒸发强度（mm/d）
- $h$：潜水埋深（m）
- $h_{max}$：极限蒸发深度（2~3m）
- $\alpha$：经验系数（3~5）

**临界深度**：一般2~3m，超过此深度蒸发可忽略

---

### 3.2 河川基流排泄

**分割法**：
1. 绘制河流流量过程线
2. 分割地表径流与基流
3. 基流即为地下水排泄

**基流指数**：

$$BFI = \frac{Q_{base}}{Q_{total}}$$

---

### 3.3 人工开采

$$W_{pump} = \sum Q_i \cdot t_i$$

**参数说明**：
- $W_{pump}$：总开采量（m³）
- $Q_i$：第$i$井抽水流量（m³/d）
- $t_i$：第$i$井抽水时间（d）

---

## 四、地下水均衡方程

### 4.1 基本方程

$$\Delta W = W_{in} - W_{out}$$

**详细形式**：

$$\Delta W = (W_{rain} + W_{river} + W_{irr} + W_{lateral}) - (W_{evap} + W_{base} + W_{pump} + W_{out,lateral})$$

**参数说明**：
- $\Delta W$：储存量变化（m³）
- $W_{rain}$：降水补给
- $W_{river}$：地表水补给
- $W_{irr}$：灌溉回归补给
- $W_{lateral}$：侧向流入
- $W_{evap}$：蒸发排泄
- $W_{base}$：河川基流排泄
- $W_{pump}$：开采量
- $W_{out,lateral}$：侧向流出

---

### 4.2 水均衡法评价资源量

$$W_{resource} = W_{in} - W_{evap} - W_{base}$$

**可开采量**：

$$W_{exploit} = W_{resource} - W_{reserve}$$

**参数说明**：
- $W_{reserve}$：生态保护预留量

---

## 五、地下水可持续开发

### 5.1 安全开采量

**定义**：在不引起环境地质问题的前提下，允许的最大开采量

**约束条件**：
1. 水位降深≤允许值
2. 地面沉降≤允许值
3. 海水入侵风险可控
4. 生态需水量保障

### 5.2 超采与恢复

**超采判别**：

$$\text{超采率} = \frac{W_{pump} - W_{resource}}{W_{resource}} \times 100\%$$

**恢复措施**：
1. 控制开采总量
2. 人工回灌
3. 调整井位
4. 地表水替代

---

## 六、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class GroundwaterResourceEvaluation:
    """地下水资源评价"""
    
    @staticmethod
    def static_storage(A, m, mu):
        """
        静储量计算
        
        W_s = A × m × μ
        
        参数:
            A: 含水层面积 (km²)
            m: 平均厚度 (m)
            mu: 给水度
        """
        A_m2 = A * 1e6  # 转换为m²
        W_s = A_m2 * m * mu
        return W_s / 1e6  # 转换为百万m³
    
    @staticmethod
    def precipitation_recharge(alpha, P, A):
        """
        降水入渗补给
        
        W = α × P × A
        
        参数:
            alpha: 入渗系数
            P: 年降水量 (mm)
            A: 补给面积 (km²)
        """
        P_m = P / 1000  # 转换为m
        A_m2 = A * 1e6
        W = alpha * P_m * A_m2
        return W / 1e6  # 百万m³
    
    @staticmethod
    def river_seepage(K, i, B, L):
        """
        河流渗漏补给
        
        Q = K × i × B × L
        
        参数:
            K: 河床渗透系数 (m/d)
            i: 水力坡度
            B: 渗漏带宽度 (m)
            L: 河段长度 (km)
        """
        L_m = L * 1000  # 转换为m
        Q = K * i * B * L_m  # m³/d
        return Q
    
    @staticmethod
    def irrigation_return(beta, W_total):
        """
        灌溉回归补给
        
        W_irr = β × W_total
        
        参数:
            beta: 回归系数
            W_total: 总灌溉用水 (百万m³)
        """
        W_irr = beta * W_total
        return W_irr
    
    @staticmethod
    def evapotranspiration(E0, h, h_max, alpha=4):
        """
        潜水蒸发强度
        
        E = E0 × exp(-α × h/h_max)
        
        参数:
            E0: 水面蒸发强度 (mm/d)
            h: 潜水埋深 (m)
            h_max: 极限蒸发深度 (m)
            alpha: 经验系数
        """
        E = E0 * np.exp(-alpha * h / h_max)
        return E
    
    @staticmethod
    def water_balance(inputs, outputs):
        """
        水均衡计算
        
        ΔW = Σinputs - Σoutputs
        
        参数:
            inputs: 补给项字典 {'rain': xx, 'river': xx, ...}
            outputs: 排泄项字典 {'evap': xx, 'pump': xx, ...}
        """
        total_input = sum(inputs.values())
        total_output = sum(outputs.values())
        delta_W = total_input - total_output
        
        return delta_W, total_input, total_output
    
    @staticmethod
    def overdraft_rate(W_pump, W_resource):
        """
        超采率
        
        参数:
            W_pump: 开采量
            W_resource: 资源量
        """
        rate = (W_pump - W_resource) / W_resource * 100
        return rate
    
    @staticmethod
    def plot_resource_evaluation():
        """绘制地下水资源评价图"""
        fig, axes = plt.subplots(2, 2, figsize=(16, 12))
        
        # 1. 降水入渗系数对补给的影响
        ax1 = axes[0, 0]
        
        P_range = np.linspace(300, 1000, 100)  # mm
        alphas = [0.1, 0.2, 0.3]
        A = 100  # km²
        colors = ['lightblue', 'skyblue', 'steelblue']
        
        for alpha, color in zip(alphas, colors):
            W_rain = [GroundwaterResourceEvaluation.precipitation_recharge(alpha, P, A) for P in P_range]
            ax1.plot(P_range, W_rain, color=color, linewidth=2.5, label=f'α={alpha}')
        
        ax1.set_xlabel('年降水量 (mm)', fontsize=11)
        ax1.set_ylabel('降水补给量 (百万m³)', fontsize=11)
        ax1.set_title('降水入渗补给分析', fontsize=13, fontweight='bold')
        ax1.legend()
        ax1.grid(True, alpha=0.3)
        
        # 2. 蒸发强度与埋深关系
        ax2 = axes[0, 1]
        
        E0 = 5.0  # mm/d
        h_max = 3.0  # m
        h_range = np.linspace(0, 5, 100)
        
        alphas_evap = [3, 4, 5]
        colors2 = ['salmon', 'coral', 'orangered']
        
        for alpha_e, color in zip(alphas_evap, colors2):
            E_values = [GroundwaterResourceEvaluation.evapotranspiration(E0, h, h_max, alpha_e) for h in h_range]
            ax2.plot(h_range, E_values, color=color, linewidth=2.5, label=f'α={alpha_e}')
        
        ax2.axvline(h_max, color='g', linestyle='--', linewidth=2, label=f'极限深度={h_max}m')
        ax2.set_xlabel('潜水埋深 h (m)', fontsize=11)
        ax2.set_ylabel('蒸发强度 E (mm/d)', fontsize=11)
        ax2.set_title(f'潜水蒸发强度（E₀={E0}mm/d）', fontsize=13, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        
        # 3. 水均衡分析
        ax3 = axes[1, 0]
        
        components = ['降水补给', '河流补给', '灌溉回归', '蒸发排泄', '河川基流', '人工开采']
        values = [45, 15, 8, -12, -18, -35]  # 百万m³，负值表示排泄
        colors3 = ['skyblue', 'lightblue', 'cyan', 'salmon', 'coral', 'red']
        
        bars = ax3.barh(components, values, color=colors3, alpha=0.8, edgecolor='black')
        
        # 添加数值标签
        for bar, value in zip(bars, values):
            width = bar.get_width()
            ax3.text(width + (2 if width > 0 else -2), bar.get_y() + bar.get_height()/2,
                    f'{abs(value):.1f}', va='center', ha='left' if width > 0 else 'right',
                    fontsize=10, fontweight='bold')
        
        ax3.axvline(0, color='k', linewidth=1)
        ax3.set_xlabel('水量 (百万m³/年)', fontsize=11)
        ax3.set_title('地下水均衡分析', fontsize=13, fontweight='bold')
        ax3.grid(True, alpha=0.3, axis='x')
        
        # 计算净变化
        total_input = sum(v for v in values if v > 0)
        total_output = abs(sum(v for v in values if v < 0))
        delta_W = total_input - total_output
        
        ax3.text(0.05, 0.95, f'总补给: {total_input:.1f}\n总排泄: {total_output:.1f}\n净变化: {delta_W:+.1f}',
                transform=ax3.transAxes, fontsize=11, va='top',
                bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))
        
        # 4. 可开采量与超采率
        ax4 = axes[1, 1]
        
        W_resource = 50  # 百万m³/年
        W_pump_range = np.linspace(0, 100, 100)
        overdraft_rates = [(w - W_resource) / W_resource * 100 for w in W_pump_range]
        
        ax4.plot(W_pump_range, overdraft_rates, 'b-', linewidth=2.5)
        ax4.axhline(0, color='g', linestyle='--', linewidth=2, label='平衡开采')
        ax4.axhline(20, color='orange', linestyle='--', linewidth=2, label='轻度超采(20%)')
        ax4.axhline(50, color='red', linestyle='--', linewidth=2, label='严重超采(50%)')
        ax4.axvline(W_resource, color='g', linestyle=':', linewidth=1.5,
                   label=f'资源量={W_resource}')
        
        # 填充区域
        ax4.fill_between(W_pump_range, 0, overdraft_rates,
                        where=(np.array(overdraft_rates) > 0),
                        alpha=0.2, color='red', label='超采区')
        ax4.fill_between(W_pump_range, 0, overdraft_rates,
                        where=(np.array(overdraft_rates) <= 0),
                        alpha=0.2, color='green', label='安全区')
        
        ax4.set_xlabel('开采量 (百万m³/年)', fontsize=11)
        ax4.set_ylabel('超采率 (%)', fontsize=11)
        ax4.set_title(f'超采率分析（资源量={W_resource}）', fontsize=13, fontweight='bold')
        ax4.legend(loc='upper left', fontsize=9)
        ax4.grid(True, alpha=0.3)
        ax4.set_ylim([-50, 100])
        
        plt.tight_layout()
        plt.savefig('groundwater_resource_evaluation.png', dpi=300)
        plt.show()

# 示例1：静储量计算
print("="*60)
print("示例1：地下水静储量评价")
print("="*60)

gw_eval = GroundwaterResourceEvaluation()

A = 500  # km²
m = 30   # m
mu = 0.15

W_s = gw_eval.static_storage(A, m, mu)

print(f"含水层参数:")
print(f"  面积 A = {A} km²")
print(f"  平均厚度 m = {m} m")
print(f"  给水度 μ = {mu}")

print(f"\n静储量 W_s = {W_s:.1f} 百万m³")

# 示例2：补给量计算
print("\n" + "="*60)
print("示例2：年补给量评价")
print("="*60)

# 降水补给
alpha = 0.2
P = 600  # mm
A_rain = 500  # km²

W_rain = gw_eval.precipitation_recharge(alpha, P, A_rain)

print(f"1. 降水补给:")
print(f"   入渗系数 α = {alpha}")
print(f"   年降水量 P = {P} mm")
print(f"   补给面积 A = {A_rain} km²")
print(f"   补给量 = {W_rain:.2f} 百万m³/年")

# 河流渗漏补给
K = 5.0   # m/d
i = 0.002
B = 200   # m
L = 50    # km

Q_river = gw_eval.river_seepage(K, i, B, L)
W_river = Q_river * 365 / 1e6  # 转为百万m³/年

print(f"\n2. 河流渗漏补给:")
print(f"   渗透系数 K = {K} m/d")
print(f"   水力坡度 i = {i}")
print(f"   渗漏带宽度 B = {B} m")
print(f"   河段长度 L = {L} km")
print(f"   日补给量 = {Q_river:.0f} m³/d")
print(f"   年补给量 = {W_river:.2f} 百万m³/年")

# 灌溉回归补给
beta = 0.3
W_irr_total = 50  # 百万m³

W_irr = gw_eval.irrigation_return(beta, W_irr_total)

print(f"\n3. 灌溉回归补给:")
print(f"   回归系数 β = {beta}")
print(f"   总灌溉用水 = {W_irr_total} 百万m³")
print(f"   回归补给量 = {W_irr:.2f} 百万m³/年")

# 总补给
W_total_recharge = W_rain + W_river + W_irr

print(f"\n总补给量 = {W_total_recharge:.2f} 百万m³/年")

# 示例3：蒸发排泄
print("\n" + "="*60)
print("示例3：蒸发排泄计算")
print("="*60)

E0 = 6.0  # mm/d
h_max = 3.0  # m

depths = [0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 4.0]

print(f"水面蒸发强度 E₀ = {E0} mm/d")
print(f"极限蒸发深度 = {h_max} m")

print(f"\n{'埋深(m)':<10s} {'蒸发强度(mm/d)':<18s} {'占E₀比例':<12s}")
print("-" * 42)

for h in depths:
    E = gw_eval.evapotranspiration(E0, h, h_max)
    ratio = E / E0 * 100
    print(f"{h:<10.1f} {E:<18.3f} {ratio:<11.1f}%")

# 示例4：水均衡分析
print("\n" + "="*60)
print("示例4：地下水均衡分析")
print("="*60)

inputs = {
    '降水补给': W_rain,
    '河流补给': W_river,
    '灌溉回归': W_irr
}

# 排泄项（假设）
outputs = {
    '蒸发排泄': 15.0,
    '河川基流': 20.0,
    '人工开采': 45.0
}

delta_W, total_in, total_out = gw_eval.water_balance(inputs, outputs)

print(f"补给项:")
for name, value in inputs.items():
    print(f"  {name}: {value:.2f} 百万m³/年")

print(f"\n排泄项:")
for name, value in outputs.items():
    print(f"  {name}: {value:.2f} 百万m³/年")

print(f"\n均衡结果:")
print(f"  总补给: {total_in:.2f} 百万m³/年")
print(f"  总排泄: {total_out:.2f} 百万m³/年")
print(f"  储存变化: {delta_W:+.2f} 百万m³/年")

if delta_W < 0:
    print(f"  ⚠️ 警告：地下水位下降，开采量过大！")
elif delta_W > 0:
    print(f"  ✓ 地下水位上升，开采量适中")
else:
    print(f"  ✓ 补排平衡")

# 示例5：超采评价
print("\n" + "="*60)
print("示例5：超采评价")
print("="*60)

W_resource = total_in - outputs['蒸发排泄'] - outputs['河川基流']
W_pump = outputs['人工开采']

overdraft = gw_eval.overdraft_rate(W_pump, W_resource)

print(f"资源量评估:")
print(f"  总补给 = {total_in:.2f} 百万m³/年")
print(f"  自然排泄（蒸发+基流） = {outputs['蒸发排泄'] + outputs['河川基流']:.2f} 百万m³/年")
print(f"  可开采资源量 = {W_resource:.2f} 百万m³/年")

print(f"\n开采现状:")
print(f"  实际开采量 = {W_pump:.2f} 百万m³/年")
print(f"  超采率 = {overdraft:+.1f}%")

if overdraft > 50:
    print(f"  评价：严重超采！")
elif overdraft > 20:
    print(f"  评价：轻度超采")
elif overdraft > 0:
    print(f"  评价：略有超采")
else:
    print(f"  评价：开采合理")

# 绘制资源评价图
print("\n绘制地下水资源评价分析图...")
gw_eval.plot_resource_evaluation()
```

---

## 七、典型考题

### 【例题1】静储量计算（10分）

**题目**：含水层面积$A=300$km²，平均厚度$m=25$m，给水度$\mu=0.18$。求静储量。

**【解答】**

$$W_s = A \cdot m \cdot \mu = (300 \times 10^6) \times 25 \times 0.18$$

$$= 1.35 \times 10^9 \text{ m}^3 = 1350 \text{ 百万m}^3$$

---

### 【例题2】水均衡（15分）

**题目**：某区域年降水补给50百万m³，河流补给20百万m³，灌溉回归10百万m³；蒸发15百万m³，基流18百万m³，开采40百万m³。求储存变化。

**【解答】**

$$\Delta W = (50 + 20 + 10) - (15 + 18 + 40) = 80 - 73 = +7 \text{ 百万m}^3$$

储存增加7百万m³，地下水位上升。

---

**本章重点**：
- 静储量与动储量
- 补给量计算方法
- 水均衡方程
- 超采评价

**全书完成！**
