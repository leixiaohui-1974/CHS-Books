# 第1章：地下水基础理论

**学科**: 地下水动力学  
**难度**: ⭐⭐⭐⭐

---

## 一、基本概念

### 1.1 含水层分类

| 类型 | 特征 | 水头 |
|------|------|------|
| 潜水 | 上部自由水面 | 自由水面 |
| 承压水 | 上下隔水层 | 压力水头 |
| 半承压 | 弱透水层 | 渗漏补给 |

### 1.2 水力参数

**渗透系数** $K$：
$$v = K \cdot i$$

**给水度** $\mu$（潜水）：单位水平面积释水体积

**贮水系数** $S$（承压水）：单位水平面积、单位水头降释水体积

---

## 二、达西定律

### 2.1 一维形式

$$Q = -K A \frac{dh}{dl}$$

- $Q$：渗透流量
- $A$：过水断面积
- $dh/dl$：水力梯度

### 2.2 三维形式

$$\mathbf{v} = -K \nabla h$$

---

## 三、地下水流动方程

### 3.1 承压水

$$S \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}\left(T\frac{\partial h}{\partial x}\right) + \frac{\partial}{\partial y}\left(T\frac{\partial h}{\partial y}\right) + W$$

- $T = Kb$：导水系数
- $W$：源汇项

### 3.2 潜水

$$\mu \frac{\partial h}{\partial t} = \frac{\partial}{\partial x}\left(Kh\frac{\partial h}{\partial x}\right) + \frac{\partial}{\partial y}\left(Kh\frac{\partial h}{\partial y}\right) + W$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

class GroundwaterFlow:
    """地下水流动"""
    
    def __init__(self, K=10, b=20):
        """
        参数:
            K: 渗透系数 (m/d)
            b: 含水层厚度 (m)
        """
        self.K = K
        self.b = b
        self.T = K * b  # 导水系数
    
    def darcy_velocity(self, dh_dl):
        """
        达西定律
        
        v = K · i
        
        参数:
            dh_dl: 水力梯度
        """
        v = self.K * dh_dl
        return v
    
    def confined_well_flow(self, Q, r, r_w=0.1, h_w=50, r_R=500):
        """
        承压水井流（稳定流）
        
        Dupuit公式:
        h = h_w + (Q / (2πT)) · ln(r/r_w)
        
        参数:
            Q: 抽水量 (m³/d)
            r: 距井中心距离 (m)
            r_w: 井半径 (m)
            h_w: 井内水头 (m)
            r_R: 影响半径 (m)
        """
        h = h_w + (Q / (2 * np.pi * self.T)) * np.log(r / r_w)
        return h
    
    def unconfined_well_flow(self, Q, r, r_w=0.1, h_w=30, r_R=500):
        """
        潜水井流（稳定流）
        
        Dupuit公式:
        h² = h_w² + (Q / (πK)) · ln(r/r_w)
        
        参数:
            Q: 抽水量 (m³/d)
            r: 距井中心距离 (m)
        """
        h_squared = h_w**2 + (Q / (np.pi * self.K)) * np.log(r / r_w)
        h = np.sqrt(h_squared)
        return h
    
    def plot_well_drawdown(self, Q=500, well_type='confined'):
        """绘制井流降落漏斗"""
        r = np.linspace(0.1, 500, 100)
        
        if well_type == 'confined':
            h = self.confined_well_flow(Q, r)
            h0 = self.confined_well_flow(Q, r[-1])
        else:
            h = self.unconfined_well_flow(Q, r)
            h0 = self.unconfined_well_flow(Q, r[-1])
        
        # 降深
        s = h0 - h
        
        fig, axes = plt.subplots(1, 2, figsize=(14, 5))
        
        # 水头分布
        axes[0].plot(r, h, 'b-', linewidth=2)
        axes[0].axhline(h0, color='red', linestyle='--', 
                       label=f'初始水头={h0:.1f}m')
        axes[0].set_xlabel('径向距离 (m)')
        axes[0].set_ylabel('水头 (m)')
        axes[0].set_title(f'{well_type}井流水头分布')
        axes[0].legend()
        axes[0].grid(True, alpha=0.3)
        
        # 降深分布
        axes[1].plot(r, s, 'r-', linewidth=2)
        axes[1].fill_between(r, 0, s, alpha=0.3)
        axes[1].set_xlabel('径向距离 (m)')
        axes[1].set_ylabel('降深 (m)')
        axes[1].set_title('降落漏斗')
        axes[1].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('well_drawdown.png', dpi=300)
        plt.show()
        
        print(f"抽水量: {Q} m³/d")
        print(f"井中心降深: {s[0]:.2f} m")
        print(f"影响半径: {r[-1]:.1f} m")

# 示例
print("="*60)
print("地下水井流分析")
print("="*60)

# 创建地下水模型
gw = GroundwaterFlow(K=15, b=25)

print(f"水力参数:")
print(f"  渗透系数 K = {gw.K} m/d")
print(f"  含水层厚度 b = {gw.b} m")
print(f"  导水系数 T = {gw.T} m²/d")

# 达西定律
i = 0.01  # 水力梯度
v = gw.darcy_velocity(i)
print(f"\n达西定律:")
print(f"  水力梯度 i = {i}")
print(f"  渗透速度 v = {v:.4f} m/d = {v/86400*100:.2e} cm/s")

# 承压水井流
print("\n" + "="*60)
print("承压水井流")
print("="*60)
gw.plot_well_drawdown(Q=800, well_type='confined')

# 潜水井流
print("\n" + "="*60)
print("潜水井流")
print("="*60)
gw.plot_well_drawdown(Q=500, well_type='unconfined')
```

---

## 四、井流理论

### 4.1 Theis非稳定流

$$s(r,t) = \frac{Q}{4\pi T} W(u)$$

其中：
$$u = \frac{r^2 S}{4Tt}$$

$W(u)$：井函数

### 4.2 井干扰

两井间距$L$，各抽水量$Q_1, Q_2$

叠加原理：
$$s = s_1 + s_2$$

---

## 五、典型考题

### 【例题】井流计算

**题目**：承压含水层，T=500m²/d，抽水Q=1000m³/d，求距井50m处的降深

**解**：稳定流Dupuit公式
$$s = \frac{Q}{2\pi T}\ln\frac{R}{r}$$

设影响半径R=500m：
$$s = \frac{1000}{2\pi \times 500}\ln\frac{500}{50} = 0.733 \text{ m}$$

---

**本章重点**：
- 达西定律
- 井流Dupuit公式
- Theis非稳定流
