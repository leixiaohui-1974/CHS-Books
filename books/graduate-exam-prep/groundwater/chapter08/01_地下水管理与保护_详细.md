# 第8章：地下水管理与保护

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐

---

## 一、地下水资源管理

### 1.1 管理目标

**可持续利用**：
- 开采量≤补给量
- 水位维持稳定
- 水质保持良好

**多目标优化**：
- 经济效益最大化
- 环境影响最小化
- 社会公平性

### 1.2 管理模式

**(1) 总量控制**：

$$\sum_{i=1}^n Q_i \leq Q_{allow}$$

**(2) 水位控制**：

$$h \geq h_{min}$$

**(3) 水质控制**：

$$C \leq C_{std}$$

---

## 二、地下水超采与调控

### 2.1 超采判别

**超采量**：

$$\Delta W = W_{extract} - W_{recharge}$$

**超采率**：

$$\eta = \frac{W_{extract}}{W_{recharge}} \times 100\%$$

**判据**：
- 轻度超采：$1.0 < \eta < 1.2$
- 中度超采：$1.2 \leq \eta < 1.5$
- 严重超采：$\eta \geq 1.5$

### 2.2 超采影响

**(1) 水位下降**：

$$\Delta h = \frac{\Delta W}{A \cdot \mu}$$

**(2) 地面沉降**：

$$s = \sum_{i=1}^n \alpha_i \Delta h_i M_i$$

**参数**：
- $\alpha_i$：压缩系数（1/m）
- $M_i$：第$i$层厚度（m）
- $\Delta h_i$：第$i$层水位降深（m）

### 2.3 调控措施

**工程措施**：
- 人工回灌
- 雨洪利用
- 调水补源

**管理措施**：
- 取水许可
- 水位红线
- 分区管理

---

## 三、人工回灌

### 3.1 回灌方式

**(1) 地表回灌**：
- 渗水池
- 渗水沟
- 渗水井

**(2) 井回灌**：
- 注水井
- 组合井

### 3.2 回灌量计算

**渗水池**：

$$Q = K A i$$

其中$i$为渗水池水头与地下水位差除以池底至地下水位距离

**注水井**（承压含水层）：

$$Q = 2\pi K M \frac{H_w - H_0}{\ln(R/r_w)}$$

### 3.3 堵塞问题

**物理堵塞**：
- 悬浮物沉积
- 气泡滞留

**化学堵塞**：
- 碳酸盐沉淀
- 铁锰氧化

**生物堵塞**：
- 细菌繁殖
- 生物膜形成

**防治**：
- 预处理（过滤、沉淀）
- 定期反冲洗
- 化学清洗

---

## 四、地下水保护区划

### 4.1 水源地保护区

**(1) 一级保护区**：
- 范围：取水井周围一定区域
- 要求：禁止一切与取水无关活动

**范围计算**：

$$R_I = \alpha \sqrt{\frac{K M Q t}{\pi n \mu}}$$

$\alpha = 2 \sim 3$（安全系数）

**(2) 二级保护区**：

$$R_{II} = v \cdot T_{safe}$$

$T_{safe}$为污染物到达取水井的时间（通常取1000天）

**(3) 三级保护区**：
- 范围：地下水补给区
- 要求：限制污染源

### 4.2 脆弱性评价

**DRASTIC模型**：

$$V = D_w \times D_r + R_w \times R_r + A_w \times A_r + \ldots$$

**7个因子**：
- D：地下水埋深（Depth）
- R：净补给量（Recharge）
- A：含水层介质（Aquifer media）
- S：土壤类型（Soil）
- T：地形坡度（Topography）
- I：包气带介质（Impact vadose）
- C：渗透系数（Conductivity）

---

## 五、地下水经济分析

### 5.1 开采成本

**直接成本**：

$$C_{direct} = C_{energy} + C_{maintain} + C_{depreciation}$$

**提水能耗**：

$$E = \frac{\rho g Q H}{3600 \eta} \times T$$

**参数**：
- $Q$：流量（m³/h）
- $H$：扬程（m）
- $\eta$：效率
- $T$：年运行时间（h）

### 5.2 优化配置

**目标函数**：

$$\max Z = \sum_{i=1}^n (B_i - C_i) Q_i$$

**约束条件**：

$$\begin{cases}
\sum Q_i \leq Q_{total} \\
h_j \geq h_{min,j} \\
Q_i \geq 0
\end{cases}$$

---

## 六、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import linprog, minimize

class GroundwaterManagement:
    """地下水管理与保护"""
    
    def __init__(self):
        pass
    
    def overdraft_assessment(self, W_extract, W_recharge):
        """
        超采评估
        
        参数:
            W_extract: 开采量 (万m³)
            W_recharge: 补给量 (万m³)
        """
        delta_W = W_extract - W_recharge
        eta = (W_extract / W_recharge) * 100
        
        # 判别等级
        if eta <= 100:
            level = '平衡'
            color = 'green'
        elif eta <= 120:
            level = '轻度超采'
            color = 'yellow'
        elif eta <= 150:
            level = '中度超采'
            color = 'orange'
        else:
            level = '严重超采'
            color = 'red'
        
        return {
            'delta_W': delta_W,
            'overdraft_rate': eta,
            'level': level,
            'color': color
        }
    
    def land_subsidence(self, delta_h_layers, M_layers, alpha_layers):
        """
        地面沉降计算
        
        s = Σ α_i · Δh_i · M_i
        
        参数:
            delta_h_layers: 各层水位降深 (m)
            M_layers: 各层厚度 (m)
            alpha_layers: 各层压缩系数 (1/m)
        """
        s_total = np.sum(np.array(delta_h_layers) * 
                        np.array(M_layers) * 
                        np.array(alpha_layers))
        
        return s_total
    
    def recharge_basin_capacity(self, K, A, h_basin, h_gw, d):
        """
        渗水池回灌量
        
        Q = K·A·i
        i = (h_basin - h_gw) / d
        
        参数:
            K: 渗透系数 (m/d)
            A: 渗水池面积 (m²)
            h_basin: 池中水位 (m)
            h_gw: 地下水位 (m)
            d: 池底至地下水位距离 (m)
        """
        i = (h_basin - h_gw) / d
        Q = K * A * i
        
        return Q
    
    def protection_zone_radius(self, K, M, Q, t, n, mu, alpha=2):
        """
        一级保护区半径
        
        R_I = α·√[(KMQt)/(πnμ)]
        
        参数:
            K: 渗透系数 (m/d)
            M: 含水层厚度 (m)
            Q: 取水量 (m³/d)
            t: 保护时间 (d)
            n: 孔隙率
            mu: 给水度
            alpha: 安全系数
        """
        R_I = alpha * np.sqrt((K * M * Q * t) / (np.pi * n * mu))
        
        return R_I
    
    def pumping_energy_cost(self, Q, H, eta, T, price):
        """
        提水能耗与成本
        
        E = ρgQH/(3600η)·T (kWh)
        
        参数:
            Q: 流量 (m³/h)
            H: 扬程 (m)
            eta: 效率
            T: 年运行时间 (h)
            price: 电价 (元/kWh)
        """
        rho = 1000  # kg/m³
        g = 9.81    # m/s²
        
        # 功率 (kW)
        P = (rho * g * Q * H) / (3600 * eta)
        
        # 年能耗 (kWh)
        E_annual = P * T
        
        # 年成本 (元)
        C_annual = E_annual * price
        
        return {
            'power': P,
            'energy_annual': E_annual,
            'cost_annual': C_annual
        }
    
    def optimal_allocation(self, demand, K_wells, costs, h_min):
        """
        地下水优化配置
        
        最小化总成本，满足需求和水位约束
        
        参数:
            demand: 总需求 (m³/d)
            K_wells: 各井导水系数列表
            costs: 各井开采成本列表 (元/m³)
            h_min: 最小水位约束
        """
        n_wells = len(K_wells)
        
        # 目标：最小化总成本
        c = np.array(costs)
        
        # 约束：满足需求
        A_eq = np.ones((1, n_wells))
        b_eq = np.array([demand])
        
        # 约束：各井最大开采量（简化）
        bounds = [(0, K_wells[i] * 100) for i in range(n_wells)]
        
        # 求解
        result = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds,
                        method='highs')
        
        if result.success:
            Q_opt = result.x
            cost_total = result.fun
            
            return {
                'Q_optimal': Q_opt,
                'cost_total': cost_total,
                'success': True
            }
        else:
            return {'success': False}
    
    def plot_management_analysis(self):
        """绘制地下水管理分析图"""
        fig, axes = plt.subplots(2, 2, figsize=(16, 12))
        
        # 1. 超采评估
        ax1 = axes[0, 0]
        
        years = np.arange(2000, 2021)
        W_recharge_base = 1000  # 万m³
        
        # 模拟开采量逐年增加
        W_extract_values = W_recharge_base * (1 + 0.03 * np.arange(len(years)))
        W_recharge_values = W_recharge_base * np.ones(len(years))
        
        eta_values = (W_extract_values / W_recharge_values) * 100
        
        # 绘制
        ax1.plot(years, W_extract_values, 'r-', linewidth=2.5,
                marker='o', markersize=6, label='开采量')
        ax1.plot(years, W_recharge_values, 'b--', linewidth=2.5,
                label='补给量')
        
        # 超采区域
        ax1.fill_between(years, W_recharge_values, W_extract_values,
                        where=W_extract_values > W_recharge_values,
                        alpha=0.3, color='red', label='超采量')
        
        # 辅助轴（超采率）
        ax1_twin = ax1.twinx()
        ax1_twin.plot(years, eta_values, 'g-', linewidth=2,
                     marker='s', markersize=5, label='超采率')
        ax1_twin.axhline(100, color='gray', linestyle=':', linewidth=1.5)
        ax1_twin.axhline(120, color='orange', linestyle=':', linewidth=1.5)
        ax1_twin.axhline(150, color='red', linestyle=':', linewidth=1.5)
        
        ax1.set_xlabel('年份', fontsize=11)
        ax1.set_ylabel('水量 (万m³)', fontsize=11)
        ax1_twin.set_ylabel('超采率 (%)', fontsize=11, color='green')
        ax1.set_title('地下水超采趋势分析', fontsize=13, fontweight='bold')
        
        # 合并图例
        lines1, labels1 = ax1.get_legend_handles_labels()
        lines2, labels2 = ax1_twin.get_legend_handles_labels()
        ax1.legend(lines1 + lines2, labels1 + labels2, loc='upper left')
        ax1.grid(True, alpha=0.3)
        
        # 2. 保护区范围
        ax2 = axes[0, 1]
        
        # 中心取水井
        ax2.plot(0, 0, 'r*', markersize=20, label='取水井', zorder=5)
        
        # 一级保护区
        K_prot = 20  # m/d
        M_prot = 30  # m
        Q_prot = 500  # m³/d
        t_prot = 100  # d
        n_prot = 0.25
        mu_prot = 0.15
        
        R_I = self.protection_zone_radius(K_prot, M_prot, Q_prot,
                                         t_prot, n_prot, mu_prot, alpha=2)
        
        circle_I = plt.Circle((0, 0), R_I, color='red', alpha=0.3,
                             label=f'一级保护区(R={R_I:.0f}m)')
        ax2.add_patch(circle_I)
        
        # 二级保护区
        v = K_prot * 0.002  # 实际流速
        T_safe = 1000  # d
        R_II = v * T_safe
        
        circle_II = plt.Circle((0, 0), R_II, color='orange', alpha=0.2,
                              label=f'二级保护区(R={R_II:.0f}m)')
        ax2.add_patch(circle_II)
        
        # 地下水流向
        ax2.arrow(-R_II, 0, R_II * 0.8, 0, head_width=R_II*0.1,
                 head_length=R_II*0.15, fc='blue', ec='blue',
                 linewidth=2, alpha=0.7, label='地下水流向')
        
        ax2.set_xlim([-R_II*1.2, R_II*1.2])
        ax2.set_ylim([-R_II*1.2, R_II*1.2])
        ax2.set_xlabel('x (m)', fontsize=11)
        ax2.set_ylabel('y (m)', fontsize=11)
        ax2.set_title('水源地保护区划分', fontsize=13, fontweight='bold')
        ax2.legend(loc='upper right')
        ax2.grid(True, alpha=0.3)
        ax2.axis('equal')
        
        # 3. 提水成本分析
        ax3 = axes[1, 0]
        
        H_range = np.linspace(10, 100, 100)
        Q_cost = 100  # m³/h
        eta_pump = 0.7
        T_annual = 3000  # h/yr
        price_elec = 0.6  # 元/kWh
        
        costs = []
        for H in H_range:
            result_cost = self.pumping_energy_cost(Q_cost, H, eta_pump,
                                                   T_annual, price_elec)
            costs.append(result_cost['cost_annual'] / 1000)  # 千元
        
        ax3.plot(H_range, costs, 'b-', linewidth=2.5)
        
        # 标注典型扬程
        H_typical = [20, 50, 80]
        colors_h = ['green', 'orange', 'red']
        
        for H, color in zip(H_typical, colors_h):
            result = self.pumping_energy_cost(Q_cost, H, eta_pump,
                                             T_annual, price_elec)
            cost = result['cost_annual'] / 1000
            
            ax3.plot(H, cost, 'o', color=color, markersize=12)
            ax3.text(H, cost * 1.1, f'H={H}m\n{cost:.1f}千元/年',
                    ha='center', fontsize=9,
                    bbox=dict(boxstyle='round', facecolor=color, alpha=0.3))
        
        ax3.set_xlabel('扬程 H (m)', fontsize=11)
        ax3.set_ylabel('年运行成本 (千元)', fontsize=11)
        ax3.set_title(f'提水成本分析\nQ={Q_cost}m³/h, 电价={price_elec}元/kWh',
                     fontsize=13, fontweight='bold')
        ax3.grid(True, alpha=0.3)
        
        # 4. 优化配置
        ax4 = axes[1, 1]
        
        # 3口井的开采方案对比
        scenarios = {
            '均匀开采': [100, 100, 100],
            '优先1号井': [150, 100, 50],
            '优先2号井': [50, 150, 100],
            '优化配置': [120, 110, 70]
        }
        
        costs_scenario = [0.8, 0.9, 1.0]  # 元/m³
        
        scenario_names = list(scenarios.keys())
        x_pos = np.arange(len(scenario_names))
        
        # 计算总成本
        total_costs = []
        for name in scenario_names:
            Q_values = scenarios[name]
            total_cost = sum(Q * c for Q, c in zip(Q_values, costs_scenario))
            total_costs.append(total_cost)
        
        bars = ax4.bar(x_pos, total_costs, alpha=0.7,
                      color=['blue', 'orange', 'green', 'red'],
                      edgecolor='black', linewidth=2)
        
        # 标注数值
        for i, (bar, cost) in enumerate(zip(bars, total_costs)):
            height = bar.get_height()
            ax4.text(bar.get_x() + bar.get_width()/2, height * 1.02,
                    f'{cost:.0f}元',
                    ha='center', va='bottom', fontsize=10, fontweight='bold')
        
        ax4.set_xticks(x_pos)
        ax4.set_xticklabels(scenario_names, rotation=15, ha='right')
        ax4.set_ylabel('日总成本 (元/d)', fontsize=11)
        ax4.set_title('不同配置方案成本对比\n总需求300m³/d',
                     fontsize=13, fontweight='bold')
        ax4.grid(True, alpha=0.3, axis='y')
        
        plt.tight_layout()
        plt.savefig('groundwater_management.png', dpi=300)
        plt.show()

# 示例计算
print("="*60)
print("地下水管理与保护")
print("="*60)

gm = GroundwaterManagement()

# 1. 超采评估
print("1. 地下水超采评估:")

W_extract = 1200  # 万m³
W_recharge = 1000  # 万m³

result_od = gm.overdraft_assessment(W_extract, W_recharge)

print(f"  开采量 = {W_extract} 万m³")
print(f"  补给量 = {W_recharge} 万m³")
print(f"  超采量 = {result_od['delta_W']} 万m³")
print(f"  超采率 = {result_od['overdraft_rate']:.1f}%")
print(f"  评级: {result_od['level']}")

# 2. 地面沉降
print("\n" + "="*60)
print("2. 地面沉降预测:")

layers = [
    {'name': '第一含水层', 'delta_h': 5, 'M': 20, 'alpha': 0.0001},
    {'name': '弱透水层', 'delta_h': 8, 'M': 15, 'alpha': 0.0005},
    {'name': '第二含水层', 'delta_h': 10, 'M': 30, 'alpha': 0.0002}
]

delta_h_list = [layer['delta_h'] for layer in layers]
M_list = [layer['M'] for layer in layers]
alpha_list = [layer['alpha'] for layer in layers]

s_total = gm.land_subsidence(delta_h_list, M_list, alpha_list)

print(f"  分层计算:")
for layer in layers:
    s_layer = layer['delta_h'] * layer['M'] * layer['alpha']
    print(f"    {layer['name']}: Δh={layer['delta_h']}m, M={layer['M']}m, "
          f"α={layer['alpha']}, s={s_layer*1000:.1f}mm")

print(f"\n  总沉降量 s = {s_total*1000:.1f} mm = {s_total*100:.2f} cm")

# 3. 人工回灌
print("\n" + "="*60)
print("3. 渗水池回灌能力:")

K_basin = 5  # m/d
A_basin = 200  # m²
h_basin = 2  # m（池中水深）
h_gw = -5  # m（地下水位，相对池底）
d_basin = 5  # m（池底至地下水位）

Q_recharge = gm.recharge_basin_capacity(K_basin, A_basin, h_basin, 0, d_basin)

print(f"  渗透系数 K = {K_basin} m/d")
print(f"  池面积 A = {A_basin} m²")
print(f"  池中水深 = {h_basin} m")
print(f"  池底至地下水位距离 = {d_basin} m")
print(f"  水力坡度 i = {h_basin/d_basin:.2f}")
print(f"\n  回灌量 Q = {Q_recharge:.1f} m³/d")
print(f"  年回灌量 = {Q_recharge*365/10000:.2f} 万m³/年")

# 4. 保护区划定
print("\n" + "="*60)
print("4. 水源地保护区划定:")

K_zone = 25  # m/d
M_zone = 40  # m
Q_zone = 800  # m³/d
t_zone = 100  # d
n_zone = 0.3
mu_zone = 0.2

R_I_zone = gm.protection_zone_radius(K_zone, M_zone, Q_zone,
                                    t_zone, n_zone, mu_zone, alpha=2)

print(f"  取水量 Q = {Q_zone} m³/d")
print(f"  含水层参数: K={K_zone}m/d, M={M_zone}m")
print(f"  水文地质参数: n={n_zone}, μ={mu_zone}")
print(f"\n  一级保护区半径 R_I = {R_I_zone:.1f} m")
print(f"  一级保护区面积 A_I = {np.pi * R_I_zone**2 / 10000:.2f} ha")

# 二级保护区
v_zone = K_zone * 0.002  # 实际流速估算
T_safe = 1000  # d
R_II_zone = v_zone * T_safe

print(f"\n  二级保护区半径 R_II = {R_II_zone:.1f} m")
print(f"  二级保护区面积 A_II = {np.pi * R_II_zone**2 / 10000:.2f} ha")

# 5. 提水成本
print("\n" + "="*60)
print("5. 提水能耗与成本分析:")

Q_pump = 80  # m³/h
H_pump = 60  # m
eta_pump = 0.75
T_hours = 4000  # h/yr
price = 0.55  # 元/kWh

result_energy = gm.pumping_energy_cost(Q_pump, H_pump, eta_pump,
                                      T_hours, price)

print(f"  流量 Q = {Q_pump} m³/h")
print(f"  扬程 H = {H_pump} m")
print(f"  效率 η = {eta_pump}")
print(f"  年运行时间 = {T_hours} h")
print(f"  电价 = {price} 元/kWh")
print(f"\n  计算结果:")
print(f"    功率 P = {result_energy['power']:.2f} kW")
print(f"    年能耗 E = {result_energy['energy_annual']:.0f} kWh")
print(f"    年成本 C = {result_energy['cost_annual']:.0f} 元")
print(f"    单位成本 = {result_energy['cost_annual']/(Q_pump*T_hours):.3f} 元/m³")

# 6. 优化配置
print("\n" + "="*60)
print("6. 地下水优化配置:")

demand_total = 300  # m³/d
K_wells_list = [30, 25, 20]  # m/d
costs_list = [0.8, 0.9, 1.0]  # 元/m³
h_min_const = 10  # m

result_opt = gm.optimal_allocation(demand_total, K_wells_list,
                                  costs_list, h_min_const)

if result_opt['success']:
    print(f"  总需求 = {demand_total} m³/d")
    print(f"  井数 = {len(K_wells_list)}")
    print(f"\n  优化配置方案:")
    
    for i, (Q, K, c) in enumerate(zip(result_opt['Q_optimal'],
                                      K_wells_list, costs_list)):
        print(f"    {i+1}号井: Q={Q:.1f}m³/d, K={K}m/d, 成本={c}元/m³")
    
    print(f"\n  总成本 = {result_opt['cost_total']:.2f} 元/d")
    print(f"  平均成本 = {result_opt['cost_total']/demand_total:.3f} 元/m³")
else:
    print("  优化求解失败")

# 绘图
print("\n绘制地下水管理分析图...")
gm.plot_management_analysis()
```

---

## 七、典型考题

### 【例题1】超采评估（10分）

**题目**：某地区年开采量1500万m³，年补给量1200万m³。评估超采状况。

**【解答】**

$$\Delta W = 1500 - 1200 = 300 \text{ 万m}^3$$

$$\eta = \frac{1500}{1200} \times 100\% = 125\%$$

$120\% < \eta < 150\%$

**结论**：中度超采

---

**本章重点**：
- 超采评估与调控
- 人工回灌技术
- 保护区划定
- 优化配置

**全书完成！**
