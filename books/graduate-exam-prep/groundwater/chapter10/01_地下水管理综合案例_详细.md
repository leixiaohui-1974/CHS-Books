# 第10章：地下水管理综合案例

**学习时间**: 6小时  
**考试频率**: ⭐⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、地下水资源评价与规划

### 1.1 资源评价方法

**地下水资源量**：
$$W = W_{static} + W_{dynamic}$$

**静储量**：
$$W_{static} = A \cdot H \cdot \mu$$

其中：
- $A$：含水层面积（km²）
- $H$：饱和厚度（m）
- $\mu$：给水度

**动储量**（年补给量）：
$$W_{dynamic} = W_{precip} + W_{surface} + W_{lateral} - W_{evap} - W_{outflow}$$

**可开采量**：
$$W_{exploit} = \alpha \cdot W_{dynamic}$$

开采系数$\alpha = 0.6 \sim 0.9$

**例题1**：某潜水含水层，面积$A = 500$ km²，平均饱和厚度$H = 20$ m，给水度$\mu = 0.15$。
年降水入渗补给$W_{precip} = 5000$万m³，河流侧向补给$W_{lateral} = 2000$万m³，
蒸发排泄$W_{evap} = 1500$万m³。
求静储量、动储量和可开采量（$\alpha = 0.8$）。

**解**：

静储量：
$$W_{static} = 500 \times 10^6 \times 20 \times 0.15 = 1.5 \times 10^9 \text{ m}^3 = 15\text{亿m}^3$$

动储量：
$$W_{dynamic} = 5000 + 2000 - 1500 = 5500 \text{ 万m}^3/\text{年}$$

可开采量：
$$W_{exploit} = 0.8 \times 5500 = 4400 \text{ 万m}^3/\text{年}$$

---

### 1.2 水量平衡分析

**平衡方程**：
$$\Delta V = Q_{in} - Q_{out} - Q_{exploit}$$

**超采判别**：
$$\begin{cases}
Q_{exploit} \leq W_{exploit} & \text{合理开采} \\
Q_{exploit} > W_{exploit} & \text{超采}
\end{cases}$$

**超采后果**：
- 水位持续下降
- 地面沉降
- 海水入侵（滨海地区）
- 泉水断流、河流断流

---

## 二、案例1：超采区地下水恢复

### 2.1 问题背景

**区域**：华北某平原，面积$1000$ km²

**超采状况**：
- 开采量：$Q_{exploit} = 2.0$亿m³/年
- 可开采量：$W_{exploit} = 1.2$亿m³/年
- 超采量：$\Delta Q = 0.8$亿m³/年
- 水位年均下降：$\Delta h = 1.5$ m/年
- 已形成降落漏斗，面积$200$ km²

### 2.2 恢复方案

**措施组合**：

1. **压采**：
   - 限制农业灌溉井
   - 工业用水转地表水
   - 目标：压采至$1.5$亿m³/年

2. **回灌**：
   - 雨洪水回灌
   - 再生水回灌
   - 回灌量：$0.3$亿m³/年

3. **生态补水**：
   - 河道生态补水
   - 引黄河水0.5亿m³/年

**水量平衡**：

调整后：
$$Q_{in} = 1.2 \text{（天然补给）} + 0.3 \text{（回灌）} + 0.5 \text{（生态补水）} = 2.0 \text{ 亿m}^3/\text{年}$$
$$Q_{out} = 1.5 \text{（开采）} + 0.3 \text{（蒸发）} = 1.8 \text{ 亿m}^3/\text{年}$$

净补给：$\Delta V = 2.0 - 1.8 = 0.2$ 亿m³/年 > 0 ✓

**水位恢复预测**：

假设漏斗区给水度$\mu = 0.1$，面积$A = 200$ km²：
$$\Delta h = \frac{\Delta V}{A \cdot \mu} = \frac{0.2 \times 10^8}{200 \times 10^6 \times 0.1} = 1.0 \text{ m/年}$$

**恢复时长**：
累计降深$H_{deficit} = 30$ m（30年超采）
$$T_{recovery} = \frac{H_{deficit}}{\Delta h} = \frac{30}{1.0} = 30 \text{ 年}$$

---

### 2.3 数值模拟

**模型设置**：
- 网格：$100 \times 100$，步长$1$ km
- 含水层：潜水+承压两层
- 边界：西北侧定水头（山前补给），其余隔水

**参数**：
- 潜水层：$K_1 = 20$ m/d，$\mu_1 = 0.15$，厚度$50$ m
- 承压层：$K_2 = 10$ m/d，$S_2 = 0.001$，厚度$30$ m
- 越流系数：$K' / m' = 0.01$ d⁻¹

**情景模拟**：
1. **基准情景**：维持现状，$Q = 2.0$亿m³/年
2. **压采情景**：压至$1.5$亿m³/年
3. **压采+回灌**：压采+回灌$0.3$亿m³/年
4. **综合方案**：压采+回灌+生态补水

**结果对比**（10年后漏斗中心水位）：

| 情景 | 水位 (m) | 相对现状 (m) |
|------|---------|-------------|
| 基准 | -45 | -15 |
| 压采 | -38 | -8 |
| 压采+回灌 | -32 | -2 |
| 综合方案 | -25 | +5 |

---

## 三、案例2：海水入侵防治

### 3.1 问题背景

**区域**：滨海城市，承压含水层开采

**入侵状况**：
- 淡咸水界面已内移$5$ km
- 沿海水井氯离子浓度$>1000$ mg/L（淡水标准$<250$ mg/L）
- 影响面积$50$ km²

### 3.2 Ghyben-Herzberg关系

**原理**：
淡水与海水密度差导致界面倾斜

**关系式**：
$$z = \frac{\rho_f}{\rho_s - \rho_f} \cdot h = \frac{1.000}{1.025 - 1.000} \cdot h = 40h$$

其中：
- $z$：界面深度（海平面下）
- $h$：淡水水头（海平面上）
- $\rho_f = 1.000$ g/cm³（淡水）
- $\rho_s = 1.025$ g/cm³（海水）

**例题2**：滨海承压含水层，水头$h = 2.5$ m（高于海平面）。
求淡咸水界面深度。

**解**：
$$z = 40 \times 2.5 = 100 \text{ m}$$

界面在海平面下100 m

**临界水头**（防止入侵）：
若井底在海平面下$80$ m，要求界面不上升至井底：
$$h \geq \frac{z}{40} = \frac{80}{40} = 2.0 \text{ m}$$

---

### 3.3 防治措施

**1. 控制开采**：

**最大允许降深**：
$$s_{max} = h_0 - h_{crit} = 2.5 - 2.0 = 0.5 \text{ m}$$

**单井最大流量**（Dupuit公式）：
$$Q_{max} = \frac{\pi K (2h_0 s_{max} - s_{max}^2)}{\ln(R/r_w)}$$

取$K = 20$ m/d，$h_0 = 50$ m，$s_{max} = 0.5$ m，$R = 1000$ m，$r_w = 0.2$ m：
$$Q_{max} = \frac{\pi \times 20 \times (2 \times 50 \times 0.5 - 0.5^2)}{\ln(1000/0.2)} = \frac{62.8 \times 49.75}{8.52} = 367 \text{ m}^3/\text{d}$$

**2. 淡水屏障**：

在海岸带布设回灌井，形成淡水屏障

**回灌井间距**：
$$L = \sqrt{\frac{Q_{inject} \cdot R}{\pi K (h_{barrier} - h_{coast})}}$$

**3. 抽咸补淡**：

在界面前沿抽取咸水，减轻淡水开采压力

---

### 3.4 数值模拟（密度流）

**控制方程**：
$$\nabla \cdot (K \nabla h) = S_s \frac{\partial h}{\partial t} + \frac{\rho_s - \rho_f}{\rho_f} \nabla \cdot (K \nabla z)$$

**溶质运移**：
$$\frac{\partial C}{\partial t} = D_L \frac{\partial^2 C}{\partial x^2} - v \frac{\partial C}{\partial x}$$

**界面追踪**：
用等浓度线$C = 10000$ mg/L（半咸水）表征界面

**模拟结果**（10年预测）：

| 方案 | 界面后退 (km) | 影响面积 (km²) |
|------|--------------|---------------|
| 无措施 | -3（继续内移） | 80 |
| 控采 | +0.5 | 45 |
| 淡水屏障 | +2.0 | 30 |
| 综合方案 | +4.5 | 20 |

---

## 四、案例3：地下水污染修复

### 4.1 问题背景

**污染源**：化工厂泄漏，渗入潜水含水层

**污染物**：苯（BTEX），浓度$C_0 = 500$ μg/L（超标50倍）

**污染羽**：长$300$ m，宽$100$ m，深$10$ m

**目标**：10年内降至标准$10$ μg/L

### 4.2 修复技术对比

**1. 抽出-处理（Pump and Treat）**

**原理**：抽取污染地下水，地面处理后排放或回灌

**设计**：
- 抽水井：3口，间距$100$ m
- 单井流量：$Q = 200$ m³/d
- 总抽水量：$600$ m³/d

**水力控制**：
保证捕获区覆盖污染羽

**捕获宽度**（双井）：
$$W = \frac{Q}{\sqrt{2\pi K b i}}$$

取$K = 10$ m/d，$b = 10$ m，$i = 0.001$：
$$W = \frac{600}{\sqrt{2\pi \times 10 \times 10 \times 0.001}} = 239 \text{ m}$$

$W > 100$ m ✓（可覆盖）

**修复时长**：

污染水体积：$V_{污} = 300 \times 100 \times 10 = 3 \times 10^5$ m³

孔隙体积：$V_{孔} = V_{污} \times n = 3 \times 10^5 \times 0.3 = 9 \times 10^4$ m³

理论冲洗倍数（达标）：
$$N = \frac{\ln(C_0 / C_{target})}{\ln(1 + 1/R_d)}$$

取$R_d = 5$（阻滞因子）：
$$N = \frac{\ln(500/10)}{\ln(1.2)} = \frac{3.91}{0.182} = 21.5$$

冲洗体积：$V_{flush} = 21.5 \times 9 \times 10^4 = 1.94 \times 10^6$ m³

修复时间：$T = \frac{1.94 \times 10^6}{600} = 3230$ 天 $\approx 9$ 年

---

**2. 渗透反应墙（PRB）**

**原理**：设置反应介质墙体（如零价铁），污染物流经时降解

**设计**：
- 墙体厚度：$t = 1$ m
- 长度：$L = 100$ m
- 深度：$d = 10$ m
- 填料：零价铁+砂

**反应速率**（一级动力学）：
$$C = C_0 e^{-k \cdot t_{residence}}$$

停留时间：$t_{residence} = \frac{t \cdot n}{v}$

渗透速度：$v = K \cdot i = 10 \times 0.001 = 0.01$ m/d

$$t_{residence} = \frac{1 \times 0.3}{0.01} = 30 \text{ d}$$

反应速率常数$k = 0.15$ d⁻¹（苯-零价铁）：
$$C = 500 \times e^{-0.15 \times 30} = 500 \times e^{-4.5} = 5.6 \text{ μg/L}$$

$C < 10$ μg/L ✓

**优势**：被动修复，长期有效（10-20年）

---

**3. 生物修复（原位）**

**原理**：注入电子受体（如氧气）或营养物质，激活土著微生物降解

**设计**：
- 注入井：5口
- 注入溶液：过氧化氢+营养盐
- 注入速率：$50$ m³/d

**降解速率**（Monod模型）：
$$\frac{dC}{dt} = -\frac{\mu_{max} X C}{K_s + C}$$

**半衰期**（一级近似）：
$$t_{1/2} = \frac{\ln 2}{k} = \frac{0.693}{0.05} = 13.9 \text{ d}$$

（$k = 0.05$ d⁻¹，好氧条件）

衰减至10 μg/L：
$$t = \frac{\ln(C_0 / C_f)}{k} = \frac{\ln(500/10)}{0.05} = 78 \text{ d}$$

**实际修复**：需多轮注入，总时长$2-3$年

---

### 4.3 修复方案对比

| 方案 | 修复时间 | 投资 | 运行成本 | 适用性 |
|------|---------|------|---------|--------|
| 抽出-处理 | 9年 | 中 | 高（电费、处理） | 大面积 |
| PRB | 10年 | 高 | 低（被动） | 窄污染羽 |
| 生物修复 | 2-3年 | 低 | 中 | 可生物降解 |

**推荐**：生物修复（快速、经济）+ PRB（长期保障）

---

## 五、案例4：地下水优化配置

### 5.1 问题背景

**区域**：干旱区，水资源短缺

**水源**：
- 地表水：$W_s = 5000$万m³/年，成本$1.5$元/m³
- 地下水：可开采$W_g = 3000$万m³/年，成本$2.0$元/m³
- 再生水：$W_r = 2000$万m³/年，成本$2.5$元/m³

**需求**：
- 生活用水：$D_1 = 2000$万m³/年（水质要求高）
- 工业用水：$D_2 = 4000$万m³/年
- 农业灌溉：$D_3 = 3000$万m³/年（水质要求低）

### 5.2 优化模型

**目标函数**（最小成本）：
$$\min Z = 1.5(x_{s1} + x_{s2} + x_{s3}) + 2.0(x_{g1} + x_{g2} + x_{g3}) + 2.5(x_{r1} + x_{r2} + x_{r3})$$

**约束条件**：

1. **需水满足**：
   $$x_{s1} + x_{g1} + x_{r1} \geq D_1$$
   $$x_{s2} + x_{g2} + x_{r2} \geq D_2$$
   $$x_{s3} + x_{g3} + x_{r3} \geq D_3$$

2. **水源限制**：
   $$x_{s1} + x_{s2} + x_{s3} \leq W_s$$
   $$x_{g1} + x_{g2} + x_{g3} \leq W_g$$
   $$x_{r1} + x_{r2} + x_{r3} \leq W_r$$

3. **水质约束**：
   - 生活用水：仅地表水和地下水
   - 农业灌溉：可用再生水

**线性规划求解**：

使用单纯形法或内点法

**优化结果**：

| 用水部门 | 地表水 | 地下水 | 再生水 | 总量 |
|---------|-------|-------|-------|------|
| 生活 | 2000 | 0 | 0 | 2000 |
| 工业 | 3000 | 1000 | 0 | 4000 |
| 农业 | 0 | 2000 | 1000 | 3000 |
| **合计** | **5000** | **3000** | **1000** | **9000** |

**总成本**：
$$Z = 1.5 \times 5000 + 2.0 \times 3000 + 2.5 \times 1000 = 16000 \text{ 万元/年}$$

---

## 六、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import linprog

class GroundwaterManagement:
    """地下水管理综合工具"""
    
    @staticmethod
    def resource_evaluation(A, H, mu, W_recharge, W_evap, alpha=0.8):
        """
        地下水资源评价
        
        参数:
            A: 含水层面积 (km²)
            H: 饱和厚度 (m)
            mu: 给水度
            W_recharge: 年补给量 (万m³)
            W_evap: 年蒸发量 (万m³)
            alpha: 开采系数
        
        返回:
            W_static: 静储量 (万m³)
            W_dynamic: 动储量 (万m³/年)
            W_exploit: 可开采量 (万m³/年)
        """
        W_static = A * 1e6 * H * mu / 1e4  # 转为万m³
        W_dynamic = W_recharge - W_evap
        W_exploit = alpha * W_dynamic
        
        return W_static, W_dynamic, W_exploit
    
    @staticmethod
    def seawater_intrusion_interface(h, rho_f=1.000, rho_s=1.025):
        """
        Ghyben-Herzberg关系计算淡咸水界面
        
        参数:
            h: 淡水水头（海平面上） (m)
            rho_f: 淡水密度 (g/cm³)
            rho_s: 海水密度 (g/cm³)
        
        返回:
            z: 界面深度（海平面下） (m)
        """
        z = rho_f / (rho_s - rho_f) * h
        return z
    
    @staticmethod
    def pump_and_treat_duration(V_contam, n, C0, C_target, Q_pump, R_d=1):
        """
        抽出-处理修复时长估算
        
        参数:
            V_contam: 污染体积 (m³)
            n: 孔隙度
            C0: 初始浓度 (μg/L)
            C_target: 目标浓度 (μg/L)
            Q_pump: 抽水流量 (m³/d)
            R_d: 阻滞因子
        
        返回:
            T: 修复时长 (年)
        """
        V_pore = V_contam * n
        
        # 冲洗倍数
        N = np.log(C0 / C_target) / np.log(1 + 1/R_d)
        
        V_flush = N * V_pore
        
        T_days = V_flush / Q_pump
        T_years = T_days / 365
        
        return T_years
    
    @staticmethod
    def water_allocation_optimization(W_sources, D_demands, C_costs):
        """
        地下水优化配置（线性规划）
        
        参数:
            W_sources: 水源量列表 [地表水, 地下水, 再生水] (万m³)
            D_demands: 需求列表 [生活, 工业, 农业] (万m³)
            C_costs: 成本列表 [地表水, 地下水, 再生水] (元/m³)
        
        返回:
            x_opt: 最优分配矩阵 (3×3)
            total_cost: 总成本 (万元)
        """
        # 决策变量：x[i,j] = 水源i分配给部门j的量
        # 展开为9维向量：[x00, x01, x02, x10, x11, x12, x20, x21, x22]
        
        # 目标函数系数（成本）
        c = []
        for i in range(3):
            for j in range(3):
                c.append(C_costs[i])
        c = np.array(c)
        
        # 不等式约束 A_ub * x <= b_ub
        A_ub = []
        b_ub = []
        
        # 水源限制
        for i in range(3):
            row = np.zeros(9)
            row[i*3:(i+1)*3] = 1
            A_ub.append(row)
            b_ub.append(W_sources[i])
        
        A_ub = np.array(A_ub)
        b_ub = np.array(b_ub)
        
        # 等式约束 A_eq * x = b_eq（需求满足）
        A_eq = []
        b_eq = []
        
        for j in range(3):
            row = np.zeros(9)
            row[j::3] = 1  # x[0,j], x[1,j], x[2,j]
            A_eq.append(row)
            b_eq.append(D_demands[j])
        
        A_eq = np.array(A_eq)
        b_eq = np.array(b_eq)
        
        # 变量边界（非负）
        bounds = [(0, None) for _ in range(9)]
        
        # 水质约束：生活用水不用再生水（x[2,0] = 0）
        bounds[6] = (0, 0)
        
        # 求解
        result = linprog(c, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq,
                        bounds=bounds, method='highs')
        
        if result.success:
            x_opt = result.x.reshape(3, 3)
            total_cost = result.fun
        else:
            x_opt = None
            total_cost = None
        
        return x_opt, total_cost
    
    @staticmethod
    def plot_management_cases():
        """可视化地下水管理案例"""
        fig = plt.figure(figsize=(16, 10))
        
        # 1. 资源评价
        ax1 = plt.subplot(2, 3, 1)
        
        categories = ['静储量', '动储量\n(年)', '可开采量\n(年)']
        values = [150000, 5500, 4400]  # 万m³
        colors = ['lightblue', 'lightgreen', 'lightcoral']
        
        bars = ax1.bar(categories, values, color=colors, edgecolor='black', width=0.6)
        
        for bar, val in zip(bars, values):
            height = bar.get_height()
            ax1.text(bar.get_x() + bar.get_width()/2, height + 2000,
                    f'{val:.0f}', ha='center', va='bottom', fontsize=10, fontweight='bold')
        
        ax1.set_ylabel('水量 (万m³)', fontsize=11)
        ax1.set_title('地下水资源评价', fontsize=12, fontweight='bold')
        ax1.grid(True, alpha=0.3, axis='y')
        
        # 2. 海水入侵界面
        ax2 = plt.subplot(2, 3, 2)
        
        h_range = np.linspace(0, 5, 100)
        z_range = GroundwaterManagement.seawater_intrusion_interface(h_range)
        
        ax2.plot(h_range, z_range, linewidth=3, color='darkblue',
                label='Ghyben-Herzberg关系')
        ax2.fill_between(h_range, 0, z_range, alpha=0.3, color='lightblue')
        
        # 标注示例点
        h_example = 2.5
        z_example = GroundwaterManagement.seawater_intrusion_interface(h_example)
        ax2.plot(h_example, z_example, 'ro', markersize=12)
        ax2.annotate(f'h={h_example}m\nz={z_example:.0f}m',
                    xy=(h_example, z_example), xytext=(h_example+0.5, z_example+20),
                    arrowprops=dict(arrowstyle='->', color='red', lw=1.5),
                    fontsize=10, bbox=dict(boxstyle='round', facecolor='wheat'))
        
        ax2.set_xlabel('淡水水头 h (m, 高于海平面)', fontsize=11)
        ax2.set_ylabel('界面深度 z (m, 海平面下)', fontsize=11)
        ax2.set_title('淡咸水界面（海水入侵）', fontsize=12, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        ax2.invert_yaxis()
        
        # 3. 污染修复对比
        ax3 = plt.subplot(2, 3, 3)
        
        methods = ['抽出-处理', 'PRB', '生物修复']
        durations = [9, 10, 2.5]  # 年
        costs = [80, 120, 40]  # 万元
        
        x_pos = np.arange(len(methods))
        width = 0.35
        
        bars1 = ax3.bar(x_pos - width/2, durations, width, label='修复时长(年)',
                       color='lightblue', edgecolor='black')
        ax3_twin = ax3.twinx()
        bars2 = ax3_twin.bar(x_pos + width/2, costs, width, label='成本(万元)',
                            color='lightcoral', edgecolor='black')
        
        ax3.set_xlabel('修复方法', fontsize=11)
        ax3.set_ylabel('修复时长 (年)', fontsize=11, color='blue')
        ax3_twin.set_ylabel('成本 (万元)', fontsize=11, color='red')
        ax3.set_title('污染修复方案对比', fontsize=12, fontweight='bold')
        ax3.set_xticks(x_pos)
        ax3.set_xticklabels(methods)
        ax3.grid(True, alpha=0.3, axis='y')
        
        # 图例
        lines1, labels1 = ax3.get_legend_handles_labels()
        lines2, labels2 = ax3_twin.get_legend_handles_labels()
        ax3.legend(lines1 + lines2, labels1 + labels2, loc='upper right')
        
        # 4. 超采区水位恢复
        ax4 = plt.subplot(2, 3, 4)
        
        years = np.arange(0, 41)
        
        # 基准情景（超采）
        h_baseline = 0 - 1.5 * years
        
        # 综合方案（恢复）
        h_recovery = np.zeros_like(years, dtype=float)
        h_recovery[:10] = -30 - 1.5 * np.arange(10)  # 前10年继续下降
        h_recovery[10:] = h_recovery[9] + 1.0 * np.arange(31)  # 后30年恢复
        
        ax4.plot(years, h_baseline, linewidth=2, linestyle='--',
                label='基准情景（持续超采）', color='red')
        ax4.plot(years, h_recovery, linewidth=2,
                label='综合方案（压采+回灌+补水）', color='green')
        
        ax4.axhline(0, color='blue', linestyle=':', linewidth=1.5,
                   label='初始水位')
        ax4.axvline(10, color='gray', linestyle=':', linewidth=1,
                   label='措施实施')
        
        ax4.set_xlabel('时间 (年)', fontsize=11)
        ax4.set_ylabel('相对水位 (m)', fontsize=11)
        ax4.set_title('超采区地下水位恢复预测', fontsize=12, fontweight='bold')
        ax4.legend()
        ax4.grid(True, alpha=0.3)
        
        # 5. 水量平衡
        ax5 = plt.subplot(2, 3, 5)
        
        categories_balance = ['天然补给', '回灌', '生态补水', '开采', '蒸发']
        values_balance = [1.2, 0.3, 0.5, -1.5, -0.3]  # 亿m³/年
        colors_balance = ['lightgreen', 'lightblue', 'cyan', 'lightcoral', 'orange']
        
        bars_balance = ax5.barh(categories_balance, values_balance,
                               color=colors_balance, edgecolor='black')
        
        ax5.axvline(0, color='black', linewidth=2)
        
        ax5.set_xlabel('水量 (亿m³/年)', fontsize=11)
        ax5.set_title('地下水平衡分析（综合方案）', fontsize=12, fontweight='bold')
        ax5.grid(True, alpha=0.3, axis='x')
        
        # 标注净平衡
        net_balance = sum(values_balance)
        ax5.text(0.8, -0.5, f'净平衡：{net_balance:+.2f}亿m³/年',
                fontsize=11, bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.7))
        
        # 6. 水资源优化配置
        ax6 = plt.subplot(2, 3, 6)
        
        # 求解优化
        W_sources = [5000, 3000, 2000]  # 万m³
        D_demands = [2000, 4000, 3000]
        C_costs = [1.5, 2.0, 2.5]  # 元/m³
        
        x_opt, total_cost = GroundwaterManagement.water_allocation_optimization(
            W_sources, D_demands, C_costs
        )
        
        if x_opt is not None:
            sources = ['地表水', '地下水', '再生水']
            demands = ['生活', '工业', '农业']
            
            bottom = np.zeros(3)
            colors_stack = ['lightblue', 'lightgreen', 'lightyellow']
            
            for i, (source, color) in enumerate(zip(sources, colors_stack)):
                ax6.bar(demands, x_opt[i, :], bottom=bottom, label=source,
                       color=color, edgecolor='black', width=0.6)
                bottom += x_opt[i, :]
            
            ax6.set_ylabel('用水量 (万m³/年)', fontsize=11)
            ax6.set_title(f'水资源优化配置\n总成本：{total_cost:.0f}万元/年',
                         fontsize=12, fontweight='bold')
            ax6.legend()
            ax6.grid(True, alpha=0.3, axis='y')
        
        plt.tight_layout()
        plt.savefig('groundwater_management_comprehensive.png', dpi=300)
        plt.show()

# 示例使用
print("="*60)
print("地下水管理综合案例")
print("="*60)

gwm = GroundwaterManagement()

# 1. 资源评价
print("\n1. 地下水资源评价")

A, H, mu = 500, 20, 0.15  # km², m
W_recharge, W_evap = 7000, 1500  # 万m³/年

W_static, W_dynamic, W_exploit = gwm.resource_evaluation(
    A, H, mu, W_recharge, W_evap, alpha=0.8
)

print(f"  含水层面积：{A} km², 厚度：{H} m, 给水度：{mu}")
print(f"  静储量：{W_static:.0f} 万m³ = {W_static/1e4:.2f} 亿m³")
print(f"  动储量：{W_dynamic:.0f} 万m³/年")
print(f"  可开采量：{W_exploit:.0f} 万m³/年 (开采系数0.8)")

# 2. 海水入侵
print("\n" + "="*60)
print("2. 海水入侵界面计算")

h_fresh = 2.5  # m
z_interface = gwm.seawater_intrusion_interface(h_fresh)

print(f"  淡水水头：{h_fresh} m（高于海平面）")
print(f"  界面深度：{z_interface:.1f} m（海平面下）")
print(f"  Ghyben-Herzberg比例：1:{z_interface/h_fresh:.0f}")

# 临界水头
z_well = 80  # m
h_crit = z_well / 40
print(f"  井底深度：{z_well} m（海平面下）")
print(f"  临界水头：{h_crit:.1f} m（防止入侵至井底）")

# 3. 污染修复
print("\n" + "="*60)
print("3. 污染修复时长估算（抽出-处理）")

V_contam = 300 * 100 * 10  # m³
n = 0.3
C0, C_target = 500, 10  # μg/L
Q_pump = 600  # m³/d
R_d = 5

T_years = gwm.pump_and_treat_duration(V_contam, n, C0, C_target, Q_pump, R_d)

print(f"  污染体积：{V_contam:.0f} m³")
print(f"  初始浓度：{C0} μg/L")
print(f"  目标浓度：{C_target} μg/L")
print(f"  抽水流量：{Q_pump} m³/d")
print(f"  阻滞因子：{R_d}")
print(f"  修复时长：{T_years:.1f} 年")

# 4. 水资源优化配置
print("\n" + "="*60)
print("4. 水资源优化配置（线性规划）")

W_sources = [5000, 3000, 2000]  # 万m³
D_demands = [2000, 4000, 3000]
C_costs = [1.5, 2.0, 2.5]  # 元/m³

x_opt, total_cost = gwm.water_allocation_optimization(W_sources, D_demands, C_costs)

if x_opt is not None:
    sources = ['地表水', '地下水', '再生水']
    demands = ['生活', '工业', '农业']
    
    print(f"  优化配置方案（万m³/年）：")
    print(f"  {'':10s}", end='')
    for d in demands:
        print(f"{d:>10s}", end='')
    print(f"{'总计':>10s}")
    
    for i, s in enumerate(sources):
        print(f"  {s:10s}", end='')
        for j in range(3):
            print(f"{x_opt[i,j]:10.0f}", end='')
        print(f"{x_opt[i,:].sum():10.0f}")
    
    print(f"  总成本：{total_cost:.0f} 万元/年")

# 可视化
print("\n绘制地下水管理综合可视化...")
gwm.plot_management_cases()
```

---

## 七、本章要点

### 管理策略总结

1. **资源评价**：
   - 静储量：$W_s = A \cdot H \cdot \mu$
   - 动储量：补给-排泄
   - 可开采量：$W_e = \alpha \cdot W_d$

2. **超采治理**：
   - 压采、回灌、生态补水
   - 水位恢复：$\Delta h = \frac{\Delta V}{A \cdot \mu}$

3. **海水入侵防治**：
   - Ghyben-Herzberg：$z = 40h$
   - 控制开采、淡水屏障、抽咸补淡

4. **污染修复**：
   - 抽出-处理、PRB、生物修复
   - 修复时长：冲洗倍数 × 孔隙体积 / 抽水量

5. **优化配置**：
   - 线性规划：$\min \sum c_i x_i$
   - 约束：水源、需求、水质

---

**本章重点**：
- 地下水资源评价（静储量、动储量、可开采量）
- 超采区恢复（压采、回灌、生态补水、数值模拟）
- 海水入侵防治（Ghyben-Herzberg、临界水头、淡水屏障）
- 污染修复（抽出-处理、PRB、生物修复、时长估算）
- 水资源优化配置（线性规划、多目标优化）
- Python综合管理工具

**课程总结**：本书系统介绍了地下水动力学从基础理论到工程应用的全部内容，涵盖达西定律、井流理论、数值模拟、污染运移和综合管理，为地下水资源可持续利用提供科学依据和技术支撑。
