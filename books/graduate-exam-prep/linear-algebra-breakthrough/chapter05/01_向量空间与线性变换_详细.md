# 第5章：向量空间与线性变换

**学习时间**: 4小时  
**难度**: ⭐⭐⭐⭐⭐  
**考试权重**: 10%

---

## 一、向量空间基本概念

### 1.1 向量空间定义

**定义**：非空集合$V$，定义加法和数乘运算，满足8条运算律，称为**向量空间**。

**8条运算律**：
1. 加法交换律：$\alpha + \beta = \beta + \alpha$
2. 加法结合律：$(\alpha + \beta) + \gamma = \alpha + (\beta + \gamma)$
3. 零元素：$\exists 0, \alpha + 0 = \alpha$
4. 负元素：$\exists -\alpha, \alpha + (-\alpha) = 0$
5. 数乘单位元：$1 \cdot \alpha = \alpha$
6. 数乘结合律：$k(l\alpha) = (kl)\alpha$
7. 分配律1：$(k+l)\alpha = k\alpha + l\alpha$
8. 分配律2：$k(\alpha + \beta) = k\alpha + k\beta$

### 1.2 子空间

**定义**：$W \subseteq V$，$W$对加法和数乘封闭，则$W$是$V$的**子空间**。

**判别**：
1. $0 \in W$
2. $\alpha, \beta \in W \Rightarrow \alpha + \beta \in W$
3. $\alpha \in W, k \in \mathbb{R} \Rightarrow k\alpha \in W$

---

## 二、线性相关性

### 2.1 定义

**线性组合**：
$$\beta = k_1\alpha_1 + k_2\alpha_2 + \cdots + k_n\alpha_n$$

**线性相关**：存在不全为零的$k_1, ..., k_n$，使
$$k_1\alpha_1 + \cdots + k_n\alpha_n = 0$$

**线性无关**：只有$k_1 = \cdots = k_n = 0$时上式成立

### 2.2 判别方法

**向量组** $\alpha_1, ..., \alpha_n$：

1. **矩阵秩法**：构造矩阵$A = [\alpha_1, ..., \alpha_n]$
   - $r(A) = n$ → 线性无关
   - $r(A) < n$ → 线性相关

2. **行列式法**（方阵）：
   - $|A| \neq 0$ → 线性无关
   - $|A| = 0$ → 线性相关

---

## 三、基与维数

### 3.1 基的概念

**基**：向量空间$V$的一个最大线性无关组

**维数**：dim$V$ = 基所含向量个数

**坐标**：$\alpha = x_1\mathbf{e}_1 + \cdots + x_n\mathbf{e}_n$

则$(x_1, ..., x_n)^T$为$\alpha$在基下的坐标

### 3.2 过渡矩阵

基$\{\alpha_1, ..., \alpha_n\}$到基$\{\beta_1, ..., \beta_n\}$：

$$(\beta_1, ..., \beta_n) = (\alpha_1, ..., \alpha_n)P$$

$P$：**过渡矩阵**

**坐标变换公式**：
$$\mathbf{x}_{\alpha} = P \mathbf{x}_{\beta}$$

### Python实现

```python
import numpy as np
import sympy as sp

class VectorSpace:
    """
    向量空间分析
    """
    
    @staticmethod
    def is_linearly_independent(vectors):
        """
        判断向量组线性相关性
        
        参数:
            vectors: 列向量列表 [[v1], [v2], ...]
        
        返回:
            是否线性无关
        """
        # 构造矩阵
        A = np.column_stack(vectors)
        
        # 计算秩
        rank = np.linalg.matrix_rank(A)
        n_vectors = len(vectors)
        
        is_independent = (rank == n_vectors)
        
        return is_independent, rank
    
    @staticmethod
    def find_basis(vectors):
        """
        从向量组中提取极大线性无关组（基）
        
        参数:
            vectors: 向量列表
        
        返回:
            基的索引
        """
        A = np.column_stack(vectors)
        m, n = A.shape
        
        # 行简化阶梯形
        _, pivots = sp.Matrix(A).T.rref()
        
        # 主元列即为基
        basis_indices = list(pivots)
        
        return basis_indices
    
    @staticmethod
    def coordinates_in_basis(vector, basis_vectors):
        """
        求向量在基下的坐标
        
        α = x1·e1 + x2·e2 + ... + xn·en
        
        参数:
            vector: 向量
            basis_vectors: 基向量列表
        
        返回:
            坐标
        """
        # 构造基矩阵
        B = np.column_stack(basis_vectors)
        
        # 求解 B·x = vector
        coordinates = np.linalg.solve(B, vector)
        
        return coordinates
    
    @staticmethod
    def transition_matrix(old_basis, new_basis):
        """
        计算过渡矩阵
        
        (new_basis) = (old_basis) · P
        
        参数:
            old_basis: 旧基向量列表
            new_basis: 新基向量列表
        
        返回:
            过渡矩阵P
        """
        B_old = np.column_stack(old_basis)
        B_new = np.column_stack(new_basis)
        
        # P = B_old^(-1) · B_new
        P = np.linalg.solve(B_old, B_new)
        
        return P
    
    @staticmethod
    def coordinate_transformation(coordinates_old, transition_matrix):
        """
        坐标变换
        
        x_old = P · x_new
        
        参数:
            coordinates_old: 旧坐标
            transition_matrix: 过渡矩阵
        
        返回:
            新坐标
        """
        x_new = np.linalg.solve(transition_matrix, coordinates_old)
        
        return x_new


# 示例1：线性相关性判别
print("="*60)
print("示例1：线性相关性判别")
print("="*60)

# 向量组
v1 = np.array([1, 2, 3])
v2 = np.array([2, 1, 0])
v3 = np.array([1, -1, -3])

vectors = [v1, v2, v3]

is_indep, rank = VectorSpace.is_linearly_independent(vectors)

print(f"向量组:")
for i, v in enumerate(vectors, 1):
    print(f"  v{i} = {v}")

print(f"\n秩: {rank}")
print(f"向量个数: {len(vectors)}")
print(f"线性无关: {is_indep}")

if not is_indep:
    print("线性相关！")

# 示例2：提取极大线性无关组
print("\n" + "="*60)
print("示例2：提取基")
print("="*60)

# 更多向量
v4 = np.array([3, 3, 3])
vectors_extended = [v1, v2, v3, v4]

basis_idx = VectorSpace.find_basis(vectors_extended)

print(f"向量组:")
for i, v in enumerate(vectors_extended, 1):
    print(f"  v{i} = {v}")

print(f"\n极大线性无关组（基）: v{[i+1 for i in basis_idx]}")
print("基向量:")
for i in basis_idx:
    print(f"  v{i+1} = {vectors_extended[i]}")

# 示例3：坐标计算
print("\n" + "="*60)
print("示例3：向量在基下的坐标")
print("="*60)

# 标准基
e1 = np.array([1, 0, 0])
e2 = np.array([0, 1, 0])
e3 = np.array([0, 0, 1])

standard_basis = [e1, e2, e3]

# 向量
vector = np.array([3, -2, 5])

# 在标准基下的坐标
coords_standard = VectorSpace.coordinates_in_basis(vector, standard_basis)

print(f"向量: v = {vector}")
print(f"标准基: e1={e1}, e2={e2}, e3={e3}")
print(f"坐标: {coords_standard}")

# 在另一组基下
basis_new = [v1, v2, np.array([1, 0, 1])]
coords_new = VectorSpace.coordinates_in_basis(vector, basis_new)

print(f"\n新基:")
for i, b in enumerate(basis_new, 1):
    print(f"  b{i} = {b}")
print(f"坐标: {coords_new}")

# 验证
reconstructed = sum(c * b for c, b in zip(coords_new, basis_new))
print(f"\n验证: {np.allclose(reconstructed, vector)}")

# 示例4：过渡矩阵与坐标变换
print("\n" + "="*60)
print("示例4：基变换与坐标变换")
print("="*60)

# 两组基
basis_alpha = [
    np.array([1, 0]),
    np.array([0, 1])
]

basis_beta = [
    np.array([1, 1]),
    np.array([1, -1])
]

# 过渡矩阵
P = VectorSpace.transition_matrix(basis_alpha, basis_beta)

print("旧基 (α):")
for i, b in enumerate(basis_alpha, 1):
    print(f"  α{i} = {b}")

print("\n新基 (β):")
for i, b in enumerate(basis_beta, 1):
    print(f"  β{i} = {b}")

print(f"\n过渡矩阵 P:")
print(P)

# 向量在旧基下的坐标
vector_2d = np.array([3, 2])
coords_alpha = vector_2d  # 在标准基（旧基）下

# 坐标变换
coords_beta = VectorSpace.coordinate_transformation(coords_alpha, P)

print(f"\n向量 v = {vector_2d}")
print(f"在旧基α下坐标: {coords_alpha}")
print(f"在新基β下坐标: {coords_beta}")

# 验证
v_from_alpha = sum(c * b for c, b in zip(coords_alpha, basis_alpha))
v_from_beta = sum(c * b for c, b in zip(coords_beta, basis_beta))

print(f"\n验证:")
print(f"  从α基重构: {v_from_alpha}")
print(f"  从β基重构: {v_from_beta}")
print(f"  相等: {np.allclose(v_from_alpha, v_from_beta)}")
```

---

## 四、线性变换

### 4.1 定义

**线性变换** $T: V \to W$：

1. $T(\alpha + \beta) = T(\alpha) + T(\beta)$
2. $T(k\alpha) = kT(\alpha)$

### 4.2 线性变换的矩阵表示

设$V$的基为$\{\alpha_1, ..., \alpha_n\}$

$$T(\alpha_j) = \sum_{i=1}^{n} a_{ij}\alpha_i$$

则$A = (a_{ij})$为$T$在该基下的矩阵

$$T(\mathbf{x}) = A\mathbf{x}$$

---

## 五、典型考题

### 考题1：判断线性相关性

**【题目】**判断向量组是否线性相关
$$\alpha_1 = (1,2,3)^T, \alpha_2 = (2,1,0)^T, \alpha_3 = (0,5,9)^T$$

**【解答】**

构造矩阵：
$$A = \begin{bmatrix} 1 & 2 & 0 \\ 2 & 1 & 5 \\ 3 & 0 & 9 \end{bmatrix}$$

行变换：
$$\to \begin{bmatrix} 1 & 2 & 0 \\ 0 & -3 & 5 \\ 0 & -6 & 9 \end{bmatrix} \to \begin{bmatrix} 1 & 2 & 0 \\ 0 & -3 & 5 \\ 0 & 0 & -1 \end{bmatrix}$$

$r(A) = 3 = n$ → **线性无关**

---

### 考题2：求坐标

**【题目】**$\alpha = (1,2,3)^T$在基$\beta_1=(1,1,1)^T, \beta_2=(1,1,0)^T, \beta_3=(1,0,0)^T$下的坐标？

**【解答】**

设$\alpha = x_1\beta_1 + x_2\beta_2 + x_3\beta_3$

$$\begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix} = x_1\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix} + x_2\begin{bmatrix} 1 \\ 1 \\ 0 \end{bmatrix} + x_3\begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}$$

解得：$x_1 = 3, x_2 = -1, x_3 = -1$

**坐标**：$(3, -1, -1)^T$

---

## 六、速记口诀

> 线性相关看秩小  
> 基的个数是维数  
> 坐标变换用过渡  
> 线性变换矩阵化

---

**本章重点**：
- 线性相关性判别
- 极大线性无关组
- 基与坐标
- 过渡矩阵

**下一章**：内积空间
