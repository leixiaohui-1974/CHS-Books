# Day 10：地下水污染与防治

**学习时间**: 4小时  
**难度**: ⭐⭐⭐⭐  
**重要性**: ⭐⭐⭐⭐

---

## 一、地下水污染特征

### 1.1 污染途径

1. **点源污染**
   - 垃圾填埋场
   - 工业废水渗坑
   - 加油站泄漏

2. **面源污染**
   - 农药化肥
   - 大气沉降
   - 污水灌溉

### 1.2 污染特点

- **隐蔽性强**：不易察觉
- **滞后性长**：影响延迟
- **难以治理**：恢复困难
- **持续时间久**：影响长远

---

## 二、污染物迁移模型

### 2.1 对流-弥散方程

**一维稳定流**：
$$\frac{\partial C}{\partial t} = D_L \frac{\partial^2 C}{\partial x^2} - v \frac{\partial C}{\partial x} - \lambda C$$

其中：
- C：浓度（mg/L）
- $D_L$：纵向弥散系数（m²/d）
- v：渗流速度（m/d）
- λ：衰减系数（1/d）

### 2.2 解析解

**瞬时点源**（高斯分布）：
$$C(x,t) = \frac{M}{n\sqrt{4\pi D_L t}}e^{-\frac{(x-vt)^2}{4D_L t}}$$

其中：
- M：污染物质量（kg）
- n：孔隙度

**连续点源**：
$$C(x,t) = \frac{C_0}{2}\text{erfc}\left(\frac{x-vt}{2\sqrt{D_L t}}\right)$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.special import erfc
from scipy.integrate import odeint

class GroundwaterContamination:
    """
    地下水污染模拟
    """
    
    def __init__(self, v, D_L, lambda_decay=0, porosity=0.3):
        """
        参数:
            v: 渗流速度 (m/d)
            D_L: 纵向弥散系数 (m²/d)
            lambda_decay: 衰减系数 (1/d)
            porosity: 孔隙度
        """
        self.v = v
        self.D_L = D_L
        self.lambda_decay = lambda_decay
        self.n = porosity
    
    def instantaneous_point_source(self, x, t, M):
        """
        瞬时点源解析解
        
        参数:
            x: 空间坐标 (m)
            t: 时间 (d)
            M: 污染物质量 (kg)
        
        返回:
            浓度 (mg/L)
        """
        if t <= 0:
            return 0
        
        # 主项
        coeff = M / (self.n * np.sqrt(4 * np.pi * self.D_L * t))
        
        # 指数项
        exponent = -(x - self.v * t)**2 / (4 * self.D_L * t)
        
        # 衰减项
        decay = np.exp(-self.lambda_decay * t)
        
        C = coeff * np.exp(exponent) * decay
        
        return C * 1000  # 转mg/L
    
    def continuous_point_source(self, x, t, C0):
        """
        连续点源解析解
        
        参数:
            x: 空间坐标 (m)
            t: 时间 (d)
            C0: 源浓度 (mg/L)
        
        返回:
            浓度 (mg/L)
        """
        if t <= 0:
            return 0
        
        # 误差函数补
        arg = (x - self.v * t) / (2 * np.sqrt(self.D_L * t))
        C = (C0 / 2) * erfc(arg)
        
        # 衰减
        C *= np.exp(-self.lambda_decay * t)
        
        return C
    
    def numerical_1d(self, x_grid, t_max, dt, C_initial, C_boundary):
        """
        数值解（有限差分法）
        
        参数:
            x_grid: 空间网格
            t_max: 最大时间 (d)
            dt: 时间步长 (d)
            C_initial: 初始浓度分布
            C_boundary: 边界浓度 (mg/L)
        
        返回:
            时间序列, 浓度场
        """
        nx = len(x_grid)
        dx = x_grid[1] - x_grid[0]
        nt = int(t_max / dt)
        
        # CFL条件
        CFL = self.v * dt / dx
        diffusion_number = self.D_L * dt / (dx**2)
        
        if CFL > 1 or diffusion_number > 0.5:
            print(f"警告: 数值不稳定 (CFL={CFL:.3f}, D*={diffusion_number:.3f})")
        
        # 初始化
        C = np.zeros((nt, nx))
        C[0, :] = C_initial
        
        # 时间循环
        for n in range(nt - 1):
            # 对流项（上风格式）
            conv = -self.v * dt / dx * (C[n, 1:] - C[n, :-1])
            
            # 弥散项（中心差分）
            diff = self.D_L * dt / (dx**2) * (
                C[n, 2:] - 2*C[n, 1:-1] + C[n, :-2]
            )
            
            # 衰减项
            decay = -self.lambda_decay * dt * C[n, 1:-1]
            
            # 更新
            C[n+1, 1:-1] = C[n, 1:-1] + conv[:-1] + diff + decay
            
            # 边界条件
            C[n+1, 0] = C_boundary  # 上游边界
            C[n+1, -1] = C[n+1, -2]  # 下游边界（零梯度）
        
        t_grid = np.arange(nt) * dt
        
        return t_grid, C
    
    def plot_instantaneous_plume(self, M, t_snapshots):
        """
        绘制瞬时源污染羽演化
        """
        x = np.linspace(-50, 300, 500)
        
        fig, ax = plt.subplots(figsize=(12, 6))
        
        colors = plt.cm.viridis(np.linspace(0, 1, len(t_snapshots)))
        
        for i, t in enumerate(t_snapshots):
            C = [self.instantaneous_point_source(xi, t, M) for xi in x]
            ax.plot(x, C, color=colors[i], linewidth=2,
                   label=f't={t}天')
        
        ax.set_xlabel('距离 (m)', fontsize=12)
        ax.set_ylabel('浓度 (mg/L)', fontsize=12)
        ax.set_title('瞬时点源污染羽演化', fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('contaminant_plume.png', dpi=300, bbox_inches='tight')
        plt.show()
    
    def plot_numerical_solution(self, x_grid, t_grid, C_field):
        """
        绘制数值解时空演化
        """
        fig, axes = plt.subplots(1, 2, figsize=(14, 5))
        
        # 时空分布
        X, T = np.meshgrid(x_grid, t_grid)
        im = axes[0].contourf(X, T, C_field, levels=20, cmap='jet')
        axes[0].set_xlabel('距离 (m)', fontsize=12)
        axes[0].set_ylabel('时间 (d)', fontsize=12)
        axes[0].set_title('浓度时空分布', fontsize=14)
        plt.colorbar(im, ax=axes[0], label='浓度 (mg/L)')
        
        # 不同时刻的浓度剖面
        time_indices = [0, len(t_grid)//4, len(t_grid)//2, 
                       3*len(t_grid)//4, -1]
        
        for idx in time_indices:
            axes[1].plot(x_grid, C_field[idx, :], 
                        label=f't={t_grid[idx]:.1f}d',
                        linewidth=2)
        
        axes[1].set_xlabel('距离 (m)', fontsize=12)
        axes[1].set_ylabel('浓度 (mg/L)', fontsize=12)
        axes[1].set_title('浓度剖面演化', fontsize=14)
        axes[1].legend()
        axes[1].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('numerical_contamination.png', dpi=300, bbox_inches='tight')
        plt.show()


# 使用示例
print("="*60)
print("地下水污染模拟")
print("="*60)

# 含水层参数
v = 0.5       # 渗流速度 (m/d)
D_L = 5.0     # 弥散系数 (m²/d)
lambda_decay = 0.01  # 衰减系数 (1/d)

model = GroundwaterContamination(v, D_L, lambda_decay)

print(f"含水层参数:")
print(f"  渗流速度: {v} m/d")
print(f"  弥散系数: {D_L} m²/d")
print(f"  衰减系数: {lambda_decay} 1/d")

# 示例1：瞬时点源
print("\n示例1：瞬时点源污染羽")
M = 10  # kg

t_snapshots = [1, 5, 10, 20, 40]
model.plot_instantaneous_plume(M, t_snapshots)

# 峰值浓度随时间变化
print("\n峰值浓度随时间变化:")
for t in t_snapshots:
    x_peak = v * t  # 峰值位置
    C_peak = model.instantaneous_point_source(x_peak, t, M)
    print(f"  t={t:3d}天: x={x_peak:5.1f}m, C={C_peak:.2f}mg/L")

# 示例2：连续点源
print("\n示例2：连续点源污染")
C0 = 100  # mg/L

x_obs = 50  # 观测点 (m)
t_obs = np.linspace(0, 100, 200)
C_obs = [model.continuous_point_source(x_obs, t, C0) for t in t_obs]

plt.figure(figsize=(10, 6))
plt.plot(t_obs, C_obs, 'b-', linewidth=2)
plt.axhline(C0/2, color='r', linestyle='--', 
           label=f'稳态浓度 ({C0/2}mg/L)')
plt.xlabel('时间 (d)', fontsize=12)
plt.ylabel('浓度 (mg/L)', fontsize=12)
plt.title(f'连续点源下游{x_obs}m处浓度变化', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.savefig('continuous_source.png', dpi=300, bbox_inches='tight')
plt.show()

# 突破时间
C_threshold = 10  # mg/L
breakthrough_idx = np.where(np.array(C_obs) >= C_threshold)[0]
if len(breakthrough_idx) > 0:
    t_breakthrough = t_obs[breakthrough_idx[0]]
    print(f"\n污染物突破时间（C≥{C_threshold}mg/L）: {t_breakthrough:.1f}天")

# 示例3：数值模拟
print("\n示例3：数值模拟")
x_grid = np.linspace(0, 200, 100)
t_max = 50
dt = 0.1

C_initial = np.zeros(len(x_grid))
C_boundary = 50  # mg/L

t_grid, C_field = model.numerical_1d(x_grid, t_max, dt, 
                                     C_initial, C_boundary)

print(f"网格: {len(x_grid)}×{len(t_grid)}")
print(f"最终最大浓度: {C_field[-1, :].max():.2f} mg/L")

model.plot_numerical_solution(x_grid, t_grid, C_field)
```

---

## 三、地下水污染防治

### 3.1 防治措施

1. **源头控制**
   - 防渗处理
   - 废物管理
   - 清洁生产

2. **过程阻断**
   - 阻隔墙
   - 抽水井
   - 气相抽提

3. **末端治理**
   - 抽出处理
   - 原位修复
   - 监测预警

### 3.2 抽出-处理系统

```python
class PumpAndTreat:
    """
    抽出-处理系统设计
    """
    
    @staticmethod
    def capture_zone_radius(Q, K, H, i):
        """
        捕获区半径（稳定井流）
        
        参数:
            Q: 抽水量 (m³/d)
            K: 渗透系数 (m/d)
            H: 含水层厚度 (m)
            i: 水力坡度
        
        返回:
            捕获区半径 (m)
        """
        R_capture = Q / (2 * np.pi * K * H * i)
        return R_capture
    
    @staticmethod
    def remediation_time(V_aquifer, Q, C0, C_target, retardation=1):
        """
        修复时间估算
        
        参数:
            V_aquifer: 污染区体积 (m³)
            Q: 抽水量 (m³/d)
            C0: 初始浓度 (mg/L)
            C_target: 目标浓度 (mg/L)
            retardation: 阻滞因子
        
        返回:
            修复时间 (年)
        """
        # 孔隙体积倍数
        pore_volumes = retardation * np.log(C0 / C_target)
        
        # 修复时间
        t_years = (V_aquifer * pore_volumes) / (Q * 365)
        
        return t_years


# 抽出-处理示例
print("\n" + "="*60)
print("抽出-处理系统设计")
print("="*60)

# 含水层参数
Q = 100      # m³/d
K = 10       # m/d
H = 20       # m
i = 0.001

R_capture = PumpAndTreat.capture_zone_radius(Q, K, H, i)

print(f"抽水井设计:")
print(f"  抽水量: {Q} m³/d")
print(f"  捕获区半径: {R_capture:.1f} m")

# 修复时间估算
V_aquifer = np.pi * R_capture**2 * H * 0.3  # 孔隙度0.3
C0 = 100  # mg/L
C_target = 5  # mg/L

t_remediation = PumpAndTreat.remediation_time(V_aquifer, Q, C0, C_target)

print(f"\n修复时间估算:")
print(f"  污染区体积: {V_aquifer:.0f} m³")
print(f"  初始浓度: {C0} mg/L")
print(f"  目标浓度: {C_target} mg/L")
print(f"  预计修复时间: {t_remediation:.1f} 年")

if t_remediation > 10:
    print(f"  ⚠️ 修复时间过长，建议优化方案")
```

---

## 四、典型考题

### 考题：污染羽预测

**【题目】**（30分）

某地下水污染，参数：
- v = 0.8 m/d
- $D_L$ = 8 m²/d
- 瞬时泄漏：M = 50 kg
- 衰减系数：λ = 0.02 1/d

求：
1. 10天后污染羽中心位置
2. 中心处浓度（孔隙度0.25）
3. 污染羽前锋位置

**【解答】**

1. **中心位置**：
   $$x_c = vt = 0.8 \times 10 = 8 \text{ m}$$

2. **中心浓度**：
   $$C(x_c, t) = \frac{M}{n\sqrt{4\pi D_L t}}e^{-\lambda t}$$
   $$= \frac{50}{0.25\sqrt{4\pi \times 8 \times 10}}e^{-0.02 \times 10}$$
   $$\approx 1.99 \text{ kg/m³} = 1990 \text{ mg/L}$$

3. **前锋位置**（近似为3倍标准差）：
   $$x_f \approx x_c + 3\sqrt{2D_L t} = 8 + 3\sqrt{160} \approx 46 \text{ m}$$

---

## 五、高频考点

| 考点 | 公式/方法 | 难度 |
|------|---------|------|
| 对流-弥散方程 | 解析解 | ⭐⭐⭐⭐ |
| 污染羽演化 | 高斯分布 | ⭐⭐⭐⭐ |
| 修复时间 | 孔隙体积法 | ⭐⭐⭐ |
| 捕获区 | 稳定井流 | ⭐⭐⭐ |

---

**明日预告**: Day 11 - 水资源系统分析

**本日重点**：
- 对流-弥散方程（必考）
- 污染羽预测
- 抽出-处理系统
