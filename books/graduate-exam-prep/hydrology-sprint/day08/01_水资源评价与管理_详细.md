# Day 8：水资源评价与管理

**学习时间**: 4小时  
**难度**: ⭐⭐⭐⭐  
**重要性**: ⭐⭐⭐⭐⭐

---

## 一、水资源量计算

### 1.1 地表水资源量

**径流系数法**：
$$W = \alpha \cdot P \cdot F$$

其中：
- W：径流量（m³）
- α：径流系数
- P：降雨量（m）
- F：流域面积（m²）

### 1.2 地下水资源量

**降雨入渗法**：
$$W_g = \alpha_g \cdot P \cdot F$$

**地下水模数法**：
$$W_g = M_g \cdot F$$

$M_g$：地下水模数（m³/s/km²）

### 1.3 重复量扣除

总水资源量 = 地表水 + 地下水 - 重复量

重复量：河川基流

---

## 二、水资源评价指标

### 2.1 水资源丰度

**人均水资源量**：
$$w_{人均} = \frac{W}{N}$$

**联合国标准**：
- 充裕：> 1700 m³/人·年
- 紧张：1000-1700
- 缺水：< 1000
- 严重缺水：< 500

### 2.2 水资源开发利用率

$$\eta = \frac{W_{利用}}{W_{可利用}} \times 100\%$$

**警戒线**：≤40%（国际公认）

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

class WaterResourcesEvaluation:
    """
    水资源评价与管理
    """
    
    def __init__(self, basin_name, area):
        """
        参数:
            basin_name: 流域名称
            area: 流域面积 (km²)
        """
        self.basin_name = basin_name
        self.area = area
    
    def surface_water_resources(self, P, alpha=0.4):
        """
        地表水资源量计算
        
        参数:
            P: 年降雨量 (mm)
            alpha: 径流系数
        
        返回:
            地表水资源量 (亿m³)
        """
        # 转换单位：mm -> m, km² -> m²
        W_surface = alpha * (P / 1000) * (self.area * 1e6)
        
        # 转亿m³
        W_surface_yi = W_surface / 1e8
        
        return W_surface_yi
    
    def groundwater_resources(self, P, alpha_g=0.15, base_flow_ratio=0.5):
        """
        地下水资源量计算
        
        参数:
            P: 年降雨量 (mm)
            alpha_g: 地下水补给系数
            base_flow_ratio: 基流比例（与地表水重复部分）
        
        返回:
            地下水资源量, 重复量 (亿m³)
        """
        # 地下水总量
        W_groundwater = alpha_g * (P / 1000) * (self.area * 1e6) / 1e8
        
        # 重复量（河川基流）
        W_overlap = W_groundwater * base_flow_ratio
        
        return W_groundwater, W_overlap
    
    def total_water_resources(self, P, alpha_surface=0.4, 
                             alpha_ground=0.15, base_flow_ratio=0.5):
        """
        总水资源量
        
        返回:
            总量, 地表, 地下, 重复量 (亿m³)
        """
        W_surface = self.surface_water_resources(P, alpha_surface)
        W_ground, W_overlap = self.groundwater_resources(P, alpha_ground,
                                                         base_flow_ratio)
        
        W_total = W_surface + W_ground - W_overlap
        
        return {
            'total': W_total,
            'surface': W_surface,
            'groundwater': W_ground,
            'overlap': W_overlap
        }
    
    def per_capita_water(self, W_total, population):
        """
        人均水资源量
        
        参数:
            W_total: 总水资源量 (亿m³)
            population: 人口 (万人)
        
        返回:
            人均量 (m³/人·年), 丰度等级
        """
        w_per_capita = (W_total * 1e8) / (population * 1e4)
        
        # 等级判定
        if w_per_capita >= 1700:
            grade = "充裕"
            color = 'green'
        elif w_per_capita >= 1000:
            grade = "紧张"
            color = 'orange'
        elif w_per_capita >= 500:
            grade = "缺水"
            color = 'red'
        else:
            grade = "严重缺水"
            color = 'darkred'
        
        return w_per_capita, grade, color
    
    def utilization_rate(self, W_utilized, W_available):
        """
        水资源开发利用率
        
        参数:
            W_utilized: 已利用量 (亿m³)
            W_available: 可利用量 (亿m³)
        
        返回:
            利用率 (%), 评价
        """
        eta = (W_utilized / W_available) * 100
        
        if eta <= 20:
            evaluation = "开发潜力大"
        elif eta <= 40:
            evaluation = "适度开发"
        elif eta <= 60:
            evaluation = "高强度开发"
        else:
            evaluation = "过度开发"
        
        return eta, evaluation
    
    def water_balance(self, W_total, W_demand_sectors):
        """
        水量平衡分析
        
        参数:
            W_total: 总水资源量 (亿m³)
            W_demand_sectors: 各部门需水量字典 (亿m³)
                {'农业': x, '工业': y, '生活': z, ...}
        
        返回:
            平衡结果
        """
        W_demand_total = sum(W_demand_sectors.values())
        W_balance = W_total - W_demand_total
        
        surplus_deficit = "盈余" if W_balance >= 0 else "缺口"
        
        return {
            'total_supply': W_total,
            'total_demand': W_demand_total,
            'balance': W_balance,
            'status': surplus_deficit,
            'sectors': W_demand_sectors
        }
    
    def plot_water_budget(self, water_resources, demand_sectors, population):
        """
        绘制水资源评价图
        """
        fig = plt.figure(figsize=(14, 10))
        gs = fig.add_gridspec(2, 2, hspace=0.3, wspace=0.3)
        
        # 1. 水资源组成饼图
        ax1 = fig.add_subplot(gs[0, 0])
        
        labels = ['地表水', '地下水（不重复）']
        sizes = [water_resources['surface'],
                water_resources['groundwater'] - water_resources['overlap']]
        colors = ['#3498db', '#95a5a6']
        explode = (0.05, 0)
        
        ax1.pie(sizes, explode=explode, labels=labels, colors=colors,
               autopct='%1.1f%%', shadow=True, startangle=90)
        ax1.set_title('水资源组成', fontsize=14)
        
        # 2. 需水结构柱状图
        ax2 = fig.add_subplot(gs[0, 1])
        
        sectors = list(demand_sectors.keys())
        demands = list(demand_sectors.values())
        
        bars = ax2.bar(sectors, demands, color=['#2ecc71', '#e74c3c', 
                                                 '#f39c12', '#9b59b6'])
        ax2.set_ylabel('需水量 (亿m³)', fontsize=12)
        ax2.set_title('各部门需水量', fontsize=14)
        ax2.grid(True, alpha=0.3, axis='y')
        
        # 标注数值
        for bar in bars:
            height = bar.get_height()
            ax2.text(bar.get_x() + bar.get_width()/2., height,
                    f'{height:.1f}',
                    ha='center', va='bottom', fontsize=10)
        
        # 3. 供需平衡对比
        ax3 = fig.add_subplot(gs[1, 0])
        
        total_demand = sum(demands)
        total_supply = water_resources['total']
        
        categories = ['可供水量', '需水量']
        values = [total_supply, total_demand]
        colors_balance = ['blue', 'red']
        
        bars = ax3.barh(categories, values, color=colors_balance, alpha=0.7)
        ax3.set_xlabel('水量 (亿m³)', fontsize=12)
        ax3.set_title('供需平衡分析', fontsize=14)
        ax3.grid(True, alpha=0.3, axis='x')
        
        for i, bar in enumerate(bars):
            width = bar.get_width()
            ax3.text(width, bar.get_y() + bar.get_height()/2.,
                    f'{values[i]:.1f}',
                    ha='left', va='center', fontsize=11, fontweight='bold')
        
        # 平衡状况标注
        balance = total_supply - total_demand
        if balance >= 0:
            ax3.text(max(values) * 0.5, 0.5,
                    f'盈余: {balance:.1f} 亿m³',
                    fontsize=12, color='green',
                    bbox=dict(boxstyle='round', facecolor='lightgreen', alpha=0.7))
        else:
            ax3.text(max(values) * 0.5, 0.5,
                    f'缺口: {-balance:.1f} 亿m³',
                    fontsize=12, color='red',
                    bbox=dict(boxstyle='round', facecolor='lightcoral', alpha=0.7))
        
        # 4. 人均水资源对比
        ax4 = fig.add_subplot(gs[1, 1])
        
        w_per_capita, grade, color = self.per_capita_water(
            water_resources['total'], population
        )
        
        # 世界/中国平均值对比
        world_avg = 8000
        china_avg = 2200
        
        regions = ['世界平均', '中国平均', self.basin_name]
        per_capita_values = [world_avg, china_avg, w_per_capita]
        colors_pc = ['lightblue', 'lightgreen', color]
        
        bars = ax4.bar(regions, per_capita_values, color=colors_pc, alpha=0.7)
        ax4.set_ylabel('人均水资源量 (m³/人·年)', fontsize=12)
        ax4.set_title(f'人均水资源量对比\n{self.basin_name}: {grade}',
                     fontsize=14)
        ax4.grid(True, alpha=0.3, axis='y')
        
        # 标注数值
        for bar in bars:
            height = bar.get_height()
            ax4.text(bar.get_x() + bar.get_width()/2., height,
                    f'{height:.0f}',
                    ha='center', va='bottom', fontsize=10)
        
        # 标准线
        ax4.axhline(1700, color='green', linestyle='--', alpha=0.5,
                   label='充裕线')
        ax4.axhline(1000, color='orange', linestyle='--', alpha=0.5,
                   label='紧张线')
        ax4.axhline(500, color='red', linestyle='--', alpha=0.5,
                   label='缺水线')
        ax4.legend(fontsize=9)
        
        plt.suptitle(f'{self.basin_name}水资源评价', fontsize=16, y=0.98)
        
        plt.savefig('water_resources_evaluation.png',
                   dpi=300, bbox_inches='tight')
        plt.show()


# 使用示例
print("="*60)
print("水资源评价示例")
print("="*60)

# 创建评价对象
basin = WaterResourcesEvaluation("某流域", area=10000)  # km²

# 气象水文参数
P_annual = 800  # mm

# 计算水资源量
water_res = basin.total_water_resources(P_annual)

print(f"流域面积: {basin.area} km²")
print(f"年降雨量: {P_annual} mm")
print(f"\n水资源量计算:")
print(f"  地表水: {water_res['surface']:.2f} 亿m³")
print(f"  地下水: {water_res['groundwater']:.2f} 亿m³")
print(f"  重复量: {water_res['overlap']:.2f} 亿m³")
print(f"  总水资源量: {water_res['total']:.2f} 亿m³")

# 人口与人均水资源
population = 500  # 万人
w_pc, grade, color = basin.per_capita_water(water_res['total'], population)

print(f"\n人均水资源:")
print(f"  人口: {population} 万人")
print(f"  人均: {w_pc:.0f} m³/人·年")
print(f"  等级: {grade}")

# 需水量分析
demand_sectors = {
    '农业': 20.0,
    '工业': 8.0,
    '生活': 5.0,
    '生态': 3.0
}

balance = basin.water_balance(water_res['total'], demand_sectors)

print(f"\n供需平衡:")
print(f"  总供水量: {balance['total_supply']:.2f} 亿m³")
print(f"  总需水量: {balance['total_demand']:.2f} 亿m³")
print(f"  平衡: {balance['balance']:.2f} 亿m³ ({balance['status']})")

# 开发利用率
W_utilized = balance['total_demand']
W_available = water_res['total'] * 0.7  # 可利用量约70%

eta, evaluation = basin.utilization_rate(W_utilized, W_available)
print(f"\n开发利用率:")
print(f"  可利用量: {W_available:.2f} 亿m³")
print(f"  已利用量: {W_utilized:.2f} 亿m³")
print(f"  利用率: {eta:.1f}%")
print(f"  评价: {evaluation}")

# 绘图
basin.plot_water_budget(water_res, demand_sectors, population)
```

---

## 三、水资源管理策略

### 3.1 节水措施

1. **农业节水**（占比最大）
   - 喷灌、滴灌
   - 提高灌溉效率

2. **工业节水**
   - 循环用水
   - 提高重复利用率

3. **生活节水**
   - 节水器具
   - 中水回用

### 3.2 水资源配置

**优化目标**：
$$\min Z = \sum_{i}\sum_{j} c_{ij} x_{ij}$$

约束：
- 水源供水能力
- 用户需水量
- 输水能力

---

## 四、典型考题

### 考题：水资源评价计算

**【题目】**（30分）

某市：
- 面积：5000 km²
- 人口：300万
- 年降雨：600mm
- 径流系数：0.35
- 年需水：15亿m³

评价水资源状况。

**【解答】**

1. **地表水资源量**：
   $$W = 0.35 \times 0.6 \times 5000 \times 10^6 = 10.5 \text{ 亿m³}$$

2. **人均水资源**：
   $$w = \frac{10.5 \times 10^8}{300 \times 10^4} = 350 \text{ m³/人·年}$$
   
   **严重缺水**（< 500）

3. **利用率**：
   $$\eta = \frac{15}{10.5} \times 100\% = 143\%$$
   
   **严重超载**

**结论**：该市水资源严重短缺，需跨流域调水或海水淡化。

---

## 五、高频考点

| 考点 | 关键公式 | 难度 |
|------|---------|------|
| 水资源量 | W=αPF | ⭐⭐⭐ |
| 人均量 | w=W/N | ⭐⭐ |
| 利用率 | η=W利用/W可利用 | ⭐⭐⭐ |
| 供需平衡 | 平衡分析 | ⭐⭐⭐⭐ |

---

**明日预告**: Day 9 - 水环境容量与水质评价

**本日重点**：
- 水资源量计算（必考）
- 人均水资源评价
- 供需平衡分析
