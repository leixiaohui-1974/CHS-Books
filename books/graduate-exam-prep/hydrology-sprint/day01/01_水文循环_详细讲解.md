# Day 1：水文循环与水量平衡

**学习时间**: 4小时  
**难度**: ⭐⭐  
**重要性**: ⭐⭐⭐⭐⭐

---

## 一、核心知识点

### 1.1 水文循环

#### 定义
水文循环是指水在地球上以各种形态在大气圈、水圈、岩石圈和生物圈之间不断运动和转化的过程。

#### 基本环节

```python
# 文件：hydrologic_cycle.py
class HydrologicCycle:
    """
    水文循环模拟
    """
    
    def __init__(self):
        self.components = {
            'precipitation': 0,      # 降水 (mm)
            'evaporation': 0,        # 蒸发 (mm)
            'infiltration': 0,       # 入渗 (mm)
            'runoff': 0,            # 径流 (mm)
            'storage_change': 0      # 蓄变 (mm)
        }
    
    def water_balance(self, P, E, R, delta_S=None):
        """
        水量平衡方程: P = E + R + ΔS
        
        参数:
            P: 降水量 (mm)
            E: 蒸发量 (mm)
            R: 径流量 (mm)
            delta_S: 蓄变量 (mm)，可选
        """
        if delta_S is None:
            delta_S = P - E - R
        
        self.components['precipitation'] = P
        self.components['evaporation'] = E
        self.components['runoff'] = R
        self.components['storage_change'] = delta_S
        
        # 验证平衡
        balance = P - (E + R + delta_S)
        
        return {
            'P': P,
            'E': E,
            'R': R,
            'ΔS': delta_S,
            'balance': balance,
            'runoff_coefficient': R / P if P > 0 else 0
        }
    
    def annual_water_balance(self, P_annual, E_annual):
        """
        多年平均水量平衡: P = E + R (ΔS ≈ 0)
        """
        R_annual = P_annual - E_annual
        alpha = R_annual / P_annual if P_annual > 0 else 0
        
        return {
            'P_annual': P_annual,
            'E_annual': E_annual,
            'R_annual': R_annual,
            'runoff_coefficient': alpha
        }

# 示例：流域水量平衡计算
cycle = HydrologicCycle()

# 月水量平衡
result = cycle.water_balance(P=150, E=80, R=50)
print(f"月水量平衡:")
print(f"  降水: {result['P']} mm")
print(f"  蒸发: {result['E']} mm")
print(f"  径流: {result['R']} mm")
print(f"  蓄变: {result['ΔS']} mm")
print(f"  平衡误差: {result['balance']:.3f} mm")
print(f"  径流系数: {result['runoff_coefficient']:.3f}")
```

---

## 二、重点考题类型

### 考题1：流域水量平衡计算

**【题目】**（20分，考频⭐⭐⭐⭐⭐）

某流域，面积A=500km²，年降水量P=1200mm，年径流量W=3×10⁸m³。求：
1. 年径流深R
2. 年蒸发量E
3. 径流系数α
4. 若下年降水增加10%，径流量如何变化（假设E不变）

**【解答】**

#### 1. 年径流深

$$R = \frac{W}{A} = \frac{3 \times 10^8}{500 \times 10^6} = 0.6 \text{ m} = 600 \text{ mm}$$

#### 2. 年蒸发量

水量平衡方程：
$$P = E + R$$

$$E = P - R = 1200 - 600 = 600 \text{ mm}$$

#### 3. 径流系数

$$\alpha = \frac{R}{P} = \frac{600}{1200} = 0.5$$

#### 4. 降水增加后的径流

$$P' = 1.1 \times 1200 = 1320 \text{ mm}$$

$$R' = P' - E = 1320 - 600 = 720 \text{ mm}$$

$$W' = R' \times A = 720 \times 10^{-3} \times 500 \times 10^6 = 3.6 \times 10^8 \text{ m}^3$$

径流增加：
$$\frac{\Delta W}{W} = \frac{3.6 - 3.0}{3.0} = 20\%$$

**结论**：降水增加10%，径流增加20%（放大效应）

#### Python代码

```python
import numpy as np
import matplotlib.pyplot as plt

def basin_water_balance(A, P, W=None, R=None, E=None):
    """
    流域水量平衡
    
    参数:
        A: 流域面积 (km²)
        P: 降水量 (mm)
        W: 径流量 (m³)，可选
        R: 径流深 (mm)，可选
        E: 蒸发量 (mm)，可选
    """
    # 单位转换
    A_m2 = A * 1e6  # km² → m²
    
    # 径流深计算
    if W is not None:
        R = (W / A_m2) * 1000  # m³ → mm
    
    # 水量平衡
    if E is None and R is not None:
        E = P - R
    elif R is None and E is not None:
        R = P - E
    
    # 径流系数
    alpha = R / P if P > 0 else 0
    
    # 径流量
    W_calc = (R / 1000) * A_m2
    
    return {
        'A': A,
        'P': P,
        'R': R,
        'E': E,
        'W': W_calc,
        'alpha': alpha
    }

def precipitation_sensitivity(A, P0, E, delta_P_percent):
    """
    降水敏感性分析
    """
    results = []
    
    for delta in delta_P_percent:
        P = P0 * (1 + delta / 100)
        result = basin_water_balance(A, P, E=E)
        results.append({
            'delta_P': delta,
            'P': P,
            'R': result['R'],
            'W': result['W'],
            'alpha': result['alpha']
        })
    
    return results

# 计算
result_base = basin_water_balance(A=500, P=1200, W=3e8)

print("流域水量平衡:")
print(f"  流域面积: {result_base['A']} km²")
print(f"  年降水量: {result_base['P']} mm")
print(f"  年径流深: {result_base['R']:.0f} mm")
print(f"  年蒸发量: {result_base['E']:.0f} mm")
print(f"  年径流量: {result_base['W']:.2e} m³")
print(f"  径流系数: {result_base['alpha']:.2f}")

# 敏感性分析
print("\n降水敏感性分析:")
delta_range = np.arange(-20, 30, 5)
sensitivity = precipitation_sensitivity(500, 1200, 600, delta_range)

for item in sensitivity:
    delta_W = (item['W'] - result_base['W']) / result_base['W'] * 100
    print(f"  P变化{item['delta_P']:+3.0f}% → R={item['R']:4.0f}mm, W变化{delta_W:+5.1f}%")

# 绘图
fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# 水量平衡饼图
labels = ['径流 R', '蒸发 E']
sizes = [result_base['R'], result_base['E']]
colors = ['#3498db', '#e74c3c']
axes[0].pie(sizes, labels=labels, autopct='%1.1f%%', startangle=90, colors=colors)
axes[0].set_title(f'水量平衡组成\n年降水 P = {result_base["P"]} mm')

# 敏感性曲线
P_list = [s['P'] for s in sensitivity]
R_list = [s['R'] for s in sensitivity]
axes[1].plot(P_list, R_list, 'b-o', linewidth=2, markersize=6, label='径流深 R')
axes[1].axvline(result_base['P'], color='r', linestyle='--', label='基准降水')
axes[1].set_xlabel('降水量 P (mm)')
axes[1].set_ylabel('径流深 R (mm)')
axes[1].set_title('降水-径流关系')
axes[1].grid(True, alpha=0.3)
axes[1].legend()

plt.tight_layout()
plt.savefig('water_balance_analysis.png', dpi=300, bbox_inches='tight')
plt.show()
```

---

## 三、快速记忆口诀

**水量平衡口诀**：
> 降水等于蒸发径流加蓄变  
> 多年平均蓄变为零看  
> 径流系数半干旱  
> 湿润地区零点六到七

---

## 四、高频考点总结

| 考点 | 公式 | 注意事项 |
|------|------|---------|
| 水量平衡 | P = E + R + ΔS | 单位统一 |
| 径流系数 | α = R/P | 无量纲，0~1 |
| 多年平衡 | P = E + R | ΔS≈0 |
| 单位换算 | 1mm=1L/m² | 注意流域面积 |

---

## 五、本日练习题

### 练习1（15分）
某流域面积800km²，某月降水150mm，月初蓄水量20×10⁶m³，月末18×10⁶m³，实测径流量60mm。求月蒸发量。

### 练习2（20分）
某区域多年平均降水1000mm，径流系数0.4，流域面积1200km²。求：
1. 多年平均径流深
2. 多年平均蒸发量
3. 年径流总量

---

**明日预告**: Day 2 - 流域特征与水系分析

**建议学习时间安排**：
- 理论学习：1小时
- 例题练习：2小时
- Python编程：1小时
