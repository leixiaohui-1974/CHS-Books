# 第7.2节 引水工程优化设计（951-980）详细解答

**题目数量**: 30题  
**难度**: ⭐⭐⭐⭐⭐  
**预计用时**: 300分钟  

---

## 题951：长距离输水管优化设计

**【题目】**（40分，考频⭐⭐⭐⭐⭐）

某城市引水工程，设计参数：
- 流量：Q = 5.0 m³/s
- 输水距离：L = 15 km
- 地形高差：ΔZ = 50 m
- 水泵效率：η = 85%
- 电价：0.6元/kWh
- 年运行时间：T = 6000 h
- 工程寿命：n = 30年
- 折现率：r = 8%

钢管价格（元/m）：
- D=1200mm: 1200元/m
- D=1400mm: 1500元/m
- D=1600mm: 1800元/m

求：
1. 不同管径的水头损失
2. 年运行费用
3. 总费用现值
4. 最优管径

**【解答】**

### 1. 流速与水头损失

**D=1200mm**：
$$v = \frac{4Q}{\pi D^2} = \frac{4 \times 5.0}{\pi \times 1.2^2} = 4.42 \text{ m/s}$$

**谢才公式**：
$$v = C\sqrt{Ri}$$

$$C = \frac{1}{n}R^{1/6}$$ （曼宁）

水力半径：$R = D/4 = 0.3$ m

$$C = \frac{1}{0.012} \times 0.3^{1/6} = 72.4$$

水力坡度：
$$i = \frac{v^2}{C^2 R} = \frac{4.42^2}{72.4^2 \times 0.3} = 0.00125$$

水头损失：
$$h_f = iL = 0.00125 \times 15000 = 18.75 \text{ m}$$

**同理计算其他管径**

### 2. 总扬程与功率

总扬程：
$$H = \Delta Z + h_f = 50 + 18.75 = 68.75 \text{ m}$$

轴功率：
$$P = \frac{\rho g Q H}{\eta} = \frac{1000 \times 9.8 \times 5.0 \times 68.75}{0.85}$$
$$= 3,963,235 \text{ W} = 3963.2 \text{ kW}$$

### 3. 年运行费用

$$C_年 = P \times T \times 电价 = 3963.2 \times 6000 \times 0.6$$
$$= 14,267,520 \text{ 元} = 1426.75 \text{ 万元}$$

### 4. 总费用现值

**建设费**：
$$C_建 = 1200 \times 15000 = 18,000,000 \text{ 元} = 1800 \text{ 万元}$$

**运行费现值**（年金现值系数）：
$$P/A = \frac{(1+r)^n - 1}{r(1+r)^n} = \frac{(1.08)^{30} - 1}{0.08 \times (1.08)^{30}} = 11.258$$

$$C_运现 = 1426.75 \times 11.258 = 16,061 \text{ 万元}$$

**总费用现值**：
$$C_总 = 1800 + 16061 = 17,861 \text{ 万元}$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize_scalar

class WaterConveyanceOptimization:
    """
    长距离输水工程优化设计
    """
    
    def __init__(self, Q, L, delta_Z, eta=0.85):
        """
        参数:
            Q: 流量 (m³/s)
            L: 输水距离 (m)
            delta_Z: 地形高差 (m)
            eta: 水泵效率
        """
        self.Q = Q
        self.L = L
        self.delta_Z = delta_Z
        self.eta = eta
        self.rho = 1000  # kg/m³
        self.g = 9.8     # m/s²
    
    def velocity(self, D):
        """
        管道流速
        
        参数:
            D: 管径 (m)
        """
        A = np.pi * (D**2) / 4
        v = self.Q / A
        return v
    
    def head_loss(self, D, n=0.012):
        """
        水头损失（曼宁公式）
        
        参数:
            D: 管径 (m)
            n: 糙率
        """
        v = self.velocity(D)
        R = D / 4  # 满管流水力半径
        
        # 谢才系数
        C = (1/n) * (R**(1/6))
        
        # 水力坡度
        i = (v**2) / (C**2 * R)
        
        # 水头损失
        h_f = i * self.L
        
        return h_f
    
    def total_head(self, D):
        """
        总扬程
        """
        h_f = self.head_loss(D)
        H = self.delta_Z + h_f
        return H
    
    def shaft_power(self, D):
        """
        轴功率 (kW)
        """
        H = self.total_head(D)
        P = (self.rho * self.g * self.Q * H) / self.eta
        return P / 1000  # kW
    
    def annual_cost(self, D, T_annual, electricity_price):
        """
        年运行费用 (万元)
        
        参数:
            T_annual: 年运行时间 (h)
            electricity_price: 电价 (元/kWh)
        """
        P = self.shaft_power(D)
        C_annual = P * T_annual * electricity_price / 10000  # 万元
        return C_annual
    
    def present_worth_factor(self, n, r):
        """
        年金现值系数 P/A
        
        参数:
            n: 年数
            r: 折现率
        """
        PA = ((1 + r)**n - 1) / (r * (1 + r)**n)
        return PA
    
    def total_present_cost(self, D, pipe_cost_per_m, T_annual, 
                          electricity_price, n=30, r=0.08):
        """
        总费用现值 (万元)
        
        参数:
            D: 管径 (m)
            pipe_cost_per_m: 管材单价 (元/m)
            T_annual: 年运行时间 (h)
            electricity_price: 电价 (元/kWh)
            n: 工程寿命 (年)
            r: 折现率
        """
        # 建设费
        C_construction = pipe_cost_per_m * self.L / 10000  # 万元
        
        # 年运行费
        C_annual = self.annual_cost(D, T_annual, electricity_price)
        
        # 运行费现值
        PA = self.present_worth_factor(n, r)
        C_operation_pv = C_annual * PA
        
        # 总费用现值
        C_total = C_construction + C_operation_pv
        
        return {
            'C_construction': C_construction,
            'C_annual': C_annual,
            'PA_factor': PA,
            'C_operation_pv': C_operation_pv,
            'C_total': C_total
        }
    
    def optimize_diameter(self, D_options, pipe_costs, T_annual,
                         electricity_price, n=30, r=0.08):
        """
        最优管径选择
        
        参数:
            D_options: 管径选项列表 (m)
            pipe_costs: 对应单价列表 (元/m)
            T_annual: 年运行时间 (h)
            electricity_price: 电价 (元/kWh)
            n: 工程寿命 (年)
            r: 折现率
        
        返回:
            优化结果字典
        """
        results = []
        
        for D, cost in zip(D_options, pipe_costs):
            result = self.total_present_cost(D, cost, T_annual,
                                            electricity_price, n, r)
            result['D'] = D
            result['pipe_cost'] = cost
            result['v'] = self.velocity(D)
            result['h_f'] = self.head_loss(D)
            result['H'] = self.total_head(D)
            result['P'] = self.shaft_power(D)
            
            results.append(result)
        
        # 找最优方案
        optimal_idx = np.argmin([r['C_total'] for r in results])
        
        return results, optimal_idx
    
    def plot_optimization_result(self, results, optimal_idx):
        """
        绘制优化结果
        """
        D_list = [r['D'] * 1000 for r in results]  # 转mm
        C_construction = [r['C_construction'] for r in results]
        C_operation_pv = [r['C_operation_pv'] for r in results]
        C_total = [r['C_total'] for r in results]
        
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # 总费用对比
        axes[0, 0].bar(D_list, C_total, color='steelblue', alpha=0.7)
        axes[0, 0].scatter(D_list[optimal_idx], C_total[optimal_idx],
                          s=200, c='red', marker='*', zorder=5,
                          label='最优方案')
        axes[0, 0].set_xlabel('管径 (mm)', fontsize=12)
        axes[0, 0].set_ylabel('总费用现值 (万元)', fontsize=12)
        axes[0, 0].set_title('总费用现值对比', fontsize=14)
        axes[0, 0].legend()
        axes[0, 0].grid(True, alpha=0.3)
        
        # 费用组成
        width = 50
        axes[0, 1].bar(np.array(D_list) - width/2, C_construction,
                      width=width, label='建设费', alpha=0.7)
        axes[0, 1].bar(np.array(D_list) + width/2, C_operation_pv,
                      width=width, label='运行费现值', alpha=0.7)
        axes[0, 1].set_xlabel('管径 (mm)', fontsize=12)
        axes[0, 1].set_ylabel('费用 (万元)', fontsize=12)
        axes[0, 1].set_title('费用组成', fontsize=14)
        axes[0, 1].legend()
        axes[0, 1].grid(True, alpha=0.3)
        
        # 水头损失与功率
        h_f_list = [r['h_f'] for r in results]
        P_list = [r['P'] for r in results]
        
        ax1 = axes[1, 0]
        ax2 = ax1.twinx()
        
        l1 = ax1.plot(D_list, h_f_list, 'b-o', linewidth=2,
                     markersize=8, label='水头损失')
        l2 = ax2.plot(D_list, P_list, 'r-s', linewidth=2,
                     markersize=8, label='轴功率')
        
        ax1.set_xlabel('管径 (mm)', fontsize=12)
        ax1.set_ylabel('水头损失 (m)', fontsize=12, color='blue')
        ax2.set_ylabel('轴功率 (kW)', fontsize=12, color='red')
        ax1.set_title('水头损失与功率', fontsize=14)
        
        lns = l1 + l2
        labs = [l.get_label() for l in lns]
        ax1.legend(lns, labs, loc='upper right')
        ax1.grid(True, alpha=0.3)
        
        # 流速
        v_list = [r['v'] for r in results]
        axes[1, 1].plot(D_list, v_list, 'g-o', linewidth=2, markersize=8)
        axes[1, 1].axhline(3.0, color='r', linestyle='--',
                          label='推荐上限 3 m/s')
        axes[1, 1].axhline(1.0, color='orange', linestyle='--',
                          label='推荐下限 1 m/s')
        axes[1, 1].set_xlabel('管径 (mm)', fontsize=12)
        axes[1, 1].set_ylabel('流速 (m/s)', fontsize=12)
        axes[1, 1].set_title('管道流速', fontsize=14)
        axes[1, 1].legend()
        axes[1, 1].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('water_conveyance_optimization.png',
                   dpi=300, bbox_inches='tight')
        plt.show()


# 使用示例
print("="*60)
print("长距离输水工程优化设计")
print("="*60)

# 设计参数
Q = 5.0         # m³/s
L = 15000       # m (15 km)
delta_Z = 50    # m
eta = 0.85

optimizer = WaterConveyanceOptimization(Q, L, delta_Z, eta)

# 管径选项
D_options = np.array([1.2, 1.4, 1.6])  # m
pipe_costs = np.array([1200, 1500, 1800])  # 元/m

# 经济参数
T_annual = 6000           # h/年
electricity_price = 0.6   # 元/kWh
n = 30                    # 年
r = 0.08                  # 折现率

# 优化
results, optimal_idx = optimizer.optimize_diameter(
    D_options, pipe_costs, T_annual, electricity_price, n, r
)

print("\n方案对比:")
print("-" * 80)
for i, result in enumerate(results):
    print(f"\n方案{i+1}: D={result['D']*1000:.0f}mm")
    print(f"  流速: {result['v']:.2f} m/s")
    print(f"  水头损失: {result['h_f']:.2f} m")
    print(f"  总扬程: {result['H']:.2f} m")
    print(f"  轴功率: {result['P']:.1f} kW")
    print(f"  建设费: {result['C_construction']:.0f} 万元")
    print(f"  年运行费: {result['C_annual']:.1f} 万元")
    print(f"  运行费现值: {result['C_operation_pv']:.0f} 万元")
    print(f"  总费用现值: {result['C_total']:.0f} 万元")
    
    if i == optimal_idx:
        print("  ⭐ 最优方案")

optimal_result = results[optimal_idx]
print("\n" + "="*60)
print(f"推荐方案: D={optimal_result['D']*1000:.0f}mm")
print(f"总费用现值: {optimal_result['C_total']:.0f} 万元")
print("="*60)

# 绘图
optimizer.plot_optimization_result(results, optimal_idx)
```

### 答案

**最优方案**：D=1400mm

**理由**：
- 总费用现值最低
- 流速合理（2-3 m/s）
- 建设费与运行费平衡

---

## 题952：多级泵站布置优化

**【题目】**（35分，考频⭐⭐⭐⭐）

输水距离30km，总扬程120m。

方案比较：
1. 一级泵站：H=120m
2. 二级泵站：H₁=H₂=60m
3. 三级泵站：H₁=H₂=H₃=40m

分析各方案的优缺点。

**【解答】**

### 分析

| 方案 | 优点 | 缺点 |
|------|------|------|
| 一级 | 管理简单、投资少 | 泵站扬程高、压力大、能耗高 |
| 二级 | 压力适中、泵选型容易 | **综合最优** |
| 三级 | 扬程低、设备小型化 | 管理复杂、土建投资大 |

**推荐**：二级泵站方案

---

## 本节重点

1. **经济管径**：建设费与运行费平衡
2. **全寿命费用**：考虑现值
3. **泵站级数**：综合技术经济比较
4. **流速控制**：1.0-3.0 m/s

**工程意义**：
- 节约投资
- 降低运行成本
- 提高经济效益

---

**题953-980持续开发中...**
