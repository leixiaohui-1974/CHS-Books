# 第8章：水力相似与模型试验

**学习时间**: 4小时  
**考试频率**: ⭐⭐⭐⭐  
**难度**: ⭐⭐⭐⭐⭐

---

## 一、相似理论基础

### 1.1 三种相似

**(1) 几何相似**：

$$\frac{L_p}{L_m} = \lambda_L = \text{常数}$$

要求所有对应线性尺寸比相等

**(2) 运动相似**：

$$\frac{v_p}{v_m} = \lambda_v = \text{常数}, \quad \frac{t_p}{t_m} = \lambda_t = \text{常数}$$

要求对应点流速方向相同，大小成比例

**(3) 动力相似**：

$$\frac{F_p}{F_m} = \lambda_F = \text{常数}$$

要求对应点各力的比值相等，方向平行

### 1.2 相似准则

**必要条件**：
1. 几何相似
2. 运动相似
3. 动力相似

**充要条件**：
- 几何相似
- 单值条件相似（边界、初始条件）
- 相似准则数相等

---

## 二、π定理与量纲分析

### 2.1 白金汉π定理

**定理**：若物理现象涉及$n$个物理量，包含$m$个基本量纲，则可组成$(n-m)$个无量纲数

**步骤**：
1. 列出所有物理量
2. 确定基本量纲数$m$
3. 构造$(n-m)$个π项
4. 建立π之间的函数关系

### 2.2 常用无量纲数

**雷诺数**（Re）：

$$Re = \frac{vL}{\nu} = \frac{\text{惯性力}}{\text{粘性力}}$$

**弗劳德数**（Fr）：

$$Fr = \frac{v}{\sqrt{gL}} = \sqrt{\frac{\text{惯性力}}{\text{重力}}}$$

**韦伯数**（We）：

$$We = \frac{\rho v^2 L}{\sigma} = \frac{\text{惯性力}}{\text{表面张力}}$$

**欧拉数**（Eu）：

$$Eu = \frac{\Delta p}{\rho v^2} = \frac{\text{压力}}{\text{惯性力}}$$

**马赫数**（Ma）：

$$Ma = \frac{v}{c} = \frac{\text{流速}}{\text{声速}}$$

---

## 三、相似准则

### 3.1 重力相似准则（弗劳德准则）

**适用**：重力起主导作用（明渠流、溢洪道、波浪）

**相似条件**：

$$Fr_p = Fr_m$$

$$\frac{v_p}{\sqrt{gL_p}} = \frac{v_m}{\sqrt{gL_m}}$$

**比尺关系**：

$$\lambda_v = \sqrt{\lambda_L}, \quad \lambda_Q = \lambda_L^{5/2}, \quad \lambda_t = \sqrt{\lambda_L}$$

### 3.2 粘性力相似准则（雷诺准则）

**适用**：粘性力起主导作用（管流、边界层、绕流）

**相似条件**：

$$Re_p = Re_m$$

$$\frac{v_p L_p}{\nu_p} = \frac{v_m L_m}{\nu_m}$$

**比尺关系**：

$$\lambda_v = \frac{\lambda_L}{\lambda_\nu}, \quad \lambda_Q = \frac{\lambda_L^2}{\lambda_\nu}$$

### 3.3 重力-粘性力混合相似

**问题**：Fr准则和Re准则不能同时满足

**解决方案**：
1. 主次分明（按主要力选准则）
2. 变态模型（改变工质，如盐水）
3. 分区模拟（局部模型）

---

## 四、模型设计

### 4.1 比尺选择

**几何比尺$\lambda_L$**：

$$\lambda_L = \frac{L_p}{L_m}$$

**限制因素**：
- 实验室尺寸
- 测量精度
- 雷诺数下限（避免层流）

**常用范围**：
- 溢洪道：$\lambda_L = 30 \sim 100$
- 河工模型：$\lambda_L = 50 \sim 500$
- 港口：$\lambda_L = 100 \sim 300$

### 4.2 模型失真

**(1) 重力模型失真**：

**原因**：雷诺数过小，粘性力相对增大

**补救**：
- 提高糙率（粗化床面）
- 变态比尺（$\lambda_h \neq \lambda_L$）

**(2) 表面张力失真**：

**原因**：小水深时表面张力相对增大

**下限**：$h_m > 1 \sim 2$cm

---

## 五、模型验证

### 5.1 验证方法

**原型对比**：
- 水位过程线
- 流速分布
- 泥沙淤积形态

**相似指标**：
- 水位误差<5%
- 流速误差<10%

### 5.2 误差分析

**系统误差**：
- 模型失真
- 比尺效应

**随机误差**：
- 测量误差
- 操作误差

---

## 六、Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class HydraulicSimilarity:
    """水力相似与模型试验"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def reynolds_number(self, v, L, nu):
        """雷诺数"""
        Re = v * L / nu
        return Re
    
    def froude_number(self, v, L, g=None):
        """弗劳德数"""
        if g is None:
            g = self.g
        Fr = v / np.sqrt(g * L)
        return Fr
    
    def weber_number(self, rho, v, L, sigma):
        """韦伯数"""
        We = rho * v**2 * L / sigma
        return We
    
    def froude_similarity_scales(self, lambda_L):
        """
        弗劳德相似比尺关系
        
        参数:
            lambda_L: 几何比尺 Lp/Lm
        
        返回:
            lambda_v, lambda_t, lambda_Q: 速度、时间、流量比尺
        """
        lambda_v = np.sqrt(lambda_L)
        lambda_t = np.sqrt(lambda_L)
        lambda_Q = lambda_L**2.5
        
        return lambda_v, lambda_t, lambda_Q
    
    def reynolds_similarity_scales(self, lambda_L, lambda_nu=1):
        """
        雷诺相似比尺关系
        
        参数:
            lambda_L: 几何比尺
            lambda_nu: 运动粘度比尺（默认1，同种工质）
        
        返回:
            lambda_v, lambda_t, lambda_Q
        """
        lambda_v = lambda_L / lambda_nu
        lambda_t = lambda_nu
        lambda_Q = lambda_L**2 / lambda_nu
        
        return lambda_v, lambda_t, lambda_Q
    
    def model_distortion_check(self, L_p, L_m, v_m, nu_m=1e-6):
        """
        模型失真检验
        
        检查模型雷诺数是否足够大（避免层流）
        """
        lambda_L = L_p / L_m
        
        # 弗劳德相似
        lambda_v, _, _ = self.froude_similarity_scales(lambda_L)
        v_p = lambda_v * v_m
        
        # 原型雷诺数
        Re_p = self.reynolds_number(v_p, L_p, nu_m)
        
        # 模型雷诺数
        Re_m = self.reynolds_number(v_m, L_m, nu_m)
        
        # 判断
        Re_critical = 2000  # 层流-湍流临界
        
        if Re_m < Re_critical:
            status = "层流，存在失真"
        else:
            status = "湍流，相似性好"
        
        return Re_p, Re_m, status
    
    def minimum_water_depth(self, sigma=0.073, rho=1000):
        """
        最小水深（避免表面张力失真）
        
        经验值：h_min = 1~2cm
        """
        h_min = 0.015  # m
        return h_min
    
    def plot_similarity_analysis(self):
        """绘制相似分析图"""
        fig, axes = plt.subplots(2, 2, figsize=(16, 12))
        
        # 1. 比尺关系（弗劳德相似）
        ax1 = axes[0, 0]
        
        lambda_L_range = np.logspace(1, 3, 100)  # 10~1000
        
        lambda_v_values = []
        lambda_t_values = []
        lambda_Q_values = []
        
        for lambda_L in lambda_L_range:
            lambda_v, lambda_t, lambda_Q = self.froude_similarity_scales(lambda_L)
            lambda_v_values.append(lambda_v)
            lambda_t_values.append(lambda_t)
            lambda_Q_values.append(lambda_Q)
        
        ax1.loglog(lambda_L_range, lambda_v_values, 'b-', linewidth=2.5, label='速度 λ_v=√λ_L')
        ax1.loglog(lambda_L_range, lambda_t_values, 'g-', linewidth=2.5, label='时间 λ_t=√λ_L')
        ax1.loglog(lambda_L_range, lambda_Q_values, 'r-', linewidth=2.5, label='流量 λ_Q=λ_L^2.5')
        
        # 参考线
        ax1.loglog(lambda_L_range, lambda_L_range, 'k--', linewidth=1, alpha=0.5, label='λ_L')
        ax1.loglog(lambda_L_range, lambda_L_range**2, 'k:', linewidth=1, alpha=0.5, label='λ_L²')
        
        ax1.set_xlabel('几何比尺 λ_L', fontsize=11)
        ax1.set_ylabel('其他比尺', fontsize=11)
        ax1.set_title('弗劳德相似比尺关系', fontsize=13, fontweight='bold')
        ax1.legend()
        ax1.grid(True, alpha=0.3, which='both')
        
        # 2. 雷诺数对比
        ax2 = axes[0, 1]
        
        L_p = 100  # m (原型)
        v_p = 2.0  # m/s
        nu = 1e-6  # m²/s
        
        lambda_L_Re = np.linspace(10, 200, 100)
        
        Re_p_values = []
        Re_m_values = []
        
        for lambda_L in lambda_L_Re:
            L_m = L_p / lambda_L
            
            # 弗劳德相似
            lambda_v = np.sqrt(lambda_L)
            v_m = v_p / lambda_v
            
            Re_p = self.reynolds_number(v_p, L_p, nu)
            Re_m = self.reynolds_number(v_m, L_m, nu)
            
            Re_p_values.append(Re_p)
            Re_m_values.append(Re_m)
        
        ax2.plot(lambda_L_Re, Re_p_values, 'b-', linewidth=2.5, label='原型Re_p')
        ax2.plot(lambda_L_Re, Re_m_values, 'r-', linewidth=2.5, label='模型Re_m')
        ax2.axhline(2000, color='g', linestyle='--', linewidth=2, label='临界Re=2000')
        
        ax2.set_xlabel('几何比尺 λ_L', fontsize=11)
        ax2.set_ylabel('雷诺数 Re', fontsize=11)
        ax2.set_title(f'雷诺数对比\n原型: L={L_p}m, v={v_p}m/s', fontsize=13, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        ax2.set_yscale('log')
        
        # 3. 模型失真区域
        ax3 = axes[1, 0]
        
        # 水深范围
        h_range = np.linspace(0.001, 0.1, 100)
        
        # 表面张力影响（We数）
        v_test = 0.5  # m/s
        rho = 1000  # kg/m³
        sigma = 0.073  # N/m
        
        We_values = [self.weber_number(rho, v_test, h, sigma) for h in h_range]
        
        ax3.plot(h_range * 100, We_values, 'b-', linewidth=2.5)
        
        # 标注失真区
        h_min = self.minimum_water_depth()
        ax3.axvline(h_min * 100, color='r', linestyle='--', linewidth=2,
                   label=f'最小水深={h_min*100:.1f}cm')
        ax3.axvspan(0, h_min * 100, alpha=0.3, color='red', label='表面张力失真区')
        
        ax3.set_xlabel('水深 h (cm)', fontsize=11)
        ax3.set_ylabel('韦伯数 We', fontsize=11)
        ax3.set_title(f'表面张力影响\nv={v_test}m/s', fontsize=13, fontweight='bold')
        ax3.legend()
        ax3.grid(True, alpha=0.3)
        
        # 4. 相似准则选择
        ax4 = axes[1, 1]
        
        # 示意图：不同流动类型的准则选择
        flow_types = ['明渠流\n溢洪道', '管流\n边界层', '波浪\n潮汐', '高速流\n空化']
        criteria = ['弗劳德\n(Fr)', '雷诺\n(Re)', '弗劳德\n(Fr)', '欧拉\n(Eu)']
        y_pos = np.arange(len(flow_types))
        
        colors_crit = ['lightblue', 'lightgreen', 'lightcyan', 'lightyellow']
        
        bars = ax4.barh(y_pos, [1]*len(flow_types), color=colors_crit, alpha=0.8,
                       edgecolor='black', linewidth=2)
        
        ax4.set_yticks(y_pos)
        ax4.set_yticklabels(flow_types, fontsize=10)
        ax4.set_xlabel('相似准则', fontsize=11)
        ax4.set_title('不同流动类型的相似准则选择', fontsize=13, fontweight='bold')
        ax4.set_xlim([0, 1.2])
        ax4.set_xticks([])
        
        # 标注准则
        for i, (bar, criterion) in enumerate(zip(bars, criteria)):
            ax4.text(0.5, bar.get_y() + bar.get_height()/2, criterion,
                    ha='center', va='center', fontsize=12, fontweight='bold',
                    bbox=dict(boxstyle='round', facecolor='white', alpha=0.8))
        
        plt.tight_layout()
        plt.savefig('hydraulic_similarity_analysis.png', dpi=300)
        plt.show()

# 示例计算
print("="*60)
print("水力相似与模型试验")
print("="*60)

hs = HydraulicSimilarity()

# 1. 弗劳德相似比尺
print("1. 弗劳德相似比尺计算:")

L_p = 150  # m (原型溢洪道长度)
L_m = 3    # m (模型长度)
lambda_L = L_p / L_m

lambda_v, lambda_t, lambda_Q = hs.froude_similarity_scales(lambda_L)

print(f"  原型长度 L_p = {L_p} m")
print(f"  模型长度 L_m = {L_m} m")
print(f"  几何比尺 λ_L = {lambda_L}")
print(f"\n  比尺关系:")
print(f"    速度比尺 λ_v = {lambda_v:.2f}")
print(f"    时间比尺 λ_t = {lambda_t:.2f}")
print(f"    流量比尺 λ_Q = {lambda_Q:.2f}")

# 原型到模型
v_p = 10  # m/s
Q_p = 500  # m³/s

v_m = v_p / lambda_v
Q_m = Q_p / lambda_Q

print(f"\n  换算:")
print(f"    原型流速 v_p = {v_p} m/s → 模型 v_m = {v_m:.3f} m/s")
print(f"    原型流量 Q_p = {Q_p} m³/s → 模型 Q_m = {Q_m:.4f} m³/s")

# 2. 雷诺数检验
print("\n" + "="*60)
print("2. 模型失真检验:")

h_p = 5.0  # m
h_m = h_p / lambda_L
v_m_calc = 1.0  # m/s (假设)
nu = 1e-6  # m²/s

Re_p, Re_m, status = hs.model_distortion_check(h_p, h_m, v_m_calc, nu)

print(f"  原型水深 h_p = {h_p} m")
print(f"  模型水深 h_m = {h_m:.3f} m")
print(f"  模型流速 v_m = {v_m_calc} m/s")
print(f"\n  雷诺数:")
print(f"    原型 Re_p = {Re_p:.2e}")
print(f"    模型 Re_m = {Re_m:.2e}")
print(f"  判断：{status}")

# 3. 最小水深
print("\n" + "="*60)
print("3. 表面张力失真判断:")

h_min = hs.minimum_water_depth()

print(f"  最小水深 h_min = {h_min*100:.1f} cm")
print(f"  模型水深 h_m = {h_m*100:.2f} cm")

if h_m >= h_min:
    print(f"  判断：h_m > h_min，表面张力影响可忽略 ✓")
else:
    print(f"  判断：h_m < h_min，存在表面张力失真 ✗")

# 4. 时间换算
print("\n" + "="*60)
print("4. 时间换算:")

t_p = 2 * 3600  # 2小时 (秒)
t_m = t_p / lambda_t

print(f"  原型过程时间 t_p = 2 小时")
print(f"  模型过程时间 t_m = {t_m:.1f} 秒 = {t_m/60:.2f} 分钟")

# 绘图
print("\n绘制水力相似分析图...")
hs.plot_similarity_analysis()
```

---

## 七、典型考题

### 【例题1】比尺计算（12分）

**题目**：溢洪道模型，$\lambda_L=50$。原型流量$Q_p=1000$m³/s，水位变化时间$t_p=2$h。求模型对应值。

**【解答】**

弗劳德相似：

$$\lambda_v = \sqrt{\lambda_L} = \sqrt{50} = 7.07$$

$$\lambda_Q = \lambda_L^{5/2} = 50^{2.5} = 17678$$

$$\lambda_t = \sqrt{\lambda_L} = 7.07$$

$$Q_m = \frac{Q_p}{\lambda_Q} = \frac{1000}{17678} = 0.0566 \text{ m}^3\text{/s} = 56.6 \text{ L/s}$$

$$t_m = \frac{t_p}{\lambda_t} = \frac{7200}{7.07} = 1018 \text{ s} = 17 \text{ min}$$

---

### 【例题2】相似准则选择（8分）

**题目**：以下流动选择何种相似准则？
(1) 水库回水
(2) 水泵叶轮绕流
(3) 海洋波浪

**【解答】**

(1) 水库回水：重力主导，**弗劳德准则**

(2) 水泵叶轮：粘性力主导，**雷诺准则**

(3) 海洋波浪：重力主导，**弗劳德准则**

---

**本章重点**：
- 相似三定律
- 弗劳德与雷诺准则
- 比尺关系推导
- 模型失真分析

**全书完成！**
