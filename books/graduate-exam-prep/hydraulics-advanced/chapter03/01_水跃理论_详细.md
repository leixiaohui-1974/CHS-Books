# 第3章：水跃理论

**现象**: 明渠急流→缓流  
**工程应用**: 消能设计

---

## 一、水跃基本概念

### 1.1 定义

**水跃（Hydraulic Jump）**：明渠水流从急流过渡到缓流时，水深突然增大、水面急剧升高、伴随强烈紊动和能量损失的局部水力现象。

**特征**：
- 水深突增：$h_2 > h_1$
- 流态转变：$Fr_1 > 1$ → $Fr_2 < 1$
- 能量损失：约40-70%

### 1.2 发生条件

**必要条件**：
$$Fr_1 = \frac{v_1}{\sqrt{gh_1}} > 1$$

**充分条件**：下游水深$h_2 > h_c$（临界水深）

### 1.3 工程意义

1. **消能**：泄洪、溢流坝下游
2. **掺气**：改善水质
3. **危害**：冲刷、振动

---

## 二、共轭水深

### 2.1 理论推导

**动量方程**（忽略底坡和阻力）：

$$\frac{\gamma}{g}Q(v_1 - v_2) = P_1 - P_2$$

对于矩形断面：
$$P = \frac{1}{2}\gamma b h^2$$

代入并简化：
$$\frac{h_2}{h_1} = \frac{1}{2}(\sqrt{1 + 8Fr_1^2} - 1)$$

**共轭水深公式**：
$$h_2 = \frac{h_1}{2}(\sqrt{1 + 8Fr_1^2} - 1)$$

或：
$$h_1 = \frac{h_2}{2}(\sqrt{1 + 8Fr_2^2} - 1)$$

### 2.2 性质

1. **对称性**：$h_1$、$h_2$可互换
2. **单调性**：$Fr_1$↑，$h_2/h_1$↑
3. **渐近性**：$Fr_1 \to 1$，$h_2 \to h_1$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class HydraulicJump:
    """水跃理论"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def conjugate_depth(self, h1, Fr1):
        """
        共轭水深计算
        
        h₂ = (h₁/2) * (√(1+8Fr₁²) - 1)
        
        参数:
            h1: 跃前水深 (m)
            Fr1: 跃前弗劳德数
        
        返回:
            h2: 跃后水深 (m)
        """
        h2 = h1 / 2 * (np.sqrt(1 + 8*Fr1**2) - 1)
        
        return h2
    
    def jump_length(self, h1, h2, method='smetana'):
        """
        水跃长度
        
        Smetana公式: L_j = 5(h₂ - h₁)
        经验公式: L_j = 6.9h₂ (Fr₁=2-16)
        
        参数:
            h1: 跃前水深 (m)
            h2: 跃后水深 (m)
            method: 'smetana' 或 'empirical'
        
        返回:
            L_j: 水跃长度 (m)
        """
        if method == 'smetana':
            L_j = 5 * (h2 - h1)
        elif method == 'empirical':
            L_j = 6.9 * h2
        else:
            L_j = 5 * (h2 - h1)
        
        return L_j
    
    def energy_loss(self, h1, h2):
        """
        水跃能量损失
        
        ΔE = (h₂-h₁)³ / (4h₁h₂)
        
        返回:
            delta_E: 能量损失 (m)
            efficiency: 消能率 (%)
        """
        delta_E = (h2 - h1)**3 / (4 * h1 * h2)
        
        # 跃前总水头（以h2为基准）
        E1 = h1 + delta_E
        
        # 消能率
        efficiency = delta_E / E1 * 100
        
        return delta_E, efficiency
    
    def jump_type(self, Fr1):
        """
        水跃类型分类
        
        Fr₁ = 1.0-1.7: 波状水跃
        Fr₁ = 1.7-2.5: 弱水跃
        Fr₁ = 2.5-4.5: 振荡水跃
        Fr₁ = 4.5-9.0: 稳定水跃
        Fr₁ > 9.0: 强水跃
        """
        if Fr1 < 1.7:
            return '波状水跃'
        elif Fr1 < 2.5:
            return '弱水跃'
        elif Fr1 < 4.5:
            return '振荡水跃'
        elif Fr1 < 9.0:
            return '稳定水跃'
        else:
            return '强水跃'
    
    def stilling_basin_design(self, Q, b, h1, h2):
        """
        消力池设计
        
        参数:
            Q: 流量 (m³/s)
            b: 宽度 (m)
            h1: 跃前水深 (m)
            h2: 跃后水深 (m)
        
        返回:
            设计参数
        """
        # 消力池长度
        L_basin = self.jump_length(h1, h2, 'empirical')
        
        # 池深（取跃后水深+0.5m安全余量）
        D_basin = h2 + 0.5
        
        # 底板高程降低（辅助形成水跃）
        Delta_z = 0.1 * h1  # 经验值
        
        # 消能率
        _, eta = self.energy_loss(h1, h2)
        
        results = {
            'length': L_basin,
            'depth': D_basin,
            'elevation_drop': Delta_z,
            'energy_dissipation_rate': eta
        }
        
        return results
    
    def plot_jump_profile(self, h1, Fr1):
        """绘制水跃纵剖面"""
        # 共轭水深
        h2 = self.conjugate_depth(h1, Fr1)
        
        # 水跃长度
        L_j = self.jump_length(h1, h2)
        
        # 水面线（简化为抛物线）
        x = np.linspace(0, L_j, 100)
        y = h1 + (h2 - h1) * (x / L_j)**0.5
        
        fig, ax = plt.subplots(figsize=(14, 6))
        
        # 底板
        ax.plot([0, L_j], [0, 0], 'k-', linewidth=3, label='底板')
        ax.fill_between([0, L_j], [0, 0], -0.5, alpha=0.2, color='gray')
        
        # 水面线
        ax.plot(x, y, 'b-', linewidth=2.5, label='水面线')
        ax.fill_between(x, 0, y, alpha=0.3, color='blue')
        
        # 跃前、跃后标注
        ax.plot([0, 0], [0, h1], 'r--', linewidth=2, label=f'跃前h₁={h1:.2f}m')
        ax.plot([L_j, L_j], [0, h2], 'g--', linewidth=2, label=f'跃后h₂={h2:.2f}m')
        
        # 水跃长度标注
        ax.annotate('', xy=(L_j, h2+0.3), xytext=(0, h2+0.3),
                   arrowprops=dict(arrowstyle='<->', color='orange', lw=2))
        ax.text(L_j/2, h2+0.4, f'水跃长度 L_j={L_j:.1f}m',
               ha='center', fontsize=11, color='orange')
        
        # 紊动标注（示意）
        for i in range(5):
            x_turb = L_j * (0.2 + 0.15*i)
            y_turb = h1 + (h2 - h1) * (x_turb / L_j)**0.5
            circle = plt.Circle((x_turb, y_turb*0.6), 0.15, 
                               color='cyan', alpha=0.3)
            ax.add_patch(circle)
        
        ax.set_xlabel('距离 (m)', fontsize=12)
        ax.set_ylabel('水深 (m)', fontsize=12)
        ax.set_title(f'水跃纵剖面 (Fr₁={Fr1:.2f})', fontsize=14)
        ax.legend(loc='upper left')
        ax.grid(True, alpha=0.3)
        ax.set_ylim([-0.5, h2+1])
        ax.set_aspect('equal')
        
        plt.tight_layout()
        plt.savefig('hydraulic_jump_profile.png', dpi=300)
        plt.show()
    
    def plot_conjugate_depth_curve(self):
        """绘制共轭水深曲线"""
        Fr1_range = np.linspace(1, 10, 100)
        
        fig, axes = plt.subplots(1, 2, figsize=(16, 6))
        
        # (a) h₂/h₁ vs Fr₁
        h_ratio = [self.conjugate_depth(1.0, Fr) for Fr in Fr1_range]
        
        axes[0].plot(Fr1_range, h_ratio, 'b-', linewidth=2)
        axes[0].set_xlabel('跃前弗劳德数 Fr₁', fontsize=12)
        axes[0].set_ylabel('水深比 h₂/h₁', fontsize=12)
        axes[0].set_title('共轭水深比曲线', fontsize=14)
        axes[0].grid(True, alpha=0.3)
        
        # 标注水跃类型区域
        axes[0].axvspan(1.0, 1.7, alpha=0.1, color='green', label='波状')
        axes[0].axvspan(1.7, 2.5, alpha=0.1, color='yellow', label='弱')
        axes[0].axvspan(2.5, 4.5, alpha=0.1, color='orange', label='振荡')
        axes[0].axvspan(4.5, 9.0, alpha=0.1, color='blue', label='稳定')
        axes[0].axvspan(9.0, 10, alpha=0.1, color='red', label='强')
        axes[0].legend(loc='upper left')
        
        # (b) 消能率 vs Fr₁
        eta_list = []
        for Fr in Fr1_range:
            h2 = self.conjugate_depth(1.0, Fr)
            _, eta = self.energy_loss(1.0, h2)
            eta_list.append(eta)
        
        axes[1].plot(Fr1_range, eta_list, 'r-', linewidth=2)
        axes[1].set_xlabel('跃前弗劳德数 Fr₁', fontsize=12)
        axes[1].set_ylabel('消能率 (%)', fontsize=12)
        axes[1].set_title('水跃消能率曲线', fontsize=14)
        axes[1].grid(True, alpha=0.3)
        axes[1].set_ylim([0, 100])
        
        plt.tight_layout()
        plt.savefig('conjugate_depth_curves.png', dpi=300)
        plt.show()

# 示例1：水跃计算
print("="*60)
print("示例1：水跃基本计算")
print("="*60)

hj = HydraulicJump()

# 已知条件
h1 = 0.5  # m
v1 = 8.0  # m/s
Fr1 = v1 / np.sqrt(hj.g * h1)

print(f"已知条件:")
print(f"  跃前水深 h₁ = {h1} m")
print(f"  跃前流速 v₁ = {v1} m/s")
print(f"  跃前Fr数 Fr₁ = {Fr1:.2f}")

# 共轭水深
h2 = hj.conjugate_depth(h1, Fr1)

print(f"\n共轭水深:")
print(f"  跃后水深 h₂ = {h2:.2f} m")
print(f"  水深比 h₂/h₁ = {h2/h1:.2f}")

# 跃后流速
v2 = v1 * h1 / h2
Fr2 = v2 / np.sqrt(hj.g * h2)

print(f"\n跃后参数:")
print(f"  跃后流速 v₂ = {v2:.2f} m/s")
print(f"  跃后Fr数 Fr₂ = {Fr2:.2f}")

# 水跃长度
L_j = hj.jump_length(h1, h2)

print(f"\n水跃长度:")
print(f"  L_j = {L_j:.2f} m")

# 能量损失
delta_E, eta = hj.energy_loss(h1, h2)

print(f"\n能量损失:")
print(f"  ΔE = {delta_E:.2f} m")
print(f"  消能率 η = {eta:.1f}%")

# 水跃类型
jump_type = hj.jump_type(Fr1)

print(f"\n水跃类型: {jump_type}")

# 绘制水跃剖面
hj.plot_jump_profile(h1, Fr1)

# 示例2：消力池设计
print("\n" + "="*60)
print("示例2：消力池设计")
print("="*60)

Q = 50  # m³/s
b = 10  # m

design_params = hj.stilling_basin_design(Q, b, h1, h2)

print(f"消力池设计参数:")
print(f"  设计流量: {Q} m³/s")
print(f"  池宽: {b} m")
print(f"  池长: {design_params['length']:.1f} m")
print(f"  池深: {design_params['depth']:.1f} m")
print(f"  底板降低: {design_params['elevation_drop']:.2f} m")
print(f"  消能率: {design_params['energy_dissipation_rate']:.1f}%")

# 示例3：共轭水深曲线
print("\n" + "="*60)
print("示例3：共轭水深与消能率曲线")
print("="*60)

hj.plot_conjugate_depth_curve()

print("曲线分析:")
print("  - Fr₁增大,h₂/h₁增大（非线性）")
print("  - 消能率随Fr₁增大而增大,最高可达85%")
print("  - 稳定水跃(Fr₁=4.5-9.0)消能效果最佳")
```

---

## 三、水跃类型

### 3.1 分类

| Fr₁范围 | 类型 | 特征 | 消能率 |
|---------|------|------|--------|
| 1.0-1.7 | 波状水跃 | 水面波动，能量损失小 | <20% |
| 1.7-2.5 | 弱水跃 | 小旋滚，较稳定 | 20-45% |
| 2.5-4.5 | 振荡水跃 | 不稳定，下游脉动大 | 45-70% |
| 4.5-9.0 | 稳定水跃 | 稳定消能，工程常用 | 70-85% |
| >9.0 | 强水跃 | 水深比大，能量集中 | >85% |

### 3.2 工程选择

**推荐**：$Fr_1 = 4.5-9.0$（稳定水跃）

---

## 四、典型考题

### 【例题】水跃计算

**题目**（25分）

矩形明渠，b=8m，Q=40m³/s，跃前水深h₁=0.6m。求：
1) 跃前Fr数
2) 共轭水深h₂
3) 水跃长度
4) 能量损失

**【解答】**

(1) **跃前参数**（6分）

$$v_1 = \frac{Q}{bh_1} = \frac{40}{8 \times 0.6} = 8.33 \text{ m/s}$$

$$Fr_1 = \frac{v_1}{\sqrt{gh_1}} = \frac{8.33}{\sqrt{9.81 \times 0.6}} = 3.43$$

(2) **共轭水深**（8分）

$$h_2 = \frac{h_1}{2}(\sqrt{1 + 8Fr_1^2} - 1)$$

$$h_2 = \frac{0.6}{2}(\sqrt{1 + 8 \times 3.43^2} - 1) = 2.54 \text{ m}$$

(3) **水跃长度**（6分）

$$L_j = 5(h_2 - h_1) = 5 \times (2.54 - 0.6) = 9.7 \text{ m}$$

(4) **能量损失**（5分）

$$\Delta E = \frac{(h_2 - h_1)^3}{4h_1 h_2} = \frac{1.94^3}{4 \times 0.6 \times 2.54} = 1.20 \text{ m}$$

---

**本章重点**：
- 共轭水深公式（必考）
- 水跃类型判断
- 消能率计算
- 消力池设计
