# 第2章：边界层理论

**创始人**: Prandtl (1904)  
**重要性**: ⭐⭐⭐⭐⭐

---

## 一、边界层概念

### 1.1 定义

**边界层**：固体壁面附近，粘性力显著的薄层

**特征**：
- 厚度$\delta$很小
- 速度梯度$\frac{du}{dy}$很大
- 粘性应力$\tau = \mu \frac{du}{dy}$显著

### 1.2 边界层厚度

**定义**：$u = 0.99 u_{\infty}$处的$y$值

**数量级**：
$$\delta \sim \sqrt{\frac{\nu x}{U}}$$

---

## 二、平板边界层

### 2.1 层流边界层

**Blasius精确解**（$Re_x < 5 \times 10^5$）：

**边界层厚度**：
$$\delta = \frac{5x}{\sqrt{Re_x}} = \frac{5x}{\sqrt{Ux/\nu}}$$

**壁面摩擦应力**：
$$\tau_0 = 0.332 \rho U^2 \sqrt{\frac{\nu}{Ux}}$$

**局部摩擦系数**：
$$C_f = \frac{\tau_0}{\frac{1}{2}\rho U^2} = \frac{0.664}{\sqrt{Re_x}}$$

### 2.2 湍流边界层

**$Re_x > 5 \times 10^5$**

**边界层厚度**（1/7次方律）：
$$\delta = \frac{0.37x}{Re_x^{1/5}}$$

**摩擦系数**：
$$C_f = \frac{0.059}{Re_x^{1/5}}$$

### 2.3 转捩

**临界雷诺数**：
$$Re_{x,cr} = \frac{U x_{cr}}{\nu} \approx 5 \times 10^5$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class BoundaryLayerTheory:
    """边界层理论"""
    
    def __init__(self, U=10, nu=1e-6):
        """
        参数:
            U: 来流速度 (m/s)
            nu: 运动粘度 (m²/s)
        """
        self.U = U
        self.nu = nu
    
    def reynolds_number(self, x):
        """雷诺数 Re_x = Ux/ν"""
        return self.U * x / self.nu
    
    def laminar_thickness(self, x):
        """
        层流边界层厚度
        
        δ = 5x / √(Re_x)
        """
        Re_x = self.reynolds_number(x)
        delta = 5 * x / np.sqrt(Re_x)
        return delta
    
    def turbulent_thickness(self, x):
        """
        湍流边界层厚度
        
        δ = 0.37x / Re_x^(1/5)
        """
        Re_x = self.reynolds_number(x)
        delta = 0.37 * x / (Re_x**0.2)
        return delta
    
    def laminar_friction_coefficient(self, x):
        """
        层流摩擦系数
        
        C_f = 0.664 / √(Re_x)
        """
        Re_x = self.reynolds_number(x)
        C_f = 0.664 / np.sqrt(Re_x)
        return C_f
    
    def turbulent_friction_coefficient(self, x):
        """
        湍流摩擦系数
        
        C_f = 0.059 / Re_x^(1/5)
        """
        Re_x = self.reynolds_number(x)
        C_f = 0.059 / (Re_x**0.2)
        return C_f
    
    def velocity_profile_laminar(self, x, y_points=100):
        """
        层流边界层速度分布（Blasius解的近似）
        
        u/U ≈ f(η), η = y√(U/(νx))
        """
        delta = self.laminar_thickness(x)
        y = np.linspace(0, delta, y_points)
        
        # 简化近似（实际需要数值求解Blasius方程）
        eta = y * np.sqrt(self.U / (self.nu * x))
        
        # Blasius解的近似多项式
        u_ratio = np.zeros_like(eta)
        for i, eta_val in enumerate(eta):
            if eta_val < 5:
                u_ratio[i] = eta_val / 5  # 线性近似
            else:
                u_ratio[i] = 1.0
        
        u = u_ratio * self.U
        
        return y, u
    
    def velocity_profile_turbulent(self, x, y_points=100):
        """
        湍流边界层速度分布（1/7次方律）
        
        u/U = (y/δ)^(1/7)
        """
        delta = self.turbulent_thickness(x)
        y = np.linspace(0, delta, y_points)
        
        u = self.U * (y / delta)**(1/7)
        
        return y, u
    
    def plot_boundary_layer_growth(self, x_max=2):
        """绘制边界层发展"""
        x = np.linspace(0.01, x_max, 200)
        
        # 临界位置
        x_cr = 5e5 * self.nu / self.U
        
        # 计算厚度
        delta_lam = np.array([self.laminar_thickness(xi) 
                             if xi < x_cr else np.nan 
                             for xi in x])
        delta_turb = np.array([self.turbulent_thickness(xi)
                              if xi >= x_cr else np.nan
                              for xi in x])
        
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # 边界层厚度
        axes[0, 0].plot(x[x < x_cr], delta_lam[x < x_cr]*1000, 
                       'b-', linewidth=2, label='层流')
        axes[0, 0].plot(x[x >= x_cr], delta_turb[x >= x_cr]*1000,
                       'r-', linewidth=2, label='湍流')
        axes[0, 0].axvline(x_cr, color='k', linestyle='--',
                          label=f'转捩点 x={x_cr:.3f}m')
        axes[0, 0].set_xlabel('距离 x (m)', fontsize=12)
        axes[0, 0].set_ylabel('边界层厚度 δ (mm)', fontsize=12)
        axes[0, 0].set_title('边界层发展', fontsize=14)
        axes[0, 0].legend()
        axes[0, 0].grid(True, alpha=0.3)
        
        # 雷诺数
        Re_x = [self.reynolds_number(xi) for xi in x]
        axes[0, 1].plot(x, Re_x, 'g-', linewidth=2)
        axes[0, 1].axhline(5e5, color='r', linestyle='--',
                          label='临界Re')
        axes[0, 1].set_xlabel('距离 x (m)', fontsize=12)
        axes[0, 1].set_ylabel('Re_x', fontsize=12)
        axes[0, 1].set_title('雷诺数分布', fontsize=14)
        axes[0, 1].legend()
        axes[0, 1].grid(True, alpha=0.3)
        axes[0, 1].set_yscale('log')
        
        # 摩擦系数
        C_f_lam = np.array([self.laminar_friction_coefficient(xi)
                           if xi < x_cr else np.nan
                           for xi in x])
        C_f_turb = np.array([self.turbulent_friction_coefficient(xi)
                            if xi >= x_cr else np.nan
                            for xi in x])
        
        axes[1, 0].plot(x[x < x_cr], C_f_lam[x < x_cr]*1000,
                       'b-', linewidth=2, label='层流')
        axes[1, 0].plot(x[x >= x_cr], C_f_turb[x >= x_cr]*1000,
                       'r-', linewidth=2, label='湍流')
        axes[1, 0].set_xlabel('距离 x (m)', fontsize=12)
        axes[1, 0].set_ylabel('摩擦系数 C_f × 1000', fontsize=12)
        axes[1, 0].set_title('摩擦系数', fontsize=14)
        axes[1, 0].legend()
        axes[1, 0].grid(True, alpha=0.3)
        
        # 速度剖面对比
        x_lam = x_cr * 0.5
        x_turb = x_cr * 2
        
        y_lam, u_lam = self.velocity_profile_laminar(x_lam)
        y_turb, u_turb = self.velocity_profile_turbulent(x_turb)
        
        axes[1, 1].plot(u_lam/self.U, y_lam*1000, 'b-',
                       linewidth=2, label=f'层流 (x={x_lam:.3f}m)')
        axes[1, 1].plot(u_turb/self.U, y_turb*1000, 'r-',
                       linewidth=2, label=f'湍流 (x={x_turb:.3f}m)')
        axes[1, 1].set_xlabel('u/U', fontsize=12)
        axes[1, 1].set_ylabel('y (mm)', fontsize=12)
        axes[1, 1].set_title('速度剖面对比', fontsize=14)
        axes[1, 1].legend()
        axes[1, 1].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('boundary_layer_development.png', dpi=300)
        plt.show()

# 示例
print("="*60)
print("边界层理论分析")
print("="*60)

# 创建边界层模型
bl = BoundaryLayerTheory(U=10, nu=1e-6)

print(f"参数:")
print(f"  来流速度 U = {bl.U} m/s")
print(f"  运动粘度 ν = {bl.nu} m²/s")

# 临界位置
x_cr = 5e5 * bl.nu / bl.U
print(f"\n转捩:")
print(f"  临界雷诺数 Re_cr = 5×10⁵")
print(f"  临界位置 x_cr = {x_cr:.3f} m")

# 特定位置分析
x_test = [0.1, 0.5, 1.0, 2.0]

print(f"\n{'x(m)':>8s} {'Re_x':>12s} {'δ(mm)':>10s} {'C_f×1000':>12s} {'类型':>8s}")
print("-" * 55)

for x in x_test:
    Re_x = bl.reynolds_number(x)
    
    if Re_x < 5e5:
        delta = bl.laminar_thickness(x)
        C_f = bl.laminar_friction_coefficient(x)
        flow_type = "层流"
    else:
        delta = bl.turbulent_thickness(x)
        C_f = bl.turbulent_friction_coefficient(x)
        flow_type = "湍流"
    
    print(f"{x:8.2f} {Re_x:12.2e} {delta*1000:10.3f} {C_f*1000:12.4f} {flow_type:>8s}")

# 可视化
bl.plot_boundary_layer_growth(x_max=2.0)
```

---

## 三、边界层分离

### 3.1 分离条件

$$\left(\frac{\partial u}{\partial y}\right)_{y=0} = 0$$

### 3.2 逆压梯度

$$\frac{dp}{dx} > 0 \Rightarrow \text{易分离}$$

### 3.3 工程影响

- 阻力增大
- 升力下降
- 流动不稳定

---

## 四、典型考题

### 【例题】边界层计算

**题目**：平板，U=5m/s，ν=1.5×10⁻⁵m²/s，x=0.3m处，求：
1. Re_x
2. 边界层厚度
3. 摩擦系数

**解**：

(1) $Re_x = \frac{Ux}{\nu} = \frac{5 \times 0.3}{1.5 \times 10^{-5}} = 1 \times 10^5$（层流）

(2) $\delta = \frac{5x}{\sqrt{Re_x}} = \frac{5 \times 0.3}{\sqrt{1 \times 10^5}} = 4.74 \text{ mm}$

(3) $C_f = \frac{0.664}{\sqrt{Re_x}} = \frac{0.664}{\sqrt{1 \times 10^5}} = 0.0021$

---

**本章重点**：
- 边界层概念
- Blasius解
- 层流/湍流边界层特性
- 分离现象
