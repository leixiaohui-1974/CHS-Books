# 第1章：湍流基础理论

**难度**: ⭐⭐⭐⭐⭐  
**重要性**: ⭐⭐⭐⭐⭐

---

## 一、湍流特征

### 1.1 定义

**湍流**：流体质点无规则运动，各物理量随时间随机脉动

### 1.2 特征

1. **不规则性**：时空随机变化
2. **扩散性**：强烈混掺
3. **耗散性**：机械能转化为热能
4. **多尺度涡旋**：从大涡到小涡

---

## 二、雷诺分解

### 2.1 瞬时值分解

$$u = \bar{u} + u'$$

- $\bar{u}$：时均值
- $u'$：脉动值

### 2.2 时均运算规则

$$\overline{u + v} = \bar{u} + \bar{v}$$
$$\overline{cu} = c\bar{u}$$
$$\overline{u'} = 0$$
$$\overline{u'v'} \neq 0$$

---

## 三、雷诺方程

### 3.1 推导

对N-S方程时均化：

$$\frac{\partial \bar{u}_i}{\partial t} + \bar{u}_j \frac{\partial \bar{u}_i}{\partial x_j} = -\frac{1}{\rho}\frac{\partial \bar{p}}{\partial x_i} + \nu \frac{\partial^2 \bar{u}_i}{\partial x_j^2} - \frac{\partial \overline{u_i' u_j'}}{\partial x_j}$$

### 3.2 雷诺应力

$$\tau_{ij} = -\rho \overline{u_i' u_j'}$$

物理意义：湍流脉动引起的附加应力

---

## 四、湍流模型

### 4.1 零方程模型

**混合长度理论**（Prandtl）：

$$\tau = \rho l^2 \left|\frac{du}{dy}\right| \frac{du}{dy}$$

$l$：混合长度

### 4.2 k-ε模型

**湍动能**：$k = \frac{1}{2}\overline{u_i' u_i'}$

**耗散率**：$\varepsilon$

```python
import numpy as np
import matplotlib.pyplot as plt

class TurbulenceModel:
    """湍流模型"""
    
    @staticmethod
    def reynolds_decomposition(u_instantaneous, time_window=100):
        """
        雷诺分解
        
        u = ū + u'
        """
        # 时均值（移动平均）
        u_mean = np.convolve(u_instantaneous, 
                            np.ones(time_window)/time_window, 
                            mode='same')
        
        # 脉动值
        u_fluctuation = u_instantaneous - u_mean
        
        return u_mean, u_fluctuation
    
    @staticmethod
    def turbulence_intensity(u_fluctuation):
        """
        湍流强度
        
        I = √(u'²) / ū
        """
        rms = np.sqrt(np.mean(u_fluctuation**2))
        return rms
    
    @staticmethod
    def reynolds_stress(u_fluc, v_fluc):
        """
        雷诺应力
        
        τ = -ρ·u'v'‾
        """
        rho = 1000  # kg/m³
        uv_bar = np.mean(u_fluc * v_fluc)
        tau = -rho * uv_bar
        return tau
    
    @staticmethod
    def plot_turbulent_signal():
        """绘制湍流信号"""
        # 生成模拟湍流信号
        t = np.linspace(0, 10, 1000)
        u_mean = 5  # m/s
        
        # 叠加多个频率
        u = u_mean
        for freq in [1, 3, 7, 15]:
            amplitude = 1 / freq
            u += amplitude * np.sin(2*np.pi*freq*t + np.random.rand())
        
        # 雷诺分解
        u_avg, u_prime = TurbulenceModel.reynolds_decomposition(u, 50)
        
        fig, axes = plt.subplots(3, 1, figsize=(12, 10))
        
        # 瞬时速度
        axes[0].plot(t, u, 'b-', linewidth=0.5, alpha=0.7)
        axes[0].set_ylabel('u (m/s)')
        axes[0].set_title('瞬时速度')
        axes[0].grid(True, alpha=0.3)
        
        # 时均速度
        axes[1].plot(t, u_avg, 'r-', linewidth=2)
        axes[1].set_ylabel('ū (m/s)')
        axes[1].set_title('时均速度')
        axes[1].grid(True, alpha=0.3)
        
        # 脉动速度
        axes[2].plot(t, u_prime, 'g-', linewidth=0.5)
        axes[2].set_xlabel('时间 (s)')
        axes[2].set_ylabel("u' (m/s)")
        axes[2].set_title('脉动速度')
        axes[2].grid(True, alpha=0.3)
        
        plt.tight_layout()
        plt.savefig('turbulence_signal.png', dpi=300)
        plt.show()
        
        # 统计特性
        I = TurbulenceModel.turbulence_intensity(u_prime)
        print(f"湍流强度: {I/u_mean*100:.1f}%")

# 示例
print("="*60)
print("湍流信号分析")
print("="*60)

TurbulenceModel.plot_turbulent_signal()
```

---

## 五、典型考题

### 【例题】雷诺应力

**题目**：$\bar{u}=5$ m/s，$u'_{rms}=0.5$ m/s，$v'_{rms}=0.3$ m/s，$\overline{u'v'}=-0.1$ m²/s²，求雷诺应力

**解**：
$$\tau = -\rho \overline{u'v'} = -1000 \times (-0.1) = 100 \text{ Pa}$$

---

**本章重点**：
- 雷诺分解
- 雷诺方程
- 湍流模型基础
