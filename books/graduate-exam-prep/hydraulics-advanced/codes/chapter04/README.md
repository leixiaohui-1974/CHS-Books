# 第04章 地下水与渗流 - 代码实现

## 📋 概述

本目录包含第04章"地下水与渗流"的Python代码实现，涵盖3个核心题目，共计约2200行高质量代码。

**完成状态**: ✅ 100%完成（5/5程序）

## 📁 文件清单

### 1. 达西定律基础
**文件**: `ch04_problem01_darcy_law.py` (640行)  
**难度**: ⭐⭐⭐ 基础  
**核心知识**:
- 达西定律 v = ki
- 水力坡度 i = Δh/L
- 渗透流速与实际流速 u = v/n
- 单宽流量 q = vH

**主要功能**:
- 水力坡度计算
- 渗透流速计算（达西定律）
- 实际流速计算
- 单宽流量计算
- 渗透系数影响分析
- 水力坡度影响分析
- 土层厚度影响分析
- 孔隙率影响分析
- 9个专业图表

---

### 2. 承压完整井计算
**文件**: `ch04_problem03_well_flow.py` (644行)  
**难度**: ⭐⭐⭐⭐ 强化  
**核心知识**:
- 承压井公式 Q = 2πkM(H₀-hw)/ln(R/r₀)
- 水头分布 h(r) = H₀ - Q/(2πkM)·ln(R/r)
- 叠加原理（多井干扰）
- 影响半径计算

**主要功能**:
- 井出水量计算
- 任意半径处水头计算
- 水头分布曲线（对数坐标）
- 降深分布分析
- 流线与等水头线绘制
- 两井干扰计算（叠加原理）
- 渗透系数影响分析
- 影响半径影响分析
- 9个专业图表

---

### 3. 渗流场流网分析
**文件**: `ch04_problem06_seepage_network.py` (753行)  
**难度**: ⭐⭐⭐⭐ 强化  
**核心知识**:
- 渗流网理论（流线、等势线）
- 流网法计算流量 q = k·ΔH·(m/n)
- 达西定律 q = k·i·T
- 渗透稳定性分析

**主要功能**:
- 渗流网绘制（流线与等势线）
- 单宽流量计算（流网法、达西法）
- 水头沿程分布
- 渗透流速计算
- 出口坡降与临界坡降
- 渗透稳定安全系数
- 渗透系数影响分析
- 水头差影响分析
- 9个专业图表

---

### 4. 非稳定井流（Theis公式）
**文件**: `ch04_problem09_unsteady_flow.py` (710行)  
**难度**: ⭐⭐⭐⭐⭐ 综合  
**核心知识**:
- Theis公式 s = Q/(4πT)·W(u)
- 无量纲参数 u = r²S/(4Tt)
- 井函数W(u)
- Jacob近似（u<0.01时）
- 叠加原理（水位恢复）

**主要功能**:
- Theis公式计算降深
- 井函数W(u)计算
- Jacob近似计算
- 水位恢复计算（叠加原理）
- 降深随时间变化曲线
- 降深随距离变化曲线
- Theis vs Jacob对比
- 贮水系数影响分析
- 9个专业图表

---

### 5. 基坑降水设计（综合应用）
**文件**: `ch04_problem15_dewatering_design.py` (887行)  
**难度**: ⭐⭐⭐⭐⭐ 综合  
**核心知识**:
- 大井法（等效半径）
- 裘布依公式（潜水井）
- 井群干扰系数
- 降水井布置设计

**主要功能**:
- 所需降深计算
- 等效半径计算（r_e = 0.29(L+B)）
- 大井出水量（裘布依公式）
- 井数确定（环形布井）
- 总抽水量（考虑干扰）
- 降水井布置方案
- 降深影响分析
- 渗透系数影响分析
- 井间距优化
- 9个专业图表

---

## 🎯 代码特色

### 1. 完整的理论体系
- **达西定律**: 渗流基础理论
- **稳定井流**: 承压井完整解
- **非稳定井流**: Theis公式与Jacob近似

### 2. 先进的数值方法
- **井函数计算**: scipy.special.exp1
- **对数坐标**: semilogx, loglog
- **叠加原理**: 多井干扰、水位恢复

### 3. 丰富的可视化
- **45个专业图表**: 平均每程序9个
- **对数坐标图**: 水头分布、降深曲线
- **流线图**: 等水头线、径向流线、渗流网
- **时间曲线**: 降深随时间变化
- **平面布置图**: 降水井环形布置

### 4. 工程实用价值
- 直接可用于工程计算
- 多参数敏感性分析
- 优化设计建议
- 完整的考试要点

## 🔧 使用方法

### 环境要求
```bash
Python >= 3.8
numpy >= 1.20.0
matplotlib >= 3.3.0
scipy >= 1.6.0
```python

### 运行示例
```bash
# 运行达西定律
python ch04_problem01_darcy_law.py

# 运行井流计算
python ch04_problem03_well_flow.py

# 运行非稳定流
python ch04_problem09_unsteady_flow.py
```

## 📊 代码统计

| 程序 | 文件名 | 行数 | 可视化 |
|------|--------|------|--------|
| 题1 | ch04_problem01_darcy_law.py | 640 | 9图 |
| 题3 | ch04_problem03_well_flow.py | 644 | 9图 |
| 题6 | ch04_problem06_seepage_network.py | 753 | 9图 |
| 题9 | ch04_problem09_unsteady_flow.py | 710 | 9图 |
| 题15 | ch04_problem15_dewatering_design.py | 887 | 9图 |
| **总计** | **5个文件** | **3,634** | **45图** |

## 🎓 学习建议

### 基础学习路径
1. **题1：达西定律** → 理解渗流基本定律
2. **题3：承压井** → 掌握稳定井流理论

### 进阶学习路径
3. **题6：渗流网** → 学习流网法与渗透稳定性
4. **题9：非稳定流** → 深入Theis公式与叠加原理

### 综合应用路径
5. **题15：基坑降水** → 掌握工程设计全流程

### 考研重点
- 达西定律（必考基础）
- 承压井出水量（常考）
- 渗流网绘制与流网法（常考）
- 渗透稳定性（重要）
- Theis公式（重点难点）
- 叠加原理（多井干扰、水位恢复）
- 基坑降水设计（综合应用）

## 💡 典型考题

### 例1：达西定律（基础题）
> 砂土层，k=20m/d，i=0.02，H=5m，求流量。

**解答**: 运行 `ch04_problem01_darcy_law.py`

### 例2：承压井（强化题）
> 承压含水层，M=10m，k=8m/d，求井的出水量。

**解答**: 运行 `ch04_problem03_well_flow.py`

### 例3：渗流网（强化题）
> 绘制坝基渗流网，计算单宽流量和渗透稳定性。

**解答**: 运行 `ch04_problem06_seepage_network.py`

### 例4：非稳定井流（难题）
> 用Theis公式计算抽水1h后r=100m处的降深。

**解答**: 运行 `ch04_problem09_unsteady_flow.py`

### 例5：基坑降水（综合题）
> 设计基坑降水方案，确定井数和总抽水量。

**解答**: 运行 `ch04_problem15_dewatering_design.py`

## 📚 参考资料

1. 《地下水动力学》，薛禹群主编
2. 《地下水水文学》，陈崇希主编
3. 各大高校考研真题（985/211）

## 📝 更新日志

### v1.0 - 2025-11-07
- ✅ 完成题1：达西定律基础（640行）
- ✅ 完成题3：承压完整井计算（644行）
- ✅ 完成题6：渗流场流网分析（753行）
- ✅ 完成题9：非稳定井流（710行）
- ✅ 完成题15：基坑降水设计（887行）
- ✅ 总计3,634行代码
- ✅ 包含45个专业图表
- ✅ 第4章100%完成

---

**作者**: CHS-Books Team  
**日期**: 2025-11-07  
**状态**: ✅ 100%完成
