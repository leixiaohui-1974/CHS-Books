# 第04章 地下水与渗流 - 代码实现

## 📋 概述

本目录包含第04章"地下水与渗流"的Python代码实现，涵盖3个核心题目，共计约2200行高质量代码。

**完成状态**: ✅ 核心内容完成（3/3程序，60%）

## 📁 文件清单

### 1. 达西定律基础
**文件**: `ch04_problem01_darcy_law.py` (约640行)  
**难度**: ⭐⭐⭐ 基础  
**核心知识**:
- 达西定律 v = ki
- 水力坡度 i = Δh/L
- 渗透流速与实际流速 u = v/n
- 单宽流量 q = vH

**主要功能**:
- 水力坡度计算
- 渗透流速计算（达西定律）
- 实际流速计算
- 单宽流量计算
- 渗透系数影响分析
- 水力坡度影响分析
- 土层厚度影响分析
- 孔隙率影响分析
- 9个专业图表

---

### 2. 承压完整井计算
**文件**: `ch04_problem03_well_flow.py` (约644行)  
**难度**: ⭐⭐⭐⭐ 强化  
**核心知识**:
- 承压井公式 Q = 2πkM(H₀-hw)/ln(R/r₀)
- 水头分布 h(r) = H₀ - Q/(2πkM)·ln(R/r)
- 叠加原理（多井干扰）
- 影响半径计算

**主要功能**:
- 井出水量计算
- 任意半径处水头计算
- 水头分布曲线（对数坐标）
- 降深分布分析
- 流线与等水头线绘制
- 两井干扰计算（叠加原理）
- 渗透系数影响分析
- 影响半径影响分析
- 9个专业图表

---

### 3. 非稳定井流（Theis公式）
**文件**: `ch04_problem09_unsteady_flow.py` (约710行)  
**难度**: ⭐⭐⭐⭐⭐ 强化  
**核心知识**:
- Theis公式 s = Q/(4πT)·W(u)
- 无量纲参数 u = r²S/(4Tt)
- 井函数W(u)
- Jacob近似（u<0.01时）
- 叠加原理（水位恢复）

**主要功能**:
- Theis公式计算降深
- 井函数W(u)计算
- Jacob近似计算
- 水位恢复计算（叠加原理）
- 降深随时间变化曲线
- 降深随距离变化曲线
- Theis vs Jacob对比
- 贮水系数影响分析
- 9个专业图表

---

## 🎯 代码特色

### 1. 完整的理论体系
- **达西定律**: 渗流基础理论
- **稳定井流**: 承压井完整解
- **非稳定井流**: Theis公式与Jacob近似

### 2. 先进的数值方法
- **井函数计算**: scipy.special.exp1
- **对数坐标**: semilogx, loglog
- **叠加原理**: 多井干扰、水位恢复

### 3. 丰富的可视化
- **27个专业图表**: 平均每程序9个
- **对数坐标图**: 水头分布、降深曲线
- **流线图**: 等水头线、径向流线
- **时间曲线**: 降深随时间变化

### 4. 工程实用价值
- 直接可用于工程计算
- 多参数敏感性分析
- 优化设计建议
- 完整的考试要点

## 🔧 使用方法

### 环境要求
```bash
Python >= 3.8
numpy >= 1.20.0
matplotlib >= 3.3.0
scipy >= 1.6.0
```

### 运行示例
```bash
# 运行达西定律
python ch04_problem01_darcy_law.py

# 运行井流计算
python ch04_problem03_well_flow.py

# 运行非稳定流
python ch04_problem09_unsteady_flow.py
```

## 📊 代码统计

| 程序 | 文件名 | 行数 | 可视化 |
|------|--------|------|--------|
| 题1 | ch04_problem01_darcy_law.py | 640 | 9图 |
| 题3 | ch04_problem03_well_flow.py | 644 | 9图 |
| 题9 | ch04_problem09_unsteady_flow.py | 710 | 9图 |
| **总计** | **3个文件** | **~2000** | **27图** |

## 🎓 学习建议

### 基础学习路径
1. **题1：达西定律** → 理解渗流基本定律
2. **题3：承压井** → 掌握稳定井流理论

### 进阶学习路径
3. **题9：非稳定流** → 深入Theis公式与叠加原理

### 考研重点
- 达西定律（必考基础）
- 承压井出水量（常考）
- Theis公式（重点难点）
- 叠加原理（多井干扰、水位恢复）

## 💡 典型考题

### 例1：达西定律（基础题）
> 砂土层，k=20m/d，i=0.02，H=5m，求流量。

**解答**: 运行 `ch04_problem01_darcy_law.py`

### 例2：承压井（强化题）
> 承压含水层，M=10m，k=8m/d，求井的出水量。

**解答**: 运行 `ch04_problem03_well_flow.py`

### 例3：非稳定井流（难题）
> 用Theis公式计算抽水1h后r=100m处的降深。

**解答**: 运行 `ch04_problem09_unsteady_flow.py`

## 📚 参考资料

1. 《地下水动力学》，薛禹群主编
2. 《地下水水文学》，陈崇希主编
3. 各大高校考研真题（985/211）

## 📝 更新日志

### v1.0 - 2025-11-07
- ✅ 完成题1：达西定律基础（640行）
- ✅ 完成题3：承压完整井计算（644行）
- ✅ 完成题9：非稳定井流（710行）
- ✅ 总计约2000行代码
- ✅ 包含27个专业图表
- ✅ 核心内容60%完成

---

**作者**: CHS-Books Team  
**日期**: 2025-11-07  
**状态**: ✅ 核心内容完成
