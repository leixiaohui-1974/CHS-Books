# 第11章 水工建筑物 - 代码实现

## 目录结构

```python
chapter11/
├── ch11_problem01_gravity_dam_stability.py    # 题1：重力坝稳定分析
├── ch11_problem02_arch_dam_stress.py          # 题2：拱坝应力分析
├── ch11_problem04_spillway_design.py          # 题4：溢洪道水力设计
├── ch11_problem07_sluice_operation.py         # 题7：水闸调度运行
├── ch11_problem10_earth_dam_design.py         # 题10：土石坝设计
├── ch11_problem13_comprehensive.py            # 题13：综合水利枢纽布置
└── README.md
```

## 核心内容

### 1. 重力坝稳定分析（题1）

**问题描述：**
混凝土重力坝，坝高H = 50m，坝顶宽b = 6m，上游坡比m₁ = 0.1，下游坡比m₂ = 0.8，上游水深h₁ = 45m，下游水深h₂ = 5m，混凝土重度γc = 24 kN/m³，扬压力折减系数α = 0.3。

**核心公式：**
```python
1. 抗滑稳定：Kc = f·ΣV/ΣH ≥ 1.05
2. 抗倾覆：K₀ = ΣM稳/ΣM倾 ≥ 1.5
3. 坝底应力：σ = ΣV/B ± 6ΣM/B²
4. 扬压力：U = (1/2)γw·(h₁+αh₁)·B
```

**主要功能：**
- 坝体自重与作用点计算
- 水压力与扬压力计算
- 抗滑与抗倾覆稳定验算
- 坝底应力分布分析
- 坝高影响分析

**可视化输出：**
- 坝体断面与荷载示意图
- 荷载汇总柱状图
- 安全系数对比
- 坝底应力分布曲线
- 坝高影响曲线

---

### 2. 拱坝应力分析（题2）

**问题描述：**
双曲拱坝，坝顶高程300m，河床高程200m，拱冠梁顶部厚度dt = 6m，底部厚度db = 40m，拱冠梁顶部半径Rt = 150m，底部半径Rb = 100m，上游水位285m，混凝土弹性模量E = 25GPa。

**核心公式：**
```python
1. 水压力：p = γw·h
2. 拱向应力：σθ = p·R/d
3. 梁向应力：σz = M/(d²/6)
4. 拱梁分载：η = Ka/(Ka+Kb)
```

**主要功能：**
- 拱坝几何参数计算
- 坝厚与半径沿高程分布
- 拱向应力与梁向应力分析
- 拱梁分载比计算
- 安全系数验算

**可视化输出：**
- 拱坝纵剖面图
- 坝厚与半径分布曲线
- 水压力分布
- 拱向与梁向应力分布
- 拱梁分载比曲线

---

### 3. 溢洪道水力设计（题4）

**问题描述：**
某水库需设计溢洪道，设计流量Q = 2000 m³/s，堰顶高程P = 80m，上游水位H = 85m，溢流堰采用WES型实用堰，堰顶宽b = 50m，下游消能采用挑流方式。

**核心公式：**
```python
1. 溢流堰流量：Q = m·b·H^(3/2)·√(2g)
2. WES堰流量系数：m = 0.502
3. 溢流面曲线：y = -0.5·(x/H)^1.85·H
4. 挑流射程：L = v₀²·sin(2θ)/g
5. 冲刷坑深度：t = q^0.5·H₀^0.25
```

**主要功能：**
- 堰顶水头与流量关系
- WES堰剖面曲线生成
- 挑流鼻坎设计
- 挑流轨迹计算
- 下游冲刷坑深度估算

**可视化输出：**
- 溢洪道纵剖面与挑流轨迹
- H-Q关系曲线
- WES剖面无量纲化验证
- 不同挑角的挑流轨迹对比
- 挑距-挑角关系

---

### 4. 水闸调度运行（题7）

**问题描述：**
某水闸控制渠道流量，闸门净宽b = 10m，闸门数n = 3孔，上游设计水位H₁ = 8m，下游水位H₂ = 5m，闸门启闭规则：e = 0.5H₁。

**核心公式：**
```python
1. 自由出流：Q = μ₀·b·e·√(2g·H₁)
2. 淹没出流：Q = μs·b·e·√(2g·(H₁-H₂))
3. 判别：hc < H₂（淹没），hc ≥ H₂（自由）
4. 收缩系数：ε ≈ 0.62
```

**主要功能：**
- 自由出流与淹没出流判别
- 不同开度下的过闸流量
- 水位-流量关系曲线
- 闸门启闭调度方案
- 泄流能力分析

**可视化输出：**
- 水闸断面示意图
- 开度-流量关系曲线
- 流态判别图
- 调度方案对比
- 闸孔数与流量系数影响

---

### 5. 土石坝设计（题10）

**问题描述：**
某土石坝最大坝高H = 60m，坝顶宽度b = 10m，上游坡比m₁ = 3.0，下游坡比m₂ = 2.5，正常蓄水位h₁ = 55m，设计洪水位hd = 58m，土料干密度ρd = 1.8 t/m³，饱和密度ρsat = 2.0 t/m³。

**核心公式：**
```python
1. 坝底宽度：B = b + m₁·H + m₂·H
2. 边坡稳定：Fs = (c·L + W·cos(α)·tan(φ))/(W·sin(α))
3. 浸润线：y² = h₁² - (h₁²/L)·x
4. 单宽渗流量：q = k·h₁/L
```

**主要功能：**
- 坝体断面尺寸计算
- 坝体填筑方量统计
- 边坡稳定分析（Bishop法）
- 渗流安全分析
- 经济指标估算

**可视化输出：**
- 土石坝断面与浸润线
- 填筑方量对比
- 边坡稳定验算
- 浸润线分析
- 造价分布饼图

---

### 6. 综合水利枢纽布置（题13）

**问题描述：**
某综合水利枢纽工程，包含大坝、溢洪道、电站、船闸等建筑物，水库总库容V = 5亿m³，正常蓄水位h_norm = 150m，死水位h_dead = 130m，防洪限制水位h_flood = 145m，装机容量P = 300MW，设计水头Hd = 50m。

**核心公式：**
```python
1. 有效库容：V_eff = V_norm - V_dead
2. 防洪库容：V_flood = V_design - V_flood_limit
3. 水电出力：P = 9.81·Q·H·η
4. 年发电量：E = P·T
```

**主要功能：**
- 水库特征水位与库容
- 大坝枢纽总体布置
- 水电站出力计算
- 综合效益评价
- 枢纽运行调度

**可视化输出：**
- 枢纽平面布置图
- 特征水位对比
- 库容分布饼图
- 水位-库容关系曲线
- 综合效益柱状图与雷达图
- 全年运行调度曲线

---

## 考试要点

### 1. 水工建筑物分类
- **挡水建筑物**：重力坝、拱坝、土石坝
- **泄水建筑物**：溢洪道、水闸
- **输水建筑物**：隧洞、渡槽
- **专门建筑物**：水电站、船闸

### 2. 重力坝稳定
- **抗滑稳定**：Kc = f·ΣV/ΣH ≥ 1.05（正常）
- **抗倾覆稳定**：K₀ ≥ 1.5（正常）
- **坝底应力**：无拉应力，压应力不超限

### 3. 拱坝应力
- **拱向应力**：σθ = p·R/d（圆筒公式）
- **梁向应力**：悬臂梁弯曲应力
- **拱梁分载**：刚度比法

### 4. 土石坝设计
- **坝体断面**：梯形断面，上下游坡比
- **边坡稳定**：Fs ≥ 1.3
- **渗流控制**：浸润线、防渗体
- **超高**：e = R + a

### 5. 溢洪道设计
- **堰型选择**：WES堰、宽顶堰
- **消能工**：挑流、底流、面流
- **水力计算**：流量、流速、能量

### 6. 水闸运行
- **流态判别**：自由出流、淹没出流
- **流量计算**：闸孔出流公式
- **调度原则**：防洪、兴利

### 7. 水利枢纽
- **综合利用**：防洪、发电、灌溉、航运
- **特征水位**：正常、设计、死水位
- **效益分析**：经济、社会、环境

---

## 使用方法

### 1. 单独运行某个程序：
```bash
python3 ch11_problem01_gravity_dam_stability.py
python3 ch11_problem02_arch_dam_stress.py
python3 ch11_problem04_spillway_design.py
python3 ch11_problem07_sluice_operation.py
python3 ch11_problem10_earth_dam_design.py
python3 ch11_problem13_comprehensive.py
```python

### 2. 修改参数进行计算：
在每个程序的 `main()` 函数中修改参数值，例如：
```python
def main():
    # 重力坝参数
    H = 50      # 坝高
    b = 6       # 坝顶宽
    m1 = 0.1    # 上游坡比
    m2 = 0.8    # 下游坡比
    # ...
```

### 3. 查看可视化结果：
程序会生成9宫格图表，保存在 `/tmp/` 目录下，并显示在屏幕上。

---

## 输出内容

每个程序输出包括：
1. **文本输出**：详细的计算步骤、中间结果和最终结果
2. **图形输出**：9宫格综合分析图，包括：
   - 断面图与示意图
   - 参数分布曲线
   - 应力/流量/库容分析
   - 对比图表
   - 结果汇总表

---

## 代码统计

| 文件 | 行数 | 功能 | 图表数 |
|-----|------|------|--------|
| ch11_problem01_gravity_dam_stability.py | ~520 | 重力坝稳定 | 9 |
| ch11_problem02_arch_dam_stress.py | ~520 | 拱坝应力 | 9 |
| ch11_problem04_spillway_design.py | ~540 | 溢洪道设计 | 9 |
| ch11_problem07_sluice_operation.py | ~530 | 水闸调度 | 9 |
| ch11_problem10_earth_dam_design.py | ~560 | 土石坝设计 | 9 |
| ch11_problem13_comprehensive.py | ~590 | 综合枢纽 | 9 |
| **总计** | **~3,260** | **6个程序** | **54** |

---

## 技术特点

### 1. 面向对象设计
- 每个问题封装为一个类
- 清晰的方法划分
- 易于扩展和维护

### 2. 完整的工程计算
- 荷载计算
- 应力分析
- 稳定验算
- 水力计算
- 经济评估

### 3. 丰富的可视化
- 断面图
- 分布曲线
- 对比图表
- 雷达图
- 数据表格

### 4. 详细的注释
- 公式说明
- 参数解释
- 计算步骤
- 考试要点

---

## 工程应用

### 1. 大坝设计
- 重力坝稳定分析
- 拱坝应力计算
- 土石坝断面设计

### 2. 泄水建筑物
- 溢洪道水力设计
- 水闸调度运行
- 消能工设计

### 3. 水利枢纽
- 综合利用规划
- 水库调度
- 效益评估

### 4. 考研备考
- 典型例题
- 计算方法
- 考点覆盖

---

## 知识拓展

### 1. 坝工设计规范
- 《混凝土重力坝设计规范》SL 319
- 《混凝土拱坝设计规范》SL 282
- 《碾压式土石坝设计规范》SL 274

### 2. 水力学规范
- 《水利水电工程等级划分及洪水标准》SL 252
- 《水电站进水口设计规范》SL 279

### 3. 工程实例
- 三峡大坝（混凝土重力坝）
- 锦屏一级（混凝土拱坝）
- 紫坪铺（堆石坝）

---

## 参考资料

1. 吴持恭《水力学》（第四版）
2. 李国英《水工建筑物》
3. 朱伯芳《拱坝设计与研究》
4. 河海大学《土石坝工程》

---

## 注意事项

1. 所有公式均基于规范和经典理论
2. 计算结果仅供参考，实际工程需详细设计
3. 安全系数标准可根据规范调整
4. 单位制：长度(m)、力(kN)、应力(kPa)、流量(m³/s)

---

## 版本信息

- **版本**：v1.0
- **日期**：2025-11-07
- **作者**：CHS-Books Team
- **Python版本**：3.8+
- **依赖库**：numpy, matplotlib, scipy

---

**项目状态：✅ 100% 完成**
- 6个核心程序
- 54个可视化图表
- ~3,260行代码
- 完整的考点覆盖
