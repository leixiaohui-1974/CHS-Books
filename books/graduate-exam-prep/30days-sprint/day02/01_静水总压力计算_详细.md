# Day 2：静水总压力计算

**学习时间**: 3小时  
**必考指数**: ⭐⭐⭐⭐⭐

---

## 一、平面上的静水总压力

### 1.1 基本公式

**总压力**：
$$P = \gamma h_C A$$

- $h_C$：形心深度
- $A$：受压面积

**压力中心**：
$$y_D = y_C + \frac{I_C}{y_C A}$$

- $y_C$：形心位置
- $I_C$：对形心轴的惯性矩

### 1.2 常见图形惯性矩

| 图形 | 惯性矩 $I_C$ |
|------|--------------|
| 矩形(b×h) | $\frac{bh^3}{12}$ |
| 圆形(d) | $\frac{\pi d^4}{64}$ |
| 三角形(b×h) | $\frac{bh^3}{36}$ |

---

## 二、矩形平面闸门

### 2.1 竖直放置

**顶部与水面齐平**：

$$P = \gamma \frac{h}{2} \cdot bh = \frac{1}{2}\gamma b h^2$$

$$y_D = \frac{2h}{3}$$

**顶部距水面$h_0$**：

$$h_C = h_0 + \frac{h}{2}$$

$$P = \gamma h_C \cdot bh$$

$$y_D = y_C + \frac{bh^3/12}{(h_0 + h/2) \cdot bh} = h_0 + \frac{h}{2} + \frac{h^2}{12(h_0 + h/2)}$$

### 2.2 倾斜放置

倾角$\alpha$，沿斜面度量：

$$y_C = \frac{h_0}{\sin\alpha} + \frac{L}{2}$$

$$h_C = y_C \sin\alpha$$

$$P = \gamma h_C A$$

$$y_D = y_C + \frac{I_C}{y_C A}$$

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt

class HydrostaticForce:
    """静水总压力计算"""
    
    def __init__(self, gamma=9810):
        self.gamma = gamma  # N/m³
    
    def rectangular_gate_vertical(self, b, h, h0=0):
        """
        竖直矩形闸门
        
        参数:
            b: 宽度 (m)
            h: 高度 (m)
            h0: 顶部距水面距离 (m)
        
        返回:
            P: 总压力 (N)
            y_D: 压力中心距顶部距离 (m)
        """
        # 形心深度
        h_C = h0 + h / 2
        
        # 面积
        A = b * h
        
        # 总压力
        P = self.gamma * h_C * A
        
        # 惯性矩
        I_C = b * h**3 / 12
        
        # 形心位置（距水面）
        y_C = h0 + h / 2
        
        # 压力中心
        y_D = h0 + h / 2 + I_C / (y_C * A)
        
        return P, y_D
    
    def rectangular_gate_inclined(self, b, L, h0, alpha_deg):
        """
        倾斜矩形闸门
        
        参数:
            b: 宽度 (m)
            L: 长度 (m)
            h0: 顶部距水面垂直距离 (m)
            alpha_deg: 倾角 (度)
        
        返回:
            P: 总压力 (N)
            y_D: 压力中心沿斜面距顶部距离 (m)
        """
        alpha = np.radians(alpha_deg)
        
        # 形心位置（沿斜面）
        y_C = h0 / np.sin(alpha) + L / 2
        
        # 形心深度
        h_C = y_C * np.sin(alpha)
        
        # 面积
        A = b * L
        
        # 总压力
        P = self.gamma * h_C * A
        
        # 惯性矩
        I_C = b * L**3 / 12
        
        # 压力中心
        y_D = y_C + I_C / (y_C * A)
        
        return P, y_D
    
    def circular_gate(self, d, h_center):
        """
        圆形闸门
        
        参数:
            d: 直径 (m)
            h_center: 圆心深度 (m)
        
        返回:
            P: 总压力 (N)
            e: 压力中心偏离圆心距离 (m)
        """
        # 面积
        A = np.pi * d**2 / 4
        
        # 总压力
        P = self.gamma * h_center * A
        
        # 惯性矩
        I_C = np.pi * d**4 / 64
        
        # 压力中心偏离
        e = I_C / (h_center * A)
        
        return P, e
    
    def plot_pressure_distribution(self, b, h, h0=0):
        """绘制压强分布和总压力"""
        # 深度
        z = np.linspace(h0, h0 + h, 100)
        
        # 压强
        p = self.gamma * z
        
        # 计算总压力和压力中心
        P, y_D = self.rectangular_gate_vertical(b, h, h0)
        
        fig, axes = plt.subplots(1, 2, figsize=(14, 6))
        
        # 压强分布
        axes[0].plot(p/1000, z, 'b-', linewidth=2, label='压强分布')
        axes[0].fill_betweenx(z, 0, p/1000, alpha=0.3)
        
        # 标注压力中心
        p_D = self.gamma * y_D
        axes[0].plot(p_D/1000, y_D, 'ro', markersize=10, 
                    label=f'压力中心 (深度={y_D:.3f}m)')
        
        axes[0].invert_yaxis()
        axes[0].set_xlabel('压强 (kPa)', fontsize=12)
        axes[0].set_ylabel('深度 (m)', fontsize=12)
        axes[0].set_title('压强分布', fontsize=14)
        axes[0].legend()
        axes[0].grid(True, alpha=0.3)
        
        # 闸门示意图
        gate_x = [0, b, b, 0, 0]
        gate_y = [h0, h0, h0+h, h0+h, h0]
        
        axes[1].plot(gate_x, gate_y, 'k-', linewidth=2)
        axes[1].fill(gate_x, gate_y, alpha=0.3, color='gray')
        
        # 水面
        axes[1].axhline(0, color='blue', linestyle='--', 
                       linewidth=2, label='水面')
        
        # 形心
        h_C = h0 + h/2
        axes[1].plot(b/2, h_C, 'gs', markersize=12, 
                    label=f'形心 (深度={h_C:.3f}m)')
        
        # 压力中心
        axes[1].plot(b/2, y_D, 'ro', markersize=12,
                    label=f'压力中心 (深度={y_D:.3f}m)')
        
        # 总压力箭头
        arrow_y = y_D
        axes[1].arrow(-0.5, arrow_y, 0.3, 0, 
                     head_width=0.1, head_length=0.1,
                     fc='red', ec='red', linewidth=2)
        axes[1].text(-0.7, arrow_y, f'P={P/1000:.1f}kN',
                    fontsize=10, va='center')
        
        axes[1].set_xlim([-1, b+0.5])
        axes[1].set_ylim([h0+h+0.5, -0.5])
        axes[1].set_xlabel('宽度 (m)', fontsize=12)
        axes[1].set_ylabel('深度 (m)', fontsize=12)
        axes[1].set_title('闸门与总压力', fontsize=14)
        axes[1].legend()
        axes[1].grid(True, alpha=0.3)
        axes[1].set_aspect('equal')
        
        plt.tight_layout()
        plt.savefig('hydrostatic_force.png', dpi=300)
        plt.show()

# 示例1：竖直矩形闸门
print("="*60)
print("示例1：竖直矩形闸门")
print("="*60)

calc = HydrostaticForce()

b = 2  # m
h = 3  # m
h0 = 1  # m

P, y_D = calc.rectangular_gate_vertical(b, h, h0)

print(f"闸门参数:")
print(f"  宽度 b = {b} m")
print(f"  高度 h = {h} m")
print(f"  顶部距水面 h0 = {h0} m")

print(f"\n计算结果:")
print(f"  总压力 P = {P:.0f} N = {P/1000:.2f} kN")
print(f"  压力中心深度 y_D = {y_D:.3f} m")
print(f"  压力中心距顶部 = {y_D - h0:.3f} m")

# 可视化
calc.plot_pressure_distribution(b, h, h0)

# 示例2：倾斜闸门
print("\n" + "="*60)
print("示例2：倾斜矩形闸门")
print("="*60)

b2 = 1.5  # m
L2 = 2    # m
h0_2 = 1  # m
alpha = 60  # 度

P2, y_D2 = calc.rectangular_gate_inclined(b2, L2, h0_2, alpha)

print(f"闸门参数:")
print(f"  宽度 b = {b2} m")
print(f"  长度 L = {L2} m")
print(f"  顶部距水面 h0 = {h0_2} m")
print(f"  倾角 α = {alpha}°")

print(f"\n计算结果:")
print(f"  总压力 P = {P2:.0f} N = {P2/1000:.2f} kN")
print(f"  压力中心距顶部(沿斜面) y_D = {y_D2:.3f} m")

# 验算
y_C = h0_2 / np.sin(np.radians(alpha)) + L2 / 2
print(f"\n验算:")
print(f"  形心位置(沿斜面) y_C = {y_C:.3f} m")
print(f"  压力中心偏离形心 = {y_D2 - y_C:.3f} m")

# 示例3：圆形闸门
print("\n" + "="*60)
print("示例3：圆形闸门")
print("="*60)

d = 1.2  # m
h_c = 5  # m

P3, e = calc.circular_gate(d, h_c)

print(f"闸门参数:")
print(f"  直径 d = {d} m")
print(f"  圆心深度 h = {h_c} m")

print(f"\n计算结果:")
print(f"  总压力 P = {P3:.0f} N = {P3/1000:.2f} kN")
print(f"  压力中心偏离圆心 e = {e:.4f} m")

# 对比不同情况
print("\n" + "="*60)
print("示例4：水深变化影响")
print("="*60)

b4 = 2
h4 = 3

h0_values = [0, 0.5, 1, 2, 3]

print(f"{'h0(m)':>8s} {'P(kN)':>10s} {'y_D(m)':>10s} {'偏离形心(m)':>12s}")
print("-" * 45)

for h0_val in h0_values:
    P_val, y_D_val = calc.rectangular_gate_vertical(b4, h4, h0_val)
    y_C_val = h0_val + h4/2
    offset = y_D_val - y_C_val
    
    print(f"{h0_val:8.1f} {P_val/1000:10.2f} {y_D_val:10.3f} {offset:12.4f}")
```

---

## 三、曲面上的静水总压力

### 3.1 水平分力

$$P_x = \gamma h_C A_x$$

$A_x$：曲面在垂直平面上的投影面积

### 3.2 竖直分力

$$P_z = \gamma V$$

$V$：压力体体积

### 3.3 合力

$$P = \sqrt{P_x^2 + P_z^2}$$

倾角：
$$\tan\theta = \frac{P_z}{P_x}$$

---

## 四、典型考题

### 【例题1】矩形闸门（15分）

**题目**：矩形闸门，宽b=2m，高h=4m，顶部与水面齐平。求总压力及压力中心。

**解**：

(1) 总压力（8分）
$$P = \frac{1}{2}\gamma b h^2 = \frac{1}{2} \times 9810 \times 2 \times 4^2 = 156960 \text{ N} = 157 \text{ kN}$$

(2) 压力中心（7分）
$$y_D = \frac{2h}{3} = \frac{2 \times 4}{3} = 2.67 \text{ m}$$

---

### 【例题2】倾斜闸门（20分）

**题目**：倾斜闸门，倾角60°，宽1.5m，长2m，顶部距水面1m。求总压力。

**解**：略（见Python代码）

---

## 五、速记口诀

> 总压等于γh_C乘A  
> 压力中心比形心深  
> 矩形顶齐水面时  
> 压力中心在2/3

---

**明日预告**: Day 3 - 能量方程与伯努利方程

**作业**：
1. 计算矩形闸门(3m×4m)总压力
2. 推导压力中心公式
3. 比较不同h0时的压力中心位置
