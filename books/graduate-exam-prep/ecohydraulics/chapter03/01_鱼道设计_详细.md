# 第3章：鱼道设计原理与实践

**工程目标**: 恢复河流连通性  
**设计难度**: ⭐⭐⭐⭐⭐

---

## 一、鱼道基本概念

### 1.1 定义与作用

**鱼道（Fish Pass/Fishway）**：人工建造的过鱼通道，使鱼类能够通过水坝、水闸等阻隔物。

**主要功能**：
1. 洄游通道：溯河产卵
2. 基因交流：维持种群多样性
3. 生态修复：恢复河流连通性

### 1.2 设计目标

**过鱼效率**：
$$E = \frac{N_{通过}}{N_{尝试}} \times 100\%$$

目标：E > 80%（优秀），E > 60%（合格）

---

## 二、鱼道类型

### 2.1 池坝式鱼道

**结构**：分级水池，池间隔墙（坝）连接

**优点**：
- 适应性广
- 消能效果好
- 便于鱼类休息

**设计参数**：
- 池长：3-5 m
- 池间落差：0.2-0.3 m
- 过鱼孔流速：0.6-1.2 m/s

### 2.2 竖缝式鱼道

**结构**：竖向缝隙贯通各池

**优点**：
- 流量自适应
- 适合水位变化大的河流
- 多种鱼类可通过

**设计参数**：
- 缝宽：0.2-0.4 m
- 池间落差：0.15-0.25 m

### 2.3 自然式鱼道

**结构**：模拟天然河道，设置卵石、植被

**优点**：
- 生态性好
- 景观效果佳
- 多种生物受益

### Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve

class FishwayDesign:
    """鱼道设计"""
    
    def __init__(self, g=9.81):
        self.g = g
    
    def pool_type_fishway(self, H_total, delta_h, b, fish_speed=1.0):
        """
        池坝式鱼道设计
        
        参数:
            H_total: 总落差 (m)
            delta_h: 池间落差 (m)
            b: 鱼道宽度 (m)
            fish_speed: 鱼类游泳速度 (m/s)
        
        返回:
            设计参数
        """
        # 池数
        n_pools = int(np.ceil(H_total / delta_h))
        
        # 实际池间落差
        delta_h_actual = H_total / n_pools
        
        # 过鱼孔流速（控制在鱼类游泳速度以下）
        v_orifice = 0.8 * fish_speed  # 80%安全系数
        
        # 过鱼孔面积（假设流量为0.1 m³/s）
        Q_design = 0.1  # m³/s
        A_orifice = Q_design / v_orifice
        
        # 过鱼孔尺寸（矩形）
        h_orifice = 0.4  # m（固定高度）
        w_orifice = A_orifice / h_orifice
        
        # 池长（依据流速和停留时间）
        L_pool = 3 * b  # 经验公式：3-5倍池宽
        
        # 总长度
        L_total = n_pools * L_pool
        
        # 坡度
        slope = H_total / L_total
        
        results = {
            'n_pools': n_pools,
            'delta_h_actual': delta_h_actual,
            'v_orifice': v_orifice,
            'w_orifice': w_orifice,
            'h_orifice': h_orifice,
            'L_pool': L_pool,
            'L_total': L_total,
            'slope': slope
        }
        
        return results
    
    def vertical_slot_fishway(self, H_total, delta_h, b, slot_width=0.3):
        """
        竖缝式鱼道设计
        
        参数:
            H_total: 总落差 (m)
            delta_h: 池间落差 (m)
            b: 鱼道宽度 (m)
            slot_width: 竖缝宽度 (m)
        
        返回:
            设计参数
        """
        # 池数
        n_pools = int(np.ceil(H_total / delta_h))
        
        # 实际池间落差
        delta_h_actual = H_total / n_pools
        
        # 竖缝流量（Rajaratnam公式）
        # Q = C_d * b_s * h * sqrt(2g*delta_h)
        # 其中h为水深，假设h=1.0m
        h_water = 1.0  # m
        C_d = 0.8  # 流量系数
        
        Q_slot = C_d * slot_width * h_water * np.sqrt(2*self.g*delta_h_actual)
        
        # 池内平均流速
        A_pool = b * h_water
        v_pool = Q_slot / A_pool
        
        # 池长
        L_pool = 4 * b  # 竖缝式需要更长的池
        
        # 总长度
        L_total = n_pools * L_pool
        
        results = {
            'n_pools': n_pools,
            'delta_h_actual': delta_h_actual,
            'slot_width': slot_width,
            'Q_slot': Q_slot,
            'v_pool': v_pool,
            'L_pool': L_pool,
            'L_total': L_total
        }
        
        return results
    
    def fish_swimming_capacity(self, fish_length, fish_type='cyprinid'):
        """
        鱼类游泳能力
        
        参数:
            fish_length: 鱼体长 (cm)
            fish_type: 鱼类类型
        
        返回:
            持续游泳速度 (m/s), 突进速度 (m/s)
        """
        # 经验公式：v = k * L^n
        L = fish_length / 100  # 转为m
        
        if fish_type == 'cyprinid':  # 鲤科
            v_sustained = 0.5 * L**0.5  # 持续速度
            v_burst = 3.0 * L**0.5     # 突进速度
        elif fish_type == 'salmonid':  # 鲑科
            v_sustained = 0.8 * L**0.5
            v_burst = 4.0 * L**0.5
        else:
            v_sustained = 0.6 * L**0.5
            v_burst = 3.5 * L**0.5
        
        return v_sustained, v_burst
    
    def energy_dissipation(self, Q, delta_h):
        """
        能量消散率
        
        P = ρ * g * Q * delta_h (W)
        
        单位体积消散率应<200 W/m³
        """
        rho = 1000  # kg/m³
        P = rho * self.g * Q * delta_h  # W
        
        return P
    
    def plot_fishway_profile(self, n_pools, delta_h, L_pool, fishway_type='pool'):
        """绘制鱼道纵剖面"""
        # 水面线
        x_surface = []
        z_surface = []
        
        for i in range(n_pools + 1):
            x_surface.append(i * L_pool)
            z_surface.append(-i * delta_h)
        
        # 底板线
        x_bottom = []
        z_bottom = []
        
        for i in range(n_pools):
            x_bottom.extend([i*L_pool, (i+1)*L_pool])
            z_bottom.extend([-i*delta_h - 0.5, -(i+1)*delta_h - 0.5])
        
        fig, ax = plt.subplots(figsize=(14, 6))
        
        # 水面
        ax.plot(x_surface, z_surface, 'b-', linewidth=2, label='水面线')
        ax.fill_between(x_surface, z_surface, -10, alpha=0.2, color='blue')
        
        # 底板
        ax.plot(x_bottom, z_bottom, 'k-', linewidth=2, label='底板')
        ax.fill_between(x_bottom, z_bottom, -10, alpha=0.3, color='gray')
        
        # 隔板（坝）
        for i in range(1, n_pools):
            x_dam = i * L_pool
            z_top = -i * delta_h
            z_bot = -(i+1) * delta_h - 0.5
            ax.plot([x_dam, x_dam], [z_bot, z_top], 'r-', linewidth=3)
        
        # 鱼的游泳路径（示意）
        x_fish = np.linspace(0, n_pools*L_pool, 100)
        z_fish = np.interp(x_fish, x_surface, z_surface) + 0.2
        ax.plot(x_fish, z_fish, 'g--', linewidth=1.5, 
               alpha=0.7, label='鱼类游泳路径')
        
        ax.set_xlabel('距离 (m)', fontsize=12)
        ax.set_ylabel('高程 (m)', fontsize=12)
        ax.set_title(f'{fishway_type}式鱼道纵剖面', fontsize=14)
        ax.legend()
        ax.grid(True, alpha=0.3)
        ax.set_aspect('equal')
        
        plt.tight_layout()
        plt.savefig('fishway_profile.png', dpi=300)
        plt.show()

# 示例1：池坝式鱼道设计
print("="*60)
print("示例1：池坝式鱼道设计")
print("="*60)

fw = FishwayDesign()

# 设计条件
H_total = 5.0  # m（坝高）
delta_h = 0.25  # m（池间落差）
b = 2.0  # m（鱼道宽度）

print(f"设计条件:")
print(f"  总落差: {H_total} m")
print(f"  设计池间落差: {delta_h} m")
print(f"  鱼道宽度: {b} m")

# 目标鱼种游泳能力
fish_length = 30  # cm（鲤鱼）
v_sust, v_burst = fw.fish_swimming_capacity(fish_length, 'cyprinid')

print(f"\n目标鱼种（鲤鱼，体长{fish_length}cm）:")
print(f"  持续游泳速度: {v_sust:.2f} m/s")
print(f"  突进速度: {v_burst:.2f} m/s")

# 设计计算
results = fw.pool_type_fishway(H_total, delta_h, b, fish_speed=v_sust)

print(f"\n设计结果:")
print(f"  池数: {results['n_pools']} 个")
print(f"  实际池间落差: {results['delta_h_actual']:.3f} m")
print(f"  过鱼孔流速: {results['v_orifice']:.2f} m/s")
print(f"  过鱼孔尺寸: {results['w_orifice']:.2f}m × {results['h_orifice']:.2f}m")
print(f"  池长: {results['L_pool']:.1f} m")
print(f"  鱼道总长: {results['L_total']:.1f} m")
print(f"  鱼道坡度: {results['slope']*100:.2f}%")

# 检查设计合理性
print(f"\n设计检查:")
print(f"  过鱼孔流速/鱼类持续速度: {results['v_orifice']/v_sust:.2f}")
if results['v_orifice'] < v_sust:
    print(f"  ✓ 流速适宜，鱼类可持续游泳通过")
else:
    print(f"  ✗ 流速过大，需调整设计")

# 可视化
fw.plot_fishway_profile(results['n_pools'], results['delta_h_actual'],
                        results['L_pool'], 'pool')

# 示例2：竖缝式鱼道
print("\n" + "="*60)
print("示例2：竖缝式鱼道设计")
print("="*60)

results_vs = fw.vertical_slot_fishway(H_total, 0.2, b)

print(f"竖缝式鱼道:")
print(f"  池数: {results_vs['n_pools']} 个")
print(f"  实际池间落差: {results_vs['delta_h_actual']:.3f} m")
print(f"  竖缝宽度: {results_vs['slot_width']:.2f} m")
print(f"  竖缝流量: {results_vs['Q_slot']:.3f} m³/s")
print(f"  池内平均流速: {results_vs['v_pool']:.2f} m/s")
print(f"  池长: {results_vs['L_pool']:.1f} m")
print(f"  鱼道总长: {results_vs['L_total']:.1f} m")

# 示例3：不同鱼种对比
print("\n" + "="*60)
print("示例3：不同鱼种游泳能力对比")
print("="*60)

fish_types = {
    'cyprinid': '鲤科',
    'salmonid': '鲑科'
}

fish_lengths = [20, 30, 40, 50]

fig, ax = plt.subplots(figsize=(10, 6))

for ftype, fname in fish_types.items():
    v_sust_list = []
    v_burst_list = []
    
    for L in fish_lengths:
        v_s, v_b = fw.fish_swimming_capacity(L, ftype)
        v_sust_list.append(v_s)
        v_burst_list.append(v_b)
    
    ax.plot(fish_lengths, v_sust_list, '-o', linewidth=2,
           markersize=8, label=f'{fname}-持续速度')
    ax.plot(fish_lengths, v_burst_list, '--s', linewidth=2,
           markersize=8, label=f'{fname}-突进速度')

ax.set_xlabel('鱼体长 (cm)', fontsize=12)
ax.set_ylabel('游泳速度 (m/s)', fontsize=12)
ax.set_title('鱼类游泳能力与体长关系', fontsize=14)
ax.legend()
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('fish_swimming_capacity.png', dpi=300)
plt.show()
```

---

## 三、设计关键参数

### 3.1 流速控制

**过鱼孔流速**：
$$v_{孔} \leq 0.8 \times v_{鱼,持续}$$

**池内流速**：
$$v_{池} \leq 0.3 \text{ m/s}$$（休息区）

### 3.2 水深要求

**最小水深**：
$$h_{min} = 1.5 \times h_{鱼}$$

一般：h > 0.6 m

### 3.3 能量消散

**单位体积消散率**：
$$P_v = \frac{\rho g Q \Delta h}{V_{池}} < 200 \text{ W/m}^3$$

---

## 四、工程案例

### 4.1 三峡鱼道

**类型**：竖缝式

**规模**：
- 总落差：约20 m
- 长度：约1.5 km
- 设计对象：四大家鱼

### 4.2 成功案例

**评价指标**：
- 过鱼效率：通过数/尝试数
- 时间效率：平均通过时间
- 物种多样性：通过鱼种数

---

## 五、典型考题

### 【例题】鱼道设计计算

**题目**（30分）

某水坝，落差H=8m，设计池坝式鱼道。目标鱼种为草鱼（体长40cm，持续游泳速度1.0m/s）。鱼道宽度b=3m。

求：
1. 推荐池间落差
2. 池数
3. 过鱼孔流速
4. 鱼道总长（池长取4m）

**【解答】**

(1) **池间落差**（6分）

经验值：0.2-0.3 m

取$\Delta h = 0.25$ m

(2) **池数**（6分）

$$n = \frac{H}{\Delta h} = \frac{8}{0.25} = 32 \text{ 个}$$

(3) **过鱼孔流速**（10分）

$$v_{孔} = 0.8 \times v_{鱼} = 0.8 \times 1.0 = 0.8 \text{ m/s}$$

(4) **鱼道总长**（8分）

$$L = n \times L_{池} = 32 \times 4 = 128 \text{ m}$$

---

**本章重点**：
- 鱼道类型选择
- 流速控制原则
- 池间落差确定
- 鱼类游泳能力评估
