# 第1章：线性方程组求解

**章节目标**: 掌握线性方程组的各种数值求解方法  
**项目数量**: 5个  
**学习周期**: 1周  
**难度等级**: ★★★☆☆

---

## 📚 章节概述

### 主要内容

线性方程组 $Ax = b$ 是科学计算中最基本、最重要的问题之一。本章系统介绍：

1. **直接法**: 高斯消元、LU分解
2. **迭代法**: Jacobi、Gauss-Seidel、SOR
3. **共轭梯度法**: 大型稀疏系统
4. **预条件方法**: 加速收敛
5. **特征值问题**: 幂法、QR算法

### 工程应用

- 供水管网计算
- 有限元方程组
- 电力网络分析
- 结构力学计算
- 热传导问题

---

## 🎯 项目清单

### 项目1: 直接法求解 ✅

**文件**: `project_01_direct_methods.py`

**算法**:
- 高斯消元法（Gauss Elimination）
- LU分解（LU Decomposition）
- 主元选择（Pivoting）

**工程案例**: 供水管网节点水头计算

**关键代码**:
```python
def gauss_elimination(A, b):
    """高斯消元法"""
    n = len(b)
    # 前向消元
    for i in range(n):
        # 选主元
        max_row = i + np.argmax(np.abs(A[i:, i]))
        A[[i, max_row]] = A[[max_row, i]]
        b[[i, max_row]] = b[[max_row, i]]
        
        # 消元
        for j in range(i+1, n):
            factor = A[j, i] / A[i, i]
            A[j, i:] -= factor * A[i, i:]
            b[j] -= factor * b[i]
    
    # 回代
    x = np.zeros(n)
    for i in range(n-1, -1, -1):
        x[i] = (b[i] - np.dot(A[i, i+1:], x[i+1:])) / A[i, i]
    
    return x
```

**复杂度**: $O(n^3)$

**适用场景**:
- 中小规模系统（$n < 1000$）
- 稠密矩阵
- 需要精确解

---

### 项目2: 迭代法求解 📋

**文件**: `project_02_迭代法求解线性方程组.py`

**算法**:
- Jacobi迭代
- Gauss-Seidel迭代
- SOR（超松弛迭代）

**收敛条件**:
- 严格对角占优
- 对称正定
- 谱半径 < 1

**工程案例**: 大型稀疏系统求解

**Jacobi迭代**:
$$x^{(k+1)}_i = \frac{1}{a_{ii}} \left(b_i - \sum_{j \neq i} a_{ij} x^{(k)}_j \right)$$

**Gauss-Seidel迭代**:
$$x^{(k+1)}_i = \frac{1}{a_{ii}} \left(b_i - \sum_{j<i} a_{ij} x^{(k+1)}_j - \sum_{j>i} a_{ij} x^{(k)}_j \right)$$

**复杂度**: 每次迭代 $O(n^2)$

**适用场景**:
- 大型稀疏系统
- 对角占优矩阵
- 不需要高精度

---

### 项目3: 共轭梯度法 📋

**文件**: `project_03_共轭梯度法.py`

**算法**: 共轭梯度法（Conjugate Gradient, CG）

**基本思想**:
将求解 $Ax = b$ 转化为最小化问题：
$$\min f(x) = \frac{1}{2}x^T A x - b^T x$$

**迭代公式**:
```
r₀ = b - Ax₀
p₀ = r₀
for k = 0, 1, 2, ...
    αₖ = (rₖᵀrₖ) / (pₖᵀApₖ)
    xₖ₊₁ = xₖ + αₖpₖ
    rₖ₊₁ = rₖ - αₖApₖ
    βₖ = (rₖ₊₁ᵀrₖ₊₁) / (rₖᵀrₖ)
    pₖ₊₁ = rₖ₊₁ + βₖpₖ
```

**工程案例**: 有限元方程组求解

**优势**:
- 对称正定系统最优
- 理论上 $n$ 步收敛
- 适合大型稀疏系统

**复杂度**: 每次迭代 $O(n)$（稀疏矩阵）

---

### 项目4: 预条件方法 📋

**文件**: `project_04_预条件迭代法.py`

**预条件子**: $M \approx A$

**预条件CG**: 求解 $M^{-1}Ax = M^{-1}b$

**常用预条件子**:
1. **对角预条件**: $M = \text{diag}(A)$
2. **不完全LU分解**: $M = LU$（近似）
3. **对称超松弛**: $M = (D + \omega L)D^{-1}(D + \omega L^T)$

**加速效果**:
- 降低条件数
- 加快收敛速度
- 减少迭代次数

**工程案例**: 大型有限元系统

**代码框架**:
```python
def preconditioned_cg(A, b, M, tol=1e-6):
    """预条件共轭梯度法"""
    x = np.zeros_like(b)
    r = b - A @ x
    z = M.solve(r)  # 求解 Mz = r
    p = z.copy()
    
    for k in range(len(b)):
        Ap = A @ p
        alpha = (r @ z) / (p @ Ap)
        x += alpha * p
        r_new = r - alpha * Ap
        
        if np.linalg.norm(r_new) < tol:
            break
        
        z_new = M.solve(r_new)
        beta = (r_new @ z_new) / (r @ z)
        p = z_new + beta * p
        r, z = r_new, z_new
    
    return x
```

---

### 项目5: 特征值问题 📋

**文件**: `project_05_特征值问题.py`

**特征值问题**: $Ax = \lambda x$

**算法**:
1. **幂法**: 求最大特征值
2. **反幂法**: 求最小特征值
3. **QR算法**: 求全部特征值

**幂法**:
```python
def power_method(A, max_iter=100, tol=1e-6):
    """幂法求最大特征值"""
    n = A.shape[0]
    x = np.random.rand(n)
    x = x / np.linalg.norm(x)
    
    for k in range(max_iter):
        y = A @ x
        lambda_new = x @ y
        x = y / np.linalg.norm(y)
        
        if k > 0 and abs(lambda_new - lambda_old) < tol:
            break
        lambda_old = lambda_new
    
    return lambda_new, x
```

**工程案例**: 结构振动分析

**应用**:
- 结构固有频率
- 稳定性分析
- 振动模态
- 主成分分析

---

## 📊 方法对比

| 方法 | 复杂度 | 精度 | 适用场景 |
|------|--------|------|---------|
| 高斯消元 | $O(n^3)$ | 高 | 中小规模稠密 |
| LU分解 | $O(n^3)$ | 高 | 多个右端项 |
| Jacobi | $O(kn^2)$ | 中 | 对角占优 |
| Gauss-Seidel | $O(kn^2)$ | 中高 | 对角占优 |
| CG | $O(kn)$ | 高 | 对称正定稀疏 |
| 预条件CG | $O(kn)$ | 高 | 大型稀疏 |
| 幂法 | $O(kn^2)$ | 中 | 主特征值 |

*注: $k$ 为迭代次数，$n$ 为方程组规模*

---

## 🎯 学习要点

### 理论要点

1. **收敛性分析**
   - 迭代法收敛条件
   - 收敛速度
   - 误差估计

2. **稳定性分析**
   - 数值稳定性
   - 条件数影响
   - 舍入误差

3. **复杂度分析**
   - 时间复杂度
   - 空间复杂度
   - 稀疏性利用

### 编程要点

1. **算法实现**
   - 向量化计算
   - 稀疏矩阵存储
   - 内存优化

2. **数值技巧**
   - 主元选择
   - 残差计算
   - 停止准则

3. **工程应用**
   - 问题建模
   - 参数选择
   - 结果验证

---

## 💡 实践建议

### 学习路径

1. **第1-2天**: 项目1（直接法）
   - 理解高斯消元
   - 实现LU分解
   - 应用于管网计算

2. **第3-4天**: 项目2（迭代法）
   - Jacobi/Gauss-Seidel
   - 收敛性分析
   - 对比效率

3. **第5天**: 项目3（共轭梯度）
   - CG算法实现
   - 有限元应用

4. **第6天**: 项目4（预条件）
   - 预条件子设计
   - 加速效果

5. **第7天**: 项目5（特征值）
   - 幂法实现
   - 振动分析

### 实践项目

**项目A**: 管网水力计算系统
- 节点方程建立
- 直接法求解
- 结果可视化

**项目B**: 有限元求解器
- 刚度矩阵组装
- CG迭代求解
- 预条件加速

**项目C**: 结构振动分析
- 质量、刚度矩阵
- 特征值求解
- 模态分析

---

## 📚 参考资料

### 教材

1. 李庆扬等，《数值分析》
2. Golub & Van Loan, "Matrix Computations"
3. Saad, "Iterative Methods"

### 在线资源

- NumPy/SciPy文档
- LAPACK库
- PETSc库

---

## ✅ 学习检查

完成本章后，你应该能够：

- [ ] 实现高斯消元和LU分解
- [ ] 理解迭代法收敛条件
- [ ] 编写共轭梯度算法
- [ ] 使用预条件技术
- [ ] 求解特征值问题
- [ ] 应用于实际工程问题

---

**下一章**: 第2章 - 非线性方程求解

---

*第1章文档版本: v1.0*  
*更新时间: 2025-11-12*  
*完成状态: ✅ 项目1完成，项目2-5待开发*
