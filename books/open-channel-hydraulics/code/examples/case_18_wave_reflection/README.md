# 案例18：明渠波动与反射

## 案例背景

某矩形明渠，上游设有闸门，下游为封闭端。研究闸门快速启闭产生的波动现象和边界反射特性。

工程参数：
- 渠道长度 L = 1000 m
- 渠道宽度 b = 10 m
- 初始水深 h₀ = 3.0 m
- 河床坡度 S₀ = 0（水平）
- 糙率系数 n = 0.02
- 初始流速 v₀ = 0（静水）

扰动方式：
- 上游闸门突然下降0.5m
- 持续时间：10秒
- 观察波的传播和反射

计算要求：
1. 模拟波的产生和传播
2. 分析波在封闭端的反射
3. 研究驻波形成过程
4. 计算波速和反射系数
5. 分析多次反射效应

## 学习目标

1. 理解明渠中的波动现象
2. 掌握边界反射理论
3. 学会驻波分析方法
4. 了解共振条件
5. 掌握波动能量传播

## 核心理论

### 1. 波动基本概念

**波的分类：**
```python
按波长分类：
- 长波（浅水波）：λ >> h
- 短波（深水波）：λ << h
- 中等波：λ ≈ h

按振幅分类：
- 小振幅波：线性理论适用
- 有限振幅波：需非线性理论
```

**长波方程（线性化Saint-Venant）：**
```python
∂η/∂t + h₀·∂u/∂x = 0
∂u/∂t + g·∂η/∂x = 0

其中：
  η = h - h₀（水面扰动）
  u = 流速扰动
  h₀ = 平均水深
```

**波动方程：**
```python
对η消去u，得到：
∂²η/∂t² = c²·∂²η/∂x²

其中 c = √(gh₀) 为波速
```

**一般解（D'Alembert解）：**
```python
η(x,t) = f(x-ct) + g(x+ct)

第一项：向右传播波
第二项：向左传播波
```

### 2. 边界条件

**刚性边界（封闭端）：**
```python
速度为零：u = 0

推导：
  从 ∂η/∂t + h₀·∂u/∂x = 0
  在 u = 0 处：∂η/∂t = 0

因此：η 达到极值（波腹）
```

**自由边界（开放端）：**
```python
压力恒定：η = 0

推导：
  从 ∂u/∂t + g·∂η/∂x = 0
  在 η = 0 处：∂u/∂t = 0

因此：u 达到极值（速度腹）
```

**反射系数：**
```python
刚性边界：R = -1（全反射，相位反转）
自由边界：R = +1（全反射，相位保持）
部分吸收：|R| < 1
```

### 3. 反射波理论

**入射波和反射波：**
```python
入射波：ηᵢ = A·sin(kx - ωt)
反射波：ηᵣ = R·A·sin(kx + ωt + φ)

其中：
  k = 2π/λ（波数）
  ω = 2π/T（角频率）
  R = 反射系数
  φ = 相位差
```

**驻波：**
```python
当入射波和反射波叠加：
η = ηᵢ + ηᵣ

对于刚性边界（R=-1，φ=0）：
η = A[sin(kx-ωt) - sin(kx+ωt)]
  = -2A·cos(kx)·sin(ωt)

特点：
- 波形不传播
- 波腹位置：x = nλ/2（n=0,1,2,...）
- 波节位置：x = (2n+1)λ/4
```

**能量反射：**
```python
能量反射率：Eᵣ/Eᵢ = R²

刚性边界：Eᵣ/Eᵢ = 1（全反射）
部分吸收：Eᵣ/Eᵢ < 1
```

### 4. 波速理论

**长波波速（小振幅）：**
```python
c = √(gh)

仅与水深有关
与波长无关（无色散）
```

**有限振幅效应：**
```python
波峰波速：c₁ = √(g(h+a))
波谷波速：c₂ = √(g(h-a))

其中 a 为振幅

波峰移动更快，导致波形畸变
```

**群速度：**
```python
对于无色散长波：
cg = c = √(gh)

群速度 = 相速度
能量传播速度等于波速
```

### 5. 共振现象

**共振条件：**
```python
渠道长度为半波长整数倍：
L = n·λ/2  （n=1,2,3,...）

或频率满足：
f = n·c/(2L)

基频（第一模态）：
f₁ = c/(2L) = √(gh)/(2L)
```

**驻波模态：**
```python
第n模态：
ηₙ = Aₙ·sin(nπx/L)·cos(ωₙt)

其中：
  ωₙ = nπc/L

节点数：n-1
腹点数：n
```

**共振放大：**
```python
外激频率接近固有频率时：
幅值急剧增大

放大系数：
Q = 1/(2ζ)

其中 ζ 为阻尼比
```

### 6. 数值模拟方法

**初始条件：**
```python
静水状态：
h(x,0) = h₀
u(x,0) = 0
```

**边界条件（封闭端反射）：**
```python
上游（x=0）：给定水位扰动
  h(0,t) = h₀ + η₀(t)

下游（x=L）：刚性边界
  Q(L,t) = 0（流量为零）
  或 u(L,t) = 0（流速为零）
```

**扰动施加：**
```python
方波扰动：
η₀(t) = A  （0 < t < T）
        0  （t > T）

正弦脉冲：
η₀(t) = A·sin(πt/T)  （0 < t < T）

阶跃扰动：
η₀(t) = A·H(t)  （H为Heaviside函数）
```

### 7. 分析方法

**波腹和波节识别：**
```python
波腹：振幅最大点
  ∂η/∂t = 0时η的极值

波节：振幅最小点（几乎不动）
  η ≈ 0
```

**反射时间：**
```python
波从上游传播到下游：t₁ = L/c
反射波返回上游：t₂ = 2L/c

多次反射：tₙ = n·2L/c
```

**能量分析：**
```python
动能密度：
  Eₖ = (1/2)ρh·u²

势能密度：
  Ep = (1/2)ρg·η²

总能量：
  E = ∫(Eₖ + Ep) dx
```

### 8. 特殊波动现象

**水跃（Hydraulic Jump）：**
```python
急流向缓流过渡
能量大量耗散
非线性现象
```

**涌潮（Bore）：**
```python
激波传播
间断面
满足Rankine-Hugoniot条件
```

**孤立波（Solitary Wave）：**
```python
单峰波形
无色散
保持形状传播
```

### 9. 工程应用

**水锤现象：**
```python
管道或渠道中阀门突然关闭
产生压力波动
可能损坏结构
```

**涌浪（Surge）：**
```python
水库调度产生的波动
向下游传播
影响河道水位
```

**港口晃荡（Seiche）：**
```python
封闭或半封闭水体
风或地震激发
共振放大
```

**船行波：**
```python
船舶航行产生波浪
影响岸坡稳定
限制航速
```

### 10. 实际考虑

**摩阻耗散：**
```python
实际渠道存在摩阻
波振幅逐渐衰减
反射系数 |R| < 1
```

**非线性效应：**
```python
有限振幅时线性理论失效
波形畸变
谐波产生
```

**三维效应：**
```python
横向不均匀性
侧壁反射
复杂波型
```

**边界吸收：**
```python
实际边界非完全刚性
部分能量耗散
反射减弱
```

## 计算任务

### 任务1：单次波动

模拟单个波从上游向下游传播并反射。

### 任务2：驻波形成

观察多次反射后驻波的形成过程。

### 任务3：共振现象

施加特定频率激励，观察共振放大。

### 任务4：反射系数

分析不同边界条件下的反射特性。

### 任务5：能量耗散

计算摩阻对波传播的影响。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

**波传播：**
- 波速：c = √(gh₀) ≈ 5.4 m/s
- 传播时间：t ≈ L/c ≈ 185 s
- 反射时间：t ≈ 2L/c ≈ 370 s

**驻波特征：**
- 波腹位置：渠道两端
- 波节位置：渠道中部
- 振幅放大：2倍入射波振幅

**共振频率：**
- 基频：f₁ ≈ 0.0027 Hz（T ≈ 370 s）
- 二次谐波：f₂ ≈ 0.0054 Hz

## 工程意义

本案例展示了：
1. 明渠中的波动基本理论
2. 边界反射机制
3. 驻波形成过程
4. 共振条件和危害
5. 波动数值模拟方法

## 设计要点

1. **边界条件**：
   - 上游扰动源
   - 下游刚性/自由边界
   - 反射边界实现

2. **扰动类型**：
   - 方波脉冲
   - 正弦波
   - 阶跃变化

3. **分析方法**：
   - 时空图
   - 波腹/波节识别
   - 能量计算

4. **数值精度**：
   - 空间分辨率
   - 时间步长
   - 人工耗散

## 注意事项

1. **物理简化**：
   - 线性小振幅理论
   - 无色散长波
   - 一维简化

2. **数值问题**：
   - 反射边界实现
   - 数值耗散
   - 长时间稳定性

3. **实际复杂性**：
   - 有限振幅非线性
   - 摩阻衰减
   - 三维效应

4. **共振危害**：
   - 结构疲劳
   - 漫堤风险
   - 防护措施

## 进阶主题

1. **非线性波动**：
   - KdV方程
   - Boussinesq方程
   - 孤立波

2. **波浪相互作用**：
   - 干涉
   - 衍射
   - 折射

3. **复杂边界**：
   - 部分反射
   - 透射
   - 散射

4. **耦合系统**：
   - 流固耦合
   - 水气两相流
   - 泥沙输运
