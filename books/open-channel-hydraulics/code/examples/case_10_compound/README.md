# 案例10：复式断面河道

## 案例背景

某天然河道具有主槽和滩地的复式断面形式。在中小流量时，水流仅在主槽内流动；当流量增大到一定程度时，水流漫过两岸滩地，形成复式断面流动。

工程参数：
- 主槽底宽 bm = 30 m
- 主槽深度 hm = 3.5 m
- 左滩地宽 bl = 50 m
- 右滩地宽 br = 50 m
- 主槽边坡 m1 = 2.0（水平:竖直）
- 滩地边坡 m2 = 3.0
- 河床纵坡 S0 = 0.0003
- 主槽糙率 nm = 0.028（清洁河床）
- 滩地糙率 nf = 0.035（有植被）

设计要求：
1. 计算不同水深下的过流能力
2. 分析主槽与滩地的流量分配
3. 确定漫滩流量
4. 绘制水位-流量关系曲线
5. 评估滩地对行洪能力的贡献

## 学习目标

1. 理解复式断面河道的流动特性
2. 掌握分区计算方法
3. 学会流量分配计算
4. 了解主槽与滩地的水力联系
5. 掌握复式断面的设计要点

## 核心理论

### 1. 复式断面几何

**断面组成：**
```python
    |←── bl ──→|←─ bm ─→|←── br ──→|
    ___________         ___________
   /左滩地     \       /     右滩地\
  /             \_____/             \
                 主槽
```

**分区计算原则：**
- 主槽（Main channel）：高流速、低糙率
- 左滩地（Left floodplain）：低流速、高糙率
- 右滩地（Right floodplain）：低流速、高糙率

**漫滩水深：**
```python
当 h ≤ hm 时：单式断面（仅主槽）
当 h > hm 时：复式断面（主槽+滩地）

漫滩深度：hf = h - hm
```

### 2. 分区计算方法（Divided Channel Method）

**总流量计算：**
```python
Q = Qm + Ql + Qr

Qm - 主槽流量 (m³/s)
Ql - 左滩地流量 (m³/s)
Qr - 右滩地流量 (m³/s)
```

**各分区Manning公式：**
```python
Qi = (1/ni) * Ai * Ri^(2/3) * S0^(1/2)

i = m（主槽）, l（左滩地）, r（右滩地）

Ai - 第i分区过水断面面积 (m²)
Ri - 第i分区水力半径 (m)
ni - 第i分区糙率
```

**水力半径计算：**
```python
R = A / P

P - 湿周（不包括分界面）
分界面视为虚拟边界，不计入湿周
```

### 3. 主槽几何（梯形断面）

**水深 h ≤ hm（未漫滩）：**
```python
Am = (bm + m1*h) * h
Pm = bm + 2*h*sqrt(1 + m1²)
Tm = bm + 2*m1*h

Am - 主槽面积 (m²)
Pm - 主槽湿周 (m)
Tm - 主槽水面宽 (m)
```

**水深 h > hm（已漫滩）：**
```python
主槽面积：Am = (bm + m1*hm) * hm
主槽湿周：Pm = bm + 2*hm*sqrt(1 + m1²)
主槽水面宽：Tm = bm + 2*m1*hm
```

### 4. 滩地几何（水深 h > hm）

**左滩地：**
```python
漫滩深度：hf = h - hm
Al = bl * hf + 0.5 * m2 * hf²
Pl = bl + hf*sqrt(1 + m2²)
Tl = bl + m2*hf

假设左滩地为矩形+三角形组合
```

**右滩地：**
```python
Ar = br * hf + 0.5 * m2 * hf²
Pr = br + hf*sqrt(1 + m2²)
Tr = br + m2*hf

与左滩地对称
```

### 5. 流量分配比

**主槽流量比：**
```python
αm = Qm / Q

主槽流量占总流量的比例
反映主槽的输水能力
```

**滩地流量比：**
```python
αf = (Ql + Qr) / Q = 1 - αm

滩地流量占总流量的比例
```

**流量分配特点：**
- 主槽深度大、流速高、糙率低 → 单位面积输水能力强
- 滩地浅、流速低、糙率高 → 单位面积输水能力弱
- 漫滩初期：αm ≈ 0.7-0.8（主槽占主导）
- 大水深时：αf 逐渐增大（滩地作用增强）

### 6. 综合糙率

**复式断面等效糙率：**
```python
n_eq = [(Σ(Pi * ni^(3/2))) / P_total]^(2/3)

用于将复式断面等效为单一糙率的简化计算
实际工程中较少使用，一般采用分区计算
```

### 7. 漫滩流量

**漫滩流量：**
```python
Q_bankfull = Qm(h = hm)

当 h = hm 时，主槽满流量
超过此流量即开始漫滩
```

**漫滩频率：**
```python
p = N_bankfull / N_total

N_bankfull - 年漫滩次数
N_total - 总天数

一般河道：p = 1-5%（即1-2年一遇）
```

### 8. 水位-流量关系（Q-h 关系）

**未漫滩段（h ≤ hm）：**
```python
Q = f1(h)  - 单值关系

类似普通梯形断面
Q ∝ h^(5/3)（近似）
```

**漫滩段（h > hm）：**
```python
Q = f2(h)  - 斜率变化

斜率增大（dQ/dh增大）
滩地提供额外输水能力
```

**转折点：**
- h = hm 处，Q-h曲线斜率发生变化
- 反映漫滩对过流能力的显著影响

### 9. 复式断面设计

**设计原则：**
1. 主槽满足常水流量（如5年一遇）
2. 滩地承担超额洪水（如20-50年一遇）
3. 主槽与滩地高差适当（一般hm = 3-5m）
4. 滩地不作为永久建筑用地

**主槽设计：**
- 满足航运水深要求
- 保证基本生态流量
- 便于维护疏浚
- 抗冲刷能力

**滩地管理：**
- 禁止种植高秆作物
- 控制建筑物数量
- 预留行洪断面
- 定期清障

### 10. 交互作用

**主槽与滩地相互影响：**
- 速度差：主槽流速 > 滩地流速
- 剪切层：分界面处产生涡旋
- 动量交换：主槽向滩地传递动量
- 能量损失：交互作用增大阻力

**简化假设：**
- 各分区水面线平行（忽略横向水面差）
- 各分区独立计算（忽略动量交换）
- 分界线为垂直面（简化几何）

实际复杂流动可采用二维或三维模型

## 计算任务

### 任务1：主槽单独过流能力

计算主槽满流时（h = hm）的流量。

### 任务2：复式断面过流能力

计算不同水深（h > hm）下的总流量和分区流量。

### 任务3：流量分配分析

分析主槽与滩地的流量分配比例随水深的变化。

### 任务4：水位-流量关系

绘制完整的 Q-h 关系曲线，识别漫滩转折点。

### 任务5：滩地贡献评估

评估滩地对总过流能力的贡献及其随水深的变化。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

- 主槽满流量 Qm(hm) ≈ 150-200 m³/s
- 漫滩1m时总流量 Q(hm+1) ≈ 400-500 m³/s
- 主槽流量比 αm ≈ 0.6-0.8（漫滩初期）
- 滩地对流量贡献 ΔQ ≈ 250-350 m³/s
- Q-h关系在 h = hm 处斜率显著增大

## 工程意义

本案例展示了：
1. 复式断面河道的流动特征
2. 分区计算方法的应用
3. 主槽与滩地的协同作用
4. 滩地在防洪中的重要作用
5. 河道断面设计的考虑因素

## 设计要点

1. **主槽设计**：
   - 满足常水位流量
   - 考虑航运、生态需求
   - 深度：hm = 3-5 m
   - 边坡稳定：m1 = 2-3

2. **滩地设计**：
   - 宽度：bl, br = 30-100 m
   - 高差：hm 合理（不宜过大或过小）
   - 坡度：m2 = 3-5（缓坡）
   - 糙率：控制植被

3. **过流能力**：
   - 主槽流量：Q5（5年一遇）
   - 总流量：Q20-Q50（20-50年一遇）
   - 安全超高：≥ 0.5 m
   - 防浪墙设计

4. **防护措施**：
   - 主槽护岸
   - 滩地绿化
   - 控制侵蚀
   - 定期清淤

5. **滩地管理**：
   - 禁止违章建筑
   - 控制种植
   - 预留行洪通道
   - 标识洪水位

## 注意事项

1. **计算假设**：
   - 各分区水面平行
   - 忽略横向流动
   - 分界面为垂直线
   - 适用于规则断面

2. **糙率选择**：
   - 主槽：根据河床材料
   - 滩地：考虑植被季节变化
   - 必要时现场率定
   - 洪水期与枯水期不同

3. **适用范围**：
   - 规则复式断面
   - 主槽滩地高差明显
   - 水流基本顺直
   - 不适用于特别复杂断面

4. **精度影响因素**：
   - 交互作用忽略（可能导致10-20%误差）
   - 糙率不确定性
   - 断面简化
   - 二维效应

5. **改进方法**：
   - 考虑交互阻力（Coherence Method）
   - 三维数值模拟
   - 现场实测率定
   - 分段计算水面线
