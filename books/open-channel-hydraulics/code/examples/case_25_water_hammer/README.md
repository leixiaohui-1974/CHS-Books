# 案例25：水锤基础

## 案例背景

某长距离供水管道，长度L=1000 m，管径D=500 mm，壁厚e=10 mm，初始流速v₀=2.0 m/s。当阀门突然关闭时，会产生水锤现象，导致压力急剧升高。需要计算水锤压力升高值和压力波传播过程。

工程参数：
- 管道长度 L = 1000 m
- 管径 D = 500 mm = 0.5 m
- 壁厚 e = 10 mm = 0.01 m
- 初始流速 v₀ = 2.0 m/s
- 初始压力 p₀ = 0.5 MPa = 50 m水柱
- 管材：钢管，弹性模量 E = 200 GPa
- 水的体积模量 K = 2.1 GPa
- 水的密度 ρ = 1000 kg/m³

分析目标：
1. 计算水锤压力升高值
2. 计算压力波速
3. 分析压力波传播过程
4. 判断快速关闭与缓慢关闭
5. 计算管道承受的最大压力
6. 评估管道安全性

## 学习目标

1. 理解水锤现象的物理本质
2. 掌握Joukowsky公式的应用
3. 学会计算压力波速
4. 了解压力波的反射与传播
5. 掌握快速关闭与缓慢关闭的判别

## 核心理论

### 1. 水锤现象

**定义：**
水锤（Water Hammer）是管道中液体流速突然变化时，由于液体惯性产生的压力急剧升高或降低的现象。

**产生原因：**
- 阀门突然关闭或开启
- 泵突然启动或停止
- 负荷突然变化

**危害：**
- 管道破裂
- 设备损坏
- 噪声振动
- 水质污染（管道破损）

### 2. Joukowsky公式

**基本公式：**
```python
ΔH = (a/g) * Δv
```

或压力形式：
```python
ΔP = ρ * a * Δv
```

其中：
- ΔH：水锤压力升高（m水柱）
- ΔP：水锤压力升高（Pa）
- a：压力波速（m/s）
- Δv：流速变化（m/s）
- ρ：水的密度（kg/m³）
- g：重力加速度（m/s²）

**物理意义：**
流速变化越大，波速越快，水锤压力越高。

### 3. 压力波速

**刚性管道中的波速：**
```python
a = √(K/ρ)
```

对于水：a ≈ 1435 m/s

**弹性管道中的波速（修正公式）：**
```python
a = √(K/ρ) / √(1 + (K*D)/(E*e))
```

其中：
- K：水的体积模量（Pa）
- E：管材弹性模量（Pa）
- D：管径（m）
- e：管壁厚度（m）

**典型波速值：**
- 钢管：900~1200 m/s
- 铸铁管：1000~1100 m/s
- 混凝土管：800~1000 m/s
- 塑料管：200~500 m/s

### 4. 快速关闭与缓慢关闭

**临界时间：**
```python
T_c = 2L/a
```

T_c称为相时间（phase time），是压力波往返一次所需时间。

**判别标准：**
- **快速关闭**：关闭时间 t_c ≤ T_c
  - 水锤压力达到最大值：ΔH = (a/g) * v₀

- **缓慢关闭**：关闭时间 t_c > T_c
  - 水锤压力降低：ΔH < (a/g) * v₀
  - 近似公式：ΔH ≈ (a/g) * v₀ * (T_c/t_c)

### 5. 压力波传播过程

**第一阶段（0 < t < T_c/2）：**
- 阀门关闭，流速从v₀降为0
- 压力波从阀门向水源传播
- 阀门处压力升高：p = p₀ + ΔP

**第二阶段（T_c/2 < t < T_c）：**
- 压力波到达水源，反射
- 全管道压力升高
- 阀门处流速仍为0

**第三阶段（T_c < t < 3T_c/2）：**
- 反射波返回阀门，压力波降低
- 压力恢复到p₀，但流向相反

**第四阶段（3T_c/2 < t < 2T_c）：**
- 负压波向水源传播
- 一个完整周期结束

**周期性振荡：**
由于摩擦损失，振荡逐渐衰减。

### 6. 最大压力计算

**快速关闭（t_c ≤ T_c）：**
```python
p_max = p₀ + ρ * a * v₀
```

或：
```python
H_max = H₀ + (a/g) * v₀
```

**缓慢关闭（t_c > T_c）：**
```python
p_max = p₀ + ρ * a * v₀ * (T_c/t_c)
```

### 7. 管道安全性校核

**许用压力：**
```json
[p] = 2 * σ_s * e / (D * n_s)
```

其中：
- σ_s：管材许用应力（Pa）
- e：壁厚（m）
- D：管径（m）
- n_s：安全系数（通常取2.0~2.5）

**校核条件：**
```python
p_max ≤ [p]
```

## 计算任务

### 任务1：压力波速计算

计算钢管中的压力波速a。

### 任务2：水锤压力升高值

假设阀门瞬时关闭（t_c = 0），计算水锤压力升高值ΔH和ΔP。

### 任务3：快速/缓慢关闭判别

计算临界时间T_c，判别：
- 关闭时间t_c = 1.0 s（快速还是缓慢？）
- 关闭时间t_c = 5.0 s（快速还是缓慢？）

### 任务4：最大压力计算

计算管道承受的最大压力p_max和H_max。

### 任务5：管道安全性校核

假设钢管许用应力σ_s = 140 MPa，安全系数n_s = 2.5，校核管道是否安全。

### 任务6：关闭时间影响

分析不同关闭时间（0.5, 1.0, 2.0, 5.0, 10.0 s）对最大压力的影响。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```python

## 预期结果

- 掌握水锤压力计算方法
- 理解压力波传播过程
- 学会判别快速/缓慢关闭
- 能够进行管道安全性校核

## 工程意义

本案例展示了：
1. 水锤现象的基本原理
2. Joukowsky公式的工程应用
3. 压力波速的计算方法
4. 快速关闭的危害性
5. 管道设计的安全性校核

## 防治措施

### 1. 延长关闭时间

**原理：**
使关闭时间t_c > T_c，降低水锤压力。

**措施：**
- 采用缓闭阀
- 控制阀门关闭速度
- 设置电动或液压缓闭装置

**推荐关闭时间：**
```
t_c ≥ (5~10) * T_c
```python

### 2. 设置水锤消除装置

**调压塔（Surge Tank）：**
- 开式调压塔
- 阻抗式调压塔
- 差动式调压塔

**安全阀（Relief Valve）：**
- 压力超限时自动泄压
- 快速响应

**空气阀（Air Valve）：**
- 排气防止水柱分离
- 负压时进气

**单向调压塔：**
- 只吸收正压水锤
- 结构简单

### 3. 增加管壁厚度

提高管道承压能力，但增加造价。

### 4. 采用韧性管材

塑料管、球墨铸铁管等，可吸收部分水锤能量。

### 5. 降低流速

设计时选择较大管径，降低初始流速v₀。

### 6. 分段阀门

长距离管道设置分段阀门，缩短有效长度L。

## 工程实例

### 案例1：三峡水电站

- 引水管道长度：100~200 m
- 管径：12.4 m
- 水头：80~110 m
- 防护措施：调压井 + 缓闭蝶阀

### 案例2：南水北调

- 管道长度：数十公里
- 防护措施：分段设置调压塔、安全阀
- 控制系统：SCADA实时监控，防止误操作

### 案例3：城市供水

- 问题：居民用水突然关闭水龙头产生水锤
- 措施：管道设计留有安全裕度
- 常见事故：老旧管道破裂

## 常见问题

### 1. 为什么快速关闭水锤压力更大？

快速关闭时，整个管道的水体几乎同时减速，惯性力集中释放，压力升高剧烈。缓慢关闭时，压力波有时间反射和传播，能量逐渐耗散。

### 2. 压力波速为什么与管材有关？

管道弹性越大，管壁可膨胀吸收部分能量，降低波速。刚性管道（如钢管）波速快，柔性管道（如塑料管）波速慢。

### 3. 水锤压力能达到多大？

理论上，瞬时关闭可产生数倍于初始压力的水锤压力。例如，v₀=2 m/s，a=1000 m/s，ΔH = 1000×2/9.81 ≈ 204 m，相当于2.0 MPa。

### 4. 水锤与水击的区别？

**水锤**：液体流速突然变化产生的压力波动。
**水击**：特指固体撞击产生的冲击。

工程中常混用，但严格来说水锤是流体力学现象。

### 5. 负压水锤的危害？

负压水锤会导致：
- 管道瘪陷（压扁）
- 水柱分离与再弥合（产生极大冲击）
- 空气进入管道
- 汽蚀现象

## 理论推导

### Joukowsky公式推导

**控制体分析：**

考虑管道中长度为Δx的微元段，在Δt时间内：

**动量方程：**
```
ρ * A * Δx * (Δv/Δt) = -A * ΔP
```python

**连续性方程：**
```
Δv = -a * (ΔP / (ρ * a²))
```python

消去Δx，得：
```
ΔP = ρ * a * Δv
```python

即Joukowsky公式。

### 波速公式推导

**弹性波速：**

考虑管道弹性和水的压缩性：

```
a = √(K/ρ) / √(1 + K*D/(E*e))
```python

当管壁刚性（E→∞）时：
```
a = √(K/ρ)
```

## 扩展阅读

- 《水力瞬变》（V. L. Streeter & E. B. Wylie）
- 《管道瞬变流》
- 《给水排水工程中的水锤防护》
- 《水电站过渡过程》
- ASME标准：B31.1 Power Piping
- ISO 10631: Water hammer and surge in pressure pipelines
