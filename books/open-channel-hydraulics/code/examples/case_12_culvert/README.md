# 案例12：涵洞过流

## 案例背景

某道路下方需要修建涵洞以通过灌溉渠道的水流。涵洞为矩形断面，上下游渠道已知。

工程参数：
- 涵洞宽度 b = 2.0 m
- 涵洞高度 H = 1.5 m
- 涵洞长度 L = 30 m
- 涵洞底坡 S₀ = 0.001
- 涵洞糙率 n = 0.014（混凝土）
- 设计流量 Q = 4.0 m³/s
- 上游水位可变

设计要求：
1. 判断涵洞流态（自由流、淹没流、压力流）
2. 计算不同流态下的过流能力
3. 确定控制水深和出口水深
4. 分析进出口损失
5. 设计涵洞尺寸

## 学习目标

1. 理解涵洞的多种流态
2. 掌握涵洞流量计算方法
3. 学会流态判别准则
4. 了解涵洞进出口设计
5. 掌握涵洞水力设计方法

## 核心理论

### 1. 涵洞流态分类

**根据进出口条件分类：**

1. **自由出流（Type 1-3）：**
   - 出口未被淹没
   - 下游水深 < 临界水深
   - 出口形成自由射流

2. **淹没出流（Type 4-6）：**
   - 出口被下游水位淹没
   - 下游水深 > 出口高度
   - 形成背水

3. **压力流（Type 7）：**
   - 进出口都被淹没
   - 洞内充满流
   - 按有压管道计算

### 2. 流态判别

**进口控制（Inlet Control）：**
```
条件：洞内有自由水面
控制：进口处临界水深
流量：由进口几何和上游水头决定
```

**出口控制（Outlet Control）：**
```
条件：洞内可能满管
控制：出口水深或下游水位
流量：由洞身水力特性决定
```

### 3. 自由出流（进口控制）

**流量公式：**
```
Q = Cd * A * sqrt(2*g*H1)

Cd - 流量系数（0.6-0.9）
A - 涵洞断面面积 (m²)
H1 - 上游水头（相对于洞底） (m)
g - 重力加速度 (m/s²)
```

**流量系数Cd：**
- 无翼墙直角进口：Cd = 0.60
- 圆角进口：Cd = 0.70-0.80
- 喇叭口进口：Cd = 0.85-0.90

**适用条件：**
```
h1 / H < 1.2  （未满管）
h3 < hc      （自由出流）

h1 - 上游水深
H - 涵洞高度
h3 - 下游水深
hc - 临界水深
```

### 4. 淹没出流（出口控制）

**能量方程：**
```
H1 + S0*L = H3 + hf

H1 - 上游水头（从洞底起算）
H3 - 下游水头
S0 - 涵洞底坡
L - 涵洞长度
hf - 总水头损失
```

**水头损失：**
```
hf = hf_entrance + hf_friction + hf_exit

进口损失：
hf_entrance = ζe * v²/(2g)
ζe = 0.5（直角进口）
ζe = 0.2（圆角进口）

沿程损失：
hf_friction = (n²*L*v²) / R^(4/3)

出口损失：
hf_exit = ζo * v²/(2g)
ζo = 1.0（突然扩散）
```

### 5. 压力流（满管流）

**条件：**
```
h1 / H > 1.2   （进口淹没）
h3 / H > 1.0   （出口淹没）
洞内充满流
```

**流量公式：**
```
Q = A * sqrt[(2g*(H1-H3-ΔZ)) / (1 + ζe + ζf + ζo)]

A - 涵洞断面面积
ΔZ = S0 * L - 底高程差
ζe - 进口损失系数
ζf = (n²*L) / R^(4/3) - 沿程损失系数
ζo - 出口损失系数
```

**简化形式：**
```
Q = μ * A * sqrt(2g*ΔH)

μ - 综合流量系数
ΔH - 上下游水位差
```

### 6. 临界水深

**矩形涵洞：**
```
hc = (Q² / (g*b²))^(1/3)

Q - 流量 (m³/s)
b - 涵洞宽度 (m)
g = 9.81 m/s²
```

**临界流速：**
```
vc = sqrt(g*hc)
```

### 7. 正常水深

**满宁公式求解：**
```
Q = (1/n) * A * R^(2/3) * S0^(1/2)

对于矩形：
A = b * h
P = b + 2*h
R = A / P

迭代求解正常水深 hn
```

### 8. 涵洞设计流态选择

**推荐流态：**

1. **小型涵洞（Q < 5 m³/s）：**
   - 优选自由出流（进口控制）
   - 结构简单，造价低
   - H = (1.2-1.5) * hc

2. **中型涵洞（5 < Q < 20 m³/s）：**
   - 淹没出流（出口控制）
   - 考虑下游水位影响
   - 需要详细水力计算

3. **大型涵洞（Q > 20 m³/s）：**
   - 可能采用多孔涵洞
   - 或采用桥梁方案
   - 综合经济技术比较

### 9. 进口形式

**直角进口（Square-edged）：**
- 结构简单，造价低
- Cd = 0.60, ζe = 0.5
- 过流能力差

**圆角进口（Rounded）：**
- 圆弧半径 r = 0.1-0.2H
- Cd = 0.75, ζe = 0.2
- 性价比好（推荐）

**喇叭口进口（Flared）：**
- 扩散角 10-15°
- Cd = 0.90, ζe = 0.1
- 过流能力最好，造价高

### 10. 出口设计

**出口形式：**
- 齐平出口：简单，但易冲刷
- 挑流出口：减少冲刷
- 消能池出口：大流量涵洞

**防冲措施：**
- 出口铺砌
- 护坦
- 海漫
- 防冲槽

## 计算任务

### 任务1：临界水深和正常水深

计算涵洞的临界水深和正常水深。

### 任务2：自由出流计算

计算自由出流时的流量和水深。

### 任务3：淹没出流计算

计算淹没出流时的水头损失和流量。

### 任务4：压力流计算

计算压力流时的流量和水头差。

### 任务5：流态判别

根据上下游水位判别涵洞流态。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

**涵洞参数（b=2m, H=1.5m, L=30m）：**
- 临界水深 hc ≈ 0.74 m
- 正常水深 hn ≈ 0.85 m
- 临界流速 vc ≈ 2.69 m/s

**自由出流（h1=1.5m）：**
- 流量系数 Cd = 0.70（圆角进口）
- 计算流量 Q ≈ 4.0 m³/s
- 出口流速 v ≈ 2.7 m/s

**淹没出流（h1=2.0m, h3=1.6m）：**
- 进口损失 ≈ 0.05 m
- 沿程损失 ≈ 0.12 m
- 出口损失 ≈ 0.10 m
- 总损失 ≈ 0.27 m

**压力流（h1=2.5m, h3=2.0m）：**
- 综合流量系数 μ ≈ 0.85
- 计算流量 Q ≈ 5.5 m³/s
- 洞内充满流

## 工程意义

本案例展示了：
1. 涵洞的多种流态及判别
2. 不同流态的计算方法
3. 进出口形式的影响
4. 涵洞水力设计流程
5. 工程优化设计要点

## 设计要点

1. **尺寸选择**：
   - 宽度：b = 1.5-4.0 m（常用）
   - 高度：H = 1.0-3.0 m
   - 高宽比：H/b = 0.5-1.0
   - 长度：L取决于路堤宽度

2. **进口设计**：
   - 优先采用圆角进口
   - 圆角半径 r = 0.15H
   - 避免直角进口
   - 设置翼墙引导水流

3. **洞身设计**：
   - 底坡 S₀ = 0.001-0.005
   - 糙率：混凝土 n = 0.013-0.015
   - 保证足够覆土厚度
   - 结构强度校核

4. **出口设计**：
   - 设置消能设施
   - 防止下游冲刷
   - 护坦长度 ≥ 3H
   - 海漫长度 ≥ 5H

5. **水力设计**：
   - 避免进口淹没（经济性差）
   - 控制洞内流速 v < 3-4 m/s
   - 校核不同频率流量
   - 考虑泥沙淤积

6. **结构设计**：
   - 基础处理
   - 沉降缝设置
   - 防渗处理
   - 抗浮稳定

## 注意事项

1. **流态判别**：
   - 根据上下游水位判别
   - 不同流态公式不同
   - 临界情况需仔细分析

2. **损失系数**：
   - 进口系数取决于形式
   - 出口通常取1.0
   - 实际工程可率定

3. **设计标准**：
   - 小型涵洞：5-10年一遇
   - 重要涵洞：20-50年一遇
   - 校核：百年一遇或更高

4. **施工质量**：
   - 尺寸偏差控制
   - 表面光滑度
   - 接缝处理
   - 防渗措施

5. **运行维护**：
   - 定期检查
   - 清除淤积
   - 修补破损
   - 疏通进出口

## 特殊情况

1. **斜交涵洞**：
   - 交角 > 30°时损失增大
   - 进口设计需特殊处理

2. **多孔涵洞**：
   - 流量分配不均
   - 中孔流量大于边孔

3. **弯道涵洞**：
   - 尽量避免
   - 必要时加大断面

4. **长涵洞**：
   - L/H > 50 时摩阻显著
   - 按明渠水面线计算
