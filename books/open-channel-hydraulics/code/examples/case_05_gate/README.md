# 案例5：渠道闸门出流计算

## 案例背景

某灌区干渠上设有平板闸门，用于控制下游流量和水位。闸门参数：

闸门参数：
- 闸门宽度 b = 2.0 m
- 流量系数 μ = 0.60
- 上游水深 H = 2.0-4.0 m
- 闸门开度 e = 0.2-1.5 m

设计要求：
1. 计算不同开度下的过闸流量
2. 判断闸门出流形态（自由出流或淹没出流）
3. 分析下游水深对流量的影响
4. 优化闸门开度，满足设计流量

## 学习目标

1. 理解闸门出流的基本原理
2. 掌握自由出流和淹没出流的计算
3. 学会判断出流形态
4. 了解流量系数的影响
5. 掌握闸门调度计算

## 核心理论

### 1. 闸门出流基本概念

**闸门的作用：**
- 控制流量（调节开度）
- 调节水位（抬高上游水位）
- 挡水（全关闭）
- 泄水（全开启）

**出流特点：**
- 孔口出流（束流）
- 收缩系数影响
- 能量损失较大
- 流态受下游水位影响

### 2. 自由出流公式

当下游水深较小时，形成自由出流：

```python
Q = μ * b * e * sqrt(2g * H)

其中：
Q - 流量 (m³/s)
μ - 流量系数（0.55-0.65）
b - 闸门宽度 (m)
e - 闸门开度 (m)
H - 上游水头（从闸底算起，m）
g - 重力加速度 (9.81 m/s²)
```

**流量系数 μ：**
- 平板闸门：μ = 0.60
- 弧形闸门：μ = 0.65
- 深孔闸门：μ = 0.55

**判别条件：**
```python
h2 < hc   (下游水深小于收缩水深)
hc ≈ 0.6 * e  (收缩水深约为开度的0.6倍)
```

### 3. 淹没出流公式

当下游水深较大时，形成淹没出流：

```python
Q = μ * b * e * sqrt(2g * (H - h2))

h2 - 下游水深 (m)
(H - h2) - 作用水头差
```

**淹没度：**
```python
σ = h2 / H

σ < 0.6：自由出流
σ > 0.8：完全淹没出流
0.6 < σ < 0.8：过渡区
```

**淹没出流特点：**
- 流量减小（有效水头降低）
- 能量损失更大
- 出流稳定性好
- 对下游水位敏感

### 4. 闸门水力计算

**给定流量求开度：**
```python
e = Q / (μ * b * sqrt(2g * H))
```

**给定开度求流量：**
```python
Q = μ * b * e * sqrt(2g * H)  (自由出流)
Q = μ * b * e * sqrt(2g * (H - h2))  (淹没出流)
```

**水头损失：**
```python
ΔH = H - h2 - v2²/(2g)

其中 v2 = Q / (b * h2) 为下游流速
```

### 5. 收缩断面

**收缩系数：**
```python
Cc = Ac / (b * e)

Ac - 收缩断面面积
Cc ≈ 0.61 (平板闸门)
```

**收缩水深：**
```python
hc = Cc * e ≈ 0.61 * e
```

**收缩断面流速：**
```python
vc = Q / Ac = Q / (b * hc)
```

## 计算任务

### 任务1：自由出流计算

给定上游水深和闸门开度，计算自由出流流量。

### 任务2：淹没出流计算

考虑下游水深影响，计算淹没出流流量。

### 任务3：出流形态判别

根据上下游水位关系，判断是自由出流还是淹没出流。

### 任务4：闸门开度计算

给定设计流量，反算所需的闸门开度。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

- 自由出流流量计算准确
- 淹没判别正确
- 开度计算合理
- 流量系数在合理范围

## 工程意义

本案例展示了：
1. 闸门水力计算方法
2. 出流形态的判别
3. 闸门调度计算
4. 流量控制策略
5. 灌区水量分配

## 设计要点

1. **闸门选型**：
   - 小流量：平板闸门
   - 大流量：弧形闸门
   - 深孔：深孔闸门
   - 浅孔：表孔闸门

2. **开度控制**：
   - 最小开度 > 0.1 m（防止堵塞）
   - 最大开度 < 0.8*H（保证稳定）
   - 调节范围：通常为1:10-1:15

3. **流量系数确定**：
   - 新建闸门：现场率定
   - 标准闸门：查表取值
   - 老旧闸门：定期校测

4. **运行管理**：
   - 缓慢启闭（防止水锤）
   - 避免振动（高速水流）
   - 定期检修（密封磨损）
   - 防止泥沙淤积

5. **安全要求**：
   - 防止过流（闸前水位不超限）
   - 防止冲刷（闸后消能）
   - 防止空蚀（高速水流）
   - 防止漂浮物卡阻
