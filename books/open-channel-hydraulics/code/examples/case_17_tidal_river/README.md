# 案例17：潮汐河口非恒定流

## 案例背景

某河口地区受潮汐影响，河道水位和流速呈周期性变化。上游河流提供稳定径流，下游受海洋潮汐控制。

工程参数：
- 河道长度 L = 20000 m (20 km)
- 河道宽度 b = 200 m
- 河道坡度 S₀ = 0.00005（极缓坡）
- 糙率系数 n = 0.03（淤泥河床）
- 上游径流 Qr = 500 m³/s
- 潮汐振幅 A = 2.0 m
- 潮汐周期 T = 12.42 小时（半日潮）

计算要求：
1. 模拟潮汐传播过程
2. 分析潮差沿程变化
3. 计算涨潮和落潮流速
4. 研究径流与潮汐的相互作用
5. 评估潮汐影响范围

## 学习目标

1. 理解潮汐河口的水力特性
2. 掌握周期性边界条件设置
3. 学会潮汐传播分析
4. 了解河流-海洋相互作用
5. 掌握潮汐预报方法

## 核心理论

### 1. 潮汐基本概念

**潮汐类型：**
```python
半日潮：周期约12.42小时（月球引力为主）
全日潮：周期约24.84小时
混合潮：半日潮和全日潮的组合
```

**潮汐要素：**
```python
潮差（Tidal Range）：高潮位与低潮位之差
潮高（Tidal Height）：某时刻潮位相对平均海平面的高度
潮流（Tidal Current）：潮汐引起的往复流动
涨潮（Flood Tide）：潮位上升过程
落潮（Ebb Tide）：潮位下降过程
憩流（Slack Water）：涨落潮转换时流速为零
```

**潮汐方程（简化）：**
```python
h(t) = h₀ + A·sin(ωt + φ)

其中：
  h₀ = 平均潮位
  A = 潮汐振幅
  ω = 角频率 = 2π/T
  T = 潮汐周期
  φ = 初相位
```

### 2. 潮汐河口特性

**控制方程：**
```python
Saint-Venant方程（含潮汐项）：
∂A/∂t + ∂Q/∂x = 0
∂Q/∂t + ∂(Q²/A)/∂x + gA·∂h/∂x = gA(S₀ - Sf)

边界条件：
  上游：Q(0,t) = Qr（径流）
  下游：h(L,t) = h₀ + A·sin(ωt)（潮汐）
```

**潮波传播：**
```python
潮波波速（小振幅理论）：
  c = √(gh)

相速度：
  cp = ω/k

群速度：
  cg = ∂ω/∂k

其中 k 为波数
```

**潮汐衰减：**
```python
沿程振幅衰减：
  A(x) = A₀·exp(-αx)

衰减系数：
  α ≈ (n²g|U|)/(2h²c)

其中 U 为平均流速
```

### 3. 径流与潮汐相互作用

**无量纲参数：**
```python
径流-潮汐比：
  R = Qr/(A·b·c)

R << 1：潮汐主导
R ≈ 1：径流与潮汐相当
R >> 1：径流主导
```

**潮流不对称：**
```python
涨潮流速 > 落潮流速（径流作用）

涨潮历时 < 落潮历时

最大流速相位超前于高/低潮位
```

**潮限（Tidal Limit）：**
```python
潮汐影响消失的上游位置

判据：潮差 < 0.1m 或相位滞后 > 180°
```

### 4. 潮汐传播特性

**波速变化：**
```python
浅水中：c = √(gh)

随水深减小，波速降低
涨潮时波速 > 落潮时波速
```

**相位滞后：**
```python
相位滞后角：
  Δφ = ∫(ω/c) dx

滞后时间：
  Δt = Δφ/ω
```

**潮差变化：**
```python
河口汇聚效应：潮差放大
摩阻衰减：潮差减小
两者共同作用决定沿程潮差变化
```

### 5. 数值模拟方法

**初始条件：**
```python
稳态初始条件（平均潮位）：
  h(x,0) = h₀
  Q(x,0) = Qr

或从恒定流解开始：
  求解 dQ/dx = 0, 能量方程
```

**边界条件实现：**
```python
def bc_upstream(t):
    """上游径流边界"""
    Q = Qr  # 恒定径流
    h = compute_normal_depth(Q)
    return h, Q

def bc_downstream(t):
    """下游潮汐边界"""
    h = h0 + A * np.sin(omega * t + phi)
    Q = None  # 由内部计算
    return h, Q
```python

**网格要求：**
```
空间步长：Δx = 200-500 m
时间步长：满足CFL条件
模拟时长：至少2-3个潮周期
```python

**稳定性：**
```
CFL条件：Δt ≤ Δx/(|v|+c)

潮汐问题波速较大，需较小时间步长
```python

### 6. 潮汐预报

**调和分析：**
```
将复杂潮汐分解为多个简谐分量：
h(t) = h₀ + ΣAᵢ·cos(ωᵢt - φᵢ)

主要分潮：
  M₂：主半日分潮（12.42h）
  S₂：太阳半日分潮（12.00h）
  K₁：太阴日分潮（23.93h）
  O₁：主太阴日分潮（25.82h）
```python

**潮汐预报方程：**
```
基于历史观测数据的经验公式
或数值模式实时预报
```python

**潮流预报：**
```
流速与潮位关系：
  v(t) ≈ (A·ω/h)·cos(ωt)

最大流速出现在涨平潮和落平潮
```python

### 7. 工程应用

**通航条件：**
```
最小通航水深：h_min
最大流速限制：v_max
可通航时间窗口
```python

**取水口设置：**
```
位置选择：避开盐水楔
高程设计：保证低潮时取水
防潮闸：控制潮水倒灌
```python

**桥梁设计：**
```
桥面高程：高于最高潮位 + 安全余量
桥墩冲刷：考虑最大潮流流速
```python

**港口调度：**
```
利用高潮位进港
大船需等待潮汐窗口
```python

### 8. 特殊现象

**涌潮（Tidal Bore）：**
```
产生条件：
  - 喇叭形河口
  - 潮差大（>3m）
  - 河床坡度缓

著名涌潮：
  - 钱塘江涌潮
  - 亚马逊河涌潮
```python

**盐水楔（Salt Wedge）：**
```
密度差引起的层化流动
高密度海水在底层侵入
影响河口水质和生态
```python

**潮汐能耗散：**
```
摩阻耗散：主要机制
底床粗糙度影响
浅水区耗散更强
```python

### 9. 分析方法

**调和分析：**
```
傅里叶级数分解
提取各分潮振幅和相位
预测未来潮汐
```python

**振幅-相位图：**
```
绘制潮差和相位沿程分布
判断潮汐性质（前进波/驻波）
```python

**流速椭圆：**
```
涨潮和落潮流速矢量
判断往复流或旋转流
```python

**能量分析：**
```
潮汐能通量
能量耗散率
河口能量收支
```python

### 10. 简化与假设

**本案例假设：**
```
1. 一维流动（忽略横向变化）
2. 均质流体（忽略盐度分层）
3. 矩形断面（简化几何）
4. 刚性边界（忽略河床冲淤）
5. 单一潮汐分潮（简化潮汐）
```python

**实际河口的复杂性：**
```
1. 三维流动结构
2. 盐度分层（密度流）
3. 复杂地形和岸线
4. 河床演变
5. 多分潮叠加
6. 风应力和波浪
7. 淡水-海水混合
```python

### 11. 关键参数

**潮汐特征尺度：**
```
潮汐激励尺度：
  LT = c·T/(2π) = (T/(2π))√(gh)

对于 T=12.42h, h=5m:
  LT ≈ 50 km

潮汐影响长度取决于 LT 和衰减
```python

**无量纲时间：**
```
τ = t/T  （以潮周期为单位）

涨潮：0 < τ < 0.5
落潮：0.5 < τ < 1.0
```python

**Froude数变化：**
```
Fr = v/√(gh)

涨潮：Fr增大（正向流）
落潮：Fr减小或为负（反向流）
憩流：Fr = 0
```python

## 计算任务

### 任务1：单周期潮汐模拟

模拟一个完整潮汐周期的传播过程。

### 任务2：多周期稳定分析

模拟2-3个潮周期，观察达到周期性稳态。

### 任务3：潮差沿程分布

分析潮汐振幅和相位的沿程变化。

### 任务4：流速变化

分析涨潮和落潮的流速分布。

### 任务5：径流影响

研究不同径流量对潮汐传播的影响。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

**潮汐传播：**
- 潮波从下游向上游传播
- 相位逐渐滞后（约2-3小时）
- 振幅逐渐衰减（约30-50%）

**流速特性：**
- 涨潮最大流速：约0.8-1.2 m/s
- 落潮最大流速：约1.0-1.4 m/s（含径流）
- 流速超前潮位约3小时

**潮限位置：**
- 潮汐影响范围：约15-18 km
- 潮差衰减至0.1m处

## 工程意义

本案例展示了：
1. 潮汐河口的水力特性
2. 周期性边界条件处理
3. 河流-海洋相互作用
4. 潮汐预报基本方法
5. 河口工程设计依据

## 设计要点

1. **边界条件**：
   - 上游恒定径流
   - 下游周期性潮汐
   - 初始条件设置

2. **数值稳定性**：
   - CFL条件
   - 周期性波动
   - 长时间积分

3. **结果分析**：
   - 潮汐要素提取
   - 调和分析
   - 相位滞后计算

4. **工程应用**：
   - 通航条件
   - 取水口设计
   - 防潮标准

## 注意事项

1. **物理简化**：
   - 忽略盐度分层
   - 一维简化
   - 单一潮汐分潮

2. **数值问题**：
   - 需多个周期达到稳态
   - 长时间积分稳定性
   - 边界条件处理

3. **实际复杂性**：
   - 真实河口为三维
   - 含盐度和温度效应
   - 地形复杂多变

4. **模型验证**：
   - 需实测资料校核
   - 潮位站数据对比
   - 流速剖面验证

## 进阶主题

1. **多分潮模拟**：
   - M₂+S₂组合
   - 大潮和小潮
   - 潮汐不等

2. **盐度输运**：
   - 对流-扩散方程
   - 盐水楔模拟
   - 河口混合

3. **二维/三维模型**：
   - 横向环流
   - 层化结构
   - 真实地形

4. **泥沙输运**：
   - 悬沙浓度
   - 河口淤积
   - 涨落潮输沙
