# 案例9：河道糙率率定

## 案例背景

某天然河道需要进行水文测验和防洪计算，需要准确确定河道的糙率系数n。通过实测流量和水位数据，反算糙率系数。

实测数据：
- 断面1（上游）：B = 45 m，h₁ = 3.2 m，Q = 180 m³/s
- 断面2（下游）：B = 48 m，h₂ = 3.0 m，Q = 180 m³/s
- 断面间距 L = 500 m
- 河床平均坡度估算 S₀ ≈ 0.0004

设计要求：
1. 根据实测数据反算糙率系数
2. 分析糙率的合理性
3. 建立流量-水位关系曲线
4. 评估糙率的不确定性
5. 提出糙率取值建议

## 学习目标

1. 理解糙率系数的物理意义
2. 掌握糙率率定的基本方法
3. 学会利用实测数据反算参数
4. 了解糙率的影响因素
5. 掌握糙率取值的工程经验

## 核心理论

### 1. 糙率系数的定义

Manning公式：
```python
v = (1/n) * R^(2/3) * S^(1/2)

n - Manning糙率系数
R - 水力半径 (m)
S - 水面坡度或河床坡度
```

糙率系数反映河床粗糙程度：
- n值越大，河床越粗糙，阻力越大
- n值越小，河床越光滑，阻力越小

### 2. 糙率率定方法

**方法1：单断面法**
```python
已知：Q, h, B, S₀
求解：n

从 Q = A * v = A * (1/n) * R^(2/3) * S^(1/2)
反算：n = A * R^(2/3) * S^(1/2) / Q
```

**方法2：双断面法**
```python
已知：断面1和断面2的Q, h, B，以及断面间距L
计算：水面坡度 Sf = (E₁ - E₂) / L
反算：n = A * R^(2/3) * Sf^(1/2) / Q
```

**方法3：多次测量平均法**
```python
多次不同流量下的测量数据
对每次测量分别率定n值
取平均值或建立n-Q关系
```

### 3. 糙率的影响因素

**河床材料：**
- 光滑混凝土：n = 0.012-0.015
- 浆砌石：n = 0.020-0.025
- 卵石河床：n = 0.025-0.035
- 天然河道：n = 0.025-0.050
- 淤泥、杂草：n = 0.030-0.060

**河床形态：**
- 顺直河段：n较小
- 弯曲河段：n增大10-20%
- 断面不规则：n增大15-25%

**植被状况：**
- 无植被：基本n值
- 杂草覆盖：n增加30-50%
- 灌木丛：n增加50-100%

**水深影响：**
- 浅水时（h<1m）：n较大
- 深水时（h>3m）：n较小
- 相对粗糙度效应

**季节变化：**
- 汛期（清水）：n较小
- 枯水期（杂草）：n较大
- 冬季（冰凌）：n增大

### 4. 糙率率定的不确定性

**数据误差：**
- 流量测量误差：±5-10%
- 水位测量误差：±2-5cm
- 断面测量误差：±5-10%

**模型误差：**
- Manning公式适用性
- 断面代表性
- 坡度计算方法

**率定结果不确定性：**
```python
Δn / n ≈ sqrt((ΔQ/Q)² + (2/3*ΔR/R)² + (1/2*ΔS/S)²)
```

### 5. 综合糙率计算

**复合断面：**
河道由主槽和滩地组成时，使用面积加权：
```python
n_composite = (Σ(n_i * A_i * R_i^(2/3))) / (Σ(A_i * R_i^(2/3)))
```

**分段糙率：**
河道不同河段糙率不同时：
```python
n_avg = ((Σ(n_i^(3/2) * L_i)) / L_total)^(2/3)
```

## 计算任务

### 任务1：单断面糙率率定

利用单个断面的实测数据反算糙率。

### 任务2：双断面糙率率定

利用上下游两个断面的数据，考虑水面坡度。

### 任务3：糙率合理性检验

将率定结果与经验值对比，评估合理性。

### 任务4：不确定性分析

分析测量误差对糙率率定的影响。

### 任务5：流量-水位关系

建立该河段的流量-水位关系曲线。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

- 率定糙率：n ≈ 0.030-0.035
- 误差范围：Δn ≈ ±0.003-0.005
- 河道类型：天然河道，卵石河床
- Q-h关系：h = a * Q^b
- 适用范围：Q = 100-300 m³/s

## 工程意义

本案例展示了：
1. 糙率系数的率定方法
2. 实测数据的应用
3. 参数不确定性分析
4. 流量-水位关系建立
5. 糙率取值的工程经验

## 设计要点

1. **测量要求**：
   - 流量测量：流速仪法或浮标法
   - 水位测量：精确至±2cm
   - 断面测量：多点测深
   - 坡度测量：水准测量

2. **数据处理**：
   - 剔除异常数据
   - 多次测量取平均
   - 考虑季节影响
   - 建立统计关系

3. **糙率选择**：
   - 参考经验值
   - 现场调查确认
   - 季节修正
   - 分段考虑

4. **应用限制**：
   - 适用流量范围
   - 适用水位范围
   - 河床变化影响
   - 定期复核

5. **工程应用**：
   - 洪水位推算
   - 水库调度
   - 防洪计算
   - 水文预报
