# 案例14：洪水演进计算

## 案例背景

某河道长50km，上游发生洪水，需要预测洪水在河道中的演进过程，为下游防洪提供预见期。

工程参数：
- 河道长度 L = 50000 m
- 河道宽度 b = 80 m
- 河床坡度 S₀ = 0.0001
- 糙率 n = 0.030（天然河道）
- 初始流量 Q₀ = 500 m³/s
- 设计洪水峰值 Q_peak = 2000 m³/s

设计要求：
1. 模拟洪水在河道中的演进
2. 分析洪峰传播速度和衰减
3. 计算下游防洪预见期
4. 评估河道蓄洪作用
5. 提供不同断面的洪水过程线

## 学习目标

1. 掌握洪水演进计算方法
2. 理解洪峰衰减机理
3. 学会洪水预见期计算
4. 了解河道调蓄作用
5. 掌握洪水预报技术

## 核心理论

### 1. 洪水波特性

**洪水波分类：**
```python
按形态：
  - 涨水波：水位上升
  - 落水波：水位下降
  - 洪峰：最大流量时刻

按传播：
  - 平移波：波形基本保持
  - 扩散波：波形展宽变缓
  - 动力波：完整Saint-Venant方程
```

**洪水波要素：**
- 峰现流量 Q_peak
- 峰现时间 t_peak
- 洪量 W（洪水总水量）
- 涨峰历时 t_rise
- 退水历时 t_fall

### 2. 洪水演进过程

**物理过程：**
```python
1. 上游洪峰到达
2. 河道水位抬升
3. 河道开始蓄水
4. 洪峰向下游传播
5. 波形逐渐展宽
6. 峰值逐渐降低
7. 到达下游断面
```

**河道调蓄作用：**
```python
蓄水量：
ΔV = ∫(Q_in - Q_out) dt

削峰作用：
Q_peak_out < Q_peak_in

滞后作用：
t_peak_out > t_peak_in
```

### 3. 洪峰传播速度

**理论波速：**
```python
小扰动波速：
c = √(gh)

实际洪峰传播速度：
v_peak ≈ v + c = v + √(gh)

对于缓流（Fr<1）：
v_peak ≈ 1.5 * v_avg

经验公式：
v_peak = k * v_avg
k = 1.3-1.7（取决于河道特性）
```

**传播时间：**
```python
到达时间：
t_arrival = L / v_peak

预见期：
T_forecast = t_arrival
```

### 4. 洪峰衰减

**衰减原因：**
1. 河道蓄水作用
2. 摩阻能量损失
3. 波形扩散
4. 漫滩蓄洪（复式断面）

**衰减系数：**
```matlab
α = (Q_in - Q_out) / Q_in

一般河道：α = 5-20%
宽阔河道：α = 10-30%
峡谷河道：α = 1-5%
```

**影响因素：**
- 河道长度（L越长，衰减越大）
- 河道宽度（b越大，蓄水越多）
- 河床坡度（S₀越小，衰减越大）
- 河道糙率（n越大，衰减越大）
- 洪水过程线形状（尖瘦衰减大）

### 5. 河道蓄量计算

**蓄水量变化：**
```python
dV/dt = Q_in - Q_out

V(t) = ∫₀ᵗ (Q_in - Q_out) dt

最大蓄量：
V_max = ∫₀ᵗᵖ (Q_in - Q_out) dt

t_p - 下游峰现时刻
```

**蓄量-水位关系：**
```python
V = f(h) = ∫ A(h) dx

对于棱柱体河道：
V = L * A(h)

对于非均匀河道：
V = Σ Δx_i * A_i(h_i)
```

### 6. 洪水过程线

**典型洪水过程线形状：**
```python
三角形过程线：
  - 涨水段：线性上升
  - 退水段：线性下降
  - 简化计算用

实测过程线：
  - 涨水快、退水慢
  - 不对称
  - 实际预报用
```

**过程线参数：**
```python
基流 Q_base：洪前流量
洪峰流量 Q_peak：最大值
洪峰时间 t_peak：达到峰值的时间
涨峰历时 t_rise：从基流到洪峰
退水历时 t_fall：从洪峰到基流
洪量 W = ∫ Q dt
```

### 7. 马斯京根法（Muskingum Method）

**简化演算方法：**
```python
基本方程：
S = K[xI + (1-x)O]

S - 河段蓄量 (m³)
I - 入流流量 (m³/s)
O - 出流流量 (m³/s)
K - 蓄量常数 (s)
x - 流量比重系数 (0-0.5)

差分形式：
O₂ = C₀I₂ + C₁I₁ + C₂O₁

系数：
C₀ = (-Kx + 0.5Δt) / (K - Kx + 0.5Δt)
C₁ = (Kx + 0.5Δt) / (K - Kx + 0.5Δt)
C₂ = (K - Kx - 0.5Δt) / (K - Kx + 0.5Δt)
C₀ + C₁ + C₂ = 1
```

**参数确定：**
```python
K：约等于洪峰传播时间
  K ≈ L / v_peak

x：河道特性参数
  棱柱体河道：x = 0
  蓄量主要在入流端：x = 0.5
  一般河道：x = 0.1-0.3
```

### 8. 特征河段长度

**河段划分：**
```python
特征长度：
Δx = v_peak * Δt

推荐：
Δx = (2-5) km（天然河道）
Δx = 500-2000 m（渠道）
```

### 9. 洪水预报

**预报内容：**
- 洪峰流量
- 峰现时间
- 洪水过程线
- 水位变化

**预报方法：**
1. **确定性预报**：基于水文模型
2. **统计预报**：基于历史资料
3. **实时校正**：根据实测修正

**预报精度评价：**
```matlab
峰值相对误差：
ε_Q = |Q_obs - Q_fcst| / Q_obs

峰现时间误差：
ε_t = |t_obs - t_fcst|

合格标准：
  ε_Q < 20%
  ε_t < 3小时（大河）
  ε_t < 1小时（中小河）
```

### 10. 工程应用

**防洪调度：**
- 下游预警
- 转移群众
- 水库调度
- 闸门控制

**洪水预报系统：**
```python
输入：
  - 上游水文站流量
  - 降雨预报
  - 水库调度计划

计算：
  - 洪水演进模型
  - 实时校正

输出：
  - 下游各断面洪水过程线
  - 预见期
  - 预警信息
```

## 计算任务

### 任务1：建立洪水过程线

构造典型的洪水入流过程线。

### 任务2：洪水演进计算

使用Saint-Venant方程计算洪水演进。

### 任务3：洪峰传播分析

分析洪峰的传播速度和时间。

### 任务4：洪峰衰减计算

计算沿程洪峰的衰减规律。

### 任务5：河道调蓄分析

分析河道的蓄洪作用和蓄量变化。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

**洪水波传播：**
- 上游洪峰：2000 m³/s
- 传播速度：约3-4 m/s
- 到达下游：约4-5小时
- 预见期：4-5小时

**洪峰衰减：**
- 下游洪峰：约1700-1800 m³/s
- 衰减幅度：10-15%
- 削峰作用显著

**河道蓄量：**
- 最大蓄量：约100-150万m³
- 蓄量发生在涨水阶段
- 退水阶段释放蓄量

## 工程意义

本案例展示了：
1. 实际洪水演进的计算方法
2. 洪水预报的基本原理
3. 河道调蓄作用的定量分析
4. 防洪预见期的确定
5. 洪水预警系统的建立

## 设计要点

1. **模型精度**：
   - 断面资料准确
   - 糙率合理率定
   - 边界条件可靠
   - 数值格式适当

2. **预报精度**：
   - 洪峰流量：±15-20%
   - 峰现时间：±2-3小时
   - 洪水过程：趋势正确
   - 实时校正提高精度

3. **预见期**：
   - 取决于河道长度
   - 长河道预见期长
   - 一般：3-12小时
   - 大河可达24小时以上

4. **实用建议**：
   - 多站联合预报
   - 实时资料修正
   - 多方案比较
   - 经验判断结合

5. **系统建设**：
   - 水文遥测系统
   - 实时计算平台
   - 预警发布系统
   - 应急响应机制

## 注意事项

1. **模型适用性**：
   - 一维模型适用于河道洪水
   - 漫滩需二维模型
   - 溃坝需特殊处理

2. **数据需求**：
   - 实测流量过程线
   - 河道断面资料
   - 历史洪水资料
   - 糙率参数

3. **预报限制**：
   - 上游资料可得性
   - 模型计算时间
   - 预报不确定性
   - 极端洪水的预报难度

4. **误差来源**：
   - 入流过程不准
   - 糙率误差
   - 断面简化
   - 数值误差

5. **改进方向**：
   - 实时数据同化
   - 集合预报
   - 机器学习辅助
   - 多模型集成
