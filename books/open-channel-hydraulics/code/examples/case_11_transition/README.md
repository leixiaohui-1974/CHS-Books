# 案例11：渠道变宽与收缩

## 案例背景

某灌溉渠道系统中，渠道断面在不同位置需要进行变宽或收缩。渠道从断面1（B₁ = 4 m）过渡到断面2（B₂ = 6 m，扩散段）或收缩到断面2（B₂ = 3 m，收缩段）。

工程参数：
- 上游断面宽度 B₁ = 4.0 m
- 下游断面宽度 B₂ = 6.0 m（扩散）或 3.0 m（收缩）
- 渠底坡度 S₀ = 0.0002
- 糙率 n = 0.020（混凝土衬砌）
- 设计流量 Q = 12 m³/s
- 渐变段长度 L = 20 m

设计要求：
1. 计算扩散段的水面线变化
2. 计算收缩段的水面线变化
3. 分析渐变段的能量损失
4. 确定合理的渐变段长度
5. 比较突然扩散与渐变扩散

## 学习目标

1. 理解渠道变宽和收缩的水力特性
2. 掌握渐变段水面线计算方法
3. 学会渐变段能量损失计算
4. 了解渐变段长度设计方法
5. 掌握渐变段工程设计要点

## 核心理论

### 1. 渐变段类型

**扩散段（Expansion）：**
```
断面变宽：B₁ < B₂
水深变化：h₁ < h₂（缓流）
流速变化：v₁ > v₂
能量变化：有损失
```

**收缩段（Contraction）：**
```
断面变窄：B₁ > B₂
水深变化：h₁ > h₂（缓流）
流速变化：v₁ < v₂
能量变化：损失较小
```

### 2. 渐变角度

**渐变角定义：**
```
扩散段：
tan(θ) = (B₂ - B₁) / (2*L)

收缩段：
tan(θ) = (B₁ - B₂) / (2*L)

其中：
θ - 渐变角（边壁与轴线夹角）
L - 渐变段长度 (m)
```

**推荐角度：**
- 扩散段：θ ≤ 12.5°（tan θ ≤ 0.22）
- 收缩段：θ ≤ 30°（tan θ ≤ 0.58）
- 超过此角度视为突然扩散/收缩

### 3. 能量方程

**一般形式：**
```
E₁ + S₀*L = E₂ + hf

E₁ = h₁ + v₁²/(2g)  - 上游比能
E₂ = h₂ + v₂²/(2g)  - 下游比能
hf - 沿程及局部损失

hf = Sf_avg * L + ζ * v²/(2g)

Sf_avg - 平均摩阻坡度
ζ - 局部阻力系数
```

### 4. 扩散段能量损失

**渐变扩散（θ ≤ 12.5°）：**
```
hf = ζ_e * (v₁² - v₂²) / (2g)

ζ_e - 扩散损失系数
    = 0.1-0.2（良好渐变）
    = 0.3-0.5（一般渐变）
```

**突然扩散（θ > 12.5°）：**
```
hf = (v₁ - v₂)² / (2g)

相当于ζ = 1.0
损失远大于渐变扩散
```

**Borda-Carnot公式：**
```
hf = [(A₁/A₂ - 1)²] * v₂² / (2g)

适用于突然扩散
```

### 5. 收缩段能量损失

**渐变收缩（θ ≤ 30°）：**
```
hf = ζ_c * v₂² / (2g)

ζ_c - 收缩损失系数
    = 0.05-0.10（良好渐变）
    = 0.15-0.25（一般渐变）
```

**突然收缩：**
```
ζ_c = 0.5 * [1 - (A₂/A₁)]

收缩损失明显小于扩散损失
```

### 6. 水面线计算

**缓流扩散（常见情况）：**
- 从下游向上游推算
- 水深逐渐减小
- 形成M1型壅水曲线

**缓流收缩：**
- 从上游向下游推算
- 水深逐渐减小
- 形成M2型降水曲线

**计算方法：**
- 标准步长法（Standard Step Method）
- 考虑断面宽度变化
- 考虑局部能量损失

### 7. 渐变段长度设计

**扩散段长度：**
```
L = (B₂ - B₁) / (2 * tan θ)

推荐：θ = 10-12.5°
则：L = (2.25-2.86) * (B₂ - B₁)

简化：L ≥ 2.5 * (B₂ - B₁)
```

**收缩段长度：**
```
L = (B₁ - B₂) / (2 * tan θ)

推荐：θ = 20-30°
则：L = (0.87-1.37) * (B₁ - B₂)

简化：L ≥ (B₁ - B₂)
```

### 8. 水深计算

**扩散段下游水深h₂：**
```
对于矩形断面：
Q = B₂ * h₂ * v₂
v₂ = (1/n) * R₂^(2/3) * S₀^(1/2)

需要迭代求解
```

**扩散段上游水深h₁：**
```
从能量方程：
h₁ + v₁²/(2g) = h₂ + v₂²/(2g) + hf - S₀*L

迭代求解h₁
```

### 9. 临界情况

**临界过渡（Fr ≈ 1）：**
- 扩散：可能形成水跃
- 收缩：可能出现临界水深
- 需要特殊处理

**跨临界流动：**
- 上游缓流，收缩后变为急流
- 需要检查是否发生临界流

### 10. 设计准则

**扩散段：**
1. 渐变角：θ ≤ 12.5°（宜10°）
2. 长度：L ≥ 2.5*(B₂-B₁)
3. 避免突然扩散（能量损失大）
4. 底坡保持平顺

**收缩段：**
1. 渐变角：θ ≤ 30°（可20°）
2. 长度：L ≥ (B₁-B₂)
3. 收缩损失相对较小
4. 注意临界流动

**通用原则：**
1. 渐变段应平顺过渡
2. 避免局部突变
3. 考虑施工便利性
4. 兼顾经济性和水力性能

## 计算任务

### 任务1：扩散段水深计算

计算扩散段上下游水深和水面线。

### 任务2：收缩段水深计算

计算收缩段上下游水深和水面线。

### 任务3：能量损失分析

计算并比较渐变和突然过渡的能量损失。

### 任务4：渐变段长度设计

根据不同渐变角设计渐变段长度。

### 任务5：突然过渡影响评估

评估突然扩散/收缩对水力性能的影响。

## 使用方法

```python
# 运行主程序
python main.py

# 运行实验
python experiments.py
```

## 预期结果

**扩散段（B₁=4m → B₂=6m）：**
- 下游水深 h₂ ≈ 1.2 m
- 上游水深 h₁ ≈ 1.0 m
- 水面壅高 Δh ≈ 0.2 m
- 能量损失 hf ≈ 0.02-0.05 m（渐变）
- 能量损失 hf ≈ 0.10-0.15 m（突然）

**收缩段（B₁=4m → B₂=3m）：**
- 上游水深 h₁ ≈ 0.9 m
- 下游水深 h₂ ≈ 1.0 m
- 水面降低 Δh ≈ 0.1 m
- 能量损失 hf ≈ 0.01-0.02 m（渐变）
- 能量损失 hf ≈ 0.03-0.05 m（突然）

## 工程意义

本案例展示了：
1. 渠道断面变化的水力特性
2. 渐变段与突然过渡的差异
3. 能量损失的定量计算
4. 渐变段长度的合理设计
5. 工程设计的优化方法

## 设计要点

1. **扩散段设计**：
   - 渐变角：θ = 10-12.5°
   - 长度：L ≥ 2.5*(B₂-B₁)
   - 损失系数：ζ = 0.1-0.2
   - 避免突然扩散

2. **收缩段设计**：
   - 渐变角：θ = 20-30°
   - 长度：L ≥ (B₁-B₂)
   - 损失系数：ζ = 0.05-0.10
   - 检查临界流动

3. **水面线控制**：
   - 扩散：形成壅水
   - 收缩：形成降水
   - 影响上下游水位
   - 需与渠道系统协调

4. **施工要求**：
   - 边壁平顺过渡
   - 底坡连续
   - 避免尖角和突变
   - 便于模板施工

5. **特殊情况**：
   - 急流过渡：更复杂
   - 跨临界：专门分析
   - 弯道结合：加强设计
   - 闸门结合：综合考虑

## 注意事项

1. **能量损失**：
   - 扩散损失 > 收缩损失
   - 渐变损失 < 突然损失
   - 设计应尽量渐变

2. **水流形态**：
   - 本案例假设缓流
   - 急流情况更复杂
   - 临界流需特别注意

3. **计算方法**：
   - 标准步长法
   - 考虑局部损失
   - 迭代求解水深

4. **适用范围**：
   - 规则矩形断面
   - 缓流条件
   - 渐变角在推荐范围

5. **工程实践**：
   - 优先采用渐变过渡
   - 受地形限制时才用突然过渡
   - 结合水工模型试验
   - 施工中注意质量控制
