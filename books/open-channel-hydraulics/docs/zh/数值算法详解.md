# æ˜æ¸ éæ’å®šæµæ•°å€¼ç®—æ³•è¯¦è§£

**ç‰ˆæœ¬ï¼š** v1.0
**æ›´æ–°æ—¥æœŸï¼š** 2025-10-29
**ç›®æ ‡è¯»è€…ï¼š** ç ”ç©¶ç”Ÿã€å·¥ç¨‹å¸ˆã€ç®—æ³•å¼€å‘è€…

---

## ğŸ“ æ•°å­¦åŸºç¡€

### åœ£ç»´å—æ–¹ç¨‹ç»„ï¼ˆSaint-Venant Equationsï¼‰

**å®ˆæ’å½¢å¼ï¼š**

$$
\frac{\partial \mathbf{U}}{\partial t} + \frac{\partial \mathbf{F}}{\partial x} = \mathbf{S}
$$

å…¶ä¸­ï¼š

$$
\mathbf{U} = \begin{bmatrix} A \\ Q \end{bmatrix}, \quad
\mathbf{F} = \begin{bmatrix} Q \\ \frac{Q^2}{A} + gI_1 \end{bmatrix}, \quad
\mathbf{S} = \begin{bmatrix} 0 \\ gA(i - J) \end{bmatrix}
$$

**è¯´æ˜ï¼š**
- $A$ï¼šè¿‡æµæ–­é¢ç§¯
- $Q$ï¼šæµé‡
- $g$ï¼šé‡åŠ›åŠ é€Ÿåº¦
- $I_1 = \int_0^h (h-\eta)B(\eta)d\eta$ï¼šå‹åŠ›ç§¯åˆ†
- $i$ï¼šåº•å¡
- $J$ï¼šæ‘©é˜»å¡åº¦

**éå®ˆæ’å½¢å¼ï¼š**

è¿ç»­æ€§æ–¹ç¨‹ï¼š
$$
\frac{\partial A}{\partial t} + \frac{\partial Q}{\partial x} = 0
$$

åŠ¨é‡æ–¹ç¨‹ï¼š
$$
\frac{\partial Q}{\partial t} + \frac{\partial}{\partial x}\left(\frac{Q^2}{A}\right) + gA\frac{\partial h}{\partial x} = gA(i - J)
$$

---

## ğŸ”¢ æ•°å€¼æ–¹æ³•åˆ†ç±»

### 1. æœ‰é™å·®åˆ†æ³•ï¼ˆFinite Difference Method, FDMï¼‰

**åŸç†ï¼š** ç”¨å·®å•†è¿‘ä¼¼å¾®å•†

**åˆ†ç±»ï¼š**
- **æ˜¾å¼æ ¼å¼**ï¼šå½“å‰æ—¶åˆ»ç”±ä¸Šä¸€æ—¶åˆ»æ˜¾å¼è®¡ç®—
- **éšå¼æ ¼å¼**ï¼šå½“å‰æ—¶åˆ»éœ€è¦è§£æ–¹ç¨‹ç»„

**ä¼˜ç‚¹ï¼š** ç¼–ç¨‹ç®€å•ï¼Œæ˜“äºç†è§£
**ç¼ºç‚¹ï¼š** éš¾ä»¥å¤„ç†å¤æ‚è¾¹ç•Œ

### 2. ç‰¹å¾çº¿æ³•ï¼ˆMethod of Characteristics, MOCï¼‰

**åŸç†ï¼š** æ²¿ç‰¹å¾çº¿æ–¹ç¨‹å˜ä¸ºå¸¸å¾®åˆ†æ–¹ç¨‹

**ç‰¹å¾æ–¹ç¨‹ï¼š**
$$
\frac{dx}{dt} = v \pm c
$$

å…¶ä¸­ $c = \sqrt{gA/B}$ ä¸ºæ³¢é€Ÿ

**ä¼˜ç‚¹ï¼š** ç‰©ç†æ„ä¹‰æ¸…æ™°ï¼Œç²¾åº¦é«˜
**ç¼ºç‚¹ï¼š** ç½‘æ ¼ä¸è§„åˆ™ï¼Œæ’å€¼å¤æ‚

### 3. æœ‰é™ä½“ç§¯æ³•ï¼ˆFinite Volume Method, FVMï¼‰

**åŸç†ï¼š** å®ˆæ’å¾‹ç§¯åˆ†å½¢å¼

**ä¼˜ç‚¹ï¼š** ä¸¥æ ¼å®ˆæ’ï¼Œé€‚åˆæ¿€æ³¢
**ç¼ºç‚¹ï¼š** ç¼–ç¨‹å¤æ‚

### 4. æœ‰é™å…ƒæ³•ï¼ˆFinite Element Method, FEMï¼‰

**åŸç†ï¼š** å˜åˆ†åŸç†

**ä¼˜ç‚¹ï¼š** é€‚åˆå¤æ‚å‡ ä½•
**ç¼ºç‚¹ï¼š** è®¡ç®—é‡å¤§

---

## ğŸ“Š ç®—æ³•è¯¦è§£

## ä¸€ã€æ˜¾å¼æœ‰é™å·®åˆ†æ³•

### 1.1 Laxæ ¼å¼ï¼ˆä¸€é˜¶ç²¾åº¦ï¼‰

**ç¦»æ•£æ ¼å¼ï¼š**

$$
U_i^{n+1} = \frac{1}{2}(U_{i-1}^n + U_{i+1}^n) - \frac{\Delta t}{2\Delta x}(F_{i+1}^n - F_{i-1}^n) + \Delta t \cdot S_i^n
$$

**ç¨³å®šæ€§æ¡ä»¶ï¼ˆCFLï¼‰ï¼š**
$$
CFL = \frac{(|v| + c)\Delta t}{\Delta x} \leq 1
$$

**ä¼˜ç‚¹ï¼š** ç®€å•ï¼Œç¨³å®š
**ç¼ºç‚¹ï¼š** ç²¾åº¦ä½ï¼Œè€—æ•£å¤§

**Pythonä¼ªä»£ç ï¼š**
```python
def lax_scheme(U, F, S, dt, dx):
    """Laxæ ¼å¼æ±‚è§£ä¸€æ­¥"""
    U_new = np.zeros_like(U)
    for i in range(1, len(U)-1):
        U_new[i] = 0.5 * (U[i-1] + U[i+1]) \
                   - 0.5 * dt/dx * (F[i+1] - F[i-1]) \
                   + dt * S[i]
    return U_new
```

### 1.2 MacCormackæ ¼å¼ï¼ˆäºŒé˜¶ç²¾åº¦ï¼‰

**é¢„æµ‹æ­¥ï¼ˆPredictorï¼‰ï¼š**
$$
\bar{U}_i^{n+1} = U_i^n - \frac{\Delta t}{\Delta x}(F_{i+1}^n - F_i^n) + \Delta t \cdot S_i^n
$$

**æ ¡æ­£æ­¥ï¼ˆCorrectorï¼‰ï¼š**
$$
U_i^{n+1} = \frac{1}{2}\left(U_i^n + \bar{U}_i^{n+1} - \frac{\Delta t}{\Delta x}(\bar{F}_i^{n+1} - \bar{F}_{i-1}^{n+1}) + \Delta t \cdot \bar{S}_i^{n+1}\right)
$$

**ä¼˜ç‚¹ï¼š** äºŒé˜¶ç²¾åº¦ï¼Œæ˜“äºå®ç°
**ç¼ºç‚¹ï¼š** ä»éœ€æ»¡è¶³CFLæ¡ä»¶

**Pythonä¼ªä»£ç ï¼š**
```python
def maccormack_scheme(U, dt, dx):
    """MacCormackæ ¼å¼"""
    # é¢„æµ‹æ­¥
    F = compute_flux(U)
    S = compute_source(U)
    U_bar = np.zeros_like(U)
    for i in range(len(U)-1):
        U_bar[i] = U[i] - dt/dx * (F[i+1] - F[i]) + dt * S[i]

    # æ ¡æ­£æ­¥
    F_bar = compute_flux(U_bar)
    S_bar = compute_source(U_bar)
    U_new = np.zeros_like(U)
    for i in range(1, len(U)):
        U_new[i] = 0.5 * (U[i] + U_bar[i]
                          - dt/dx * (F_bar[i] - F_bar[i-1])
                          + dt * S_bar[i])

    return U_new
```

### 1.3 Leap-Frogæ ¼å¼ï¼ˆäºŒé˜¶ç²¾åº¦ï¼‰

**ç¦»æ•£æ ¼å¼ï¼š**
$$
U_i^{n+1} = U_i^{n-1} - \frac{2\Delta t}{\Delta x}(F_{i+1}^n - F_{i-1}^n) + 2\Delta t \cdot S_i^n
$$

**ç‰¹ç‚¹ï¼š** éœ€è¦ä¸¤ä¸ªæ—¶é—´å±‚ï¼Œä¸­å¿ƒå·®åˆ†

---

## äºŒã€éšå¼æœ‰é™å·®åˆ†æ³•

### 2.1 å‘åå·®åˆ†æ ¼å¼ï¼ˆBackward Eulerï¼‰

**ç¦»æ•£æ ¼å¼ï¼š**
$$
\frac{U_i^{n+1} - U_i^n}{\Delta t} + \frac{F_{i+1}^{n+1} - F_{i-1}^{n+1}}{2\Delta x} = S_i^{n+1}
$$

**ç‰¹ç‚¹ï¼š**
- æ— æ¡ä»¶ç¨³å®š
- éœ€è¦è¿­ä»£æ±‚è§£éçº¿æ€§æ–¹ç¨‹ç»„

**çº¿æ€§åŒ–ï¼ˆNewton-Raphsonï¼‰ï¼š**
$$
\mathbf{J} \Delta \mathbf{U} = -\mathbf{R}
$$

å…¶ä¸­ $\mathbf{J}$ æ˜¯JacobiançŸ©é˜µï¼Œ$\mathbf{R}$ æ˜¯æ®‹å·®

### 2.2 Preissmannå››ç‚¹éšæ ¼å¼

**æƒé‡å‚æ•°ï¼š**
- æ—¶é—´æƒé‡ï¼š$\theta \in [0.5, 1]$
- ç©ºé—´æƒé‡ï¼š$\psi = 0.5$ï¼ˆä¸­å¿ƒå·®åˆ†ï¼‰

**ç¦»æ•£æ ¼å¼ï¼š**

æ—¶é—´ç¦»æ•£ï¼š
$$
\phi^{n+\theta} = \theta \phi^{n+1} + (1-\theta)\phi^n
$$

ç©ºé—´ç¦»æ•£ï¼š
$$
\phi_i^{n+\psi} = \psi \phi_{i+1}^n + (1-\psi)\phi_i^n
$$

**ä¼˜ç‚¹ï¼š**
- æ— æ¡ä»¶ç¨³å®šï¼ˆ$\theta \geq 0.5$ï¼‰
- å¯ä»¥ä½¿ç”¨å¤§æ—¶é—´æ­¥é•¿
- é€‚åˆé•¿æ—¶é—´æ¨¡æ‹Ÿ

**æ–¹ç¨‹ç»„æ±‚è§£ï¼š**
- è¿½èµ¶æ³•ï¼ˆThomas Algorithmï¼‰ï¼šä¸‰å¯¹è§’çŸ©é˜µ
- è¿­ä»£æ³•ï¼ˆGauss-Seidel, SORï¼‰ï¼šå¤§å‹ç³»ç»Ÿ

**Pythonä¼ªä»£ç ï¼š**
```python
def preissmann_scheme(U, dt, dx, theta=0.6):
    """Preissmannéšæ ¼å¼"""
    n = len(U)

    # æ„é€ çº¿æ€§æ–¹ç¨‹ç»„ A * U_new = b
    A = construct_jacobian(U, dt, dx, theta)
    b = compute_rhs(U, dt, dx, theta)

    # æ±‚è§£ï¼ˆè¿½èµ¶æ³•æˆ–è¿­ä»£æ³•ï¼‰
    U_new = solve_tridiagonal(A, b)

    return U_new

def solve_tridiagonal(A, b):
    """è¿½èµ¶æ³•æ±‚è§£ä¸‰å¯¹è§’æ–¹ç¨‹ç»„"""
    # Thomas algorithm
    n = len(b)
    c_star = np.zeros(n-1)
    d_star = np.zeros(n)
    x = np.zeros(n)

    # å‰å‘æ¶ˆå…ƒ
    c_star[0] = A[0,1] / A[0,0]
    d_star[0] = b[0] / A[0,0]
    for i in range(1, n-1):
        denom = A[i,i] - A[i,i-1] * c_star[i-1]
        c_star[i] = A[i,i+1] / denom
        d_star[i] = (b[i] - A[i,i-1] * d_star[i-1]) / denom

    d_star[n-1] = (b[n-1] - A[n-1,n-2] * d_star[n-2]) / \
                  (A[n-1,n-1] - A[n-1,n-2] * c_star[n-2])

    # å›ä»£
    x[n-1] = d_star[n-1]
    for i in range(n-2, -1, -1):
        x[i] = d_star[i] - c_star[i] * x[i+1]

    return x
```

---

## ä¸‰ã€ç‰¹å¾çº¿æ³•ï¼ˆMOCï¼‰

### 3.1 ç‰¹å¾ç†è®º

**ç‰¹å¾æ–¹ç¨‹ï¼š**

$$
C^+: \frac{dx}{dt} = v + c \quad \text{(æ­£ç‰¹å¾çº¿)}
$$
$$
C^-: \frac{dx}{dt} = v - c \quad \text{(è´Ÿç‰¹å¾çº¿)}
$$

**ç›¸å®¹æ–¹ç¨‹ï¼ˆæ²¿ç‰¹å¾çº¿ï¼‰ï¼š**

$$
C^+: dv + \frac{g}{c}dh + \frac{gJ}{c}dx = 0
$$
$$
C^-: dv - \frac{g}{c}dh + \frac{gJ}{c}dx = 0
$$

### 3.2 æ•°å€¼å®ç°

**ç‰¹å¾ç½‘æ ¼ï¼š**

```
æ—¶é—´ t^{n+1}  â—â”€â”€â”€â”€â”€â”€â”€â”€â”€Pâ”€â”€â”€â”€â”€â”€â”€â”€â”€â—
               â•±           â•²
              â•±             â•²
             â•±               â•²
æ—¶é—´ t^n    â—â”€â”€â”€â”€â”€â”€â”€â”€â”€Lâ”€â”€â”€â”€â”€â—â”€â”€â”€â”€â”€Râ”€â”€â”€â—
           x_{i-1}   x_i   x_{i+1}
```

**è®¡ç®—æ­¥éª¤ï¼š**

1. ä»ç‚¹Lå’ŒRå‡ºå‘ï¼Œç»˜åˆ¶ç‰¹å¾çº¿
2. ç‰¹å¾çº¿äº¤äºç‚¹P
3. æ²¿ç‰¹å¾çº¿ç§¯åˆ†ç›¸å®¹æ–¹ç¨‹
4. æ±‚è§£Pç‚¹çš„æµé€Ÿå’Œæ°´æ·±

**ç§¯åˆ†å½¢å¼ï¼š**

æ²¿ $C^+$ ä» L åˆ° Pï¼š
$$
v_P + \frac{g}{c}h_P = v_L + \frac{g}{c}h_L - \int_L^P \frac{gJ}{c}dx
$$

æ²¿ $C^-$ ä» R åˆ° Pï¼š
$$
v_P - \frac{g}{c}h_P = v_R - \frac{g}{c}h_R - \int_R^P \frac{gJ}{c}dx
$$

**æ±‚è§£ï¼š**
$$
v_P = \frac{1}{2}(C^+ + C^-)
$$
$$
h_P = \frac{c}{2g}(C^+ - C^-)
$$

**æ’å€¼ï¼š**
- Lå’ŒRç‚¹ä¸åœ¨ç½‘æ ¼ç‚¹ä¸Šï¼Œéœ€è¦æ’å€¼
- çº¿æ€§æ’å€¼ï¼š$\phi_L = \phi_i + \alpha(\phi_{i-1} - \phi_i)$
- äºŒæ¬¡æ’å€¼ï¼šæ›´é«˜ç²¾åº¦

**Pythonä¼ªä»£ç ï¼š**
```python
def method_of_characteristics(h, v, dx, dt):
    """ç‰¹å¾çº¿æ³•"""
    n = len(h)
    h_new = np.zeros(n)
    v_new = np.zeros(n)

    for i in range(1, n-1):
        # è®¡ç®—æ³¢é€Ÿ
        c = np.sqrt(9.81 * h[i])

        # æ‰¾åˆ°ç‰¹å¾çº¿çš„èµ·ç‚¹ï¼ˆæ’å€¼ï¼‰
        x_L = i * dx - (v[i] + c) * dt
        x_R = i * dx - (v[i] - c) * dt

        # æ’å€¼å¾—åˆ°Lå’ŒRç‚¹çš„å€¼
        h_L, v_L = interpolate(h, v, x_L, dx)
        h_R, v_R = interpolate(h, v, x_R, dx)

        # è®¡ç®—æ‘©é˜»é¡¹ç§¯åˆ†
        J_L = friction_slope(h_L, v_L)
        J_R = friction_slope(h_R, v_R)

        # ç›¸å®¹æ–¹ç¨‹
        C_plus = v_L + (9.81/c) * h_L - 9.81 * J_L * dt
        C_minus = v_R - (9.81/c) * h_R - 9.81 * J_R * dt

        # æ±‚è§£Pç‚¹
        v_new[i] = 0.5 * (C_plus + C_minus)
        h_new[i] = (c / (2*9.81)) * (C_plus - C_minus)

    return h_new, v_new
```

---

## å››ã€æœ‰é™ä½“ç§¯æ³•ï¼ˆFVMï¼‰

### 4.1 å®ˆæ’å¾‹ç§¯åˆ†å½¢å¼

$$
\frac{d}{dt}\int_{x_i}^{x_{i+1}} \mathbf{U} dx + \mathbf{F}_{i+1/2} - \mathbf{F}_{i-1/2} = \int_{x_i}^{x_{i+1}} \mathbf{S} dx
$$

**åŠç¦»æ•£å½¢å¼ï¼š**
$$
\frac{d\bar{\mathbf{U}}_i}{dt} + \frac{1}{\Delta x}(\mathbf{F}_{i+1/2} - \mathbf{F}_{i-1/2}) = \bar{\mathbf{S}}_i
$$

å…¶ä¸­ $\bar{\mathbf{U}}_i = \frac{1}{\Delta x}\int_{x_i}^{x_{i+1}} \mathbf{U} dx$ æ˜¯å•å…ƒå¹³å‡å€¼

### 4.2 Riemanné—®é¢˜

**å®šä¹‰ï¼š** åˆå§‹æ¡ä»¶ä¸ºåˆ†æ®µå¸¸æ•°çš„é—´æ–­é—®é¢˜

$$
\mathbf{U}(x, 0) = \begin{cases}
\mathbf{U}_L & x < 0 \\
\mathbf{U}_R & x > 0
\end{cases}
$$

**è§£çš„ç»“æ„ï¼š**
- å·¦è¡Œæ³¢ï¼ˆè´Ÿç‰¹å¾ï¼‰
- æ¥è§¦é—´æ–­
- å³è¡Œæ³¢ï¼ˆæ­£ç‰¹å¾ï¼‰

### 4.3 HLLæ±‚è§£å™¨ï¼ˆHarten-Lax-van Leerï¼‰

**æ•°å€¼é€šé‡ï¼š**

$$
\mathbf{F}_{HLL} = \begin{cases}
\mathbf{F}_L & 0 \leq S_L \\
\frac{S_R \mathbf{F}_L - S_L \mathbf{F}_R + S_L S_R (\mathbf{U}_R - \mathbf{U}_L)}{S_R - S_L} & S_L < 0 < S_R \\
\mathbf{F}_R & S_R \leq 0
\end{cases}
$$

**æ³¢é€Ÿä¼°è®¡ï¼š**
$$
S_L = \min(v_L - c_L, v_R - c_R)
$$
$$
S_R = \max(v_L + c_L, v_R + c_R)
$$

**Pythonä»£ç ï¼š**
```python
def hll_flux(U_L, U_R):
    """HLL Riemannæ±‚è§£å™¨"""
    # æå–å·¦å³çŠ¶æ€
    A_L, Q_L = U_L
    A_R, Q_R = U_R

    h_L = A_L / B  # å‡è®¾çŸ©å½¢æ–­é¢
    h_R = A_R / B
    v_L = Q_L / A_L
    v_R = Q_R / A_R

    # æ³¢é€Ÿ
    c_L = np.sqrt(9.81 * h_L)
    c_R = np.sqrt(9.81 * h_R)
    S_L = min(v_L - c_L, v_R - c_R)
    S_R = max(v_L + c_L, v_R + c_R)

    # è®¡ç®—é€šé‡
    F_L = compute_flux(U_L)
    F_R = compute_flux(U_R)

    if 0 <= S_L:
        return F_L
    elif S_R <= 0:
        return F_R
    else:
        return (S_R * F_L - S_L * F_R + S_L * S_R * (U_R - U_L)) / (S_R - S_L)
```

### 4.4 MUSCLé‡æ„ï¼ˆé«˜é˜¶ç²¾åº¦ï¼‰

**æ€æƒ³ï¼š** åœ¨å•å…ƒå†…é‡æ„é«˜é˜¶å¤šé¡¹å¼

**çº¿æ€§é‡æ„ï¼š**
$$
\mathbf{U}(x) = \bar{\mathbf{U}}_i + \sigma_i (x - x_i)
$$

**æ–œç‡è®¡ç®—ï¼š**
$$
\sigma_i = \frac{\bar{\mathbf{U}}_{i+1} - \bar{\mathbf{U}}_{i-1}}{2\Delta x}
$$

**è¾¹ç•Œå€¼ï¼š**
$$
\mathbf{U}_{i}^- = \bar{\mathbf{U}}_i - \frac{\Delta x}{2}\sigma_i
$$
$$
\mathbf{U}_{i}^+ = \bar{\mathbf{U}}_i + \frac{\Delta x}{2}\sigma_i
$$

**é™åˆ¶å™¨ï¼ˆé¿å…æŒ¯è¡ï¼‰ï¼š**

MinModé™åˆ¶å™¨ï¼š
$$
\sigma_i = \text{minmod}\left(\frac{\bar{\mathbf{U}}_{i+1} - \bar{\mathbf{U}}_i}{\Delta x}, \frac{\bar{\mathbf{U}}_i - \bar{\mathbf{U}}_{i-1}}{\Delta x}\right)
$$

å…¶ä¸­ï¼š
$$
\text{minmod}(a, b) = \begin{cases}
\text{sign}(a) \cdot \min(|a|, |b|) & ab > 0 \\
0 & ab \leq 0
\end{cases}
$$

**Pythonä»£ç ï¼š**
```python
def minmod(a, b):
    """MinModé™åˆ¶å™¨"""
    if a * b > 0:
        return np.sign(a) * min(abs(a), abs(b))
    else:
        return 0.0

def muscl_reconstruction(U):
    """MUSCLé‡æ„"""
    n = len(U)
    U_L = np.zeros(n)  # å·¦è¾¹ç•Œå€¼
    U_R = np.zeros(n)  # å³è¾¹ç•Œå€¼

    for i in range(1, n-1):
        # è®¡ç®—æ–œç‡
        slope = minmod((U[i+1] - U[i]) / dx, (U[i] - U[i-1]) / dx)

        # é‡æ„
        U_L[i] = U[i] - 0.5 * dx * slope
        U_R[i] = U[i] + 0.5 * dx * slope

    return U_L, U_R

def fvm_with_muscl(U, dt, dx):
    """FVM + MUSCLé«˜é˜¶æ ¼å¼"""
    # MUSCLé‡æ„
    U_L, U_R = muscl_reconstruction(U)

    # è®¡ç®—æ•°å€¼é€šé‡
    F = np.zeros(len(U)+1)
    for i in range(len(U)+1):
        F[i] = hll_flux(U_R[i-1], U_L[i])

    # æ›´æ–°
    U_new = U - dt/dx * (F[1:] - F[:-1])

    return U_new
```

---

## äº”ã€ç®—æ³•å¯¹æ¯”

### 5.1 ç²¾åº¦å¯¹æ¯”

| æ–¹æ³• | æ—¶é—´ç²¾åº¦ | ç©ºé—´ç²¾åº¦ | æ€»ç²¾åº¦ |
|------|----------|----------|--------|
| Lax | 1é˜¶ | 1é˜¶ | 1é˜¶ |
| Leap-Frog | 2é˜¶ | 2é˜¶ | 2é˜¶ |
| MacCormack | 2é˜¶ | 2é˜¶ | 2é˜¶ |
| Preissmann | 1-2é˜¶ | 2é˜¶ | 1-2é˜¶ |
| MOC | å–å†³äºæ’å€¼ | å–å†³äºæ’å€¼ | é«˜ |
| FVMï¼ˆä¸€é˜¶ï¼‰ | 1é˜¶ | 1é˜¶ | 1é˜¶ |
| FVM+MUSCL | 2é˜¶ | 2é˜¶ | 2é˜¶ |

### 5.2 ç¨³å®šæ€§å¯¹æ¯”

| æ–¹æ³• | ç¨³å®šæ€§æ¡ä»¶ | å¤‡æ³¨ |
|------|------------|------|
| æ˜¾å¼å·®åˆ† | CFL < 1 | æ¡ä»¶ç¨³å®š |
| éšå¼å·®åˆ† | æ— æ¡ä»¶ç¨³å®š | Î¸ â‰¥ 0.5 |
| MOC | CFL â‰ˆ 1 | æ²¿ç‰¹å¾çº¿ |
| FVM | CFL < 1 | æ¡ä»¶ç¨³å®š |

### 5.3 è®¡ç®—æ•ˆç‡

**æ—¶é—´æ­¥é•¿ï¼š**
- æ˜¾å¼ï¼šÎ”t â‰ˆ 0.1sï¼ˆCFLé™åˆ¶ï¼‰
- éšå¼ï¼šÎ”t â‰ˆ 10-100sï¼ˆç¨³å®šæ€§å¥½ï¼‰

**è®¡ç®—æ—¶é—´ï¼ˆå•æ­¥ï¼‰ï¼š**
- æ˜¾å¼ï¼šå¿«ï¼ˆæ— æ–¹ç¨‹ç»„æ±‚è§£ï¼‰
- éšå¼ï¼šæ…¢ï¼ˆéœ€è§£æ–¹ç¨‹ç»„ï¼‰
- MOCï¼šä¸­ç­‰ï¼ˆæ’å€¼è€—æ—¶ï¼‰
- FVMï¼šæ…¢ï¼ˆRiemannæ±‚è§£å™¨ï¼‰

**æ€»è®¡ç®—æ—¶é—´ï¼š**
å–å†³äºæ¨¡æ‹Ÿæ—¶é•¿å’Œæ‰€éœ€æ—¶é—´æ­¥æ•°

---

## å…­ã€å®é™…åº”ç”¨å»ºè®®

### 6.1 æ–¹æ³•é€‰æ‹©

**å¸¸è§„é—®é¢˜ï¼ˆæ´ªæ°´æ¼”è¿›ã€é—¸é—¨æ“ä½œï¼‰ï¼š**
- æ¨èï¼šPreissmannéšæ ¼å¼
- ç†ç”±ï¼šç¨³å®šã€å¯ç”¨å¤§æ—¶é—´æ­¥ã€ç²¾åº¦å¤Ÿç”¨

**æ¿€æ³¢é—®é¢˜ï¼ˆæºƒåæ³¢ï¼‰ï¼š**
- æ¨èï¼šFVM + HLL/HLLC
- ç†ç”±ï¼šå®ˆæ’ã€æ¿€æ³¢æ•æ‰

**é«˜ç²¾åº¦è¦æ±‚ï¼š**
- æ¨èï¼šFVM + MUSCL + TVD
- ç†ç”±ï¼šé«˜é˜¶ç²¾åº¦ã€å•è°ƒæ€§

**å¿«é€ŸåŸå‹ï¼š**
- æ¨èï¼šMacCormackæ˜¾æ ¼å¼
- ç†ç”±ï¼šç¼–ç¨‹ç®€å•ã€ç²¾åº¦å°šå¯

### 6.2 å‚æ•°è®¾ç½®

**ç©ºé—´æ­¥é•¿Î”xï¼š**
- ä¸€èˆ¬ï¼šÎ”x = 10-100 m
- å»ºç­‘ç‰©é™„è¿‘ï¼šÎ”x = 1-10 m

**æ—¶é—´æ­¥é•¿Î”tï¼š**
- æ˜¾å¼ï¼šæ»¡è¶³CFLæ¡ä»¶
- éšå¼ï¼šÎ”t = 10-600 sï¼ˆæ ¹æ®éœ€è¦ï¼‰

**CFLæ•°ï¼š**
- æ˜¾å¼ï¼šCFL = 0.5-0.9
- éšå¼ï¼šå¯ä»¥ > 1

### 6.3 æ”¶æ•›æ€§æ£€éªŒ

**ç½‘æ ¼æ— å…³æ€§ï¼š**
1. ä½¿ç”¨Î”xè¿è¡Œ
2. ä½¿ç”¨Î”x/2è¿è¡Œ
3. æ¯”è¾ƒç»“æœï¼Œè‹¥å·®å¼‚<1%ï¼Œåˆ™ç½‘æ ¼è¶³å¤Ÿç»†

**æ—¶é—´æ­¥é•¿æ£€éªŒï¼š**
ç±»ä¼¼ç½‘æ ¼æ£€éªŒ

---

## ğŸ“š æ¨èé˜…è¯»

### ä¹¦ç±
1. **Toro, E.F.** - "Riemann Solvers and Numerical Methods for Fluid Dynamics"
2. **LeVeque, R.J.** - "Finite Volume Methods for Hyperbolic Problems"
3. **Chaudhry, M.H.** - "Open-Channel Flow"

### è®ºæ–‡
1. Preissmann, A. (1961) - éšæ ¼å¼çš„åŸå§‹è®ºæ–‡
2. Harten, A. et al. (1983) - HLLæ±‚è§£å™¨
3. van Leer, B. (1979) - MUSCLæ ¼å¼

### å¼€æºä»£ç 
1. **HEC-RAS** - ç¾å›½é™†å†›å·¥ç¨‹å…µå›¢
2. **SWMM** - EPAé›¨æ´ªæ¨¡å‹
3. **Basilisk** - å¼€æºCFDæ±‚è§£å™¨

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0
**æœ€åæ›´æ–°ï¼š** 2025-10-29
**ä½œè€…ï¼š** CHS-Books æ•™æå¼€å‘ç»„
