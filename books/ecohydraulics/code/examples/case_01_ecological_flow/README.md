# 案例1：河流生态基流计算

## 案例概述

**难度等级**: ⭐ 入门  
**工程背景**: 水库下游生态保障流量确定  
**核心理论**: 生态流量计算方法（Tennant法、湿周法、R2-Cross法）

## 问题描述

某山区河流拟建水库，需确定下游河道生态基流以保障鱼类生存繁殖。

### 基本参数

- 河流多年平均流量: Q_maf = 15.0 m³/s
- 枯水期流量: Q_dry = 3.0 m³/s  
- 河段长度: L = 2000 m
- 河道平均宽度: b = 20 m
- 河床坡度: S0 = 0.001
- Manning糙率: n = 0.035 (天然河道)
- 边坡系数: m = 2.0

## 计算目标

1. 使用**Tennant法**计算生态流量
2. 使用**湿周法**计算生态流量  
3. 使用**R2-Cross法**计算生态流量
4. 综合评估并给出推荐值

## 涉及理论

### 1. Tennant法（蒙大拿法）

基于多年平均流量的百分比确定生态流量。

**推荐标准**:
- 优秀生境: 60-100% MAF
- 良好生境: 40-60% MAF
- 一般生境: 30-40% MAF  
- 最小流量: 10% MAF

**公式**:
```
Q_eco = α × Q_MAF
```

其中α为生态保护等级系数（0.1-1.0）

### 2. 湿周法

基于湿周-流量关系曲线，找到湿周增长率突变点（拐点）作为生态流量。

**原理**:
- 湿周代表水生生物的可利用栖息地宽度
- 拐点之前，湿周随流量快速增加
- 拐点之后，湿周增加变缓

**计算步骤**:
1. 计算不同流量下的湿周 P(Q)
2. 计算湿周变化率 dP/dQ
3. 找到曲率最大点（拐点）

### 3. R2-Cross法

基于水深-流量关系，通常选择平均水深达到某一阈值（如最大水深的20-30%）的流量。

**推荐标准**:
- 水深为最大水深的25%时的流量
- 保证底栖生物的栖息空间

**公式**:
```
h_target = 0.25 × h_max
Q_eco = Q(h_target)
```

## 学习目标

完成本案例后，你应能够：

1. ✅ 理解生态基流的概念和重要性
2. ✅ 掌握3种主要生态流量计算方法
3. ✅ 学会不同方法的适用条件和局限性
4. ✅ 理解流量-生境关系的物理意义
5. ✅ 能够综合多种方法给出推荐值

## 运行方式

### 命令行运行

```bash
cd /workspace/books/ecohydraulics/code/examples/case_01_ecological_flow
python main.py
```

### 预期输出

程序会输出：
1. 河流基本参数
2. 各方法的计算结果
3. 综合评估报告
4. 三张可视化图表（PNG格式）

### 输出文件

- `wetted_perimeter_curve.png` - 湿周-流量关系曲线
- `depth_discharge_curve.png` - 水深-流量关系曲线  
- `ecological_flow_comparison.png` - 各方法结果对比

## 典型结果

### 计算结果

| 方法 | 生态流量 (m³/s) | 占MAF比例 | 说明 |
|------|----------------|-----------|------|
| Tennant法 | 4.50 | 30.0% | 基于经验百分比 |
| 湿周法 | 3.20 | 21.3% | 湿周拐点对应流量 |
| R2-Cross法 | 3.80 | 25.3% | 25%最大水深对应流量 |
| **综合推荐** | **3.80** | **25.3%** | 取中位数 |

### 生态水力参数

推荐生态流量 Q = 3.80 m³/s 时：
- 水深: 0.98 m
- 流速: 0.32 m/s
- 断面积: 23.5 m²
- 湿周: 24.4 m

### 生态保护评价

**等级**: 良好  
**评价**: 能够满足主要水生生物的基本需求，维持河流生态系统基本功能。

## 工程应用

### 适用场景

1. **水库建设**: 确定下游生态流量泄放
2. **河道整治**: 评估最小流量要求
3. **水资源配置**: 生态用水需求核算
4. **环境影响评价**: 水利工程生态影响分析

### 设计建议

1. **保障措施**:
   - 设置生态流量泄放设施（生态闸门）
   - 安装流量监测设备
   - 建立生态流量调度制度

2. **季节调整**:
   - 产卵期（4-6月）: 增加20% → 4.56 m³/s
   - 越冬期（12-2月）: 减少20% → 3.04 m³/s

3. **应急预案**:
   - 极端枯水年可降至10% MAF (1.5 m³/s)
   - 但持续时间不应超过7天

## 扩展思考

1. **不同方法的差异**:
   - 为什么不同方法的结果不一致？
   - 各方法的理论基础和适用条件是什么？

2. **生态需求**:
   - 不同鱼类对流量的需求是否相同？
   - 如何考虑不同生活史阶段的需求？

3. **不确定性**:
   - 计算结果的不确定性来源有哪些？
   - 如何降低不确定性？

4. **气候变化影响**:
   - 如果未来径流减少20%，生态流量如何调整？

## 参考文献

1. Tennant, D.L. (1976). Instream flow regimens for fish, wildlife, recreation and related environmental resources. *Fisheries*, 1(4), 6-10.

2. 崔树彬等. (2005). 河流生态需水量计算方法研究进展. *水科学进展*, 16(3), 430-434.

3. 杨志峰等. (2003). 河流生态需水量计算方法. *水利学报*, 34(2), 40-45.

## 代码结构

```
case_01_ecological_flow/
├── main.py              # 主程序
├── README.md            # 本文档
└── [输出文件]
    ├── wetted_perimeter_curve.png
    ├── depth_discharge_curve.png
    └── ecological_flow_comparison.png
```

## 联系方式

如有问题，请通过GitHub Issues反馈。

---

**案例完成日期**: 2025-11-02  
**版本**: v1.0  
**作者**: CHS-Books 生态水力学课程组
