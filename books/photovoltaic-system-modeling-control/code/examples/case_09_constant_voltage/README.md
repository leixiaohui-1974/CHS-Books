# æ¡ˆä¾‹9: æ’ç”µå‹æ³•

## ğŸ“‹ æ¡ˆä¾‹æ¦‚è¿°

**å·¥ç¨‹èƒŒæ™¯**:
CV(Constant Voltage)æ˜¯æœ€ç®€å•çš„MPPTç®—æ³•:
- **åŸºäºç»éªŒæ³•åˆ™** - MPPé€šå¸¸åœ¨0.76-0.8Ã—Voc
- **æç®€å•** - 1è¡Œä»£ç å³å¯å®ç°
- **æå¿«é€Ÿ** - ç¬æ—¶å“åº”æ— éœ€è¿­ä»£
- **æä½æˆæœ¬** - é€‚åˆç®€å•ç³»ç»Ÿ

**å­¦ä¹ ç›®æ ‡**:
1. ç†è§£CVç®—æ³•åŸç†
2. æŒæ¡ç”µå‹æ¯”ä¾‹é€‰æ‹©
3. å¯¹æ¯”CVä¸P&O/INC
4. äº†è§£é€‚ç”¨åœºæ™¯

---

## ğŸ”¬ ç†è®ºåŸºç¡€

### ç»éªŒæ³•åˆ™

**æ ¸å¿ƒåŸç†**: MPPç”µå‹ä¸Vocæˆæ¯”ä¾‹

```
Vmpp â‰ˆ k Ã— Voc

å…¸å‹kå€¼:
- æ™¶ç¡…ç»„ä»¶: k = 0.76-0.78
- è–„è†œç»„ä»¶: k = 0.70-0.75
- å¤šæ™¶ç¡…:   k = 0.76-0.80
```

### ç‰©ç†è§£é‡Š

**ä¸ºä»€ä¹ˆMPPåœ¨0.76Ã—Vocé™„è¿‘?**

ä»I-Væ›²çº¿ç‰¹æ€§:
```
P = V Ã— I
Pmax åœ¨ dP/dV = 0

ç»éªŒç»Ÿè®¡:
- å¤§é‡æµ‹è¯•æ•°æ®æ˜¾ç¤º
- ä¸åŒç±»å‹ç»„ä»¶
- Vmpp/Voc æ¯”å€¼ç¨³å®šåœ¨0.76-0.8
```

### ç®—æ³•æµç¨‹

```
æ­¥éª¤1: æµ‹é‡æˆ–ä¼°ç®—Voc
     â†’ å¼€è·¯æµ‹é‡
     â†’ ä»æ•°æ®æ‰‹å†Œè·å–
     â†’ æ ¹æ®æ¸©åº¦/è¾ç…§åº¦ä¼°ç®—

æ­¥éª¤2: è®¡ç®—å‚è€ƒç”µå‹
     Vref = k Ã— Voc

æ­¥éª¤3: æ§åˆ¶å·¥ä½œåœ¨Vref
     â†’ æ’å®šç”µå‹æ§åˆ¶
     â†’ æ— éœ€åé¦ˆè°ƒæ•´
```

---

## ğŸ’» ä»£ç ç¤ºä¾‹

### 1. åŸºæœ¬CVå®ç°

```python
from code.models.mppt_algorithms import ConstantVoltage, MPPTController

# åˆ›å»ºCVç®—æ³•
cv = ConstantVoltage(
    voltage_ratio=0.76,  # MPPç”µå‹æ¯”ä¾‹
    voc=36.0             # å¼€è·¯ç”µå‹(V)
)

# åˆ›å»ºæ§åˆ¶å™¨
controller = MPPTController(cv, v_min=0, v_max=40.0)

# MPPTå¾ªç¯(æç®€å•!)
v_pv = 20.0
for step in range(100):
    i_pv = module.calculate_current(v_pv)
    
    # CVæ›´æ–°
    v_ref = controller.step(v_pv, i_pv)
    
    # ç”µå‹è·Ÿè¸ª
    v_pv = v_pv + 0.5 * (v_ref - v_pv)
```

### 2. æ”¹è¿›å‹CV(å¸¦æ¸©åº¦è¡¥å¿)

```python
from code.models.mppt_algorithms import ImprovedCV

# åˆ›å»ºæ”¹è¿›å‹CV
cv_improved = ImprovedCV(
    voltage_ratio=0.76,
    voc=36.0,
    temp_coef=-0.003  # æ¸©åº¦ç³»æ•°(/Â°C)
)

# ä½¿ç”¨æ—¶ä¼ å…¥æ¸©åº¦
v_ref = cv_improved.update(
    voltage=v_pv,
    current=i_pv,
    temperature=temperature  # å®æ—¶æ¸©åº¦
)
```

### 3. ä¸åŒæ¯”ä¾‹å¯¹æ¯”

```python
ratios = [0.70, 0.76, 0.80]

for ratio in ratios:
    cv = ConstantVoltage(voltage_ratio=ratio, voc=voc)
    controller = MPPTController(cv, v_min=0, v_max=voc)
    
    # è¿è¡ŒMPPT
    # ...
    
    perf = controller.evaluate_performance(pmpp)
    print(f"k={ratio}: æ•ˆç‡={perf['efficiency']:.1f}%")
```

---

## ğŸ“Š ç®—æ³•ç‰¹æ€§

### ä¼˜ç‚¹ âœ…

1. **æç®€å•**
   - 1è¡Œä»£ç : `Vref = 0.76 * Voc`
   - æ— éœ€å¤æ‚è®¡ç®—
   - æ˜“äºç†è§£å®ç°

2. **æå¿«é€Ÿ**
   - ç¬æ—¶å“åº”
   - æ— éœ€è¿­ä»£
   - æ— å»ºç«‹æ—¶é—´

3. **æˆæœ¬æä½**
   - ä¸éœ€è¦é«˜æ€§èƒ½MCU
   - æœ€ä½æˆæœ¬æ–¹æ¡ˆ
   - 8ä½MCUå³å¯

4. **æ— æŒ¯è¡**
   - æ’å®šç”µå‹è¾“å‡º
   - ç¨³å®šè¿è¡Œ
   - æ— åŠŸç‡æ³¢åŠ¨

5. **å¯é æ€§é«˜**
   - é€»è¾‘æç®€å•
   - ä¸ä¼šè¯¯åˆ¤
   - æ•…éšœç‡ä½

### ç¼ºç‚¹ âŒ

1. **ç²¾åº¦ä½**
   - å…¸å‹æ•ˆç‡: 90-95%
   - æŸå¤±5-10%åŠŸç‡
   - ä¸æ˜¯çœŸæ­£MPP

2. **ä¸èƒ½è·Ÿè¸ª**
   - å›ºå®šç”µå‹æ¯”ä¾‹
   - ç¯å¢ƒå˜åŒ–ä¸è·Ÿè¸ª
   - è€åŒ–ä¸é€‚åº”

3. **ä¾èµ–Voc**
   - éœ€è¦å‡†ç¡®Voc
   - Vocæµ‹é‡æœ‰è¯¯å·®
   - æ¸©åº¦å½±å“å¤§

4. **é€‚åº”æ€§å·®**
   - ä¸åŒç»„ä»¶kä¸åŒ
   - è€åŒ–åkå˜åŒ–
   - é®æŒ¡æƒ…å†µå¤±æ•ˆ

---

## ğŸ›ï¸ å‚æ•°è°ƒä¼˜

### ç”µå‹æ¯”ä¾‹ké€‰æ‹©

**ç»éªŒå€¼**:
| ç»„ä»¶ç±»å‹ | kå€¼èŒƒå›´ | æ¨èå€¼ |
|---------|---------|--------|
| å•æ™¶ç¡… | 0.76-0.78 | 0.76 |
| å¤šæ™¶ç¡… | 0.76-0.80 | 0.78 |
| è–„è†œ | 0.70-0.75 | 0.73 |
| HIT | 0.78-0.80 | 0.79 |

**ç²¾ç¡®ç¡®å®škå€¼**:
1. æµ‹è¯•å®é™…Vmppå’ŒVoc
2. è®¡ç®— k = Vmpp / Voc
3. ä½¿ç”¨è¯¥kå€¼

### Vocè·å–æ–¹æ³•

**æ–¹æ³•1: å¼€è·¯æµ‹é‡**(æœ€å‡†ç¡®)
```python
# çŸ­æš‚æ–­å¼€è´Ÿè½½
disconnect_load()
wait(100ms)  # ç­‰å¾…ç¨³å®š
voc_measured = measure_voltage()
reconnect_load()

cv.set_voc(voc_measured)
```

**æ–¹æ³•2: æ•°æ®æ‰‹å†Œ**(ç®€å•)
```python
# ä»ç»„ä»¶æ•°æ®æ‰‹å†Œ
voc_stc = 36.0  # STCæ¡ä»¶ä¸‹
cv = ConstantVoltage(voltage_ratio=0.76, voc=voc_stc)
```

**æ–¹æ³•3: æ¸©åº¦è¡¥å¿**(ç²¾ç¡®)
```python
voc_25 = 36.0  # 25Â°Cæ—¶
temp_coef = -0.0035  # /Â°C
temperature = 40.0  # å½“å‰æ¸©åº¦

voc_actual = voc_25 * (1 + temp_coef * (temperature - 25))
```

### å®šæœŸæ›´æ–°Voc

```python
cv = ConstantVoltage(
    voltage_ratio=0.76,
    voc=36.0,
    update_voc=True,           # å¯ç”¨æ›´æ–°
    voc_update_interval=100    # æ¯100æ­¥æ›´æ–°ä¸€æ¬¡
)
```

---

## ğŸ”§ å·¥ç¨‹å®ç°è¦ç‚¹

### 1. Vocæµ‹é‡

**å¿«é€Ÿæµ‹é‡æ³•**:
```python
def measure_voc_fast():
    """å¿«é€ŸVocæµ‹é‡(1ç§’å†…)"""
    # 1. è®°å½•å½“å‰å·¥ä½œç‚¹
    v_work, i_work = get_current_point()
    
    # 2. å¿«é€Ÿå¼€è·¯
    disconnect_load()
    wait(100ms)
    
    # 3. æµ‹é‡Voc
    voc = measure_voltage()
    
    # 4. æ¢å¤å·¥ä½œ
    reconnect_load()
    set_voltage(v_work)
    
    return voc
```

### 2. æ¸©åº¦è¡¥å¿

```python
class CVWithTempComp:
    def __init__(self, voc_25, temp_coef=-0.0035):
        self.voc_25 = voc_25
        self.temp_coef = temp_coef
    
    def get_voc(self, temperature):
        return self.voc_25 * (1 + self.temp_coef * (temperature - 25))
    
    def get_vref(self, temperature, k=0.76):
        voc = self.get_voc(temperature)
        return k * voc
```

### 3. ä¸P&Oæ··åˆ

**ç­–ç•¥**: å¯åŠ¨ç”¨CV,ç¨³å®šåç”¨P&O

```python
class HybridMPPT:
    def __init__(self):
        self.cv = ConstantVoltage(voltage_ratio=0.76, voc=36.0)
        self.po = PerturbAndObserve(step_size=1.0)
        self.mode = 'CV'  # åˆå§‹ç”¨CV
        self.switch_time = 100  # 100æ­¥ååˆ‡æ¢
        self.step_count = 0
    
    def update(self, v, i):
        self.step_count += 1
        
        if self.step_count < self.switch_time:
            # åˆæœŸç”¨CVå¿«é€Ÿå¯åŠ¨
            return self.cv.update(v, i)
        else:
            # åæœŸç”¨P&Oç²¾ç¡®è·Ÿè¸ª
            if self.mode == 'CV':
                self.mode = 'P&O'
                self.po.v_ref = self.cv.v_ref  # ç»§æ‰¿CVçš„ç”µå‹
            return self.po.update(v, i)
```

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### CV vs P&O vs INC

| æŒ‡æ ‡ | CV | P&O | INC |
|------|-----|-----|-----|
| è·Ÿè¸ªæ•ˆç‡ | 90-95% | 97-98% | 98-99% |
| å“åº”é€Ÿåº¦ | æå¿«(0æ­¥) | ä¸­(10-15æ­¥) | å¿«(8-12æ­¥) |
| ç¨³æ€æŒ¯è¡ | æ—  | 1-3% | <1% |
| è®¡ç®—å¤æ‚åº¦ | æä½ | ä½ | ä¸­ |
| ä»£ç é‡ | ~10è¡Œ | ~50è¡Œ | ~100è¡Œ |
| æˆæœ¬ | æä½ | ä½ | ä¸­ |
| å¯é æ€§ | æé«˜ | é«˜ | ä¸­ |
| é€‚åº”æ€§ | å·® | å¥½ | å¥½ |

### å…¸å‹æ€§èƒ½æ•°æ®

**CV (k=0.76)**:
```
è·Ÿè¸ªæ•ˆç‡:   92.5%
å“åº”æ—¶é—´:   <0.1s (ç¬æ—¶)
ç¨³æ€æŒ¯è¡:   0 W
å»ºç«‹æ—¶é—´:   0 æ­¥
```

**ä¸åŒkå€¼å½±å“**:
```
k=0.70:  88.5%æ•ˆç‡ (åç¦»è¾ƒè¿œ)
k=0.76:  92.5%æ•ˆç‡ (æœ€ä¼˜)
k=0.80:  90.8%æ•ˆç‡ (åç¦»)
```

---

## ğŸ¯ åº”ç”¨åœºæ™¯

### é€‚ç”¨åœºæ™¯ âœ…

1. **ç®€å•å…‰ä¼ç³»ç»Ÿ**
   - å°å‹æˆ·ç”¨(1-3kW)
   - è·¯ç¯/ç›‘æ§
   - ç¦»ç½‘ç³»ç»Ÿ

2. **æˆæœ¬æ•æ„Ÿåº”ç”¨**
   - ä½æˆæœ¬é€†å˜å™¨
   - å……ç”µæ§åˆ¶å™¨
   - ç®€æ˜“MPPT

3. **å¿«é€Ÿå¯åŠ¨éœ€æ±‚**
   - é¢‘ç¹å¯åœ
   - ç¬æ—¶å“åº”
   - åº”æ€¥ç”µæº

4. **ç¨³å®šç¯å¢ƒ**
   - è¾ç…§åº¦å˜åŒ–å°
   - æ¸©åº¦ç›¸å¯¹æ’å®š
   - æ— é®æŒ¡

### ä¸é€‚ç”¨åœºæ™¯ âŒ

1. **é«˜ç²¾åº¦è¦æ±‚**
   - å¤§å‹ç”µç«™
   - é«˜æ•ˆç‡è¦æ±‚
   - æŸå¤±ä¸å¯æ¥å—

2. **å˜åŒ–ç¯å¢ƒ**
   - äº‘å±‚é¢‘ç¹
   - æ¸©åº¦å‰§å˜
   - éƒ¨åˆ†é®æŒ¡

3. **é«˜ç«¯ç³»ç»Ÿ**
   - å¹¶ç½‘é€†å˜å™¨
   - å•†ä¸šå±‹é¡¶
   - ç§‘ç ”æµ‹è¯•

4. **å¤æ‚é…ç½®**
   - å¤šä¸²å¹¶è”
   - ä¸åŒç»„ä»¶
   - å¤šå³°P-Væ›²çº¿

---

## ğŸ’¡ æ€è€ƒé¢˜

1. **ä¸ºä»€ä¹ˆMPPé€šå¸¸åœ¨0.76Ã—Vocé™„è¿‘?è¿™ä¸ªæ¯”ä¾‹ä¼šå˜å—?**

2. **CVç®—æ³•åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æ€§èƒ½æœ€å·®?ä¸ºä»€ä¹ˆ?**

3. **å¦‚ä½•ç¡®å®šé€‚åˆè‡ªå·±ç»„ä»¶çš„æœ€ä½³kå€¼?**

4. **CVèƒ½å¦ä¸å…¶ä»–ç®—æ³•ç»“åˆ?å¦‚ä½•ç»“åˆ?**

5. **è€åŒ–10å¹´å,kå€¼ä¼šå¦‚ä½•å˜åŒ–?**

---

## ğŸ“š ä½œä¸š

### åŸºç¡€é¢˜

**ä½œä¸š1**: å®ç°åŸºæœ¬CVç®—æ³•,æµ‹è¯•ä¸åŒkå€¼çš„æ•ˆç‡ã€‚

**ä½œä¸š2**: æµ‹é‡å®é™…ç»„ä»¶çš„Vmpp/Vocæ¯”å€¼ã€‚

**ä½œä¸š3**: å¯¹æ¯”CVã€P&Oã€INCçš„å»ºç«‹æ—¶é—´ã€‚

### è¿›é˜¶é¢˜

**ä½œä¸š4**: å®ç°å¸¦æ¸©åº¦è¡¥å¿çš„æ”¹è¿›å‹CVã€‚

**ä½œä¸š5**: è®¾è®¡CV+P&Oæ··åˆç®—æ³•,å…¼é¡¾é€Ÿåº¦å’Œç²¾åº¦ã€‚

**ä½œä¸š6**: åˆ†æä¸åŒç±»å‹ç»„ä»¶(å•æ™¶/å¤šæ™¶/è–„è†œ)çš„æœ€ä½³kå€¼ã€‚

### æŒ‘æˆ˜é¢˜

**ä½œä¸š7**: å®ç°è‡ªé€‚åº”CV,æ ¹æ®å†å²æ•°æ®è°ƒæ•´kå€¼ã€‚

**ä½œä¸š8**: è®¾è®¡ä¸€ä¸ªç®—æ³•,è‡ªåŠ¨é€‰æ‹©CV/P&O/INCã€‚

**ä½œä¸š9**: ç ”ç©¶CVåœ¨å¤šå³°P-Væ›²çº¿ä¸‹çš„è¡¨ç°ã€‚

---

## âœ… æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬æ¡ˆä¾‹å,ä½ åº”è¯¥èƒ½å¤Ÿ:

- [ ] ç†è§£CVç®—æ³•çš„ç»éªŒæ³•åˆ™åŸç†
- [ ] çŸ¥é“ä¸ºä»€ä¹ˆké€šå¸¸æ˜¯0.76-0.8
- [ ] å®ç°åŸºæœ¬CVç®—æ³•
- [ ] é€‰æ‹©åˆé€‚çš„ç”µå‹æ¯”ä¾‹k
- [ ] æµ‹é‡å’Œæ›´æ–°Voc
- [ ] å®ç°æ¸©åº¦è¡¥å¿
- [ ] å¯¹æ¯”CVä¸P&O/INCçš„ä¼˜åŠ£
- [ ] åˆ¤æ–­CVçš„é€‚ç”¨åœºæ™¯
- [ ] è®¾è®¡CV+P&Oæ··åˆç®—æ³•

---

## ğŸ“– æ‰©å±•é˜…è¯»

### ç»å…¸è®ºæ–‡

1. **"Comparative Study of MPPT Algorithms"**
   - Renewable Energy, 2012

2. **"Constant Voltage Method for MPPT"**
   - Solar Energy, 2010

### æ”¹è¿›æ–¹æ¡ˆ

- **Adaptive CV**: è‡ªé€‚åº”kå€¼è°ƒæ•´
- **Hybrid CV-P&O**: æ··åˆç®—æ³•
- **CV with Voc Tracking**: å®æ—¶Vocè·Ÿè¸ª
- **Fuzzy CV**: æ¨¡ç³Šæ§åˆ¶kå€¼

### å·¥ä¸šåº”ç”¨

- å°å‹å……ç”µæ§åˆ¶å™¨
- è·¯ç¯/ç›‘æ§MPPT
- ç¦»ç½‘ç³»ç»Ÿæ§åˆ¶å™¨
- ä½æˆæœ¬é€†å˜å™¨

---

**æ¡ˆä¾‹9å®Œæˆ!** ğŸ‰

**ä¸‰ç§ç®—æ³•å¯¹æ¯”æ€»ç»“**:
```
CV:   æœ€ç®€å•,æœ€å¿«,ç²¾åº¦ä½ (90-95%)
P&O:  ç®€å•,ä¸­é€Ÿ,ç²¾åº¦ä¸­ (97-98%)
INC:  å¤æ‚,å¿«é€Ÿ,ç²¾åº¦é«˜ (98-99%)

é€‰æ‹©å»ºè®®:
- ç®€å•ç³»ç»Ÿ â†’ CV
- é€šç”¨åœºåˆ â†’ P&O
- é«˜ç²¾åº¦ â†’ INC
```

ä¸‹ä¸€æ­¥: [æ¡ˆä¾‹10 - æ¨¡ç³Šé€»è¾‘MPPT](../case_10_fuzzy_logic/README.md)
