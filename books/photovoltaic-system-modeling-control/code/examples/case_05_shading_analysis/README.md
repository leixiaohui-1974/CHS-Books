# æ¡ˆä¾‹5: é®æŒ¡åˆ†æžä¸Žè¯Šæ–­

## ðŸ“‹ æ¡ˆä¾‹æ¦‚è¿°

**å·¥ç¨‹èƒŒæ™¯**:
å…‰ä¼ç³»ç»Ÿè¿è¡Œä¸­å¸¸é‡åˆ°é®æŒ¡é—®é¢˜,å¯¼è‡´:
- åŠŸçŽ‡å¤§å¹…æŸå¤±
- çƒ­æ–‘æ•ˆåº”é£Žé™©
- ç»„ä»¶æ°¸ä¹…æŸå
- ç³»ç»Ÿæ•…éšœåœæœº

**å¸¸è§é®æŒ¡æº**:
- å»ºç­‘ç‰©/æ ‘æœ¨é˜´å½±
- ç°å°˜/é¸Ÿç²ª/è½å¶
- é›ªè¦†ç›–
- ç»„ä»¶è€åŒ–ä¸å‡

**å­¦ä¹ ç›®æ ‡**:
1. æŽŒæ¡é®æŒ¡æ¨¡å¼è¯†åˆ«æ–¹æ³•
2. å­¦ä¹ çƒ­æ–‘é£Žé™©è¯„ä¼°æŠ€æœ¯
3. ç†è§£I-Væ›²çº¿è¯Šæ–­åŽŸç†
4. æŽŒæ¡æ•…éšœå®šä½æ–¹æ³•

---

## ðŸ”¬ ç†è®ºåŸºç¡€

### é®æŒ¡æ•ˆåº”

**ä¸²è”ç‰¹æ€§å½±å“**:
```
ä¸²è”ç”µè·¯: I_string = min(I1, I2, ..., In)
â†’ æœ€å¼±ç”µæ± é™åˆ¶æ•´ä¸²ç”µæµ
â†’ åŠŸçŽ‡æŸå¤±è¿œå¤§äºŽé®æŒ¡é¢ç§¯æ¯”ä¾‹
```

**åŠŸçŽ‡æŸå¤±éžçº¿æ€§**:
- 5%é¢ç§¯é®æŒ¡ â†’ å¯èƒ½æŸå¤±20-30%åŠŸçŽ‡
- æ•´ç»„é®æŒ¡ â†’ æ—è·¯äºŒæžç®¡å¯¼é€š
- åˆ†æ•£é®æŒ¡ â†’ å½±å“æ›´ä¸¥é‡

### çƒ­æ–‘æ•ˆåº”

**å½¢æˆæœºåˆ¶**:
```
1. é®æŒ¡ç”µæ± äº§ç”Ÿè´Ÿç”µåŽ‹
2. æ¶ˆè€—åŠŸçŽ‡è€Œéžäº§ç”ŸåŠŸçŽ‡
3. è½¬åŒ–ä¸ºçƒ­é‡
4. æ¸©åº¦å‡é«˜(å¯è¾¾150Â°C)
5. æ°¸ä¹…æŸå
```

**çƒ­æ–‘æ¸©åº¦**:
- æ­£å¸¸è¿è¡Œ: 40-60Â°C
- è½»åº¦çƒ­æ–‘: 60-80Â°C
- ä¸¥é‡çƒ­æ–‘: 80-120Â°C
- å±é™©: >120Â°C

### I-Væ›²çº¿ç‰¹å¾

**æ­£å¸¸æ›²çº¿**:
- å¹³æ»‘å•è°ƒä¸‹é™
- æ— å°é˜¶
- FF > 0.70

**é®æŒ¡æ›²çº¿**:
- å‡ºçŽ°å°é˜¶
- å¤šä¸ªå±€éƒ¨å³°å€¼
- FFæ˜¾è‘—ä¸‹é™

**æ•…éšœæ›²çº¿**:
- å¼€è·¯: I â‰ˆ 0
- çŸ­è·¯: V â‰ˆ 0
- ä½ŽRsh: æ›²çº¿å¼¯æ›²
- é«˜Rs: FFä¸‹é™

---

## ðŸ’» ä»£ç ç¤ºä¾‹

### 1. é®æŒ¡æ¨¡å¼åˆ†æž

```python
from code.models.pv_cell import SingleDiodeModel
from code.models.pv_module import PVModule
from code.models.pv_diagnostics import ShadingAnalyzer

# åˆ›å»ºç»„ä»¶
cell = SingleDiodeModel(Isc=8.0, Voc=0.6, Imp=7.5, Vmp=0.48)
module = PVModule(cell_model=cell, Ns=60, Nb=3)

# åˆ›å»ºåˆ†æžå™¨
analyzer = ShadingAnalyzer(module)

# å®šä¹‰é®æŒ¡åœºæ™¯
irradiances = [1000.0] * 40 + [200.0] * 20  # åŽ20ç‰‡é®æŒ¡

# åˆ†æžé®æŒ¡æ¨¡å¼
result = analyzer.analyze_shading_pattern(irradiances)

print(f"é®æŒ¡ç”µæ± æ•°: {result['num_shaded_cells']}/{module.Ns}")
print(f"é®æŒ¡æ¯”ä¾‹: {result['shading_ratio']*100:.1f}%")
print(f"ä¸¥é‡ç¨‹åº¦: {result['severity']}")
print(f"å—å½±å“ç»„: {result['num_affected_groups']}/{module.Nb}")
```

è¾“å‡º:
```
é®æŒ¡ç”µæ± æ•°: 20/60
é®æŒ¡æ¯”ä¾‹: 33.3%
ä¸¥é‡ç¨‹åº¦: ä¸­åº¦é®æŒ¡
å—å½±å“ç»„: 1/3
```

### 2. çƒ­æ–‘é£Žé™©è¯„ä¼°

```python
# çƒ­æ–‘é£Žé™©æ£€æµ‹
hotspot_result = analyzer.detect_hot_spot_risk(irradiances)

print(f"æœ€å¼±ç”µæ± : #{hotspot_result['weakest_cell_index']}")
print(f"è¾ç…§åº¦: {hotspot_result['weakest_cell_irradiance']} W/mÂ²")
print(f"é¢„ä¼°æ¸©å‡: {hotspot_result['estimated_temp_rise']:.1f}Â°C")
print(f"é£Žé™©ç­‰çº§: {hotspot_result['risk_level']}")
print(f"æ—è·¯æ¿€æ´»: {'æ˜¯' if hotspot_result['will_bypass_activate'] else 'å¦'}")
```

è¾“å‡º:
```
æœ€å¼±ç”µæ± : #59
è¾ç…§åº¦: 200.0 W/mÂ²
é¢„ä¼°æ¸©å‡: 75.0Â°C
é£Žé™©ç­‰çº§: é«˜é£Žé™©
æ—è·¯æ¿€æ´»: æ˜¯
```

### 3. åŠŸçŽ‡æŸå¤±ä¼°ç®—

```python
# åŠŸçŽ‡æŸå¤±åˆ†æž
loss_result = analyzer.estimate_power_loss(irradiances)

print(f"åŸºå‡†åŠŸçŽ‡: {loss_result['baseline_power']:.2f} W")
print(f"é®æŒ¡åŠŸçŽ‡: {loss_result['shaded_power']:.2f} W")
print(f"åŠŸçŽ‡æŸå¤±: {loss_result['power_loss']:.2f} W")
print(f"æŸå¤±æ¯”ä¾‹: {loss_result['loss_percentage']:.1f}%")
```

### 4. I-Væ›²çº¿è¯Šæ–­

```python
from code.models.pv_diagnostics import IVCurveDiagnostics

# åˆ›å»ºè¯Šæ–­å™¨
diagnostics = IVCurveDiagnostics()

# èŽ·å–I-Væ›²çº¿
V, I = module.get_iv_curve(300)

# æ›²çº¿åˆ†æž
analysis = diagnostics.analyze_curve_shape(V, I)

print(f"Isc: {analysis['Isc']:.2f} A")
print(f"Voc: {analysis['Voc']:.2f} V")
print(f"Pmpp: {analysis['Pmpp']:.2f} W")
print(f"FF: {analysis['FF']:.3f}")
print(f"å°é˜¶æ•°: {analysis['num_steps']}")
print(f"é®æŒ¡: {'æ˜¯' if analysis['has_shading'] else 'å¦'}")
```

### 5. æ•…éšœæ£€æµ‹

```python
# å‚è€ƒå‚æ•°(æ­£å¸¸æ¡ä»¶)
reference = {
    'Voc': 36.0,
    'Isc': 8.0,
    'FF': 0.75
}

# æ•…éšœæ£€æµ‹
faults = diagnostics.detect_faults(V, I, reference)

print("æ•…éšœè¯Šæ–­:")
for fault in faults:
    print(f"  â€¢ {fault}")
```

è¾“å‡º:
```
æ•…éšœè¯Šæ–­:
  â€¢ æ£€æµ‹åˆ°é®æŒ¡ç‰¹å¾ - 3ä¸ªå°é˜¶
  â€¢ çŸ­è·¯ç”µæµè¿‡ä½Ž - å¯èƒ½é®æŒ¡æˆ–æ±¡æŸ“
```

### 6. æ€§èƒ½è¯„ä¼°

```python
from code.models.pv_diagnostics import PerformanceEvaluator

evaluator = PerformanceEvaluator()

# ç³»ç»Ÿå¥åº·è¯„ä¼°
health = evaluator.evaluate_system_health(
    current_power=850,      # å½“å‰åŠŸçŽ‡(W)
    rated_power=1000,       # é¢å®šåŠŸçŽ‡(W)
    irradiance=1000,        # è¾ç…§åº¦(W/mÂ²)
    temperature=25          # æ¸©åº¦(Â°C)
)

print(f"å½“å‰åŠŸçŽ‡: {health['current_power']} W")
print(f"æœŸæœ›åŠŸçŽ‡: {health['expected_power']:.0f} W")
print(f"æ€§èƒ½æ¯”: {health['pr_percentage']:.1f}%")
print(f"å¥åº·è¯„çº§: {health['health_grade']}")
```

---

## ðŸ“Š é®æŒ¡åœºæ™¯å¯¹æ¯”

### å…¸åž‹é®æŒ¡åœºæ™¯

| åœºæ™¯ | é®æŒ¡é¢ç§¯ | é®æŒ¡åˆ†å¸ƒ | åŠŸçŽ‡æŸå¤± | çƒ­æ–‘é£Žé™© | æ—è·¯å¯¼é€š |
|------|----------|----------|----------|----------|----------|
| æ— é®æŒ¡ | 0% | - | 0% | æ—  | å¦ |
| è½»åº¦ | 5-10% | åˆ†æ•£ | 10-20% | ä½Ž | å¦ |
| ä¸­åº¦ | 20-30% | é›†ä¸­ | 30-50% | ä¸­ | å¯èƒ½ |
| ä¸¥é‡ | 30-50% | æ•´ç»„ | 50-70% | é«˜ | æ˜¯ |
| æžç«¯ | >50% | å¤šç»„ | >70% | æžé«˜ | æ˜¯ |

### é®æŒ¡æºå¯¹æ¯”

| é®æŒ¡æº | æŒç»­æ—¶é—´ | å¯é¢„æµ‹æ€§ | æ¸…æ´éš¾åº¦ | é¢„é˜²æŽªæ–½ |
|--------|----------|----------|----------|----------|
| å»ºç­‘é˜´å½± | æ¯æ—¥/å­£èŠ‚ | é«˜ | N/A | é€‰å€ä¼˜åŒ– |
| æ ‘æœ¨é˜´å½± | æ¯æ—¥/å­£èŠ‚ | ä¸­ | N/A | ä¿®å‰ª/ç§»é™¤ |
| ç°å°˜ | é•¿æœŸ | ä½Ž | ä¸­ | å®šæœŸæ¸…æ´— |
| é¸Ÿç²ª | çŸ­æœŸ | ä½Ž | æ˜“ | é©±é¸Ÿè£…ç½® |
| ç§¯é›ª | å­£èŠ‚ | ä¸­ | éš¾ | å€¾è§’è®¾è®¡ |
| è½å¶ | å­£èŠ‚ | ä¸­ | æ˜“ | å®šæœŸæ¸…ç† |

---

## ðŸŽ¯ è¯Šæ–­æµç¨‹

### çŽ°åœºè¯Šæ–­æ­¥éª¤

```
æ­¥éª¤1: ç›®è§†æ£€æŸ¥
  â†’ è§‚å¯Ÿç»„ä»¶è¡¨é¢
  â†’ è¯†åˆ«æ˜Žæ˜¾é®æŒ¡ç‰©
  â†’ æ£€æŸ¥æŽ¥çº¿ç›’

æ­¥éª¤2: çº¢å¤–çƒ­æˆåƒ
  â†’ æ‰«æç»„ä»¶è¡¨é¢æ¸©åº¦
  â†’ è¯†åˆ«çƒ­æ–‘ä½ç½®
  â†’ è¯„ä¼°ä¸¥é‡ç¨‹åº¦

æ­¥éª¤3: I-Væ›²çº¿æµ‹è¯•
  â†’ æµ‹é‡ç»„ä¸²I-Væ›²çº¿
  â†’ å¯¹æ¯”æ ‡å‡†æ›²çº¿
  â†’ è¯†åˆ«å¼‚å¸¸ç‰¹å¾

æ­¥éª¤4: æ•…éšœå®šä½
  â†’ ç¡®å®šé—®é¢˜ç»„ä»¶
  â†’ åˆ†æžæ•…éšœåŽŸå› 
  â†’ åˆ¶å®šä¿®å¤æ–¹æ¡ˆ

æ­¥éª¤5: éªŒè¯ä¿®å¤
  â†’ æ¸…ç†/æ›´æ¢ç»„ä»¶
  â†’ é‡æ–°æµ‹è¯•
  â†’ ç¡®è®¤æ€§èƒ½æ¢å¤
```

### è¯Šæ–­å·¥å…·

**å¿…å¤‡å·¥å…·**:
- I-Væ›²çº¿æµ‹è¯•ä»ª
- çº¢å¤–çƒ­åƒä»ª
- ä¸‡ç”¨è¡¨
- é’³å½¢ç”µæµè¡¨

**è¾…åŠ©å·¥å…·**:
- æ— äººæœº(å±‹é¡¶å·¡æ£€)
- æ¸…æ´å·¥å…·
- è®°å½•è¡¨æ ¼

---

## ðŸ’¡ æœ€ä½³å®žè·µ

### é¢„é˜²æŽªæ–½

**1. é€‰å€é˜¶æ®µ**
- é¿å¼€é«˜å¤§å»ºç­‘/æ ‘æœ¨
- è¯„ä¼°å…¨å¹´é˜´å½±
- é¢„ç•™å®‰å…¨è·ç¦»

**2. è®¾è®¡é˜¶æ®µ**
- ä¼˜åŒ–ç»„ä»¶å¸ƒå±€
- åˆç†é…ç½®æ—è·¯äºŒæžç®¡
- è€ƒè™‘æ¸…æ´é€šé“

**3. è¿ç»´é˜¶æ®µ**
- å®šæœŸæ¸…æ´—(æ¯å­£åº¦)
- å®šæœŸå·¡æ£€(æ¯æœˆ)
- åŠæ—¶ä¿®å‰ªæ ‘æœ¨

### æ¸…æ´é¢‘çŽ‡

**å»ºè®®å‘¨æœŸ**:
- æ²™å°˜åœ°åŒº: æ¯æœˆ1æ¬¡
- æ™®é€šåœ°åŒº: æ¯å­£åº¦1æ¬¡
- æ¸…æ´åœ°åŒº: æ¯åŠå¹´1æ¬¡
- é›¨å­£åŽ: åŠ å¼ºæ¸…æ´—

**æ¸…æ´æ–¹æ³•**:
- çº¯æ°´å†²æ´—(æŽ¨è)
- è½¯æ¯›åˆ·æ¸…æ‰«
- ä¸“ä¸šæ¸…æ´—å‰‚
- é¿å…ç¡¬ç‰©åˆ®æ“¦

### ç›‘æŽ§å‘Šè­¦

**è®¾ç½®é˜ˆå€¼**:
- åŠŸçŽ‡ä¸‹é™>10%: è­¦å‘Š
- åŠŸçŽ‡ä¸‹é™>20%: å‘Šè­¦
- çƒ­æ–‘æ¸©åº¦>80Â°C: ç´§æ€¥
- FF<0.65: å¼‚å¸¸

---

## ðŸ“ æ€è€ƒé¢˜

1. **ä¸ºä»€ä¹ˆ5%çš„é®æŒ¡å¯èƒ½å¯¼è‡´30%çš„åŠŸçŽ‡æŸå¤±?**

2. **æ—è·¯äºŒæžç®¡èƒ½å®Œå…¨æ¶ˆé™¤é®æŒ¡å½±å“å—?**

3. **å¦‚ä½•åŒºåˆ†é®æŒ¡å’Œç»„ä»¶è€åŒ–?**

4. **ä»€ä¹ˆæƒ…å†µä¸‹åº”ç«‹å³åœæœºæ£€ä¿®?**

---

## ðŸ“š ä½œä¸š

### åŸºç¡€é¢˜

**ä½œä¸š1**: åˆ†æžä¸åŒé®æŒ¡æ¨¡å¼(é›†ä¸­vsåˆ†æ•£)çš„åŠŸçŽ‡æŸå¤±å·®å¼‚ã€‚

**ä½œä¸š2**: è®¾è®¡ä¸€ä¸ªçƒ­æ–‘æ£€æµ‹ç®—æ³•,åŸºäºŽæ¸©åº¦é˜ˆå€¼ã€‚

**ä½œä¸š3**: ç¼–å†™I-Væ›²çº¿è‡ªåŠ¨è¯Šæ–­ç¨‹åºã€‚

### è¿›é˜¶é¢˜

**ä½œä¸š4**: å»ºç«‹é®æŒ¡-åŠŸçŽ‡æŸå¤±é¢„æµ‹æ¨¡åž‹ã€‚

**ä½œä¸š5**: è®¾è®¡åŸºäºŽæ— äººæœºçš„å…‰ä¼ç”µç«™å·¡æ£€æ–¹æ¡ˆã€‚

**ä½œä¸š6**: å¼€å‘å…‰ä¼ç”µç«™å¥åº·ç›‘æŽ§ç³»ç»Ÿã€‚

---

## âœ… æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬æ¡ˆä¾‹åŽ,ä½ åº”è¯¥èƒ½å¤Ÿ:

- [ ] è¯†åˆ«ä¸åŒé®æŒ¡æ¨¡å¼
- [ ] è¯„ä¼°çƒ­æ–‘é£Žé™©ç­‰çº§
- [ ] åˆ†æžI-Væ›²çº¿å¼‚å¸¸
- [ ] è¿›è¡Œæ•…éšœè¯Šæ–­å®šä½
- [ ] ä¼°ç®—åŠŸçŽ‡æŸå¤±
- [ ] åˆ¶å®šé¢„é˜²æŽªæ–½
- [ ] è®¾è®¡ç›‘æŽ§å‘Šè­¦ç³»ç»Ÿ

---

**æ¡ˆä¾‹5å®Œæˆ!** ðŸŽ‰

ä¸‹ä¸€æ­¥: [æ¡ˆä¾‹6 - å‚æ•°è¾¨è¯†æ–¹æ³•](../case_06_parameter_identification/README.md)
