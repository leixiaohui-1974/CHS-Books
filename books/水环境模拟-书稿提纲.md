# 水环境模拟教材
## 基于案例驱动的水环境数值模拟课程

**适用对象**: 环境工程、水利工程、市政工程专业本科生及研究生  
**教学方法**: 案例驱动学习（Case-Based Learning）  
**完成度**: 规划阶段（0/30个案例）  
**版本**: v1.0-outline（提纲设计）

---

## 📋 教材定位

### 核心理念：从理论到实践，从简单到复杂

本教材是CHS-Books系列的**第五本**，专注于**水环境模拟**，将水力学、水质学、生态学和数值方法有机结合，培养学生解决实际水环境问题的能力。

### 与前四本书的关系

```
第1本：《水系统控制论》
         ↓ 复用
    - 系统动力学建模方法
    - 参数辨识技术
    - 状态空间方法
    
第2本：《明渠水力学》
         ↓ 复用
    - 水流运动方程
    - 对流-扩散方程求解
    - 数值算法（有限差分、有限体积）
    
第3本：《渠道与管道控制》
         ↓ 复用
    - 数值求解技术
    - 优化算法
    
第4本：《智能水网工程设计》
         ↓ 复用
    - 系统建模思想
    
第5本：《水环境模拟》（本书）
         ↓ 新增
    - **水质模型**
    - **污染物迁移转化机理**
    - **生态动力学模型**
    - **富营养化模拟**
    - **水环境容量计算**
```

### 三大核心特色

#### 1. 机理建模 + 数值求解
- 从质量守恒定律出发建立微分方程
- 系统讲解数值求解技术
- 强调物理意义和数学严谨性

#### 2. 案例驱动 + 工程实践
- 每个案例对应真实工程问题
- 提供完整的Python实现代码
- 包含参数率定和模型验证

#### 3. 单一过程 → 耦合系统
- 从单一污染物到多组分
- 从1D到2D/3D
- 从物理过程到生化反应
- 从河流到湖库到地下水

---

## 🎯 教材目标

### 知识目标
1. 掌握水质模型的基本原理和数学描述
2. 理解污染物在水体中的迁移转化机理
3. 掌握水环境模拟的数值方法
4. 熟悉常用水质模型（如QUAL2K、WASP、CE-QUAL-W2等）的原理

### 能力目标
1. 能够建立水环境问题的数学模型
2. 能够使用Python编写水质模拟程序
3. 能够进行模型参数率定和验证
4. 能够分析水环境问题并提出治理方案

### 素质目标
1. 培养系统思维和建模能力
2. 建立环境保护意识
3. 形成严谨的科研态度

---

## 📚 教材体系（30个案例）

### 知识体系架构

```
第一部分：水质模拟基础（案例1-6）
    ↓
  基础理论：对流-扩散方程、守恒定律
    ↓
第二部分：河流水质模拟（案例7-12）
    ↓
  一维河流模型、污染带计算
    ↓
第三部分：湖库水质模拟（案例13-18）
    ↓
  完全混合、分层、富营养化
    ↓
第四部分：地下水污染模拟（案例19-22）
    ↓
  渗流-溶质运移耦合
    ↓
第五部分：综合水环境系统（案例23-30）
    ↓
  流域尺度、水质-生态耦合、治理方案评估
```

---

## 📖 第一部分：水质模拟基础（案例1-6）

### 第一阶段：基本概念（案例1-3）

#### 案例1：污染物在静水中的扩散 ⭐
**难度**: ★☆☆☆☆  
**学时**: 4学时  

**工程背景**：  
某实验室水槽（长10m，宽2m，深1m），在中心点瞬时投放100g染料，观察扩散过程。

**学习目标**：
- 理解Fick扩散定律
- 掌握扩散方程的基本形式
- 学会解析解与数值解的对比

**核心方程**：
```
∂C/∂t = Dx * ∂²C/∂x² + Dy * ∂²C/∂y²
```

**计算任务**：
1. 建立1D/2D扩散模型
2. 显式差分法求解
3. 与解析解对比验证
4. 分析扩散系数的影响

**复用知识**：
- ✅ 第2本：有限差分法基础

---

#### 案例2：示踪剂在渠道中的对流-扩散 ⭐⭐
**难度**: ★★☆☆☆  
**学时**: 6学时  

**工程背景**：  
某灌溉渠道（Q=2m³/s，宽5m，深1.5m），在上游投放示踪剂，监测下游5km处的浓度变化。

**学习目标**：
- 理解对流-扩散过程
- 掌握对流项和扩散项的数值处理
- 学会数值稳定性分析

**核心方程**：
```
∂C/∂t + u * ∂C/∂x = Dx * ∂²C/∂x² - k*C
```

**计算任务**：
1. 建立1D对流-扩散-衰减模型
2. 对比不同格式（迎风、中心差分、QUICK）
3. 分析Peclet数和Courant数
4. 验证数值耗散和振荡

**复用知识**：
- ✅ 第2本：对流方程数值格式
- ✅ 第2本：数值稳定性分析

---

#### 案例3：河流中的降解反应 ⭐⭐
**难度**: ★★☆☆☆  
**学时**: 6学时  

**工程背景**：  
某河段接纳污水处理厂尾水（COD=50mg/L），分析污染物沿程衰减规律。

**学习目标**：
- 理解一阶衰减动力学
- 掌握反应-迁移耦合
- 学会参数率定方法

**核心方程**：
```
dC/dt = -k * C    （零阶、一阶、二阶反应）
```

**计算任务**：
1. 建立不同反应级数模型
2. 实验数据拟合率定反应速率常数
3. 分析温度对降解速率的影响（Arrhenius方程）
4. 预测污染带长度

**复用知识**：
- ✅ 第1本：参数辨识技术

---

### 第二阶段：经典水质模型（案例4-6）

#### 案例4：Streeter-Phelps溶解氧模型（经典） ⭐⭐⭐
**难度**: ★★★☆☆  
**学时**: 8学时  

**工程背景**：  
某河流接纳城市污水，分析DO变化过程，确定氧垂曲线和临界点。

**学习目标**：
- 理解DO动力学平衡
- 掌握S-P模型的建立和求解
- 学会分析最小溶解氧点

**核心方程**：
```
dL/dt = -k1 * L                    （BOD衰减）
dD/dt = k1*L - k2*D                （氧亏方程）
DO = DO_sat - D                    （溶解氧）
```

**计算任务**：
1. 建立S-P模型
2. 求解析解并绘制氧垂曲线
3. 确定临界氧亏点位置和时间
4. 分析复氧系数k2的影响
5. 扩展：考虑光合作用和底泥耗氧

**关键参数**：
- k1: BOD降解系数（典型值0.1-0.3 d⁻¹）
- k2: 复氧系数（典型值0.3-1.0 d⁻¹）

**工程意义**：
- 环境容量计算
- 排污口选址
- 污水处理厂设计

---

#### 案例5：营养盐循环基础模型 ⭐⭐⭐
**难度**: ★★★☆☆  
**学时**: 8学时  

**工程背景**：  
湖泊富营养化问题，分析氮磷循环过程。

**学习目标**：
- 理解氮磷循环机理
- 掌握多组分耦合模型
- 学会质量平衡分析

**核心组分**：
- NH₄-N（铵氮）
- NO₃-N（硝氮）
- PO₄-P（磷酸盐）
- 有机氮、有机磷

**核心反应**：
```
NH₄ → NO₃    （硝化反应）
NO₃ → N₂     （反硝化反应）
有机N → NH₄   （氨化作用）
```

**计算任务**：
1. 建立氮循环模型（NH₄-NO₃-有机N）
2. 建立磷循环模型（PO₄-有机P）
3. 分析不同反应速率
4. 模拟外源输入的影响

---

#### 案例6：水体自净能力评估 ⭐⭐⭐
**难度**: ★★★☆☆  
**学时**: 8学时  

**工程背景**：  
评估某河段的自净能力，确定最大纳污量。

**学习目标**：
- 理解水体自净机理
- 掌握环境容量计算方法
- 学会总量控制方法

**自净过程**：
- 物理自净：稀释、沉降
- 化学自净：氧化、还原
- 生物自净：微生物降解

**计算任务**：
1. 建立综合自净模型
2. 计算环境容量
3. 分析不同保证率下的纳污能力
4. 制定总量控制方案

---

## 📖 第二部分：河流水质模拟（案例7-12）

### 第三阶段：一维河流模型（案例7-9）

#### 案例7：河流点源污染模拟 ⭐⭐⭐
**难度**: ★★★☆☆  
**学时**: 8学时  

**工程背景**：  
某化工厂排污口下游水质预测。

**学习目标**：
- 建立1D河流水质完整模型
- 掌握点源边界条件处理
- 学会水质预测和评价

**控制方程**：
```
∂C/∂t + u*∂C/∂x = Dx*∂²C/∂x² - k*C + S(x,t)
```

**计算任务**：
1. 耦合水力学模块（Manning公式或圣维南方程）
2. 建立水质模块（COD、NH₃-N、DO）
3. 点源污染边界条件
4. 预测下游水质分布
5. 水质达标分析

**复用知识**：
- ✅ 第2本：明渠水力计算
- ✅ 第2本：圣维南方程求解

---

#### 案例8：河流非点源污染模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 10学时  

**工程背景**：  
农业面源污染（化肥、农药）对河流的影响。

**学习目标**：
- 理解非点源污染特点
- 掌握分布源项处理方法
- 学会降雨-径流-水质耦合

**污染源**：
- 农田施肥流失
- 畜禽养殖废水
- 城市地表径流

**计算任务**：
1. 建立降雨-产流模型（SCS-CN方法）
2. 计算非点源污染负荷
3. 耦合河流水质模型
4. 分析降雨强度和污染负荷的关系
5. 制定面源污染控制方案

---

#### 案例9：河流突发污染事故模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 10学时  

**工程背景**：  
危化品泄漏进入河流，快速预测污染范围和到达时间。

**学习目标**：
- 理解瞬时排放和连续排放
- 掌握实时模拟技术
- 学会应急响应方案制定

**污染类型**：
- 瞬时泄漏（脉冲输入）
- 连续泄漏（阶跃输入）

**计算任务**：
1. 建立快速响应模型
2. 预测污染带到达时间
3. 确定警戒区范围
4. 制定应急调度方案（闸门调控、取水口关闭）
5. 实时更新模拟（数据同化）

**关键技术**：
- 高效数值格式（TVD、WENO）
- 自适应网格
- 并行计算

---

### 第四阶段：二维河流模型（案例10-12）

#### 案例10：河流横向混合模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
宽浅河流，排污口位于岸边，分析横向浓度分布。

**学习目标**：
- 理解横向混合机理
- 掌握2D对流-扩散方程求解
- 学会混合区计算

**控制方程**：
```
∂C/∂t + u*∂C/∂x + v*∂C/∂y = Dx*∂²C/∂x² + Dy*∂²C/∂y² - k*C
```

**计算任务**：
1. 建立2D流场（深度平均）
2. 求解2D水质方程
3. 分析横向扩散系数
4. 确定混合区范围
5. 优化排污口位置

**数值方法**：
- 有限差分法（ADI格式）
- 有限体积法
- 不规则边界处理

**复用知识**：
- ✅ 第2本：二维浅水方程

---

#### 案例11：河流弯道水质模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
弯曲河道中的二次流对污染物分布的影响。

**学习目标**：
- 理解弯道二次流
- 掌握曲线坐标系下的方程
- 学会复杂边界处理

**关键现象**：
- 横向环流
- 浓度偏向凹岸
- 纵向离散增强

**计算任务**：
1. 建立曲线坐标系
2. 模拟弯道二次流
3. 分析污染物横向分布
4. 对比直道与弯道的混合特性

---

#### 案例12：河口盐水入侵与水质模拟 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 14学时  

**工程背景**：  
河口地区，潮汐作用下盐淡水混合和污染物分布。

**学习目标**：
- 理解密度流和盐水楔
- 掌握往复流动条件下的水质模拟
- 学会潮汐边界条件处理

**控制方程**：
```
水流：考虑密度差的圣维南方程
盐度：对流-扩散方程
水质：耦合盐度的对流-扩散方程
```

**计算任务**：
1. 建立潮汐河口水动力模型
2. 模拟盐水入侵过程
3. 分析盐淡水混合对污染物的影响
4. 预测取水口水质变化
5. 制定枯水期取水方案

**关键技术**：
- 潮汐边界条件
- 密度分层处理
- 长时间模拟的数值稳定性

---

## 📖 第三部分：湖库水质模拟（案例13-18）

### 第五阶段：完全混合模型（案例13-14）

#### 案例13：小型湖泊完全混合模型 ⭐⭐
**难度**: ★★☆☆☆  
**学时**: 6学时  

**工程背景**：  
城市景观湖（面积0.5km²，平均水深3m），风力作用强，垂向混合充分。

**学习目标**：
- 理解完全混合假设
- 掌握箱式模型（Box Model）
- 学会湖泊质量平衡

**控制方程**：
```
V * dC/dt = Q_in * C_in - Q_out * C - k*V*C + S
```

**计算任务**：
1. 建立0D箱式模型
2. 计算水力停留时间
3. 模拟外源输入的响应
4. 分析换水周期的影响
5. 评估水质改善措施（换水、曝气）

**工程应用**：
- 城市景观湖水质保持
- 调蓄池水质控制

---

#### 案例14：湖泊营养盐输入响应分析 ⭐⭐⭐
**难度**: ★★★☆☆  
**学时**: 8学时  

**工程背景**：  
评估点源削减对湖泊水质的改善效果。

**学习目标**：
- 理解湖泊营养盐平衡
- 掌握Vollenweider模型
- 学会污染负荷削减方案评估

**Vollenweider模型**：
```
dP/dt = L/V - P*Q/V - σ*P*A/V
```
其中：
- L: 外源负荷
- σ: 沉降速率
- A: 湖泊面积

**计算任务**：
1. 建立磷平衡模型
2. 率定沉降系数
3. 预测不同削减方案的效果
4. 确定临界营养负荷
5. 制定污染控制目标

---

### 第六阶段：分层模型（案例15-16）

#### 案例15：水库温度分层与水质模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
深水水库（最大水深80m），夏季温度分层明显，底层DO下降。

**学习目标**：
- 理解热分层机理
- 掌握1D垂向模型
- 学会温度-DO耦合模拟

**控制方程**：
```
温度：∂T/∂t = ∂/∂z(Kz * ∂T/∂z) + Heat_source
DO：   ∂DO/∂t = ∂/∂z(Kz * ∂DO/∂z) + SOD + 光合作用 - 呼吸
```

**计算任务**：
1. 建立1D垂向温度模型
2. 计算热量收支（太阳辐射、蒸发、对流）
3. 模拟春季-夏季-秋季分层演变
4. 耦合DO模型
5. 分析底层缺氧成因
6. 评估曝气措施效果

**关键参数**：
- 垂向扩散系数 Kz（强分层<0.01 cm²/s，弱分层>1 cm²/s）
- 沉积物耗氧速率 SOD

---

#### 案例16：水库异重流模拟 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 14学时  

**工程背景**：  
汛期高浓度泥沙水流进入水库，形成异重流潜入底层。

**学习目标**：
- 理解密度流动力学
- 掌握2D（x-z）模型
- 学会泥沙-水质耦合

**物理过程**：
- 潜入点判断
- 异重流头部前进
- 界面混合夹卷

**计算任务**：
1. 建立2D密度流模型
2. 模拟异重流运动过程
3. 分析泥沙和污染物的垂向分布
4. 预测取水口水质风险
5. 优化水库调度方案（分层取水）

**数值方法**：
- 结构化/非结构化网格
- 湍流闭合（k-ε模型）
- 界面捕捉技术

---

### 第七阶段：富营养化模型（案例17-18）

#### 案例17：湖泊藻类生长动力学模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
浅水湖泊，夏季蓝藻暴发，水华频发。

**学习目标**：
- 理解藻类生长机理
- 掌握Monod动力学
- 学会富营养化模拟

**核心变量**：
- Chl-a（叶绿素a，代表藻类生物量）
- N（氮）
- P（磷）
- DO（溶解氧）

**控制方程**：
```
dChl/dt = (μ - r - m) * Chl
μ = μ_max * f(T) * min(f_N, f_P) * f_light
```

**限制因子**：
- 营养盐限制（Monod方程）
- 光照限制（Steele方程）
- 温度影响（Arrhenius方程）

**计算任务**：
1. 建立藻类-营养盐-DO耦合模型
2. 率定生长速率和呼吸速率
3. 模拟春季-夏季-秋季演替
4. 分析N限制vs P限制
5. 评估营养盐削减对水华的控制效果

---

#### 案例18：三维湖泊富营养化模拟 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 16学时  

**工程背景**：  
大型浅水湖泊（如太湖、巢湖），风生流作用显著，藻类空间分布不均。

**学习目标**：
- 掌握3D水动力-水质-生态耦合模型
- 理解风场对藻类分布的影响
- 学会湖流和营养盐输运模拟

**模型组成**：
1. **水动力模块**：3D湖流（EFDC、FVCOM类型）
2. **水质模块**：多组分迁移转化
3. **生态模块**：藻类-浮游动物-鱼类

**计算任务**：
1. 建立3D湖流模型（风驱动）
2. 耦合营养盐和藻类模型
3. 模拟风场变化下的藻类聚集（水华）
4. 分析不同风向下的空间分布
5. 预测未来气候变化的影响

**数值方法**：
- 非结构化网格（三角形）
- σ坐标系（垂向）
- 并行计算

**模型软件**：
- EFDC（Environmental Fluid Dynamics Code）
- CE-QUAL-W2
- MIKE 3

---

## 📖 第四部分：地下水污染模拟（案例19-22）

### 第八阶段：地下水溶质运移（案例19-21）

#### 案例19：一维地下水污染柱实验 ⭐⭐
**难度**: ★★☆☆☆  
**学时**: 6学时  

**工程背景**：  
实验室土柱实验，研究污染物在多孔介质中的运移。

**学习目标**：
- 理解多孔介质中的对流-弥散
- 掌握吸附和解吸过程
- 学会穿透曲线分析

**控制方程**：
```
R * ∂C/∂t + v * ∂C/∂x = D * ∂²C/∂x²
R = 1 + ρb*Kd/θ    （阻滞因子）
```

**计算任务**：
1. 建立1D对流-弥散-吸附模型
2. 模拟穿透曲线
3. 率定弥散度和分配系数
4. 分析阻滞效应
5. 预测污染羽到达时间

---

#### 案例20：二维含水层污染羽迁移 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
化工厂渗漏，污染物进入地下水，形成污染羽。

**学习目标**：
- 理解地下水流动和污染物运移的耦合
- 掌握2D溶质运移模拟
- 学会污染羽轨迹预测

**控制方程**：
```
地下水流：∂h/∂t = ∇·(K∇h) + W
溶质运移：∂C/∂t + v·∇C = ∇·(D∇C) - λC
```

**计算任务**：
1. 建立2D地下水流模型
2. 耦合溶质运移模型
3. 模拟污染羽扩展过程
4. 预测下游水井污染风险
5. 设计抽水井阻截方案

**数值方法**：
- 有限差分法
- 有限元法（Galerkin）
- 粒子追踪法（MT3D）

---

#### 案例21：多层含水层垂向迁移 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
垃圾填埋场渗滤液污染潜水和承压含水层。

**学习目标**：
- 理解多层含水层系统
- 掌握垂向迁移模拟
- 学会隔水层作用分析

**关键过程**：
- 非饱和带运移
- 弱透水层越流
- 多层含水层耦合

**计算任务**：
1. 建立多层含水层模型
2. 模拟污染物垂向迁移
3. 分析隔水层保护作用
4. 评估深层含水层污染风险
5. 设计防渗方案

---

### 第九阶段：地下水修复（案例22）

#### 案例22：抽出-处理修复方案优化 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
污染场地修复，通过抽水井抽出污染地下水处理。

**学习目标**：
- 理解修复技术原理
- 掌握修复方案优化方法
- 学会费用-效益分析

**修复技术**：
- 抽出-处理（Pump & Treat）
- 原位化学氧化（ISCO）
- 生物修复

**计算任务**：
1. 模拟不同抽水方案的效果
2. 优化抽水井位置和流量
3. 预测修复时间
4. 分析修复费用
5. 制定最优修复方案

**优化算法**：
- 遗传算法（GA）
- 模拟退火（SA）
- 粒子群算法（PSO）

**复用知识**：
- ✅ 第2本：优化算法

---

## 📖 第五部分：综合水环境系统（案例23-30）

### 第十阶段：流域尺度模拟（案例23-25）

#### 案例23：流域水文-水质耦合模拟 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 16学时  

**工程背景**：  
小流域（面积500km²），分析降雨-径流-面源污染过程。

**学习目标**：
- 理解流域水循环和污染物循环
- 掌握分布式水文模型
- 学会SWAT/HSPF等模型原理

**模型框架**：
```
降雨 → 产流 → 坡面汇流 → 河道汇流 → 出口
        ↓        ↓            ↓
     土壤侵蚀  养分流失    河道水质
```

**计算任务**：
1. 建立分布式水文模型（子流域划分）
2. 模拟降雨-径流过程
3. 计算非点源污染负荷
4. 河道水质响应
5. 评估土地利用变化的影响

**模型工具**：
- SWAT（Soil and Water Assessment Tool）
- HSPF（Hydrological Simulation Program-Fortran）

---

#### 案例24：河湖水系连通与水质改善 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
城市河网，通过闸门调度实现引清释污。

**学习目标**：
- 理解河网水动力学
- 掌握水系连通调度方法
- 学会水质改善方案评估

**系统组成**：
- 河道网络
- 闸门控制点
- 污染源
- 取水口

**计算任务**：
1. 建立河网水动力模型
2. 模拟不同调度方案的水质响应
3. 优化闸门调度策略
4. 分析换水周期
5. 评估生态补水需求

**复用知识**：
- ✅ 第2本：河网水力计算
- ✅ 第3本：闸门调度优化

---

#### 案例25：跨流域调水水质风险评估 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 14学时  

**工程背景**：  
南水北调工程，长距离输水过程中的水质变化。

**学习目标**：
- 理解长距离输水水质问题
- 掌握多水源混合模拟
- 学会水质风险评估

**关键问题**：
- 藻类生长（渠道日照充分）
- 泥沙沉积
- 突发污染风险
- 水源切换

**计算任务**：
1. 建立输水渠道水质模型
2. 模拟多水源混合过程
3. 评估藻类生长风险
4. 突发污染事故模拟
5. 制定应急预案

---

### 第十一阶段：水质-生态耦合（案例26-28）

#### 案例26：河流生态系统模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
河流生态修复，分析水质-生境-生物群落的关系。

**学习目标**：
- 理解水生态系统结构
- 掌握食物链模型
- 学会生态健康评价

**生态组分**：
```
初级生产者（藻类、水草）
    ↓
初级消费者（浮游动物）
    ↓
次级消费者（鱼类）
    ↓
分解者（细菌）
```

**计算任务**：
1. 建立河流生态模型（藻类-浮游动物-鱼类）
2. 模拟营养级传递
3. 分析关键物种的作用
4. 评估生态修复措施
5. 预测生物多样性变化

---

#### 案例27：湖泊生态系统稳态转换 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 14学时  

**工程背景**：  
浅水湖泊，草型清水态与藻型浊水态的转换。

**学习目标**：
- 理解生态系统多稳态理论
- 掌握catastrophe分析方法
- 学会生态修复阈值确定

**两种稳态**：
- 清水态：沉水植物主导，水质好
- 浊水态：藻类主导，水质差

**关键机制**：
- 正反馈：藻类遮光 → 水草死亡 → 底泥再悬浮 → 藻类繁殖
- 临界点（Tipping Point）

**计算任务**：
1. 建立包含水草和藻类的竞争模型
2. 分析系统稳定性
3. 确定稳态转换的临界营养盐浓度
4. 模拟生态修复过程
5. 评估水草恢复措施

**理论基础**：
- Catastrophe理论
- Alternative Stable States

---

#### 案例28：湿地生态系统净化功能模拟 ⭐⭐⭐⭐
**难度**: ★★★★☆  
**学时**: 12学时  

**工程背景**：  
人工湿地处理污水，评估净化效果。

**学习目标**：
- 理解湿地净化机理
- 掌握湿地水文-水质模型
- 学会湿地设计方法

**净化机制**：
- 植物吸收
- 微生物降解
- 基质吸附
- 沉降过滤

**计算任务**：
1. 建立湿地水文模型（考虑植物蒸腾）
2. 模拟污染物去除过程
3. 分析停留时间的影响
4. 优化湿地设计参数（面积、深度、植物）
5. 评估季节变化的影响

---

### 第十二阶段：综合治理方案（案例29-30）

#### 案例29：城市黑臭水体治理方案评估 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 16学时  

**工程背景**：  
城市河道黑臭，综合采用控源截污、清淤、生态修复等措施。

**学习目标**：
- 理解黑臭成因
- 掌握多措施协同模拟
- 学会治理方案比选

**黑臭成因**：
- 污染源：雨污混接、污水直排
- 内源：底泥污染
- 水动力：流动性差

**治理措施**：
1. 控源截污（减少外源）
2. 清淤疏浚（削减内源）
3. 生态修复（增强自净）
4. 引清释污（改善水动力）
5. 曝气增氧（提升DO）

**计算任务**：
1. 建立河道综合模型（水动力-水质-底泥-生态）
2. 模拟现状水质
3. 评估单项措施效果
4. 优化组合方案
5. 预测治理后水质达标情况
6. 制定长效保持方案

---

#### 案例30：流域水环境综合管理平台 ⭐⭐⭐⭐⭐
**难度**: ★★★★★☆  
**学时**: 20学时  

**工程背景**：  
流域水环境综合管理，集成多模型，支持决策。

**学习目标**：
- 理解流域水环境管理体系
- 掌握多模型集成技术
- 学会决策支持系统开发

**系统架构**：
```
┌─────────────────────────────────┐
│     决策支持层                    │
│  - 方案比选                      │
│  - 目标达成分析                  │
│  - 投资优化                      │
└─────────────────────────────────┘
            ↓↑
┌─────────────────────────────────┐
│     模型层                        │
│  - 水文模型（SWAT）              │
│  - 河流模型（QUAL2K）            │
│  - 湖库模型（CE-QUAL-W2）        │
│  - 地下水模型（MODFLOW/MT3D）    │
└─────────────────────────────────┘
            ↓↑
┌─────────────────────────────────┐
│     数据层                        │
│  - 水文水质监测数据              │
│  - 污染源普查数据                │
│  - GIS空间数据                   │
└─────────────────────────────────┘
```

**计算任务**：
1. 构建流域数据库
2. 集成多个子模型
3. 开发模型接口和数据交换
4. 情景分析（土地利用变化、气候变化）
5. 制定流域水环境综合治理方案
6. 开发Web可视化平台

**关键技术**：
- 模型耦合
- 数据同化
- 不确定性分析
- 可视化技术

**综合应用**：
- 集成前29个案例的所有技术
- 面向流域管理决策
- 可持续发展评估

---

## 🔧 核心技术栈

### 数学模型
- **守恒方程**：质量守恒、动量守恒
- **对流-扩散方程**：污染物迁移基本方程
- **反应动力学**：零阶、一阶、二阶、Monod动力学
- **生态动力学**：Lotka-Volterra方程、食物链模型

### 数值方法
- **有限差分法（FDM）**：显式、隐式、Crank-Nicolson
- **有限体积法（FVM）**：守恒性好，适合对流占优
- **有限元法（FEM）**：复杂边界，地下水常用
- **粒子追踪法**：Lagrangian方法

### 特殊技术
- **TVD/WENO格式**：高精度激波捕捉
- **ADI方法**：多维问题
- **算子分裂**：物理过程解耦
- **自适应网格**：提高效率

### 参数率定
- **试错法**：手动调参
- **最小二乘法**：最优化
- **贝叶斯方法**：考虑不确定性
- **PEST工具**：自动率定

### 编程实现
- **Python**：主要开发语言
- **NumPy/SciPy**：数值计算
- **Matplotlib**：绘图
- **Pandas**：数据处理
- **NetCDF/HDF5**：大数据存储

---

## 🎓 学习路径

### 路径1：环境工程本科生（推荐）
**学时**：约240学时（30周×8学时）

1. **基础阶段**（案例1-6，6周）
   - 掌握水质模拟基本原理
   - 熟悉数值方法基础
   
2. **河流模拟**（案例7-12，8周）
   - 重点掌握1D模型
   - 了解2D模型

3. **湖库模拟**（案例13-18，8周）
   - 重点掌握完全混合和分层模型
   - 了解富营养化模拟

4. **选修专题**（案例19-30中选4-6个，8周）
   - 根据兴趣选择地下水或流域尺度

### 路径2：研究生（深度）
**学时**：约400学时

1. 系统学习全部30个案例（24周）
2. 深入研究数值方法（4周）
3. 开展创新性研究（4周）
4. 论文撰写（4周）

### 路径3：在职工程师（快速）
**学时**：约100学时

1. 快速学习案例1-6（基础，3周）
2. 根据工作需要选择案例（专题，5周）
3. 应用到实际项目（2周）

---

## 📊 教材特色

### 1. 理论严谨
- 从守恒定律出发推导控制方程
- 详细的数学推导过程
- 物理意义清晰

### 2. 案例丰富
- 30个真实工程案例
- 涵盖河流、湖库、地下水、流域
- 从简单到复杂循序渐进

### 3. 代码完整
- 每个案例提供完整Python代码
- 详细注释
- 可直接运行和修改

### 4. 方法先进
- 介绍最新数值方法
- 对比不同方法的优缺点
- 提供性能基准测试

### 5. 工程导向
- 参数率定方法
- 模型验证技术
- 治理方案评估

---

## 🌟 与前四本书的关系

| 书籍 | 主题 | 本书如何应用 |
|------|------|-------------|
| 第1本：水系统控制论 | 系统建模 | 参数辨识、动力学建模 |
| 第2本：明渠水力学 | 水力计算 | 水流方程、数值方法 |
| 第3本：渠道管道控制 | 数值算法 | 求解技术、优化算法 |
| 第4本：智能水网设计 | 系统集成 | 综合平台开发 |
| **第5本（本书）** | **水环境模拟** | **水质-水量-生态耦合** |

---

## 📦 项目结构（规划）

```
water-environment-simulation/
├── README.md                           # 本文件
├── START_HERE.md                       # 快速入门
├── requirements.txt                    # 依赖包
│
├── code/                               # 代码
│   ├── models/                         # 核心模型
│   │   ├── advection_diffusion.py      # 对流-扩散模型
│   │   ├── reaction_kinetics.py        # 反应动力学
│   │   ├── river_quality.py            # 河流水质模型
│   │   ├── lake_quality.py             # 湖库水质模型
│   │   ├── groundwater_transport.py    # 地下水溶质运移
│   │   ├── eutrophication.py           # 富营养化模型
│   │   └── ecological.py               # 生态模型
│   │
│   ├── solvers/                        # 求解器
│   │   ├── fdm_solvers.py              # 有限差分求解器
│   │   ├── fvm_solvers.py              # 有限体积求解器
│   │   ├── fem_solvers.py              # 有限元求解器
│   │   └── particle_tracking.py        # 粒子追踪
│   │
│   ├── calibration/                    # 参数率定
│   │   ├── least_squares.py            # 最小二乘法
│   │   ├── bayesian.py                 # 贝叶斯方法
│   │   └── sensitivity_analysis.py     # 敏感性分析
│   │
│   ├── utils/                          # 工具函数
│   │   ├── numerical.py                # 数值方法工具
│   │   ├── plotting.py                 # 绘图工具
│   │   ├── data_io.py                  # 数据输入输出
│   │   └── validation.py               # 验证工具
│   │
│   └── examples/                       # 30个案例
│       ├── case_01_diffusion/          # 案例1
│       ├── case_02_advection_diffusion/# 案例2
│       ├── ...
│       └── case_30_comprehensive/      # 案例30
│
├── docs/                               # 文档
│   └── zh/                             # 中文文档
│       ├── 01_基础理论.md
│       ├── 02_数值方法.md
│       ├── 03_参数率定.md
│       ├── 04_模型验证.md
│       └── 05_工程应用指南.md
│
├── tests/                              # 测试
│   ├── test_models/                    # 模型测试
│   ├── test_solvers/                   # 求解器测试
│   └── test_cases/                     # 案例测试
│
└── data/                               # 数据
    ├── validation_data/                # 验证数据
    │   ├── analytical_solutions/       # 解析解
    │   └── experimental_data/          # 实验数据
    └── case_data/                      # 案例数据
```

---

## 🚀 开发计划

### 第一阶段：基础建设（8周）
- ✅ 完成教材提纲设计
- ⏳ 搭建代码框架
- ⏳ 实现基础模型（案例1-3）
- ⏳ 编写基础理论文档

### 第二阶段：核心案例（16周）
- ⏳ 实现案例4-12（河流水质）
- ⏳ 实现案例13-18（湖库水质）
- ⏳ 编写教材第2-3部分

### 第三阶段：高级案例（12周）
- ⏳ 实现案例19-22（地下水）
- ⏳ 实现案例23-28（流域和生态）
- ⏳ 编写教材第4部分

### 第四阶段：综合案例（8周）
- ⏳ 实现案例29-30（综合治理）
- ⏳ 整体优化和重构
- ⏳ 完善文档和测试

### 第五阶段：发布推广（4周）
- ⏳ 制作教学视频
- ⏳ 编写使用手册
- ⏳ 发布v1.0版本

**总开发周期**：约48周（12个月）

---

## 📚 参考资料

### 主要教材
1. 《环境水力学》- 槐文信
2. 《水质模型》- 李圭白
3. 《水环境数学模型》- 王超、王沛芳
4. 《河流水质模拟》- 左其亭

### 国际教材
1. **Water Quality Modeling** - Chapra
2. **Environmental Transport Processes** - Schnoor
3. **Eutrophication and Oligotrophication in Lake Ecosystems** - Vollenweider
4. **Groundwater Contaminant Transport** - Zheng & Bennett

### 软件手册
1. **QUAL2K** - 河流水质模型
2. **CE-QUAL-W2** - 水库水质模型
3. **WASP** - 综合水质模型
4. **MODFLOW/MT3D** - 地下水模型
5. **SWAT** - 流域水文水质模型

### 标准规范
1. GB 3838-2002 《地表水环境质量标准》
2. GB/T 14581-2020 《水质湖泊和水库采样技术指导》
3. HJ 2.3-2018 《环境影响评价技术导则 地表水环境》
4. 《水环境容量计算规程》

---

## 📈 预期成果

完成本教材后，将实现：

### 技术成果
✅ 30个完整的水环境模拟案例  
✅ 10,000+ 行高质量Python代码  
✅ 500+ 单元测试，覆盖率>90%  
✅ 完整的教材文档（80万字）

### 教学成果
✅ 可用于本科/研究生教学  
✅ 填补国内案例驱动水环境模拟教材空白  
✅ 提供配套在线课程（MOOC）  
✅ 培养实践型环境工程人才

### 学术成果
✅ 发表教学论文2-3篇  
✅ 申请软件著作权  
✅ 开源贡献，获得社区认可  
✅ 正式出版教材

### 社会效益
✅ 推动水环境保护技术进步  
✅ 为环境治理工程提供技术支持  
✅ 培养高水平环境工程师  
✅ 促进产学研结合

---

## 📊 案例统计

### 按水体类型
- 河流：6个（20%）
- 湖库：6个（20%）
- 地下水：4个（13%）
- 流域：3个（10%）
- 综合：11个（37%）

### 按难度分布
- ★☆☆☆☆（入门）：3个（10%）
- ★★☆☆☆（初级）：4个（13%）
- ★★★☆☆（中级）：9个（30%）
- ★★★★☆（高级）：10个（33%）
- ★★★★★☆（专家）：4个（14%）

### 按知识模块
- 基础理论：6个
- 河流模拟：6个
- 湖库模拟：6个
- 地下水模拟：4个
- 流域尺度：3个
- 生态耦合：3个
- 综合治理：2个

---

## 💡 创新点

### 1. 案例驱动教学
- 不同于传统教材的"理论-例题"模式
- 每个案例对应真实工程问题
- 注重实践能力培养

### 2. 代码完整可运行
- 提供生产级Python代码
- 详细注释和文档
- 100%测试覆盖

### 3. 渐进式学习体系
- 从单一过程到耦合系统
- 从0D到3D
- 从理想条件到真实工程

### 4. 多学科交叉
- 水力学 + 水化学 + 生态学
- 数学建模 + 数值计算 + 编程
- 理论 + 实验 + 工程

### 5. 开源共享
- GitHub公开代码
- 鼓励社区贡献
- 促进教育资源共享

---

## 🎯 质量保证

### 代码质量
- **编码规范**：遵循PEP 8
- **代码审查**：每个案例提交前审查
- **单元测试**：覆盖率>90%
- **性能测试**：关键算法性能基准
- **文档字符串**：完整的API文档

### 理论质量
- **方程推导**：从基本定律出发
- **物理意义**：每个项的物理解释
- **参数范围**：典型值和变化范围
- **适用条件**：模型假设和限制

### 工程质量
- **参数率定**：提供标准方法
- **模型验证**：对比实测数据
- **误差分析**：量化预测不确定性
- **工程案例**：真实项目验证

---

## 👥 目标用户

### 学生
- 环境工程本科生（主要）
- 水利工程本科生
- 市政工程本科生
- 相关专业研究生

### 教师
- 环境工程教师
- 水处理教师
- 教材开发者

### 工程师
- 环境咨询工程师
- 水环境设计人员
- 环评工作者
- 环境监测人员

### 研究人员
- 水环境研究者
- 生态模拟研究者
- 水质模型开发者

---

## 📞 联系方式

- **项目主页**：（待建立）
- **GitHub**：（待建立）
- **Issues**：GitHub Issues
- **邮箱**：chs-books@example.com

---

**最后更新**: 2025-11-02  
**版本**: v1.0-outline  
**状态**: ✅ 提纲完成，待审批  
**下一步**: 开始第一阶段开发（案例1-3）

---

## 附录：30个案例速查表

| 编号 | 案例名称 | 难度 | 学时 | 主要技术 | 依赖 |
|------|---------|------|------|---------|------|
| 1 | 污染物静水扩散 | ★☆☆☆☆ | 4 | Fick定律、显式差分 | - |
| 2 | 渠道对流-扩散 | ★★☆☆☆ | 6 | 对流-扩散方程、数值格式 | 第2本 |
| 3 | 河流降解反应 | ★★☆☆☆ | 6 | 反应动力学、参数率定 | 第1本 |
| 4 | S-P溶解氧模型 | ★★★☆☆ | 8 | DO平衡、氧垂曲线 | - |
| 5 | 营养盐循环 | ★★★☆☆ | 8 | 氮磷循环、多组分 | - |
| 6 | 自净能力评估 | ★★★☆☆ | 8 | 环境容量、总量控制 | - |
| 7 | 河流点源污染 | ★★★☆☆ | 8 | 1D水质模型、边界条件 | 第2本 |
| 8 | 河流非点源污染 | ★★★★☆ | 10 | 降雨径流、面源负荷 | - |
| 9 | 突发污染事故 | ★★★★☆ | 10 | 实时模拟、应急响应 | - |
| 10 | 横向混合 | ★★★★☆ | 12 | 2D模型、横向扩散 | 第2本 |
| 11 | 弯道水质 | ★★★★☆ | 12 | 二次流、曲线坐标 | - |
| 12 | 河口盐水入侵 | ★★★★★☆ | 14 | 密度流、潮汐 | 第2本 |
| 13 | 完全混合模型 | ★★☆☆☆ | 6 | 0D模型、质量平衡 | - |
| 14 | Vollenweider模型 | ★★★☆☆ | 8 | 磷平衡、临界负荷 | - |
| 15 | 温度分层 | ★★★★☆ | 12 | 1D垂向、热分层 | - |
| 16 | 异重流 | ★★★★★☆ | 14 | 2D密度流、泥沙 | - |
| 17 | 藻类生长 | ★★★★☆ | 12 | Monod动力学、限制因子 | - |
| 18 | 3D富营养化 | ★★★★★☆ | 16 | 3D水动力-生态耦合 | - |
| 19 | 地下水柱实验 | ★★☆☆☆ | 6 | 1D运移、吸附 | - |
| 20 | 污染羽迁移 | ★★★★☆ | 12 | 2D地下水流-溶质运移 | - |
| 21 | 多层含水层 | ★★★★☆ | 12 | 垂向迁移、越流 | - |
| 22 | 抽出-处理修复 | ★★★★☆ | 12 | 修复优化、费用分析 | 第2本优化 |
| 23 | 流域水文-水质 | ★★★★★☆ | 16 | SWAT、分布式模型 | - |
| 24 | 河湖水系连通 | ★★★★☆ | 12 | 河网模型、闸门调度 | 第3本 |
| 25 | 跨流域调水 | ★★★★★☆ | 14 | 长距离输水、风险评估 | - |
| 26 | 河流生态系统 | ★★★★☆ | 12 | 食物链、生态健康 | - |
| 27 | 湖泊稳态转换 | ★★★★★☆ | 14 | 多稳态、临界点 | - |
| 28 | 湿地净化 | ★★★★☆ | 12 | 湿地水文、净化机理 | - |
| 29 | 黑臭水体治理 | ★★★★★☆ | 16 | 综合治理、方案评估 | - |
| 30 | 流域综合管理 | ★★★★★☆ | 20 | 多模型集成、决策支持 | 全部 |

---

**本提纲设计完毕，等待审批！** 🎉
