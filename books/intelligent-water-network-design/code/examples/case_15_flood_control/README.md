# 案例15：流域防洪调度设计

**难度等级**：⭐⭐⭐⭐⭐⭐⭐ 高级+（Level 3）  
**学习时间**：34学时（12学时建模 + 16学时控制 + 6学时测试）  
**智能化等级**：L3-L4（协调控制到优化调度）  
**工程类型**：流域防洪调度系统

---

## 📖 工程背景

### 项目概况

某流域防洪调度工程：
- **流域面积**：5000 km²
- **水库数**：5座（梯级布局，总库容100亿m³）
- **河道**：干流150km + 支流3条
- **保护对象**：3座城市（人口300万）
- **调度目标**：防洪+发电+供水

### Level 3特点：流域尺度

| 对比项 | Level 2（案例11） | Level 3（案例15） | 升级 |
|-------|-----------------|------------------|------|
| **尺度** | 市区（10km²） | 流域（5000km²） | ×500 |
| **水库** | 0 | 5座（梯级） | ⬆️⬆️⬆️ |
| **目标** | 水位协调 | 防洪+发电+供水 | ⬆️⬆️⬆️ |
| **预报** | 无 | 洪水预报（24h） | ⬆️⬆️⬆️ |
| **智能化** | L3 | L3-L4 | ⬆️ |

### 现状问题

传统防洪调度（人工）：
- ❌ **响应慢**：洪水预报→人工决策，延迟12h
- ❌ **调度保守**：过度放水，浪费防洪库容
- ❌ **效益差**：防洪vs发电矛盾，经济损失大
- ❌ **风险高**：下游超标准洪水，威胁城市

### 改造目标

- ✅ 梯级水库群联合防洪调度（5库协调）
- ✅ 洪水预报驱动（24h预见期）
- ✅ 防洪安全（下游防洪标准100年）
- ✅ 经济优化（发电效益最大化）
- ✅ 智能化等级L3-L4

---

## 📐 设计依据（中国标准）

### 主要标准

1. **GB 50201-2014** 《防洪标准》⭐⭐⭐
2. **SL 706-2015** 《水库调度设计规范》⭐⭐⭐
3. **GB/T 22482-2008** 《洪水预报规范》⭐⭐

---

## 🔧 复用案例11+14

### 高度复用（70%）

```python
# ✅ 复用案例11（河湖水系）
from case_11_urban_river_network import RiverNetworkCoordinator

# ✅ 复用案例14（水库群）
from case_14_regional_irrigation import ReservoirGroupOptimizer

# 扩展：5水库梯级防洪+洪水预报
```

**复用率**：70%（案例11 30% + 案例14 40%）

### 本案例创新

```python
# 1. 洪水预报驱动调度（新增）⭐⭐⭐⭐
class FloodForecastDrivenDispatch:
    """
    洪水预报驱动调度器（本案例最大创新）
    
    功能：
    - 24h洪水预报
    - 预泄调度（提前腾库）
    - 风险评估
    
    创新：预报→预泄，防洪效益提升30%
    """
    pass

# 2. 梯级水库防洪优化（新增）⭐⭐⭐
class CascadeFloodControlOptimizer:
    """
    梯级水库防洪优化
    
    功能：
    - 5水库联合调度
    - 削峰错峰
    - 防洪+发电协调
    
    优化目标：
    min 下游洪峰流量
    max 发电效益
    """
    pass
```

---

## 📋 设计任务

### 第一部分：流域防洪系统建模

#### 1.1 系统拓扑

```
水库层（5座梯级）
├─ 水库1：上游（库容30亿m³，坝高120m）
├─ 水库2：中上游（25亿m³，坝高100m）
├─ 水库3：中游（20亿m³，坝高95m）
├─ 水库4：中下游（15亿m³，坝高85m）
└─ 水库5：下游（10亿m³，坝高70m）
    │
    ▼ 河道演进（150km）
保护对象（3座城市）
├─ 城市A：100万人（100年一遇）
├─ 城市B：120万人（100年一遇）
└─ 城市C：80万人（50年一遇）
```

#### 1.2 水库参数

| 水库 | 库容 [亿m³] | 防洪库容 [亿m³] | 汛限水位 [m] | 设计洪水 |
|------|-----------|---------------|------------|---------|
| 水库1 | 30 | 10 | 115 | 20000 m³/s |
| 水库2 | 25 | 8 | 95 | 18000 m³/s |
| 水库3 | 20 | 6 | 90 | 15000 m³/s |
| 水库4 | 15 | 5 | 80 | 12000 m³/s |
| 水库5 | 10 | 3 | 65 | 10000 m³/s |

---

### 第二部分：流域防洪调度控制设计（L3-L4核心）

#### 2.1 洪水预报驱动调度

```python
class FloodControlCoordinator:
    """
    流域防洪协调控制器（L3-L4）
    
    功能：
    1. 洪水预报驱动调度 ⭐⭐⭐⭐
    2. 梯级水库防洪优化 ⭐⭐⭐
    3. 削峰错峰
    4. 防洪+发电协调
    
    优化目标：
    - 保证下游防洪安全（流量<8000m³/s）
    - 最大化发电效益
    
    创新：预报→预泄，防洪效益提升30%
    """
    
    def __init__(self):
        # 洪水预报器
        self.flood_forecast = FloodForecast()
        
        # 梯级防洪优化器
        self.cascade_optimizer = CascadeFloodControlOptimizer()
        
        # 5个水库控制器
        self.reservoir_controllers = [...]
    
    def update(self, reservoir_levels: list, inflows: list, forecast_period: float):
        """
        流域防洪调度
        
        Parameters:
        -----------
        reservoir_levels : list
            5个水库水位 [m]
        inflows : list
            5个水库入流 [m³/s]
        forecast_period : float
            预报时长 [h]
        
        Returns:
        --------
        outflows : list
            5个水库出流 [m³/s]
        """
        # 1. 洪水预报（24h）
        forecasted_inflows = self.flood_forecast.predict(inflows, forecast_period)
        
        # 2. 梯级防洪优化
        optimal_outflows = self.cascade_optimizer.optimize(
            reservoir_levels, forecasted_inflows
        )
        
        return optimal_outflows
```

---

## 💡 关键设计参数

| 参数 | 水库1 | 水库2 | 水库3 | 水库4 | 水库5 |
|------|------|------|------|------|------|
| **库容 [亿m³]** | 30 | 25 | 20 | 15 | 10 |
| **防洪库容** | 10 | 8 | 6 | 5 | 3 |

---

## 💻 运行方式

```bash
cd code/examples/case_15_flood_control
python main.py
```

---

**案例15开发状态**: 🔄 开发中  
**预计完成时间**: 2小时  
**最后更新**: 2025-10-31
