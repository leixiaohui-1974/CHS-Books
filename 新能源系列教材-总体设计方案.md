# 新能源系列教材总体设计方案
## 基于案例驱动的新能源发电系统仿真、控制、辨识与测试

**编制日期**: 2025-11-04  
**版本**: v1.0-设计方案  
**适用对象**: 新能源科学与工程、电气工程、自动化专业本科生及研究生  
**教学方法**: 案例驱动学习 + Python实践  
**参考标准**: 参照CHS-Books系列教材体系

---

## 📋 设计理念

### 核心特色

1. **案例驱动**: 每个知识点通过实际工程案例学习
2. **仿真为先**: 从物理建模到数值仿真全流程
3. **控制为本**: 系统控制策略设计与优化
4. **辨识为基**: 数据驱动的参数辨识方法
5. **测试为证**: 标准测试与性能评估
6. **联合为终**: 多能源系统协调优化控制

### 与CHS-Books体系对应关系

```
CHS-Books水利系列 → 新能源系列

水系统控制论      → 新能源系统控制论
明渠水力学        → 光伏/风电系统建模
水环境模拟        → 综合能源系统仿真
生态水力学        → 新能源并网技术
```

---

## 📚 系列教材总体架构

### 五本书构成完整体系

```
                    新能源系列教材体系
                            │
        ┌───────────────┬───┴───┬───────────────┐
        ↓               ↓       ↓               ↓
    第1本           第2本    第3本           第4本          第5本
光伏发电系统      风力发电   储能系统      新能源系统    综合能源系统
建模与控制        建模控制   建模控制      辨识与测试    仿真与优化
 (26案例)        (26案例)  (24案例)      (28案例)      (30案例)
    │               │         │              │              │
    └───────────────┴─────────┴──────────────┴──────────────┘
                            │
                   第6本(扩展):水火风光储
                    联合仿真与控制(选修)
```

### 学习路径

#### 路径1: 本科生基础路径 (推荐)
```
第1本 → 第2本 → 第3本 → 第5本(基础部分)
周期: 2学期 (32周)
```

#### 路径2: 研究生深度路径
```
第1本 → 第2本 → 第3本 → 第4本 → 第5本(完整)
周期: 3学期 (48周)
```

#### 路径3: 工程师实践路径
```
根据实际需求选择: 第1/2/3本任选 + 第4本(测试) + 第5本(综合)
周期: 灵活安排
```

---

## 📖 第一本: 《光伏发电系统建模与控制》

**副标题**: 从单个光伏电池到大型光伏电站

### 定位与目标
- **适用对象**: 新能源、电气工程专业本科生/研究生
- **先修课程**: 电路原理、自动控制原理、电力电子技术
- **学时安排**: 96学时 (理论48 + 实验48)
- **案例数量**: 26个

### 教材结构

#### 第一部分: 光伏电池建模 (案例1-6, 6周)

**案例1: 光伏电池I-V特性建模** ⭐
- **工程背景**: 单晶硅光伏电池特性测试
- **核心模型**: 单二极管等效电路模型
- **学习目标**: 掌握光伏电池基本工程模型
- **关键方程**: 
  ```
  I = Iph - I0[exp((V+IRs)/(nVt)) - 1] - (V+IRs)/Rsh
  ```
- **实验内容**:
  1. I-V曲线仿真
  2. 温度影响分析 (25-75°C)
  3. 辐照度影响分析 (200-1000 W/m²)
  4. 参数敏感性分析

**案例2: 多二极管精确模型** ⭐⭐
- **工程背景**: 高精度光伏电池建模
- **核心模型**: 双二极管模型
- **学习目标**: 理解更精确的物理模型
- **对比分析**: 单二极管 vs 双二极管精度对比

**案例3: 光伏组件建模** ⭐⭐
- **工程背景**: 60片/72片电池组件串并联
- **核心内容**: 
  - 串联失配问题
  - 旁路二极管作用
  - 热斑效应仿真
- **实验**: 部分遮挡条件下的I-V特性

**案例4: 光伏阵列建模** ⭐⭐⭐
- **工程背景**: MW级光伏电站建模
- **核心内容**:
  - 串并联组合优化
  - 阵列配置设计
  - 汇流箱建模
- **设计任务**: 1MW光伏阵列配置方案

**案例5: 环境因素影响建模** ⭐⭐⭐
- **工程背景**: 沙漠/高原/沿海环境
- **核心内容**:
  - 温度模型 (NOCT)
  - 灰尘遮挡模型
  - 湿度影响
  - 风冷效应
- **实验**: 不同环境条件仿真

**案例6: 光伏老化与衰减建模** ⭐⭐⭐
- **工程背景**: 25年寿命期性能预测
- **核心内容**:
  - 线性衰减模型 (0.5%/年)
  - PID效应建模
  - LID效应建模
- **应用**: 全寿命周期发电量预测

---

#### 第二部分: MPPT控制技术 (案例7-12, 6周)

**案例7: 扰动观察法 (P&O)** ⭐⭐
- **工程背景**: 最基础的MPPT算法
- **核心算法**: 
  ```python
  if P(k) > P(k-1):
      if V(k) > V(k-1): V(k+1) = V(k) + ΔV
      else: V(k+1) = V(k) - ΔV
  ```
- **性能指标**: 跟踪效率、振荡幅度、响应速度
- **实验**: 不同步长ΔV的性能对比

**案例8: 增量电导法 (INC)** ⭐⭐⭐
- **工程背景**: 改进的MPPT算法
- **核心原理**: dP/dV = 0 在MPP点
- **对比**: P&O vs INC性能对比
- **快速变化条件测试**: 云层遮挡场景

**案例9: 恒电压法 (CV)** ⭐
- **工程背景**: 简化MPPT策略
- **核心思想**: Vmpp ≈ 0.76×Voc
- **适用场景**: 辐照度稳定环境
- **优缺点分析**

**案例10: 模糊逻辑MPPT** ⭐⭐⭐⭐
- **工程背景**: 智能MPPT算法
- **核心内容**:
  - 模糊规则设计
  - 隶属度函数优化
  - 模糊推理过程
- **性能提升**: 与传统算法对比

**案例11: 神经网络MPPT** ⭐⭐⭐⭐
- **工程背景**: AI驱动的MPPT
- **核心内容**:
  - BP神经网络训练
  - 输入: (G, T, V) → 输出: Vmpp
  - 在线学习
- **实验**: 复杂遮挡条件下的性能

**案例12: 多峰MPPT算法** ⭐⭐⭐⭐⭐
- **工程背景**: 部分遮挡条件
- **核心问题**: 全局最优 vs 局部最优
- **算法**:
  - 粒子群算法 (PSO)
  - 模拟退火算法 (SA)
  - 遗传算法 (GA)
- **对比实验**: 不同算法性能对比

---

#### 第三部分: 并网逆变器控制 (案例13-18, 6周)

**案例13: 单相PWM逆变器建模** ⭐⭐
- **工程背景**: 户用光伏系统 (3-5kW)
- **核心内容**:
  - H桥拓扑
  - SPWM调制
  - LC滤波器设计
- **仿真**: 输出电压/电流THD分析

**案例14: 三相PWM逆变器建模** ⭐⭐⭐
- **工程背景**: 工商业光伏 (50-500kW)
- **核心内容**:
  - 三相桥式拓扑
  - SVPWM调制
  - 输出LCL滤波
- **设计任务**: 100kW逆变器参数设计

**案例15: 电流环控制** ⭐⭐⭐
- **工程背景**: 并网电流精确控制
- **核心策略**:
  - PI控制器设计
  - dq坐标变换
  - 解耦控制
- **性能指标**: 电流THD < 5%

**案例16: 电压环控制** ⭐⭐⭐
- **工程背景**: 独立运行模式
- **核心策略**:
  - 双环控制 (电压外环 + 电流内环)
  - 参数整定
- **实验**: 负载突变响应

**案例17: 并网同步技术** ⭐⭐⭐⭐
- **工程背景**: 光伏并网接入
- **核心技术**:
  - 锁相环 (PLL) 设计
  - 软并网策略
  - 反孤岛保护
- **标准**: IEEE 1547、GB/T 19939

**案例18: 低电压穿越 (LVRT)** ⭐⭐⭐⭐⭐
- **工程背景**: 电网故障支撑
- **核心要求**: 
  - 电压跌落不脱网
  - 无功支撑能力
- **控制策略**:
  - Crowbar电路
  - 无功注入控制
- **测试**: 电压跌至20%的响应

---

#### 第四部分: 直流侧控制 (案例19-22, 4周)

**案例19: DC/DC变换器建模** ⭐⭐
- **拓扑**: Boost/Buck/Buck-Boost
- **建模**: 状态空间平均模型
- **实验**: 不同拓扑对比

**案例20: 直流母线电压控制** ⭐⭐⭐
- **工程背景**: 稳定直流电压
- **控制策略**: PI控制 + 前馈补偿
- **性能**: 电压波动 < 5%

**案例21: 功率解耦控制** ⭐⭐⭐⭐
- **工程背景**: 单相系统二倍频脉动
- **核心问题**: P(t) = P0 + P2cos(2ωt)
- **解决方案**: 
  - 有源功率解耦
  - 储能电容优化

**案例22: 直流微网母线电压控制** ⭐⭐⭐⭐
- **工程背景**: 多光伏单元并联
- **控制策略**:
  - 下垂控制 (Droop Control)
  - 主从控制
  - 对等控制
- **仿真**: 功率均衡效果

---

#### 第五部分: 系统级控制 (案例23-26, 4周)

**案例23: 有功/无功协调控制** ⭐⭐⭐⭐
- **工程背景**: MW级光伏电站
- **控制目标**:
  - 有功功率控制 (AGC)
  - 无功功率控制 (AVC)
  - 功率因数调节
- **实验**: 电网调度指令响应

**案例24: 光储联合控制** ⭐⭐⭐⭐⭐
- **工程背景**: 光伏 + 储能系统
- **核心内容**:
  - 削峰填谷策略
  - 平滑出力波动
  - 能量管理系统 (EMS)
- **优化**: 储能容量配置优化

**案例25: 多光伏电站协调控制** ⭐⭐⭐⭐⭐
- **工程背景**: 区域多个光伏电站
- **协调目标**:
  - 区域总功率控制
  - 站间功率分配
  - 无功优化配置
- **算法**: 分布式优化算法

**案例26: 虚拟同步发电机 (VSG)** ⭐⭐⭐⭐⭐
- **工程背景**: 新一代并网技术
- **核心思想**: 逆变器模拟同步机特性
- **关键参数**:
  - 虚拟惯量 J
  - 虚拟阻尼 D
  - 电压-无功下垂
- **仿真**: VSG vs 传统控制对比

---

### 核心技术栈

#### 数学建模
- 微分方程组 (状态空间)
- 传递函数
- 离散化方法
- 小信号模型

#### 数值方法
- 常微分方程求解 (odeint)
- 电力电子仿真 (PLECS/Simulink Python接口)
- 快速傅里叶变换 (FFT) - THD计算
- 优化算法 (scipy.optimize)

#### 控制算法
- PID控制及整定
- 状态反馈控制
- 模糊控制
- 神经网络控制
- 模型预测控制 (MPC)

#### Python库
```python
# 核心库
numpy, scipy, matplotlib
control  # 控制系统工具箱
pandas  # 数据处理

# 优化库
scipy.optimize
cvxpy  # 凸优化

# 机器学习
scikit-learn
tensorflow/pytorch (可选)

# 可视化
matplotlib, seaborn
plotly (交互式)
```

### 配套资源

#### 标准数据集
- 典型日辐照度曲线 (晴天/多云/阴雨)
- 商业光伏组件参数库 (隆基/晶科/天合等)
- 实测电网故障波形

#### 仿真工具
- Python纯代码实现 (主要)
- PLECS/PSCAD接口 (可选)
- 硬件在环平台对接 (高级)

#### 测试案例库
- IEC 61853 测试标准
- IEEE 1547 并网标准
- GB/T 19964 光伏发电站接入标准

---

### 学习成果

完成本书后,学生能够:

1. **建模能力**
   - 建立光伏电池/组件/阵列完整模型
   - 掌握电力电子变换器建模方法
   - 理解并网系统动态特性

2. **控制能力**
   - 设计并实现MPPT算法
   - 设计并网逆变器控制系统
   - 掌握多层级协调控制策略

3. **仿真能力**
   - 独立完成系统级仿真
   - 分析系统动态响应
   - 优化控制参数

4. **工程能力**
   - 光伏系统方案设计
   - 性能测试与评估
   - 故障诊断与处理

---

### 教学建议

#### 课程安排
- **理论课** (48学时): 讲授核心原理和算法
- **实验课** (48学时): 
  - 仿真实验 (32学时)
  - 硬件实验 (16学时, 可选)

#### 考核方式
- 平时作业: 20% (每个案例的仿真作业)
- 实验报告: 30% (8个重点案例)
- 课程设计: 30% (综合项目)
- 期末考试: 20% (理论+计算)

#### 课程设计题目示例
1. **5kW户用光伏系统设计**
   - 完整系统设计
   - 仿真验证
   - 经济性分析

2. **100kW工商业光伏并网控制器设计**
   - 逆变器拓扑选择
   - 控制器设计与仿真
   - 并网测试

3. **光储微电网能量管理系统**
   - EMS算法设计
   - 多工况仿真
   - 优化配置

---

## 📖 第二本: 《风力发电系统建模与控制》

**副标题**: 从风资源评估到智能风电场控制

### 定位与目标
- **适用对象**: 新能源、电气工程专业本科生/研究生
- **先修课程**: 第一本书 (可选)、电机学、自动控制原理
- **学时安排**: 96学时
- **案例数量**: 26个

### 教材结构 (简要)

#### 第一部分: 风资源与风力机气动学 (案例1-5)
- 案例1: 风速统计分析 (Weibull分布)
- 案例2: 风切变与湍流模型
- 案例3: 风力机叶片气动力计算 (BEM理论)
- 案例4: 风轮功率特性 (Cp-λ曲线)
- 案例5: 尾流效应与阵列损失

#### 第二部分: 风力发电机建模 (案例6-10)
- 案例6: 双馈感应发电机 (DFIG) 建模
- 案例7: 永磁同步发电机 (PMSG) 建模
- 案例8: 发电机并网动态特性
- 案例9: 传动系统建模 (两质量模型)
- 案例10: 塔架振动建模

#### 第三部分: 最大功率跟踪控制 (案例11-15)
- 案例11: 最优叶尖速比法 (TSR)
- 案例12: 功率信号反馈法 (PSF)
- 案例13: 爬山搜索法
- 案例14: 变桨距控制 (额定风速以上)
- 案例15: 转速-功率联合控制

#### 第四部分: 变流器控制技术 (案例16-20)
- 案例16: DFIG转子侧变流器控制
- 案例17: DFIG网侧变流器控制
- 案例18: 全功率变流器控制 (PMSG)
- 案例19: 低电压穿越 (LVRT) 技术
- 案例20: 次同步振荡抑制

#### 第五部分: 风电场协调控制 (案例21-26)
- 案例21: 风电场有功功率控制
- 案例22: 风电场无功电压控制
- 案例23: 机组间负荷分配
- 案例24: 风储联合调度
- 案例25: 尾流优化控制
- 案例26: 虚拟惯量控制

---

## 📖 第三本: 《储能系统建模与控制》

**副标题**: 电化学储能、物理储能与混合储能系统

### 定位与目标
- **适用对象**: 新能源、电气工程、化学工程专业本研究生
- **先修课程**: 电化学基础 (推荐)
- **学时安排**: 88学时
- **案例数量**: 24个

### 教材结构 (简要)

#### 第一部分: 电化学储能建模 (案例1-8)
- 案例1: 锂离子电池等效电路模型 (Thevenin)
- 案例2: 电池SOC估算 (安时积分法/卡尔曼滤波)
- 案例3: 电池SOH估算
- 案例4: 电池热管理建模
- 案例5: 电池组均衡控制
- 案例6: 铅酸电池建模
- 案例7: 液流电池建模
- 案例8: 超级电容建模

#### 第二部分: 储能变流器控制 (案例9-14)
- 案例9: 双向DC/DC变换器
- 案例10: 储能PCS控制 (PQ/VF模式)
- 案例11: 充放电策略优化
- 案例12: 并网/离网无缝切换
- 案例13: 黑启动控制
- 案例14: 虚拟同步发电机 (VSG) 控制

#### 第三部分: 储能系统应用 (案例15-20)
- 案例15: 削峰填谷应用
- 案例16: 平滑新能源出力
- 案例17: 调频辅助服务
- 案例18: 微网储能优化配置
- 案例19: 电动汽车V2G
- 案例20: 飞轮储能建模与控制

#### 第四部分: 混合储能系统 (案例21-24)
- 案例21: 锂电池 + 超级电容混合储能
- 案例22: 功率型/能量型分层控制
- 案例23: 氢储能系统 (电解槽 + 燃料电池)
- 案例24: 压缩空气储能建模

---

## 📖 第四本: 《新能源发电系统辨识与测试》

**副标题**: 数据驱动的建模、测试标准与故障诊断

### 定位与目标
- **适用对象**: 新能源专业研究生/工程师
- **特点**: 强调**数据驱动**和**实验验证**
- **学时安排**: 104学时 (理论40 + 实验64)
- **案例数量**: 28个

### 教材结构 (简要)

#### 第一部分: 系统辨识基础 (案例1-6)
- 案例1: 最小二乘参数辨识
- 案例2: 递推最小二乘 (RLS)
- 案例3: 卡尔曼滤波器
- 案例4: 扩展卡尔曼滤波 (EKF) - 非线性系统
- 案例5: 粒子滤波
- 案例6: 模型结构选择 (AIC/BIC)

#### 第二部分: 光伏系统辨识 (案例7-11)
- 案例7: I-V曲线参数辨识
- 案例8: MPPT算法在线辨识
- 案例9: 逆变器参数辨识
- 案例10: 光伏阵列故障检测
- 案例11: 基于机器学习的功率预测

#### 第三部分: 风电系统辨识 (案例12-16)
- 案例12: 风速序列建模 (ARMA/ARIMA)
- 案例13: 风轮气动特性辨识
- 案例14: 传动系统参数辨识
- 案例15: 风电机组整机辨识
- 案例16: 风功率预测 (神经网络/随机森林)

#### 第四部分: 储能系统辨识 (案例17-20)
- 案例17: 电池模型参数辨识 (脉冲测试)
- 案例18: SOC-OCV关系辨识
- 案例19: 电池老化参数辨识
- 案例20: 等效电路模型在线更新

#### 第五部分: 标准测试与评估 (案例21-28)
- 案例21: 光伏组件I-V测试 (IEC 61853)
- 案例22: 光伏逆变器效率测试 (CEC效率)
- 案例23: 风力发电机功率曲线测试 (IEC 61400-12)
- 案例24: 低电压穿越测试
- 案例25: 谐波与闪变测试
- 案例26: 储能系统循环寿命测试
- 案例27: 微网黑启动测试
- 案例28: 故障诊断案例 (基于振动/电流信号)

---

## 📖 第五本: 《综合能源系统仿真与优化》

**副标题**: 水火风光储多能互补与协调控制 (重点)

### 定位与目标
- **适用对象**: 新能源/电气专业研究生/高年级本科生
- **特点**: **综合性最强**,整合前四本内容
- **学时安排**: 112学时
- **案例数量**: 30个
- **核心**: 多能源协调优化控制

### 教材结构

#### 第一部分: 多能源系统建模 (案例1-6, 6周)

**案例1: 光伏电站建模** ⭐⭐
- 复用第一本书内容
- 重点: 大规模电站模型
- 输出: P-t曲线, 日发电量

**案例2: 风电场建模** ⭐⭐
- 复用第二本书内容
- 重点: 尾流效应, 风电预测
- 输出: P-t曲线, 不确定性

**案例3: 水电站建模** ⭐⭐⭐
- **新增内容**: 水力发电系统
- **核心方程**:
  ```
  P = ηρgQH
  ```
  - η: 效率
  - Q: 流量 (m³/s)
  - H: 水头 (m)
- **水库动态**:
  ```
  dV/dt = Qin - Qout
  H = f(V)  # 库容曲线
  ```
- **约束条件**:
  - 水库水位上下限
  - 最小生态流量
  - 发电流量上下限
  - 出力爬坡速率

**案例4: 火电机组建模** ⭐⭐⭐
- **新增内容**: 燃煤/燃气发电
- **核心特性**:
  - 最小开机时间/关机时间
  - 最小稳燃出力
  - 爬坡速率限制 (±3-5%Pe/min)
  - 启停成本
- **燃料消耗曲线**:
  ```
  F(P) = a + bP + cP²  (kg/h)
  ```
- **排放模型**: CO₂, NOx, SO₂

**案例5: 储能系统建模** ⭐⭐
- 复用第三本书内容
- 重点: 大容量储能电站
- SOC约束, 充放电功率约束

**案例6: 负荷建模** ⭐⭐
- **负荷类型**:
  - 刚性负荷
  - 可调节负荷
  - 可中断负荷
- **负荷预测**: 时间序列模型

---

#### 第二部分: 互补特性分析 (案例7-10, 4周)

**案例7: 风光互补特性分析** ⭐⭐⭐
- **工程背景**: 某地区风光资源互补性
- **分析内容**:
  - 日内互补 (白天光伏, 夜间风电)
  - 季节互补 (冬季风大, 夏季光强)
  - 相关系数分析
- **指标**:
  - 互补系数
  - 联合出力平滑度
  - 弃风弃光率

**案例8: 水风光互补特性** ⭐⭐⭐⭐
- **工程背景**: 西南地区水风光互补
- **核心思想**: 水电调节风光随机性
- **互补模式**:
  - 短期: 小时级调节
  - 中期: 日前调度
  - 长期: 季节性调节
- **分析**: 
  - 出力波动降低程度
  - 水电调节容量需求

**案例9: 火电调峰特性分析** ⭐⭐⭐
- **背景**: 火电为新能源提供备用
- **分析**:
  - 调峰深度 (最低负荷率)
  - 调峰成本
  - 频繁启停对寿命影响

**案例10: 储能平抑波动效果分析** ⭐⭐⭐
- **背景**: 储能配置优化
- **量化指标**:
  - 波动平抑度
  - 储能利用率
  - 经济性分析

---

#### 第三部分: 短期优化调度 (案例11-16, 6周)

**案例11: 日前调度优化 - 单一目标** ⭐⭐⭐
- **问题描述**: 
  - 时间尺度: 24小时, 15min/步
  - 决策变量: 各机组出力Pg(t)
  - 目标函数: min 总成本
    ```
    min Σ [C_coal + C_start + C_emission]
    ```
- **约束**:
  - 功率平衡: ΣPg = Pload - Ppv - Pwind
  - 机组出力上下限
  - 爬坡约束
  - 水库水量平衡
  - 储能SOC约束
- **求解方法**: 混合整数线性规划 (MILP)

**案例12: 日前调度优化 - 多目标** ⭐⭐⭐⭐
- **多目标**:
  1. 最小化成本
  2. 最小化碳排放
  3. 最大化新能源消纳
  4. 最小化负荷缺额
- **求解**: 
  - ε-约束法
  - 权重法
  - NSGA-II多目标遗传算法
- **结果**: Pareto前沿

**案例13: 日内滚动调度** ⭐⭐⭐⭐
- **背景**: 应对预测偏差
- **策略**:
  - 每4小时滚动优化一次
  - 预测时域24h, 执行时域4h
  - 模型预测控制 (MPC) 思想
- **关键**: 
  - 风光功率超短期预测
  - 负荷预测滚动更新

**案例14: 实时调度 (AGC)** ⭐⭐⭐⭐
- **背景**: 秒级/分钟级平衡
- **控制目标**: 频率偏差Δf, 联络线功率偏差ΔPtie
- **控制方法**:
  - 经典AGC (积分控制)
  - 自适应AGC
  - 考虑储能快速响应
- **仿真**: 负荷突变 + 风光波动

**案例15: 考虑不确定性的随机优化** ⭐⭐⭐⭐⭐
- **背景**: 风光预测误差
- **建模方法**:
  - 场景生成 (蒙特卡洛)
  - 场景削减
  - 鲁棒优化 / 随机规划
- **目标**: 期望成本最小
  ```
  min E[Cost] = Σ πs × Cost(s)
  ```
  - s: 场景, πs: 概率
- **对比**: 确定性 vs 随机优化

**案例16: 储能参与的多时间尺度协调** ⭐⭐⭐⭐⭐
- **背景**: 储能在不同时间尺度的作用
- **时间尺度**:
  - 日前: 削峰填谷
  - 日内: 跟踪调度计划
  - 实时: 一次调频
- **协调策略**: 分层递阶控制
- **SOC管理**: 避免过充过放

---

#### 第四部分: 中长期优化 (案例17-20, 4周)

**案例17: 周调度优化** ⭐⭐⭐
- **背景**: 考虑周内负荷变化
- **关键**: 水电跨日优化 (周末蓄水, 工作日发电)

**案例18: 月度调度优化** ⭐⭐⭐⭐
- **背景**: 季节性来水
- **核心**: 水库月初/月末水位约束
- **考虑**: 
  - 梯级水电站联合调度
  - 防洪约束

**案例19: 年度调度优化** ⭐⭐⭐⭐
- **背景**: 跨季节调节
- **丰水期**: 多发水电, 减少火电
- **枯水期**: 增加火电, 保障供电
- **优化**: 年发电量最大, 成本最小

**案例20: 多年调节水库优化** ⭐⭐⭐⭐⭐
- **背景**: 丰水年/枯水年波动
- **时间尺度**: 2-5年
- **方法**: 动态规划 (DP), 随机动态规划

---

#### 第五部分: 电网支撑与辅助服务 (案例21-25, 5周)

**案例21: 一次调频** ⭐⭐⭐⭐
- **原理**: 频率下降 → 自动增加出力
  ```
  ΔP = K × Δf
  ```
- **参与机组**:
  - 火电: 调速器
  - 水电: 快速响应
  - 储能: 最快 (ms级)
  - 风电: 虚拟惯量控制
  - 光伏: 预留备用容量
- **仿真**: 
  - 大负荷突降
  - 大机组跳闸
  - 频率动态响应

**案例22: 二次调频 (AGC)** ⭐⭐⭐⭐
- **背景**: 恢复系统频率至50Hz
- **控制策略**: 
  - 区域控制偏差 (ACE)
    ```
    ACE = ΔPtie + β×Δf
    ```
  - CPS标准 (Control Performance Standard)
- **机组分配**: 
  - 按调节速率分配
  - 按报价分配 (市场化)

**案例23: 无功电压控制** ⭐⭐⭐⭐
- **背景**: 新能源接入导致电压波动
- **控制手段**:
  - 光伏逆变器: 无功调节 (Q)
  - 风电: 无功补偿
  - 储能: 四象限调节
  - STATCOM/SVC
- **目标**: 
  - 关键节点电压合格率 >95%
  - 无功就地平衡

**案例24: 黑启动** ⭐⭐⭐⭐⭐
- **背景**: 全站停电后的恢复
- **黑启动电源**:
  - 水电 (最佳)
  - 储能 (快速)
  - 光伏+储能微网
- **启动序列**:
  1. 启动黑启动电源
  2. 带本地负荷 (测试)
  3. 启动大机组 (火电)
  4. 逐步恢复系统
- **仿真**: 完整黑启动过程

**案例25: 惯量支撑** ⭐⭐⭐⭐⭐
- **背景**: 高比例新能源导致系统惯量下降
- **问题**: 
  - 传统同步机转动惯量 → 频率稳定
  - 新能源逆变器 → 无惯量
- **解决方案**:
  - 虚拟同步机 (VSG) 控制
  - 风机转子释放动能
  - 储能快速响应
- **评估**: 频率变化率 df/dt

---

#### 第六部分: 水火风光储联合仿真 (案例26-30, 5周) 🌟核心

**案例26: 多能源互补电力系统建模** ⭐⭐⭐⭐⭐
- **系统构成**:
  - 水电: 300MW (调节)
  - 火电: 600MW (基荷+调峰)
  - 风电: 200MW
  - 光伏: 150MW
  - 储能: 50MW/100MWh
- **建模层次**:
  - 机组级模型 (详细)
  - 电站级模型 (简化)
  - 系统级模型 (调度)
- **时间尺度**: 1年, 15min步长
- **数据**: 
  - 实测辐照度/风速数据
  - 负荷曲线
  - 来水过程

**案例27: 日前-日内-实时协调优化** ⭐⭐⭐⭐⭐
- **三层优化架构**:
  ```
  日前调度 (Day-ahead)
      ↓ 调度计划
  日内调度 (Intra-day, 4h滚动)
      ↓ 实时调整
  实时平衡 (Real-time, AGC)
  ```
- **关键技术**:
  - 日前: MILP求解 (CPLEX/Gurobi)
  - 日内: MPC
  - 实时: PI控制 + 前馈
- **仿真场景**:
  - 典型日 (夏季高峰)
  - 台风过境 (风电骤减)
  - 连阴天 (光伏低发)

**案例28: 多场景仿真与分析** ⭐⭐⭐⭐⭐
- **场景设计**:
  1. **基准场景**: 正常运行
  2. **高负荷场景**: 夏季高峰
  3. **低负荷场景**: 春节假期
  4. **新能源大发场景**: 丰水期+大风
  5. **新能源低发场景**: 枯水期+无风
  6. **极端场景**: 
     - 火电机组故障
     - 输电线路跳闸
     - 负荷预测偏差
- **评估指标**:
  - 新能源消纳率
  - 火电利用小时数
  - 系统总成本
  - 碳排放量
  - 频率/电压合格率
  - 负荷缺额

**案例29: 储能优化配置** ⭐⭐⭐⭐⭐
- **问题**: 确定储能最优容量和位置
- **决策变量**:
  - 储能功率 Ps (MW)
  - 储能容量 Es (MWh)
  - 安装位置
- **目标函数**:
  ```
  min [储能投资成本 + 年运行成本 - 收益]
  ```
- **收益来源**:
  - 峰谷价差套利
  - 辅助服务补偿
  - 减少弃风弃光
- **约束**:
  - 储能技术约束
  - 电网安全约束
- **方法**: 
  - 遗传算法 (GA)
  - 粒子群算法 (PSO)
  - 考虑储能全寿命周期成本

**案例30: 综合能源系统仿真平台** ⭐⭐⭐⭐⭐ (毕业设计级)
- **目标**: 开发完整的仿真决策平台
- **功能模块**:
  1. **数据管理**:
     - 历史数据导入
     - 数据预处理
     - 数据可视化
  
  2. **建模仿真**:
     - 各类电源模型库
     - 仿真引擎
     - 状态估计
  
  3. **优化调度**:
     - 多时间尺度优化
     - 算法库 (MILP/MPC/GA等)
     - 求解器接口
  
  4. **结果分析**:
     - 性能指标计算
     - 可视化报表
     - 场景对比
  
  5. **用户界面**:
     - Web界面 (Flask/Django)
     - 交互式操作
     - 报告生成

- **实现技术**:
  ```python
  # 后端
  Python + NumPy + SciPy
  PuLP / Pyomo (优化建模)
  CVXPY (凸优化)
  
  # 前端
  Flask / Streamlit
  Plotly / ECharts
  
  # 数据库
  SQLite / PostgreSQL
  
  # 并行计算
  Multiprocessing / Dask
  ```

- **交付物**:
  - 完整源代码
  - 用户手册
  - 开发文档
  - 演示视频
  - 技术报告 (50页+)

---

### 核心技术栈

#### 优化算法
- **线性规划 (LP)**: PuLP, scipy.optimize.linprog
- **混合整数线性规划 (MILP)**: PuLP, Pyomo + CPLEX/Gurobi
- **二次规划 (QP)**: CVXPY
- **非线性规划 (NLP)**: scipy.optimize.minimize
- **动态规划 (DP)**: 自定义实现
- **启发式算法**:
  - 遗传算法 (GA): DEAP库
  - 粒子群算法 (PSO)
  - 模拟退火 (SA)

#### 控制算法
- **PID控制**: 一次/二次调频
- **模型预测控制 (MPC)**: do-mpc库
- **鲁棒控制**: 考虑不确定性
- **分层递阶控制**: 多时间尺度协调

#### 预测算法
- **时间序列**: ARIMA, Prophet
- **机器学习**: 
  - 随机森林 (scikit-learn)
  - 支持向量机 (SVM)
  - 神经网络 (TensorFlow/PyTorch)
- **集合预测**: 组合多个模型

#### 数据处理
- **Pandas**: 数据清洗、处理
- **NumPy**: 数值计算
- **SciPy**: 科学计算
- **Statsmodels**: 统计分析

---

### 配套数据与案例

#### 真实数据集
1. **气象数据**:
   - 辐照度/风速 (某地区全年, 15min)
   - 温度、湿度、气压
   
2. **电力数据**:
   - 负荷曲线 (某地区全年, 15min)
   - 电价数据 (分时电价)
   
3. **水文数据**:
   - 来水流量 (某水电站, 日)
   - 库容曲线
   
4. **机组参数**:
   - 火电: 容量、效率、成本参数
   - 水电: 额定流量、水头
   - 风电/光伏: 功率曲线

#### 标杆案例
- **青海省** 光伏+风电+水电+储能
- **四川省** 水风光互补
- **内蒙古** 风电+火电
- **河北省** 光储电站

---

### 学习成果

完成本书后,学生能够:

1. **系统级建模能力**
   - 构建多能源协调的完整系统模型
   - 理解各类电源特性及互补机制
   - 掌握多时间尺度建模方法

2. **优化调度能力**
   - 熟练使用优化工具 (PuLP/Pyomo/CVXPY)
   - 设计多目标优化方案
   - 处理不确定性问题

3. **仿真分析能力**
   - 进行长时间序列仿真 (年度)
   - 多场景对比分析
   - 性能评估与决策支持

4. **综合工程能力**
   - 独立完成综合能源系统设计
   - 撰写高质量技术报告
   - 开发仿真软件原型

---

## 📊 五本书对比总览

| 书名 | 案例数 | 学时 | 难度 | 侧重点 | 依赖关系 |
|------|--------|------|------|--------|---------|
| 第1本:光伏建模控制 | 26 | 96 | ⭐⭐⭐ | 光伏+MPPT+并网 | 无 |
| 第2本:风电建模控制 | 26 | 96 | ⭐⭐⭐⭐ | 风电+气动+并网 | 可选第1本 |
| 第3本:储能建模控制 | 24 | 88 | ⭐⭐⭐ | 电池+变流器 | 可选第1本 |
| 第4本:辨识与测试 | 28 | 104 | ⭐⭐⭐⭐ | 数据驱动+测试 | 前1-3本任选 |
| 第5本:综合能源系统 | 30 | 112 | ⭐⭐⭐⭐⭐ | 水火风光储联合 | 需前1-3本 |
| **合计** | **134** | **496** | - | **完整体系** | - |

---

## 🎯 开发计划

### 总体时间线

#### Phase 1: 第一本书开发 (20周)
- Week 1-6: 第一部分 (光伏建模)
- Week 7-12: 第二部分 (MPPT)
- Week 13-18: 第三-五部分 (并网控制)
- Week 19-20: 整体优化

#### Phase 2: 第二/三本书并行 (24周)
- 第二本书 (风电): 20周
- 第三本书 (储能): 18周
- 并行开发,交叉测试

#### Phase 3: 第四本书开发 (18周)
- 整合前三本内容
- 重点开发辨识和测试模块

#### Phase 4: 第五本书开发 (28周) 🌟
- **最重要**的一本
- Week 1-6: 单元模型
- Week 7-16: 短期优化
- Week 17-22: 中长期优化
- Week 23-28: 综合仿真平台

#### Phase 5: 整体优化 (6周)
- 五本书统一风格
- 补充测试
- 完善文档
- 制作演示

**总周期**: 96周 ≈ 24个月 (2年)

### 里程碑

- **M1 (5个月)**: 第一本书完成,发布v0.1
- **M2 (11个月)**: 前三本书完成,发布v0.5
- **M3 (15个月)**: 第四本书完成,发布v0.8
- **M4 (22个月)**: 第五本书完成,发布v1.0
- **M5 (24个月)**: 整体优化,正式发布

---

## 📈 资源需求

### 人力资源 (建议)

**核心团队**:
- 技术负责人: 1人 (全职) - 新能源+控制背景
- 高级开发: 2人 (全职) - 1人侧重仿真,1人侧重优化
- 文档工程师: 1人 (半职)
- 测试工程师: 1人 (半职)

**顾问团队**:
- 新能源专家: 1-2人 (兼职) - 审核技术方案
- 控制专家: 1人 (兼职)
- 电力系统专家: 1人 (兼职)

### 技术资源

**软件工具**:
```
开发语言: Python 3.8+
优化求解器: CPLEX / Gurobi (学术授权)
IDE: PyCharm / VS Code
版本控制: Git + GitHub
文档: Markdown + LaTeX
```

**硬件需求**:
- 计算服务器: 多核CPU (32核+) + 64GB RAM
- 工作站: 每人一台 (i7/i9)
- 存储: 1TB+ (数据+代码)

### 数据资源

**需获取的真实数据**:
- 气象数据: 国家气象局/NASA
- 电力数据: 电网公司合作
- 水文数据: 水文站
- 机组参数: 设备制造商手册

---

## 💰 成本预估

### 人力成本 (24个月)

**核心团队**:
- 技术负责人: 40k×24 = 96万
- 高级开发×2: 30k×24×2 = 144万
- 文档工程师: 15k×24×0.5 = 18万
- 测试工程师: 15k×24×0.5 = 18万
- **小计**: 276万

**顾问费用** (按次): 20万

**总人力成本**: 约300万

### 其他成本
- 硬件设备: 15万
- 软件授权: 10万 (CPLEX/GUROBI学术版可免费)
- 数据购买: 5万
- 会议差旅: 10万
- **小计**: 40万

**总成本**: 约**340万**

### 低成本方案
- 小团队 (2-3人): 100-150万
- 学生团队 (研究生): 50-80万
- 开源社区协作: 20-40万

---

## 📚 预期成果与收益

### 教学成果
- ✅ **国内首套完整的新能源案例驱动教材**
- ✅ 填补新能源系统级仿真教材空白
- ✅ 覆盖"建模-仿真-控制-辨识-测试-优化"全流程
- ✅ 特色: **水火风光储联合仿真**

### 学术价值
- 发表教学论文: 5-10篇
- 申请教学成果奖
- 教材正式出版: 5本 (高等教育出版社/清华出版社)
- 开源贡献: GitHub Stars目标 1000+

### 社会效益
- 培养新能源系统工程师
- 推动"碳达峰、碳中和"人才培养
- 产学研合作: 与新能源企业、电网公司

### 商业潜力
- 教材销售: 单本售价80-120元, 5本套装400-500元
- 在线课程: 每门课程1000-3000元
- 企业培训: 定制化培训 5-10万/次
- 咨询服务: 综合能源系统方案设计
- **预计年收益**: 50-500万 (取决于推广)

---

## ✅ 成功关键因素

### 技术层面
1. **真实数据**: 必须获取真实的气象/电力数据
2. **求解器**: 需要商业优化求解器 (学术授权)
3. **计算资源**: 长时间序列仿真需要强大算力
4. **代码质量**: 严格测试,确保正确性

### 内容层面
1. **案例设计**: 必须贴近工程实际
2. **难度梯度**: 循序渐进,避免跳跃
3. **互补协调**: 五本书形成有机整体
4. **重点突出**: 第五本是核心,投入最多资源

### 团队层面
1. **跨学科**: 新能源+电力系统+控制+优化
2. **工程经验**: 至少1-2人有企业工作经验
3. **教学经验**: 了解学生认知规律
4. **开源精神**: 愿意分享,接受社区反馈

---

## 🚀 下一步行动

### 立即行动 (本月)
1. ✅ **完成总体方案** (本文档)
2. 🔲 组建核心团队
3. 🔲 申请科研经费
4. 🔲 建立GitHub仓库

### 近期行动 (3个月)
1. 🔲 开发第一本书前6个案例 (光伏建模)
2. 🔲 搭建开发环境和CI/CD
3. 🔲 获取真实数据
4. 🔲 申请优化求解器授权

### 中期行动 (1年)
1. 🔲 完成第一本书
2. 🔲 启动第二/三本书
3. 🔲 发布v0.5版本
4. 🔲 组织试用和反馈

### 长期目标 (2年)
1. 🔲 完成全部五本书
2. 🔲 发布v1.0正式版
3. 🔲 联系出版社出版
4. 🔲 开发在线课程

---

## 📞 联系与合作

### 欢迎合作
- 高校教师: 教学试用、反馈建议
- 研究生: 参与开发、毕业设计
- 企业工程师: 提供真实案例、数据
- 开源社区: 代码贡献、Bug修复

### 预期合作单位
- **高校**: 清华/浙大/华北电力/西交等
- **企业**: 国家电网/南方电网/阳光电源/金风科技等
- **研究机构**: 中国电科院/水规总院

---

## 📋 总结

### 核心亮点

1. **系统完整**:
   - 五本书涵盖新能源全产业链
   - 光伏→风电→储能→辨识测试→综合仿真
   - 134个案例,496学时

2. **特色鲜明**:
   - 重点: **水火风光储联合仿真与控制**
   - 多能互补、多时间尺度、多目标优化
   - 理论+仿真+测试+优化

3. **实用导向**:
   - 案例驱动,贴近工程
   - Python实现,开源共享
   - 配套真实数据

4. **难度递进**:
   - 第1-3本: 基础 (单一能源)
   - 第4本: 进阶 (辨识测试)
   - 第5本: 综合 (多能互补)

### 创新点

1. **首创性**: 国内首套完整新能源案例驱动教材
2. **综合性**: 水火风光储五种能源联合仿真
3. **实践性**: 从建模到优化全流程Python实现
4. **开源性**: GitHub开源,推动教育发展

### 可行性

✅ **技术可行**: Python生态成熟,优化库完善  
✅ **数据可获取**: 公开数据+合作获取  
✅ **团队可组建**: 国内新能源人才充足  
✅ **需求旺盛**: 碳中和目标下人才缺口大

### 预期影响

- **教学**: 填补新能源教材空白
- **科研**: 提供仿真平台和算法库
- **产业**: 培养系统工程师
- **社会**: 助力碳中和目标实现

---

**方案制定人**: Claude  
**日期**: 2025-11-04  
**版本**: v1.0-设计方案  
**状态**: ✅ 方案完成,待审批

---

## 附录: 快速索引

### 按能源类型

**光伏**: 第1本 (26案例)  
**风电**: 第2本 (26案例)  
**储能**: 第3本 (24案例)  
**水电**: 第5本案例3  
**火电**: 第5本案例4  
**综合**: 第5本案例26-30

### 按技术方向

**建模**: 各书第一部分  
**控制**: 各书第二-四部分  
**辨识**: 第4本  
**测试**: 第4本第五部分  
**优化**: 第5本  
**仿真**: 第5本案例30

### 按难度等级

**入门** (⭐): 案例1-3类  
**基础** (⭐⭐): 案例4-9类  
**中级** (⭐⭐⭐): 案例10-18类  
**高级** (⭐⭐⭐⭐): 案例19-25类  
**专家** (⭐⭐⭐⭐⭐): 案例26-30类

---

**本方案完毕！期待您的审阅和指导！**
